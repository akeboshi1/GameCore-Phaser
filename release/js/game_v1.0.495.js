(this.webpackJsonpTooqingCore=this.webpackJsonpTooqingCore||[]).push([[1],Array(470).concat([function(t,e,i){"use strict";i(625),i(641);var n=i(606);i.o(n,"AlertView")&&i.d(e,"AlertView",(function(){return n.AlertView})),i.o(n,"AlignmentType")&&i.d(e,"AlignmentType",(function(){return n.AlignmentType})),i.o(n,"AnimationModel")&&i.d(e,"AnimationModel",(function(){return n.AnimationModel})),i.o(n,"AxisType")&&i.d(e,"AxisType",(function(){return n.AxisType})),i.o(n,"BackgroundScaleButton")&&i.d(e,"BackgroundScaleButton",(function(){return n.BackgroundScaleButton})),i.o(n,"BasePanel")&&i.d(e,"BasePanel",(function(){return n.BasePanel})),i.o(n,"BubbleAnimation")&&i.d(e,"BubbleAnimation",(function(){return n.BubbleAnimation})),i.o(n,"ButtonEventDispatcher")&&i.d(e,"ButtonEventDispatcher",(function(){return n.ButtonEventDispatcher})),i.o(n,"CheckboxGroup")&&i.d(e,"CheckboxGroup",(function(){return n.CheckboxGroup})),i.o(n,"CommonBackground")&&i.d(e,"CommonBackground",(function(){return n.CommonBackground})),i.o(n,"ConstraintType")&&i.d(e,"ConstraintType",(function(){return n.ConstraintType})),i.o(n,"DragonbonesDisplay")&&i.d(e,"DragonbonesDisplay",(function(){return n.DragonbonesDisplay})),i.o(n,"DynamicImage")&&i.d(e,"DynamicImage",(function(){return n.DynamicImage})),i.o(n,"DynamicImageValue")&&i.d(e,"DynamicImageValue",(function(){return n.DynamicImageValue})),i.o(n,"FrameAnimation")&&i.d(e,"FrameAnimation",(function(){return n.FrameAnimation})),i.o(n,"FramesDisplay")&&i.d(e,"FramesDisplay",(function(){return n.FramesDisplay})),i.o(n,"GridLayoutGroup")&&i.d(e,"GridLayoutGroup",(function(){return n.GridLayoutGroup})),i.o(n,"ImageBBCodeValue")&&i.d(e,"ImageBBCodeValue",(function(){return n.ImageBBCodeValue})),i.o(n,"ImageValue")&&i.d(e,"ImageValue",(function(){return n.ImageValue})),i.o(n,"InputPanel")&&i.d(e,"InputPanel",(function(){return n.InputPanel})),i.o(n,"InputView")&&i.d(e,"InputView",(function(){return n.InputView})),i.o(n,"ItemInfoTips")&&i.d(e,"ItemInfoTips",(function(){return n.ItemInfoTips})),i.o(n,"ItemsConsumeFunPanel")&&i.d(e,"ItemsConsumeFunPanel",(function(){return n.ItemsConsumeFunPanel})),i.o(n,"LabelInput")&&i.d(e,"LabelInput",(function(){return n.LabelInput})),i.o(n,"MainUIScene")&&i.d(e,"MainUIScene",(function(){return n.MainUIScene})),i.o(n,"NinePatch")&&i.d(e,"NinePatch",(function(){return n.NinePatch})),i.o(n,"NinePatchButton")&&i.d(e,"NinePatchButton",(function(){return n.NinePatchButton})),i.o(n,"PlayScene")&&i.d(e,"PlayScene",(function(){return n.PlayScene})),i.o(n,"ProgressMaskBar")&&i.d(e,"ProgressMaskBar",(function(){return n.ProgressMaskBar})),i.o(n,"ProgressThreeBar")&&i.d(e,"ProgressThreeBar",(function(){return n.ProgressThreeBar})),i.o(n,"PropItem")&&i.d(e,"PropItem",(function(){return n.PropItem})),i.o(n,"SoundButton")&&i.d(e,"SoundButton",(function(){return n.SoundButton})),i.o(n,"TextButton")&&i.d(e,"TextButton",(function(){return n.TextButton})),i.o(n,"TextToolTips")&&i.d(e,"TextToolTips",(function(){return n.TextToolTips})),i.o(n,"ThreeSliceButton")&&i.d(e,"ThreeSliceButton",(function(){return n.ThreeSliceButton})),i.o(n,"ThreeSlicePath")&&i.d(e,"ThreeSlicePath",(function(){return n.ThreeSlicePath})),i.o(n,"ToggleButton")&&i.d(e,"ToggleButton",(function(){return n.ToggleButton})),i.o(n,"ToggleColorButton")&&i.d(e,"ToggleColorButton",(function(){return n.ToggleColorButton})),i.o(n,"TweenCompent")&&i.d(e,"TweenCompent",(function(){return n.TweenCompent})),i.o(n,"UIDragonbonesDisplay")&&i.d(e,"UIDragonbonesDisplay",(function(){return n.UIDragonbonesDisplay})),i.o(n,"UiManager")&&i.d(e,"UiManager",(function(){return n.UiManager})),i.o(n,"ValueContainer")&&i.d(e,"ValueContainer",(function(){return n.ValueContainer}));i(632),i(603),i(623);var s=i(483);i.d(e,"MainUIScene",(function(){return s.c})),i.d(e,"PlayScene",(function(){return s.d}));var r=i(124);i.o(r,"AlertView")&&i.d(e,"AlertView",(function(){return r.AlertView})),i.o(r,"AlignmentType")&&i.d(e,"AlignmentType",(function(){return r.AlignmentType})),i.o(r,"AnimationModel")&&i.d(e,"AnimationModel",(function(){return r.AnimationModel})),i.o(r,"AxisType")&&i.d(e,"AxisType",(function(){return r.AxisType})),i.o(r,"BackgroundScaleButton")&&i.d(e,"BackgroundScaleButton",(function(){return r.BackgroundScaleButton})),i.o(r,"BasePanel")&&i.d(e,"BasePanel",(function(){return r.BasePanel})),i.o(r,"BubbleAnimation")&&i.d(e,"BubbleAnimation",(function(){return r.BubbleAnimation})),i.o(r,"ButtonEventDispatcher")&&i.d(e,"ButtonEventDispatcher",(function(){return r.ButtonEventDispatcher})),i.o(r,"CheckboxGroup")&&i.d(e,"CheckboxGroup",(function(){return r.CheckboxGroup})),i.o(r,"CommonBackground")&&i.d(e,"CommonBackground",(function(){return r.CommonBackground})),i.o(r,"ConstraintType")&&i.d(e,"ConstraintType",(function(){return r.ConstraintType})),i.o(r,"DragonbonesDisplay")&&i.d(e,"DragonbonesDisplay",(function(){return r.DragonbonesDisplay})),i.o(r,"DynamicImage")&&i.d(e,"DynamicImage",(function(){return r.DynamicImage})),i.o(r,"DynamicImageValue")&&i.d(e,"DynamicImageValue",(function(){return r.DynamicImageValue})),i.o(r,"FrameAnimation")&&i.d(e,"FrameAnimation",(function(){return r.FrameAnimation})),i.o(r,"FramesDisplay")&&i.d(e,"FramesDisplay",(function(){return r.FramesDisplay})),i.o(r,"GridLayoutGroup")&&i.d(e,"GridLayoutGroup",(function(){return r.GridLayoutGroup})),i.o(r,"ImageBBCodeValue")&&i.d(e,"ImageBBCodeValue",(function(){return r.ImageBBCodeValue})),i.o(r,"ImageValue")&&i.d(e,"ImageValue",(function(){return r.ImageValue})),i.o(r,"InputPanel")&&i.d(e,"InputPanel",(function(){return r.InputPanel})),i.o(r,"InputView")&&i.d(e,"InputView",(function(){return r.InputView})),i.o(r,"ItemInfoTips")&&i.d(e,"ItemInfoTips",(function(){return r.ItemInfoTips})),i.o(r,"ItemsConsumeFunPanel")&&i.d(e,"ItemsConsumeFunPanel",(function(){return r.ItemsConsumeFunPanel})),i.o(r,"LabelInput")&&i.d(e,"LabelInput",(function(){return r.LabelInput})),i.o(r,"NinePatch")&&i.d(e,"NinePatch",(function(){return r.NinePatch})),i.o(r,"NinePatchButton")&&i.d(e,"NinePatchButton",(function(){return r.NinePatchButton})),i.o(r,"ProgressMaskBar")&&i.d(e,"ProgressMaskBar",(function(){return r.ProgressMaskBar})),i.o(r,"ProgressThreeBar")&&i.d(e,"ProgressThreeBar",(function(){return r.ProgressThreeBar})),i.o(r,"PropItem")&&i.d(e,"PropItem",(function(){return r.PropItem})),i.o(r,"SoundButton")&&i.d(e,"SoundButton",(function(){return r.SoundButton})),i.o(r,"TextButton")&&i.d(e,"TextButton",(function(){return r.TextButton})),i.o(r,"TextToolTips")&&i.d(e,"TextToolTips",(function(){return r.TextToolTips})),i.o(r,"ThreeSliceButton")&&i.d(e,"ThreeSliceButton",(function(){return r.ThreeSliceButton})),i.o(r,"ThreeSlicePath")&&i.d(e,"ThreeSlicePath",(function(){return r.ThreeSlicePath})),i.o(r,"ToggleButton")&&i.d(e,"ToggleButton",(function(){return r.ToggleButton})),i.o(r,"ToggleColorButton")&&i.d(e,"ToggleColorButton",(function(){return r.ToggleColorButton})),i.o(r,"TweenCompent")&&i.d(e,"TweenCompent",(function(){return r.TweenCompent})),i.o(r,"UIDragonbonesDisplay")&&i.d(e,"UIDragonbonesDisplay",(function(){return r.UIDragonbonesDisplay})),i.o(r,"UiManager")&&i.d(e,"UiManager",(function(){return r.UiManager})),i.o(r,"ValueContainer")&&i.d(e,"ValueContainer",(function(){return r.ValueContainer}));i(600)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBasePanel",(function(){return h}));var n,s=i(470),r=i(11),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicaBasePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i}return a(PicaBasePanel,t),PicaBasePanel.prototype.initResource=function(){var t;this.atlasNames&&(t=this.uiManager.getUrlDatas(this.atlasNames));if(this.textures){var e=this.uiManager.getUrlDatas(this.textures,r.e.texture);t=t?t.concat(e):e}if(t)for(var i=0,n=t;i<n.length;i++){var s=n[i];this.scene.textures.exists(s.atlasName)||(s.uiType===r.e.atlas?this.setResourcesData("atlas",s.atlasName,s.atlasUrl,s.jsonUrl,s.foldType):s.uiType===r.e.texture&&this.setResourcesData("image",s.atlasName,s.atlasUrl,void 0,s.foldType))}},PicaBasePanel.prototype.preload=function(){this.initResource(),t.prototype.preload.call(this)},PicaBasePanel.prototype.setLinear=function(e){if(t.prototype.setLinear.call(this,e),this.atlasNames)for(var i=0,n=this.atlasNames;i<n.length;i++){var s=n[i];"string"==typeof s?t.prototype.setLinear.call(this,s):t.prototype.setLinear.call(this,s.atlasName)}},PicaBasePanel.prototype.setResourcesData=function(t,e,i,n,s){this.scene.textures.exists(e)||(this.mResources||(this.mResources=new Map),this.mResources.set(e,{dpr:this.dpr,type:t,texture:i,data:n,foldType:s}))},PicaBasePanel.prototype.addResources=function(t,e){if(e.type&&this.scene.load[e.type]){e.foldType=e.foldType||r.b.DPR;var i=e.foldType===r.b.DPR?o.Url.getUIRes(e.dpr,e.texture):o.Url.getRes(e.texture),n=e.foldType===r.b.DPR?o.Url.getUIRes(e.dpr,e.data):o.Url.getRes(e.data);this.scene.load[e.type](t,i,n)}},PicaBasePanel}(s.BasePanel)},function(t,e,i){"use strict";i.r(e);var n=i(535);i.d(e,"ItemButton",(function(){return n.ItemButton}));var s=i(473);i.d(e,"DetailDisplay",(function(){return s.DetailDisplay}));var r=i(538);i.d(e,"BackTextButton",(function(){return r.BackTextButton}));var o=i(539);i.d(e,"EnergyProgressBar",(function(){return o.EnergyProgressBar}))},function(t,e,i){"use strict";i.r(e),i.d(e,"DetailDisplay",(function(){return l}));var n,s,r=i(470),o=i(0),a=i(195),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function DetailDisplay(e,i){var n=t.call(this,e)||this;return n.render=i,n.mFixedSize=0,n.curLoadType=s.None,n.isLoading=!1,n.mFixScale=1,n}return h(DetailDisplay,t),DetailDisplay.prototype.setFixedScale=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=0),this.mFixedSize=e,this.mFixScale=t,this.scale=t,this},DetailDisplay.prototype.loadDisplay=function(t){var e=t.display;e&&(""!==e.texturePath&&""!==e.dataPath?t.animations.length>0?this.loadElement(t):this.loadUrl(o.Url.getOsdRes(e.texturePath),o.Url.getOsdRes(e.dataPath)):this.loadUrl(e.texturePath,e.dataPath))},DetailDisplay.prototype.loadElement=function(t){var e=this;this.curLoadType=s.FramesDisplay,this.clearDisplay(),this.mDisplay=t;var i=t.animations;this.mFramesDisplay||(this.mFramesDisplay=new r.FramesDisplay(this.scene,this.render,void 0));var n=t.display;if(n&&i.length>0){for(var h=[],l=i[0].node.name,c=0,p=i;c<p.length;c++){var d=p[c];d.baseLoc="0,0";for(var m=0,u=d.layer;m<u.length;m++){u[m].offsetLoc={x:0,y:0}}h.push(new r.AnimationModel(d))}var addDisplay_1=function(){var t=e.mFramesDisplay,i=t.spriteWidth,n=t.spriteHeight;if(0!==e.mFixedSize){e.scale=1;var s=e.width/i,r=e.height/n,o=s>r?r:s;e.mFramesDisplay.scale=1===e.mFixedSize?o:Math.round(o)}else e.mFramesDisplay.scale=1,e.scale=e.mFixScale;var a=e.mFramesDisplay.scale;e.mFramesDisplay.x=.5*-i*a,e.mFramesDisplay.y=.5*-n*a,e.addDisplay()};this.mFramesDisplay.createdHandler=new o.Handler(this,(function(){e.mFramesDisplay.play({name:l,flip:!1}),addDisplay_1()}));for(var y=new Map,f=0,g=h;f<g.length;f++){var P=g[f];y.set(P.name,P)}var v={animations:y,id:t.id,gene:a.sync(n.dataPath+n.texturePath),discriminator:"FramesModel",animationName:l,display:n};this.mFramesDisplay.load(v)||addDisplay_1()}},DetailDisplay.prototype.loadAvatar=function(t,e,i){var n=this;void 0===e&&(e=1),this.curLoadType=s.DragonbonesDisplay,this.clearDisplay(),this.mDragonboneDisplay||(this.mDragonboneDisplay=new r.UIDragonbonesDisplay(this.scene,this.render),i&&(this.mDragonboneDisplay.x+=i.x,this.mDragonboneDisplay.y+=i.y)),this.addDisplay(),t.suits&&this.mDragonboneDisplay.setSuits(t.suits),this.mDragonboneDisplay.once("initialized",(function(){n.mDragonboneDisplay.setBack(!1),n.mDragonboneDisplay.play({name:"idle",flip:!1})}));var o={id:0,avatar:t.avatar};this.mDragonboneDisplay.load(o),this.mDragonboneDisplay.scale=e,this.scale=1},DetailDisplay.prototype.loadUrl=function(t,e){this.mUrl=t,this.curLoadType=s.Image,this.clearDisplay(),this.mImage||(this.mImage=this.scene.make.image(void 0,!1)),this.scene.textures.exists(t)?this.onCompleteHandler():(e?this.scene.load.atlas(t,o.Url.getOsdRes(t),o.Url.getOsdRes(e)):this.scene.load.image(t,o.Url.getOsdRes(t)),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onCompleteHandler,this),this.scene.load.start())},DetailDisplay.prototype.loadSprite=function(t,e,i,n){var a=this;this.curLoadType=s.FrameAnimation,this.clearDisplay(),this.mFrameAni||(this.mFrameAni=new r.FrameAnimation(this.scene)),this.mFrameAni.load(t,e,i,new o.Handler(this,(function(){if(void 0===n)if(0!==a.mFixedSize){a.scale=1;var t=a.width/a.mFrameAni.width,e=a.height/a.mFrameAni.height,i=t>e?e:t;a.mFrameAni.scale=1===a.mFixedSize?i:Math.round(i)}else a.mFrameAni.scale=1,a.scale=a.mFixScale;else a.mFrameAni.scale=n,a.scale=1;a.addDisplay()})))},DetailDisplay.prototype.displayLoading=function(t,e,i,n){this.loadSprite(t,e,i,n),this.isLoading=!0},DetailDisplay.prototype.setTexture=function(t,e,i){if(this.curLoadType=s.Image,this.clearDisplay(),this.mImage?this.mImage.setTexture(t,e):this.mImage=this.scene.make.image({key:t,frame:e},!1),this.addDisplay(),void 0===i)if(0!==this.mFixedSize){this.scale=1;var n=this.width/this.mImage.width,r=this.height/this.mImage.height,o=n>r?r:n;this.mImage.scale=1===this.mFixedSize?o:Math.round(o)}else this.mImage.scale=1,this.scale=this.mFixScale;else this.mImage.scale=i,this.scale=1;this.emit("show",this.mImage)},DetailDisplay.prototype.setNearest=function(){this.mImage&&this.mImage.texture.setFilter(Phaser.Textures.FilterMode.NEAREST)},DetailDisplay.prototype.setComplHandler=function(t){this.complHandler=t},DetailDisplay.prototype.setPlayAnimation=function(t,e){void 0===e&&(e=!1),this.mDragonboneDisplay&&(this.mDragonboneDisplay.setBack(e),this.mDragonboneDisplay.play(t))},Object.defineProperty(DetailDisplay.prototype,"display",{get:function(){return this.mDisplay},enumerable:!1,configurable:!0}),DetailDisplay.prototype.onCompleteHandler=function(){if(this.scene){if(this.addDisplay(),this.mDisplay){this.mDisplay.display;var t=this.mDisplay.animations;if(!t||t.length<=0)return;this.mImage.setTexture(this.mDisplay.display.texturePath,t[0].frameName[0])}else this.mImage.setTexture(this.mUrl);if(0!==this.mFixedSize){this.scale=1,this.mImage.scale=1;var e=this.width/this.mImage.displayWidth,i=this.height/this.mImage.displayHeight,n=e>i?i:e;this.mImage.scale=1===this.mFixedSize?n:Math.round(n)}else this.mImage.scale=this.mFixScale,this.mImage.scale=1,this.setSize(this.mImage.width*this.scale,this.mImage.height*this.scale);this.emit("show",this.mImage),this.complHandler&&this.complHandler.run()}},DetailDisplay.prototype.clearDisplay=function(){this.mImage&&this.remove(this.mImage),this.mDragonboneDisplay&&this.remove(this.mDragonboneDisplay),this.mFramesDisplay&&this.remove(this.mFramesDisplay),this.mFrameAni&&(this.isLoading||this.remove(this.mFrameAni)),this.mDisplay=void 0,this.scene.load.off(Phaser.Loader.Events.COMPLETE,this.onCompleteHandler,this)},DetailDisplay.prototype.addDisplay=function(){this.scene&&(this.isLoading&&this.remove(this.mFrameAni),this.curLoadType===s.Image?this.add(this.mImage):this.curLoadType===s.FramesDisplay?this.add(this.mFramesDisplay):this.curLoadType===s.FrameAnimation?this.add(this.mFrameAni):this.curLoadType===s.DragonbonesDisplay&&this.add(this.mDragonboneDisplay),this.isLoading=!1)},DetailDisplay}(Phaser.GameObjects.Container);!function(t){t[t.None=0]="None",t[t.Image=1]="Image",t[t.DragonbonesDisplay=2]="DragonbonesDisplay",t[t.FramesDisplay=3]="FramesDisplay",t[t.FrameAnimation=4]="FrameAnimation"}(s||(s={}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return y}));var n,s=i(0),r=i(326),o=i(10),a=i(77),h=i(531),l=i(1),c=i(603),p=i(483),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function fulfilled(t){try{step(n.next(t))}catch(t){r(t)}}function rejected(t){try{step(n.throw(t))}catch(t){r(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function verb(r){return function(a){return function step(r){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(s=2&r[0]?n.return:r[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,r[1])).done)return s;switch(n=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],n=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},d=function(){function MotionManager(t){this.render=t,this.dirty=!1,this.holdDelay=200,this.scaleRatio=t.scaleRatio}return MotionManager.prototype.addListener=function(){this.scene&&(this.scene.input.on("pointerup",this.onPointerUpHandler,this),this.scene.input.on("pointerdown",this.onPointerDownHandler,this),this.scene.input.on("gameobjectdown",this.onGameObjectDownHandler,this),this.scene.input.on("gameobjectup",this.onGameObjectUpHandler,this))},MotionManager.prototype.removeListener=function(){this.scene&&(this.scene.input.off("pointerup",this.onPointerUpHandler,this),this.scene.input.off("pointerdown",this.onPointerDownHandler,this),this.scene.input.off("pointermove",this.onPointerMoveHandler,this),this.scene.input.off("gameobjectdown",this.onGameObjectDownHandler,this),this.scene.input.off("gameobjectup",this.onGameObjectUpHandler,this))},MotionManager.prototype.resize=function(t,e){this.scaleRatio=this.render.scaleRatio},MotionManager.prototype.update=function(t,e){if(!1!==this.dirty&&(this.curtime+=e,!(this.curtime<200))){this.curtime=0;var i=this.scene.input.activePointer;if(i.camera&&i.camera.scene&&i.camera.scene.sys.settings.key===p.c.name)return this.dirty=!1,this.scene.input.off("pointermove",this.onPointerMoveHandler,this),void this.clearGameObject();if(i&&this.render.displayManager.user&&this.render.displayManager){var n=this.render.displayManager.user,s=n.x,r=n.y,o=i.worldX/this.scaleRatio-s,a=i.worldY/this.scaleRatio-r,h=this.scene.cameras.main.getWorldPoint(i.x-o,i.y-a);this.start(h.x/this.scaleRatio,h.y/this.scaleRatio)}}},MotionManager.prototype.setScene=function(t){this.removeListener(),this.scene=t,this.scene&&this.addListener()},MotionManager.prototype.destroy=function(){this.removeListener()},MotionManager.prototype.start=function(t,e,i){this.render.physicalPeer.moveMotion(t,e,i)},MotionManager.prototype.movePath=function(t,e,i,n,s){this.render.physicalPeer.findPath(n,s)},MotionManager.prototype.stop=function(){this.render.physicalPeer.stopMove()},MotionManager.prototype.onPointerUpHandler=function(t){return __awaiter(this,void 0,void 0,(function(){var e,i,n,r,o;return __generator(this,(function(a){switch(a.label){case 0:return this.dirty=!1,this.scene.input.off("pointermove",this.onPointerMoveHandler,this),Math.abs(t.downX-t.upX)>=5*this.render.scaleRatio&&Math.abs(t.downY-t.upY)>=5*this.render.scaleRatio||t.upTime-t.downTime>this.holdDelay?(this.stop(),[3,5]):[3,1];case 1:return this.gameObject?(e=this.gameObject.getData("id"))?(i=this.render.displayManager.getDisplay(e)).nodeType===c.a.CharacterNodeType?(this.render.mainPeer.activePlayer(e),this.clearGameObject(),[2]):[4,this.render.physicalPeer.getInteractivePosition(e)]:[3,3]:[3,4];case 2:(n=a.sent())&&0!==n.length||(r=i.x,o=i.y,n=[{x:r,y:o}]),this.movePath(t.worldX/this.render.scaleRatio,t.worldY/this.render.scaleRatio,0,n,e),a.label=3;case 3:return[3,5];case 4:this.movePath(t.worldX/this.render.scaleRatio,t.worldY/this.render.scaleRatio,0,[new s.LogicPos(t.worldX/this.scaleRatio,t.worldY/this.scaleRatio)]),a.label=5;case 5:return this.clearGameObject(),[2]}}))}))},MotionManager.prototype.onPointerDownHandler=function(t){return __awaiter(this,void 0,void 0,(function(){var t=this;return __generator(this,(function(e){return this.scene.input.on("pointermove",this.onPointerMoveHandler,this),this.holdTime=setTimeout((function(){t.dirty=!0}),this.holdDelay),[2]}))}))},MotionManager.prototype.onPointerMoveHandler=function(t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){return this.dirty=!0,[2]}))}))},MotionManager.prototype.onPointeroutHandler=function(){this.dirty=!1,this.scene.input.off("pointermove",this.onPointerMoveHandler,this),this.stop(),clearTimeout(this.holdTime)},MotionManager.prototype.onGameObjectDownHandler=function(t,e){this.gameObject=e},MotionManager.prototype.onGameObjectUpHandler=function(t,e){},MotionManager.prototype.clearGameObject=function(){this.gameObject=null,clearTimeout(this.holdTime)},MotionManager}(),m=i(13),u=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),y=function(t){function PlayScene(e){var i=t.call(this,e||{key:l.SceneName.PLAY_SCENE})||this;return i.loadState=l.PlaySceneLoadState.CREATING_SCENE,i}return u(PlayScene,t),Object.defineProperty(PlayScene.prototype,"motionMgr",{get:function(){return this.motionManager},enumerable:!1,configurable:!0}),PlayScene.prototype.create=function(){this.loadState=l.PlaySceneLoadState.CREATING_ROOM,s.Logger.getInstance().debug("create playscene");var e=this.cameras.main,i=this.sys.scale,n=i.width,h=i.height;this.cameras.addExisting(new r.a(0,0,n,h,this.render.scaleRatio),!0),this.cameras.remove(e),this.game.scene.getScene(a.a.name)||this.game.scene.add(a.a.name,a.a,!1),this.game.scene.getScene(a.a.name).scene.isActive()?this.render.initUI():this.scene.launch(a.a.name,{render:this.render}),this.scene.sendToBack(),this.scale.on("orientationchange",this.checkOriention,this),this.scale.on("resize",this.checkSize,this),this.render.sceneManager.setMainScene(this),this.initInput(),this.render.camerasManager.startRoomPlay(this),this.layerManager.addLayer(this,o.d,PlayScene.LAYER_GROUNDCLICK,1),this.layerManager.addLayer(this,o.d,PlayScene.LAYER_GROUND2,2),this.layerManager.addLayer(this,o.h,PlayScene.LAYER_GROUND,3).setScale(this.render.scaleRatio),this.layerManager.addLayer(this,o.d,PlayScene.LAYER_MIDDLE,4).setScale(this.render.scaleRatio),this.layerManager.addLayer(this,o.h,PlayScene.LAYER_FLOOR,4).setScale(this.render.scaleRatio),this.layerManager.addLayer(this,o.l,PlayScene.LAYER_SURFACE,5).setScale(this.render.scaleRatio),this.layerManager.addLayer(this,o.d,PlayScene.LAYER_ATMOSPHERE,6),this.layerManager.addLayer(this,o.d,PlayScene.LAYER_SCENEUI,7),this.render.startRoomPlay(),this.render.changeScene(this),this.initListener(),t.prototype.create.call(this)},PlayScene.prototype.update=function(t,e){this.render.updateRoom(t,e),this.layerManager.update(t,e),this.motionManager&&this.motionManager.update(t,e)},PlayScene.prototype.getKey=function(){return this.sys.config.key},Object.defineProperty(PlayScene.prototype,"loadState",{get:function(){return this.mLoadState},set:function(t){t!==this.mLoadState&&(s.Logger.getInstance().debug("PlayScene change loadState: ",t),this.mLoadState=t,t===l.PlaySceneLoadState.LOAD_COMPOLETE&&this.render.hideLoading())},enumerable:!1,configurable:!0}),PlayScene.prototype.onRoomCreated=function(){this.loadState=l.PlaySceneLoadState.LOAD_COMPOLETE},PlayScene.prototype.initInput=function(){this.motionManager=new d(this.render),this.motionManager.setScene(this)},PlayScene.prototype.initListener=function(){this.input.on("pointerdown",this.onPointerDownHandler,this),this.input.on("pointerup",this.onPointerUpHandler,this)},PlayScene.prototype.onPointerDownHandler=function(t){this.addPointerMoveHandler()},PlayScene.prototype.onPointerUpHandler=function(t){this.removePointerMoveHandler()},PlayScene.prototype.addPointerMoveHandler=function(){this.input.on("pointermove",this.onPointerMoveHandler,this),this.input.on("gameout",this.onGameOutHandler,this)},PlayScene.prototype.removePointerMoveHandler=function(){this.input.off("pointermove",this.onPointerMoveHandler,this),this.input.off("gameout",this.onGameOutHandler,this),this.render.camerasManager.moving&&(this.render.syncCameraScroll(),this.render.camerasManager.moving=!1)},PlayScene.prototype.onPointerMoveHandler=function(t){this.render.camerasManager.targetFollow||this.render.camerasManager.offsetScroll(t.prevPosition.x-t.position.x,t.prevPosition.y-t.position.y)},PlayScene.prototype.onGameOutHandler=function(){this.removePointerMoveHandler()},PlayScene.prototype.checkOriention=function(t){t===Phaser.Scale.PORTRAIT||Phaser.Scale.LANDSCAPE},PlayScene.prototype.checkSize=function(t){t.width,t.height},PlayScene.LAYER_GROUNDCLICK="groundClickLayer",PlayScene.LAYER_GROUND2="groundLayer2",PlayScene.LAYER_GROUND=m.LayerEnum.Terrain.toString(),PlayScene.LAYER_MIDDLE="middleLayer",PlayScene.LAYER_FLOOR=m.LayerEnum.Floor.toString(),PlayScene.LAYER_SURFACE=m.LayerEnum.Surface.toString(),PlayScene.LAYER_ATMOSPHERE="atmosphere",PlayScene.LAYER_SCENEUI="sceneUILayer",PlayScene}(h.a)},function(t,e,i){"use strict";i.d(e,"c",(function(){return s.ItemButton})),i.d(e,"a",(function(){return s.DetailDisplay})),i.d(e,"e",(function(){return s.PicaRenderUiManager})),i.d(e,"d",(function(){return s.PicaItemTipsPanel})),i.d(e,"b",(function(){return h}));var n,s=i(481),r=i(2),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function FallEffect(e,i){var n=t.call(this,e)||this;return n.scale=i,n}return a(FallEffect,t),FallEffect.prototype.show=function(t){this.mStatus=t,this.load()},FallEffect.prototype.load=function(){this.scene.textures.exists("fall_effect")?this.onCompleteHandler():(this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onCompleteHandler,this),this.scene.load.atlas("fall_effect",o.Url.getRes("ui/fall_effect/falleffect.png"),o.Url.getRes("ui/fall_effect/falleffect.json")),this.scene.load.start())},FallEffect.prototype.showEnable=function(){this.mDisplay=new l(this.scene,"fall_effect"),this.add(this.mDisplay)},FallEffect.prototype.showDisable=function(){this.mDisplay=new c(this.scene,"fall_effect"),this.add(this.mDisplay)},FallEffect.prototype.onCompleteHandler=function(){var t=this;this.mStatus===r.op_def.PathReachableStatus.PATH_REACHABLE_AREA||this.mStatus===r.op_def.PathReachableStatus.PATH_REACHABLE_WITH_INTERACTION_SPRITE?this.showEnable():this.showDisable(),this.scene.tweens.add({targets:this,duration:1e3,ease:"Expo",delay:1e3,props:{alpha:0},onComplete:function(){t.destroy(),t.emit("remove",t)}})},FallEffect}(Phaser.GameObjects.Container),l=function(t){function EnableDisplay(e,i){var n=t.call(this,e)||this;n.mImage=e.make.sprite({key:i,x:9,y:-20},!1).setScale(.5),n.add(n.mImage),n.mEllipse=e.make.sprite(void 0,!1),n.addAt(n.mEllipse,0);var s={key:"fill_effect_enable",frames:n.scene.anims.generateFrameNames("fall_effect",{prefix:"enable",end:6,zeroPad:2}),frameRate:16,repeat:0};n.scene.anims.create(s),n.mImage.play("fill_effect_enable");var r={key:"fill_effect_ellipse",frames:n.scene.anims.generateFrameNames("fall_effect",{prefix:"ellipse",end:7,zeroPad:2}),frameRate:10,repeat:0};return n.scene.anims.create(r),n.mEllipse.play("fill_effect_ellipse"),n}return a(EnableDisplay,t),EnableDisplay}(Phaser.GameObjects.Container),c=function(t){function DisableDisplay(e,i){var n=t.call(this,e)||this;return n.mImage=e.make.image({key:i,y:-6,frame:"disable"},!1).setScale(.5),n.add(n.mImage),n.mEllipse=e.make.image({key:i,frame:"forbid"},!1).setScale(.5),n.add([n.mImage,n.mEllipse]),n}return a(DisableDisplay,t),DisableDisplay}(Phaser.GameObjects.Container);!function(){function FallEffectContainer(t){this.render=t,this.mFalls=[]}FallEffectContainer.prototype.addFall=function(t,e){if(t){var i=this.render.sceneManager.getMainScene(),n=new h(i,this.render.scaleRatio);n.once("remove",this.onRemoveHandler,this),n.setPosition(t.x,t.y),i.layerManager.addToLayer("sceneUILayer",n)}},FallEffectContainer.prototype.onRemoveHandler=function(t){}}()},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaSingleManager",(function(){return s}));var n=i(0),s=function(){function PicaSingleManager(t){this.uiMgr=t,this.singleMap=new Map,this.uiMgr=t,PicaSingleManager.Intsance=this}return PicaSingleManager.prototype.destroy=function(){this.clearSingleMap()},PicaSingleManager.prototype.clearSingleMap=function(){var t=this.singleMap;t.forEach((function(t,e){t.destroy(),n.Logger.getInstance().debug(t)})),t.clear()},PicaSingleManager.createSinglePanel=function(t){var e=this.Intsance,i=new t(this.Intsance.uiMgr);return e.singleMap.set(t.name,i),i},PicaSingleManager}()},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaManorBasePanel",(function(){return h}));var n,s=i(5),r=i(11),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicaManorBasePanel(e,i,n,s,r,o,a){var h=t.call(this,e,i,n)||this;return h.dpr=o,h.key=a,h.setSize(s,r),h.create(),h}return a(PicaManorBasePanel,t),PicaManorBasePanel.prototype.setTitleText=function(t){this.titleText.text=t},PicaManorBasePanel.prototype.setCloseHandler=function(t){this.closeHandler=t},PicaManorBasePanel.prototype.create=function(){var t=this.width,e=this.height;this.createBackground(t,e);var i=.5*-e;this.titlebg=this.scene.make.image({x:0,y:0,key:r.c.common2Key,frame:"title"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titlebg.y=i+5*this.dpr,this.add(this.titlebg),this.titleText=this.scene.make.text({x:0,y:this.titlebg.y+2*this.dpr,text:o.i18n.t("manor.title"),style:{color:"#905C06",fontSize:21*this.dpr,fontFamily:o.Font.DEFULT_FONT}}).setOrigin(.5),this.titleText.setFontStyle("bold"),this.titleText.setResolution(this.dpr),this.add(this.titleText),this.closeBtn=new s.Button(this.scene,r.c.commonKey,"close"),this.closeBtn.setDisplaySize(28*this.dpr,28*this.dpr),this.closeBtn.setPosition(.5*this.width-8*this.dpr,i+7*this.dpr),this.closeBtn.on(String(s.ClickEvent.Tap),this.onCloseHandler,this),this.add(this.closeBtn)},PicaManorBasePanel.prototype.createBackground=function(t,e){this.bg=new s.NineSlicePatch(this.scene,0,0,t,e,r.c.commonKey,"bg",{left:70*this.dpr,top:30*this.dpr,right:30*this.dpr,bottom:70*this.dpr}),this.add(this.bg)},PicaManorBasePanel.prototype.onCloseHandler=function(){this.closeHandler&&this.closeHandler.run()},PicaManorBasePanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"SecondaryMenuPanel",(function(){return o}));var n,s=i(5),r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function SecondaryMenuPanel(e,i,n,r,o,a,h,l){var c=t.call(this,e,i,n)||this;return c.dpr=a,c.zoom=h,c.setSize(r,o),l.cellupCallBack=c.onSelectCategoryHandler.bind(c),c.gameScroll=new s.GameScroller(c.scene,l),c.add(c.gameScroll),c}return r(SecondaryMenuPanel,t),SecondaryMenuPanel.prototype.setHandler=function(t,e){this.categoryHandler=t,this.subCategoryHandler=e},SecondaryMenuPanel.prototype.setButtonChangeHandler=function(t,e,i,n){this.categoryNormalHandler=t,this.categoryDownHandler=e,this.subNormalHandler=i,this.subDownHandler=n},SecondaryMenuPanel.prototype.setCategories=function(t,e,i,n){this.categoryBtn=void 0,this.gameScroll.clearItems();for(var s=i.width,r=i.height,o=i.key,a=i.normalFrame,h=i.downFrame,l=i.patchConfig,c=i.music,p=i.bold,d=[],m=0,u=e;m<u.length;m++){var y=u[m],f=y.text,g=new t(this.scene,o,a,h,f,c,this.dpr,this.zoom,l);i.textStyle&&g.setTextStyle(i.textStyle),g.setData("category",y.data),g.disableInteractive(),p&&g.setFontStyle("bold"),s&&(g.width=s),r&&(g.height=r),this.gameScroll.addItem(g),d.push(g)}this.gameScroll.Sort(!0),this.gameScroll.refreshMask(),n&&n.runWith([d]),this.onSelectCategoryHandler(d[0])},SecondaryMenuPanel.prototype.setSubItems=function(t){if(this.gridTable){this.subCategoryBtn=void 0,this.gridTable.setItems(t),this.gridTable.resetMask();var e=this.gridTable.getCells();if(e){var i=e[0];i&&i.container&&this.onSubCategoryHandler(i.container)}}},SecondaryMenuPanel.prototype.createGrideTable=function(t,e,i,n,r,o,a,h){var l=this;void 0===h&&(h=1);var c={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:r,cellHeight:o,reuseCellContainer:!0,zoom:this.zoom},scrollMode:h,clamplChildOY:!1,createCellContainerCallback:a};this.gridTable=new s.GameGridTable(this.scene,c),this.gridTable.layout(),this.gridTable.on("cellTap",(function(t){t&&l.onSubCategoryHandler(t)})),this.add(this.gridTable),this.gridTable.resetMask()},SecondaryMenuPanel.prototype.onSelectCategoryHandler=function(t){this.categoryBtn&&(this.categoryNormalHandler?this.categoryNormalHandler.runWith(this.categoryBtn):this.categoryBtn.changeNormal()),this.categoryDownHandler?this.categoryDownHandler.runWith(t):t.changeDown(),this.categoryBtn=t;var e=t.getData("category");this.categoryHandler&&this.categoryHandler.runWith(e)},SecondaryMenuPanel.prototype.onSubCategoryHandler=function(t){this.subCategoryBtn&&(this.subNormalHandler?this.subNormalHandler.runWith(this.subCategoryBtn):this.subCategoryBtn.changeNormal()),this.subDownHandler?this.subDownHandler.runWith(t):t.changeDown(),this.subCategoryBtn=t,this.subCategoryHandler&&this.subCategoryHandler.runWith(t)},SecondaryMenuPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessContentPanel",(function(){return h}));var n,s=i(5),r=i(11),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicaBusinessContentPanel(e,i,n,s,r,o,a,h){var l=t.call(this,e,i,n)||this;return l.setSize(s,r),l.dpr=o,l.key=a,l.key2=h,l.create(),l}return a(PicaBusinessContentPanel,t),PicaBusinessContentPanel.prototype.create=function(){var t=this.width,e=this.height;this.bg=new s.NineSlicePatch(this.scene,0,0,t,e,r.c.common2Key,"bg",{left:70*this.dpr,top:30*this.dpr,right:30*this.dpr,bottom:70*this.dpr}),this.add(this.bg);var i=.5*-e;this.topbg=this.scene.make.image({key:this.key,frame:"eaves"}),this.topbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.topbg.y=i-2*this.dpr,this.add(this.topbg),this.titlebg=this.scene.make.image({key:this.key,frame:"title"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titlebg.y=i-25*this.dpr,this.add(this.titlebg),this.titleText=this.scene.make.text({x:0,y:this.titlebg.y-5*this.dpr,text:o.i18n.t("business_street.commercial_street"),style:{fontSize:15*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#FFD248"}}).setOrigin(.5,0),this.titleText.setStroke("#553100",2*this.dpr),this.titleText.setShadow(2,2,"#553100",4*this.dpr,!0,!0),this.titleText.setFontStyle("bold"),this.add(this.titleText),this.closeBtn=new s.Button(this.scene,r.c.commonKey,"close"),this.closeBtn.setDisplaySize(28*this.dpr,28*this.dpr),this.closeBtn.setPosition(.5*this.width-8*this.dpr,i+7*this.dpr),this.closeBtn.on(String(s.ClickEvent.Tap),this.onCloseHandler,this),this.add(this.closeBtn),this.setContentSize(t,e)},PicaBusinessContentPanel.prototype.setContentSize=function(t,e){this.setSize(t,e),this.bg.resize(t,e);var i=.5*-e;this.topbg.y=i-2*this.dpr,this.titlebg.y=i-25*this.dpr,this.titleText.y=this.titlebg.y-5*this.dpr,this.closeBtn.setPosition(.5*this.width-8*this.dpr,i+7*this.dpr)},PicaBusinessContentPanel.prototype.setTitleText=function(t){this.titleText.text=t},PicaBusinessContentPanel.prototype.setCloseHandler=function(t){this.closeHandler=t},PicaBusinessContentPanel.prototype.onCloseHandler=function(){this.closeHandler&&this.closeHandler.run()},PicaBusinessContentPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaChapterLevelClue",(function(){return a}));var n,s=i(11),r=i(472),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),a=function(t){function PicaChapterLevelClue(e,i,n,r){var o=t.call(this,e,s.d.uicommon,"bag_icon_common_bg",i,1,!1)||this;return o.dpr=i,o.setSize(n,r),o.gou=o.scene.make.image({key:s.d.uicommon,frame:"selected"}),o.gou.x=.5*o.width-.5*o.gou.width,o.gou.y=.5*o.height-.5*o.gou.height,o.add([o.gou]),o.BGVisible=!1,o}return o(PicaChapterLevelClue,t),PicaChapterLevelClue.prototype.setItemData=function(e){t.prototype.setItemData.call(this,e),this.gou.visible=0!==e.count},PicaChapterLevelClue}(r.ItemButton)},function(t,e,i){"use strict";i.r(e);var n=i(472);i.d(e,"ItemButton",(function(){return n.ItemButton})),i.d(e,"DetailDisplay",(function(){return n.DetailDisplay})),i.d(e,"BackTextButton",(function(){return n.BackTextButton})),i.d(e,"EnergyProgressBar",(function(){return n.EnergyProgressBar}));var s=i(540);i.d(e,"ActivityPanel",(function(){return s.ActivityPanel}));var r=i(484);i.d(e,"CharacterAttributePanel",(function(){return r.CharacterAttributePanel}));var o=i(485);i.d(e,"CharacterEditorPanel",(function(){return o.CharacterEditorPanel}));var a=i(541);i.d(e,"CharacterInfoPanel",(function(){return a.CharacterInfoPanel}));var h=i(542);i.d(e,"GraphicsProgressBar",(function(){return h.GraphicsProgressBar}));var l=i(543);i.d(e,"PicaHandheldPanel",(function(){return l.PicaHandheldPanel}));var c=i(486);i.d(e,"PicaChatInputPanel",(function(){return c.PicaChatInputPanel}));var p=i(487);i.d(e,"PicaGiftPanel",(function(){return p.PicaGiftPanel}));var d=i(544);i.d(e,"PicaChatPanel",(function(){return d.PicaChatPanel}));var m=i(545);i.d(e,"PicaMainUIPanel",(function(){return m.PicaMainUIPanel}));var u=i(546);i.d(e,"PicaRenderUiManager",(function(){return u.PicaRenderUiManager}));var y=i(549);i.d(e,"CutInPanel",(function(){return y.CutInPanel}));var f=i(551);i.d(e,"DialogPanel",(function(){return f.DialogPanel}));var g=i(552);i.d(e,"LoginPanel",(function(){return g.LoginPanel}));var P=i(553);i.d(e,"VerifiedPanel",(function(){return P.VerifiedPanel}));var v=i(548);i.d(e,"CreateRolePanel",(function(){return v.CreateRolePanel}));var b=i(489);i.d(e,"InteractionBubbleCell",(function(){return b.InteractionBubbleCell}));var _=i(490);i.d(e,"InteractionBubbleContainer",(function(){return _.InteractionBubbleContainer}));var k=i(547);i.d(e,"InteractiveBubblePanel",(function(){return k.InteractiveBubblePanel}));var w=i(581);i.d(e,"PicaNavigatePanel",(function(){return w.PicaNavigatePanel}));var x=i(558);i.d(e,"PicaBagPanel",(function(){return x.PicaBagPanel}));i(473);var T=i(514);i.d(e,"ElementDetail",(function(){return T.ElementDetail}));var C=i(577);i.d(e,"PicaMarketPanel",(function(){return C.PicaMarketPanel}));var S=i(515);i.d(e,"NumberCounter",(function(){return S.NumberCounter}));var I=i(516);i.d(e,"MarketItem",(function(){return I.MarketItem}));var B=i(570);i.d(e,"PicaFriendPanel",(function(){return B.PicaFriendPanel}));var D=i(588);i.d(e,"PicaPropFunPanel",(function(){return D.PicaPropFunPanel}));var E=i(584);i.d(e,"PicaNoticePanel",(function(){return E.PicaNoticePanel}));var R=i(587);i.d(e,"PicaPartyListPanel",(function(){return R.PicaPartyListPanel}));var M=i(512);i.d(e,"PicaManorContentPanel",(function(){return M.PicaManorContentPanel}));var F=i(576);i.d(e,"PicaManorListPanel",(function(){return F.PicaManorListPanel}));var O=i(513);i.d(e,"PicaManorScrollPanel",(function(){return O.PicaManorScrollPanel}));var N=i(521);i.d(e,"PicaOpenPartyCreatePanel",(function(){return N.PicaOpenPartyCreatePanel}));var H=i(586);i.d(e,"PicaOpenPartyPanel",(function(){return H.PicaOpenPartyPanel}));var A=i(598);i.d(e,"TaskPanel",(function(){return A.TaskPanel}));var L=i(477);i.d(e,"PicaManorBasePanel",(function(){return L.PicaManorBasePanel}));var G=i(491);i.d(e,"PicaManorChildPanel",(function(){return G.PicaManorChildPanel}));var z=i(554);i.d(e,"PicManorInfoPanel",(function(){return z.PicManorInfoPanel}));var U=i(492);i.d(e,"PicaManorShopPanel",(function(){return U.PicaManorShopPanel}));var j=i(555);i.d(e,"PicaManorTipsPanel",(function(){return j.PicaManorTipsPanel}));var W=i(479);i.d(e,"PicaBusinessContentPanel",(function(){return W.PicaBusinessContentPanel}));var V=i(495);i.d(e,"PicaBusinessHistoryPanel",(function(){return V.PicaBusinessHistoryPanel}));var q=i(496);i.d(e,"PicaBusinessMyStreetPanel",(function(){return q.PicaBusinessMyStreetPanel}));var K=i(497);i.d(e,"PicaBusinessRankRewardPanel",(function(){return K.PicaBusinessRankRewardPanel}));var Y=i(498);i.d(e,"PicaBusinessRankingDetailPanel",(function(){return Y.PicaBusinessRankingDetailPanel}));var Q=i(499);i.d(e,"PicaBusinessRankingPanel",(function(){return Q.PicaBusinessRankingPanel}));var X=i(500);i.d(e,"PicaBusinessStoreCreatePanel",(function(){return X.PicaBusinessStoreCreatePanel}));var J=i(501);i.d(e,"PicaBusinessStreetListPanel",(function(){return J.PicaBusinessStreetListPanel}));var Z=i(560);i.d(e,"PicaBusinessStreetPanel",(function(){return Z.PicaBusinessStreetPanel}));var $=i(478);i.d(e,"SecondaryMenuPanel",(function(){return $.SecondaryMenuPanel}));var tt=i(493);i.d(e,"PicaBusinessChoosePlanPanel",(function(){return tt.PicaBusinessChoosePlanPanel}));var et=i(559);i.d(e,"PicaBusinessMarketingPlanPanel",(function(){return et.PicaBusinessMarketingPlanPanel}));var it=i(494);i.d(e,"PicaBusinessPlanPanel",(function(){return it.PicaBusinessPlanPanel}));var nt=i(590);i.d(e,"PicaRechargePanel",(function(){return nt.PicaRechargePanel}));var st=i(563);i.d(e,"PicaDecorateControlPanel",(function(){return st.PicaDecorateControlPanel}));var rt=i(556);i.d(e,"PicRoomUpgradePanel",(function(){return rt.PicRoomUpgradePanel}));var ot=i(503);i.d(e,"PicaEquipUpgradeItem",(function(){return ot.PicaEquipUpgradeItem}));var at=i(567);i.d(e,"PicaEquipUpgradePanel",(function(){return at.PicaEquipUpgradePanel}));var ht=i(593);i.d(e,"PicaRoomListPanel",(function(){return ht.PicaRoomListPanel})),i.d(e,"RoomDelegate",(function(){return ht.RoomDelegate})),i.d(e,"RoomZoon",(function(){return ht.RoomZoon}));var lt=i(597);i.d(e,"PicaWorkPanel",(function(){return lt.PicaWorkPanel}));var ct=i(579);i.d(e,"PicaMineCarPanel",(function(){return ct.PicaMineCarPanel}));var pt=i(574);i.d(e,"PicaHousePanel",(function(){return pt.PicaHousePanel}));var dt=i(511);i.d(e,"PicaHouseInfoPanel",(function(){return dt.PicaHouseInfoPanel}));var mt=i(580);i.d(e,"PicaMineSettlePanel",(function(){return mt.PicaMineSettlePanel}));var ut=i(591);i.d(e,"PicaRewardTipPanel",(function(){return ut.PicaRewardTipPanel}));var yt=i(561);i.d(e,"PicaComposePanel",(function(){return yt.PicaComposePanel}));var ft=i(575);i.d(e,"PicaItemPopCardPanel",(function(){return ft.PicaItemPopCardPanel}));var gt=i(578);i.d(e,"PicaMessageBoxPanel",(function(){return gt.PicaMessageBoxPanel}));var Pt=i(565);i.d(e,"PicaElementStoragePanel",(function(){return Pt.PicaElementStoragePanel}));var vt=i(550);i.d(e,"CutInMenuPanel",(function(){return vt.CutInMenuPanel}));var bt=i(529);i.d(e,"PicaTreasureOpenPanel",(function(){return bt.PicaTreasureOpenPanel}));var _t=i(596);i.d(e,"PicaTreasurePanel",(function(){return _t.PicaTreasurePanel}));var kt=i(530);i.d(e,"PicaTreasurePreviewPanel",(function(){return kt.PicaTreasurePreviewPanel}));var wt=i(528);i.d(e,"PicaTreasureAllOpenPanel",(function(){return wt.PicaTreasureAllOpenPanel}));var xt=i(573);i.d(e,"PicaGiftEffectPanel",(function(){return xt.PicaGiftEffectPanel}));var Tt=i(509);i.d(e,"PicaGiftLateralItem",(function(){return Tt.PicaGiftLateralItem}));var Ct=i(508);i.d(e,"PicaGiftLaterctPanel",(function(){return Ct.PicaGiftLaterctPanel}));var St=i(510);i.d(e,"PicaGiftPlayerPanel",(function(){return St.PicaGiftPlayerPanel}));var It=i(571);i.d(e,"PicaFurniFunPanel",(function(){return It.PicaFurniFunPanel}));var Bt=i(583);i.d(e,"PicaNewRolePanel",(function(){return Bt.PicaNewRolePanel}));var Dt=i(517);i.d(e,"PicaNewActivityPanel",(function(){return Dt.PicaNewActivityPanel}));var Et=i(518);i.d(e,"PicaNewChatPanel",(function(){return Et.PicaNewChatPanel}));var Rt=i(519);i.d(e,"PicaNewHeadPanel",(function(){return Rt.PicaNewHeadPanel}));var Mt=i(520);i.d(e,"PicaNewLeftPanel",(function(){return Mt.PicaNewLeftPanel}));var Ft=i(488);i.d(e,"PicaNewNavigatePanel",(function(){return Ft.PicaNewNavigatePanel}));var Ot=i(582);i.d(e,"PicaNewMainPanel",(function(){return Ot.PicaNewMainPanel}));var Nt=i(557);i.d(e,"PicaAvatarPanel",(function(){return Nt.PicaAvatarPanel}));var Ht=i(585);i.d(e,"PicaOnlinePanel",(function(){return Ht.PicaOnlinePanel}));var At=i(564);i.d(e,"PicaEffectMgrPanel",(function(){return At.PicaEffectMgrPanel}));var Lt=i(502);i.d(e,"PicaFurniUnlockEffectPanel",(function(){return Lt.PicaFurniUnlockEffectPanel}));var Gt=i(525);i.d(e,"PicaTaskItem",(function(){return Gt.PicaTaskItem}));var zt=i(526);i.d(e,"PicaTaskMainPanel",(function(){return zt.PicaTaskMainPanel}));var Ut=i(594);i.d(e,"PicaTaskPanel",(function(){return Ut.PicaTaskPanel}));var jt=i(595);i.d(e,"PicaTaskSidePanel",(function(){return jt.PicaTaskSidePanel}));var Wt=i(566);i.d(e,"PicaElevatorPanel",(function(){return Wt.PicaElevatorPanel}));var Vt=i(562);i.d(e,"PicaCreateRolePanel",(function(){return Vt.PicaCreateRolePanel}));var qt=i(527);i.d(e,"PicaItemTipsPanel",(function(){return qt.PicaItemTipsPanel}));var Kt=i(476);i.d(e,"PicaSingleManager",(function(){return Kt.PicaSingleManager}));var Yt=i(572);i.d(e,"PicaFurnitureComposePanel",(function(){return Yt.PicaFurnitureComposePanel}));var Qt=i(589);i.d(e,"PicaRecastePanel",(function(){return Qt.PicaRecastePanel}));var Xt=i(523);i.d(e,"PicaRoamListPanel",(function(){return Xt.PicaRoamListPanel}));var Jt=i(592);i.d(e,"PicaRoamPanel",(function(){return Jt.PicaRoamPanel}));var Zt=i(522);i.d(e,"PicaRoamDrawPanel",(function(){return Zt.PicaRoamDrawPanel}));var $t=i(524);i.d(e,"PicaRoamPreviewPanel",(function(){return $t.PicaRoamPreviewPanel}));var te=i(569);i.d(e,"PicaExploreLogPanel",(function(){return te.PicaExploreLogPanel}));var ee=i(507);i.d(e,"PicaExploreLogSettlePanel",(function(){return ee.PicaExploreLogSettlePanel}));var ie=i(480);i.d(e,"PicaChapterLevelClue",(function(){return ie.PicaChapterLevelClue}));var ne=i(504);i.d(e,"PicaExploreListBottomPanel",(function(){return ne.PicaExploreListBottomPanel}));var se=i(505);i.d(e,"PicaExploreListDetailPanel",(function(){return se.PicaExploreListDetailPanel}));var re=i(506);i.d(e,"PicaExploreListLevelPanel",(function(){return re.PicaExploreListLevelPanel}));var oe=i(568);i.d(e,"PicaExploreListPanel",(function(){return oe.PicaExploreListPanel}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function AnimationUrlData(){}return AnimationUrlData.prototype.setData=function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=".json"),this.resName=t,this.resUrl=e,this.pngUrl=e+"/"+t+(i?"_tex.png":".png"),this.jsonUrl=e+"/"+t+(i?"_tex.json":".json"),i&&(this.boneUrl=e+"/"+t+"_ske"+n),this.responseType=".dbbin"===n?"arraybuffer":null,this.boneXhrSettings=this.responseType?{responseType:"arraybuffer"}:null},AnimationUrlData.prototype.setDisplayData=function(t,e,i){void 0===i&&(i=".json"),this.pngUrl=t,this.jsonUrl=e,this.responseType=".dbbin"===i?"arraybuffer":null,this.boneXhrSettings=this.responseType?{responseType:"arraybuffer"}:null},AnimationUrlData.prototype.dispose=function(){this.textureXhrSettings=null,this.atlasXhrSettings=null,this.boneXhrSettings=null},AnimationUrlData}()},function(t,e,i){"use strict";var n=i(143);i.d(e,"a",(function(){return n.a}));i(602);var s=i(613);i.d(e,"b",(function(){return s.a}));i(614),i(615),i(537);var r=i(77);i.d(e,"c",(function(){return r.a}));var o=i(474);i.d(e,"d",(function(){return o.a}));i(531),i(622),i(616),i(325)},function(t,e,i){"use strict";i.r(e),i.d(e,"CharacterAttributePanel",(function(){return h}));var n,s=i(5),r=i(0),o=i(470),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function CharacterAttributePanel(e,i,n,s,r,o,a){var h=t.call(this,e,i,n)||this;return h.attriItems=[],h.setSize(s,r),h.key=o,h.dpr=a,h.mspace=10*a,h}return a(CharacterAttributePanel,t),Object.defineProperty(CharacterAttributePanel.prototype,"space",{set:function(t){this.mspace=t},enumerable:!1,configurable:!0}),CharacterAttributePanel.prototype.setAttributeData=function(t){for(var e=t.length,i=e>4?2:1,n=this.width,s=this.height,r=20*this.dpr,o=n/2,a=.5*-s+10*this.dpr,h=0,c=this.attriItems;h<c.length;h++){(d=c[h]).visible=!1}for(var p=0;p<e;p++){var d=void 0;p<this.attriItems.length?d=this.attriItems[p]:(d=new l(this.scene,0,0,o,r,this.key,this.dpr),this.add(d),this.attriItems.push(d));var m=.5*(n-n/i)*(p<4?-1:1),u=a+.5*r+(r+this.mspace)*(p%4);d.setPosition(m,u),d.setInfo(t[p]),d.visible=!0}},CharacterAttributePanel}(Phaser.GameObjects.Container),l=function(t){function PlayerAttributeValue(e,i,n,a,h,l,c){var p=t.call(this,e,i,n)||this;return p.dpr=c,p.setSize(a,h),p.icon=new o.DynamicImage(p.scene,0,0),p.icon.x=.5*-a+10*c,p.nameText=p.scene.make.text({x:p.icon.x+13*c,y:0,text:"Attack:",style:{fontFamily:r.Font.DEFULT_FONT,fontSize:11*c,color:"#131313"}}).setOrigin(0,.5),p.valueText=new s.BBCodeText(p.scene,0,0,"100",{color:"#131313",fontSize:11*p.dpr,fontFamily:r.Font.DEFULT_FONT}).setOrigin(0,.5),p.valueText.x=p.nameText.x+p.nameText.width,p.add([p.icon,p.nameText,p.valueText]),p}return a(PlayerAttributeValue,t),PlayerAttributeValue.prototype.setInfo=function(t){var e=this;if(t.display){var i=r.Url.getOsdRes(t.display.texturePath);this.icon.load(i,this,(function(){e.icon.displayWidth=20*e.dpr,e.icon.scaleY=e.icon.scaleX}))}this.nameText.text=t.name+":",this.valueText.text=t.value+(t.tempValue?this.getRichLabel(t.tempValue):""),this.valueText.x=this.nameText.x+this.nameText.width+3*this.dpr},PlayerAttributeValue.prototype.getRichLabel=function(t,e){return void 0===e&&(e="#0B77CD"),"[color="+e+"](+"+t+")[/color]"},PlayerAttributeValue}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"CharacterEditorPanel",(function(){return h}));var n,s=i(5),r=i(470),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function CharacterEditorPanel(e,i,n,a,h,l,c){var p=t.call(this,e,i,n)||this;p.dpr=0,p.key="",p.setSize(a,h),p.key=l,p.dpr=c;var d="bold "+15*p.dpr+"px Source Han Sans";p.title=p.scene.make.text({x:0,y:.5*-h+50*c,text:p.geti18n("edit_profile"),style:{font:d,blod:!0,color:"#ffffff",fontFamily:o.Font.DEFULT_FONT}}).setOrigin(.5);var m=p.scene.make.graphics(void 0,!1);m.clear(),m.fillStyle(16777215,.5),m.fillRect(0,0,247*c,350*c),m.setPosition(.5*-a,-184*c);var u=.5*-a+9*c,y=-170*c,f=50*c,g=p.scene.make.text({x:u,y:y,style:{blod:!0,color:"#0062BB",fontSize:15*c,fontFamily:o.Font.DEFULT_FONT}}).setOrigin(0);g.setText(p.geti18n("user_name")+":"),p.inputText=new s.InputText(p.scene,u+g.width+20*c,y,162*c,27*c,{type:"input",fontSize:18*c+"px",color:"#0062BB",align:"center",placeholder:p.geti18n("input_nickname")}).setOrigin(0);var P=p.createLine(-230*p.dpr*.5,y+32*p.dpr);p.add(m),p.add([p.title,g,p.inputText,P]),p.idText=p.createText("I        D:","",u,y+f),p.constellationText=p.createText(p.geti18n("constellation")+":","",u,y+2*f),p.birthdayText=p.createText(p.geti18n("birthday")+":","",u,y+3*f),p.cityText=p.createText(p.geti18n("city")+":","",u,y+4*f);var v=p.scene.make.text({x:u,y:y+5*f,style:{blod:!0,color:"#0062BB",fontSize:15*c,fontFamily:o.Font.DEFULT_FONT}}).setOrigin(0);v.setText(p.geti18n("signature")+":"),p.signInput=new s.InputText(p.scene,u+v.width+20*c,y+5*f,162*c,76*c,{type:"input",fontSize:18*c+"px",color:"#0062BB",align:"center",placeholder:p.geti18n("input_signature")}).setOrigin(0),p.add([v,p.signInput]);var b=new s.Button(p.scene,"common_key","back_arrow","back_arrow"),_=new r.NinePatchButton(p.scene,0,.5*h-40*c,174*p.dpr,37*p.dpr,"common_key","yellow_btn",p.geti18n("save"),{left:12*p.dpr,top:12*p.dpr,right:12*p.dpr,bottom:12*p.dpr});return _.setTextStyle({fontSize:16*p.dpr,color:"#ED7814"}),b.setPosition(u+8*c,.5*-h+50*c),b.on(s.ClickEvent.Tap,p.onBackHandler,p),_.on(s.ClickEvent.Tap,p.onSaveHandler,p),p.add([b,_]),p}return a(CharacterEditorPanel,t),CharacterEditorPanel.prototype.destroy=function(){this.inputText&&this.inputText.destroy(),this.signInput&&this.signInput.destroy(),t.prototype.destroy.call(this)},CharacterEditorPanel.prototype.createText=function(t,e,i,n){var s=this.scene.make.text({x:i,y:n,style:{blod:!0,color:"#0062BB",fontSize:15*this.dpr,fontFamily:o.Font.DEFULT_FONT}}).setOrigin(0,0);s.setText(t);var r=this.scene.make.text({x:i+s.width+20*this.dpr,y:n,text:e,style:{blod:!0,color:"#ffffff",fontSize:15*this.dpr,fontFamily:o.Font.DEFULT_FONT}}).setOrigin(0,0),a=this.createLine(-230*this.dpr*.5,n+32*this.dpr);return this.add([s,r,a]),r},CharacterEditorPanel.prototype.geti18n=function(t){return o.i18n.t("player_info."+t)},CharacterEditorPanel.prototype.createLine=function(t,e){var i=this.scene.make.graphics(void 0,!1);return i.clear(),i.fillStyle(25275,.6),i.fillRect(0,0,230*this.dpr,3),i.setPosition(t,e),i},CharacterEditorPanel.prototype.onBackHandler=function(){this.visible=!1,this.emit("editorHide")},CharacterEditorPanel.prototype.onSaveHandler=function(){},CharacterEditorPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaChatInputPanel",(function(){return h}));var n,s=i(5),r=i(11),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicaChatInputPanel(e,i,n,a){var h=t.call(this)||this;h.chatArr=[],h.maxChatLength=100,h.isOpenQuickPanel=!1,h.isSendChat=!1,h.isDispose=!1,h.key=n,h.render=i,h.dpr=window.devicePixelRatio,h.scene=e,h.chatArr=a;var l=e.cameras.main.width,c=e.cameras.main.height;h.mBackground=e.add.graphics(),h.mBackground.clear(),h.mBackground.fillStyle(0,.6),h.mBackground.fillRect(0,0,l,c),h.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,l,c),Phaser.Geom.Rectangle.Contains),h.bottomCon=e.add.container(0,0),h.bottomCon.setPosition(.5*l,.5*c);var p=new s.NineSlicePatch(e,0,0,l,47*h.dpr,h.key,"chat_Input_bg",{left:2*h.dpr,top:0*h.dpr,right:2*h.dpr,bottom:0*h.dpr});h.bottomCon.setSize(l,p.height),h.bottomCon.add(p),h.sendBtn=new s.Button(h.scene,h.key,"chat_quick_2"),h.sendBtn.x=.5*-l+.5*h.sendBtn.width+12*h.dpr,h.sendBtn.on(String(s.ClickEvent.Tap),h.onQuickSendHandler,h),h.bottomCon.add(h.sendBtn),h.cancelBtn=new s.NineSliceButton(h.scene,0,0,63*h.dpr,28*h.dpr,r.c.commonKey,"red_btn_normal",o.i18n.t("common.cancel"),h.dpr,1,{left:14*h.dpr,top:0,right:14*h.dpr,bottom:0}),h.cancelBtn.setTextStyle({color:"#ffffff",fontSize:16*h.dpr,fontFamily:o.Font.DEFULT_FONT}),h.cancelBtn.x=.5*l-.5*h.cancelBtn.width-12*h.dpr,h.cancelBtn.on(String(s.ClickEvent.Tap),h.onCancelHandler,h),h.bottomCon.add(h.cancelBtn);var d=Math.abs(h.sendBtn.x-h.cancelBtn.x)-.5*h.sendBtn.width-.5*h.cancelBtn.width-16*h.dpr,m=h.sendBtn.x+.5*h.sendBtn.width+8*h.dpr+.5*d,u=new s.NineSlicePatch(h.scene,m,0,d,36*h.dpr,h.key,"chat_Input",{left:12*h.dpr,top:0*h.dpr,right:12*h.dpr,bottom:0*h.dpr});return h.bottomCon.add(u),h.mInput=new s.InputText(h.scene,m-.5*d,0,d,40*h.dpr,{type:"text",placeholder:"",color:"#0",fontSize:20*h.dpr+"px"}),h.mInput.setOrigin(0,.5),h.bottomCon.add(h.mInput),h.contentCon=e.add.container(0,0),h.contentCon.setSize(l,200*h.dpr),h.mOutputText=new s.BBCodeText(e,.5*-l+10*h.dpr,0,"",{fontSize:14*h.dpr+"px",fontFamily:o.Font.DEFULT_FONT,stroke:"#000000",strokeThickness:1*h.dpr,textMask:!1,lineSpacing:2*h.dpr,shadow:{offsetX:0,offsetY:0,color:"#000",blur:4,stroke:!0,fill:!0},wrap:{mode:"char",width:l-12*h.dpr}}).setOrigin(0,.5),h.mOutputText.setResolution(h.dpr),h.gamescroll=new s.GameScroller(e,{x:0,y:0,width:l,height:h.contentCon.height,zoom:1,dpr:h.dpr,align:0,orientation:0,selfevent:!0}),h.contentCon.add(h.gamescroll),h.gamescroll.addItem(h.mOutputText),h.quickCon=h.scene.add.container(0,0),h.quickBg=h.scene.make.image({key:h.key,frame:"home_quick chat _bg"}),h.quickBg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.quickCon.add(h.quickBg),h.quickCon.x=.5*l,h.quickChatScroll=new s.GameScroller(e,{x:0,y:0,width:l,height:200*h.dpr,zoom:1,dpr:h.dpr,align:2,orientation:0,cellupCallBack:function(t){h.onQuickChatItemHandler(t)}}),h.quickChatScroll.removeListen(),h.quickCon.add(h.quickChatScroll),h.mInput.on("blur",h.onBlurHandler,h),h.mInput.on("focus",h.onFocusHandler,h),h.mInput.node.addEventListener("keypress",(function(t){13===(t.keyCode||t.which)&&(h.isSendChat=!0,h.onSentChat())})),window.addEventListener("native.keyboardshow",h.onKeyboardHandler.bind(h)),h.bottomCon.visible=!1,h.contentCon.visible=!1,h}return a(PicaChatInputPanel,t),PicaChatInputPanel.prototype.setKeywordHeight=function(t){var e=this.scene.cameras.main.height,i=this.scene.cameras.main.width,n=e-t-0;this.bottomCon.visible=!0,this.contentCon.visible=!0,this.bottomCon.y=n-.5*this.bottomCon.height,this.contentCon.height=this.bottomCon.y-.5*this.bottomCon.height-20*this.dpr,this.contentCon.y=this.bottomCon.y-.5*this.bottomCon.height-.5*this.contentCon.height-5*this.dpr,this.contentCon.x=.5*i,this.gamescroll.resetSize(i,this.contentCon.height),this.gamescroll.refreshMask();var s=200*this.dpr;this.quickCon.y=this.bottomCon.y-.5*this.bottomCon.height,this.quickBg.y=.5*-s,this.quickBg.displayWidth=i+10*this.dpr,this.quickBg.displayHeight=s,this.quickChatScroll.y=this.quickBg.y,this.quickChatScroll.resetSize(i,s),this.keyboardHeight=t,this.setQuickChatItems()},PicaChatInputPanel.prototype.setQuickChatData=function(t){t&&(this.quickChatAtt=t),this.quickChatAtt.unshift(void 0),this.setKeywordHeight(0),this.onQuickSendHandler();for(var e="",i=0,n=this.chatArr;i<n.length;i++){e+=n[i]}this.mOutputText.text=e,this.gamescroll.Sort(),o.Logger.getInstance().debug(t)},PicaChatInputPanel.prototype.appendChat=function(t){this.chatArr.push(t),this.chatArr.length>this.maxChatLength&&this.chatArr.shift();for(var e="",i=0,n=this.chatArr;i<n.length;i++){e+=n[i]}this.mOutputText.text=e,this.gamescroll.Sort()},PicaChatInputPanel.prototype.onKeyboardHandler=function(t){o.Logger.getInstance().debug(t.keyboardHeight),this.keyboardHeight>0&&t.keyboardHeight===this.keyboardHeight||window.removeEventListener("native.keyboardshow",this.onKeyboardHandler.bind(this))},PicaChatInputPanel.prototype.setQuickChatItems=function(){this.quickChatScroll.clearItems(!0);this.scene.cameras.main.height;for(var t=this.scene.cameras.main.width,e=0;e<this.quickChatAtt.length;e++){var i=this.quickChatAtt[e];if(i){var n=new l(this.scene,t,30*this.dpr,this.key,this.dpr,0===e);this.quickChatScroll.addItem(n),n.setText(i)}}this.quickChatScroll.Sort(),this.quickCon.visible=!1},PicaChatInputPanel.prototype.setFirstQuickItem=function(){if(this.quickChatScroll.getItemList().length===this.quickChatAtt.length){var t=this.quickChatScroll.getItemList();t&&t.length>0&&t[0].setText(this.quickChatAtt[0])}else{var e=this.scene.cameras.main.width,i=new l(this.scene,e,40*this.dpr,this.key,this.dpr,!0);this.quickChatScroll.addItemAt(i,0),this.quickChatScroll.Sort(),i.setText(this.quickChatAtt[0])}},PicaChatInputPanel.prototype.onBlurHandler=function(){this.isOpenQuickPanel||this.isSendChat||this.onCancelHandler(),this.isSendChat=!1},PicaChatInputPanel.prototype.onFocusHandler=function(){},PicaChatInputPanel.prototype.onQuickSendHandler=function(){this.isOpenQuickPanel=!this.isOpenQuickPanel,this.isOpenQuickPanel?(this.quickCon.visible=!0,this.quickChatScroll.addListen()):(this.mInput.setFocus(),this.quickCon.visible=!1,this.quickChatScroll.removeListen(),this.isOpenQuickPanel=!1)},PicaChatInputPanel.prototype.onSentChat=function(){var t=this.mInput.text;""!==t&&(this.quickChatAtt[0]=t,this.setFirstQuickItem()),this.mInput.text="",this.mInput.setFocus(),this.sendChat(t)},PicaChatInputPanel.prototype.sendChat=function(t){this.emit("send",t)},PicaChatInputPanel.prototype.onQuickChatItemHandler=function(t){this.mInput.text=t.dataChat,this.mInput.setFocus(),this.quickCon.visible=!1,this.quickChatScroll.removeListen(),this.isOpenQuickPanel=!1},PicaChatInputPanel.prototype.onCancelHandler=function(){this.isDispose||(this.isDispose=!0,this.mInput.setBlur(),this.mBackground.destroy(),this.mInput.destroy(),this.bottomCon.destroy(),this.contentCon.destroy(),this.quickCon.destroy(),this.gamescroll.clearItems(!0),this.scene=void 0,this.render=void 0,this.gamescroll=void 0,this.mOutputText=void 0,this.quickChatScroll=void 0,this.emit("close"),this.destroy())},PicaChatInputPanel}(Phaser.Events.EventEmitter),l=function(t){function QuickChatItem(e,i,n,s,r,a){void 0===a&&(a=!1);var h,l=t.call(this,e)||this;(l.dataChat="",l.key=s,l.setSize(i,n),l.text=l.scene.make.text({x:0,y:0,text:"",style:{fontSize:13*r,fontFamily:o.Font.DEFULT_FONT,color:"#6F6F6F"}}).setOrigin(0,.5),l.text.x=.5*-i+20*r,l.add(l.text),a)?((h=l.scene.make.image({key:s,frame:"home_divider"})).texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.y=.5*n,l.add(h)):((h=l.scene.make.graphics(void 0)).clear(),h.fillStyle(7303023,.3),h.fillRect(.5*-i+20*r,-1,i,2),h.setPosition(0,.5*n),l.add(h));return l}return a(QuickChatItem,t),QuickChatItem.prototype.setText=function(t){this.text.text=t,this.dataChat=t},QuickChatItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaGiftPanel",(function(){return l}));var n,s=i(5),r=i(470),o=i(11),a=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaGiftPanel(e,i,n,s,r,o,a,h){var l=t.call(this,e,i,n)||this;return l.key=o,l.dpr=a,l.zoom=h,l.setSize(s,r),l.init(),l}return h(PicaGiftPanel,t),PicaGiftPanel.prototype.resize=function(){this.mPropGrid&&this.mPropGrid.resetMask()},PicaGiftPanel.prototype.destroy=function(){this.mPropGrid&&this.mPropGrid.destroy(),t.prototype.destroy.call(this)},PicaGiftPanel.prototype.hide=function(){this.visible=!1},PicaGiftPanel.prototype.show=function(){this.visible=!0},PicaGiftPanel.prototype.setGiftDatas=function(t){var e=12-t.length,i=e>0?t.concat(new Array(e)):t;this.mPropGrid.setItems(i);var n=this.mPropGrid.getCell(0);n&&n.container&&this.onSelectItemHandler(n.container)},PicaGiftPanel.prototype.setGiftActive=function(t){this.sendButton.enable=t},PicaGiftPanel.prototype.onUsePropHandler=function(t,e,i){var n={id:t.id,quantity:i,category:e.category};this.curGiftData.remain-=i,this.curGiftData.limit>0&&this.curGiftData.remain<=0&&this.mPropGrid.refresh(),this.emit("buyItem",n,t)},PicaGiftPanel.prototype.init=function(){var t=this,e=this.scene.make.graphics(void 0,!1);e.fillStyle(3355443,.5),e.fillRect(.5*-this.width,.5*-this.height,this.width,this.height),this.add(e);var i=this.scene.textures.getFrame(o.c.common2Key,"equp_bg"),n=i.width+10*this.dpr,h=i.height+10*this.dpr,l={x:0,y:.5*-this.height+60*this.dpr,table:{width:this.width-20*this.dpr,height:120*this.dpr,columns:2,cellWidth:n,cellHeight:h,reuseCellContainer:!0,cellOriginX:.5,cellOriginY:.5,zoom:this.zoom,mask:!1},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(e,i){var n=e.scene,s=e.item;return null===i&&(i=new c(n,0,0,t.key,t.dpr)),i.setItemData(s),s&&t.curGiftData&&t.curGiftData.id===s.id&&(i.isSelect=!0,t.curGiftItem=i),i}};this.mPropGrid=new s.GameGridTable(this.scene,l),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(e){t.onSelectItemHandler(e)})),this.add(this.mPropGrid),this.giftName=this.scene.make.text({x:.5*-this.width+10*this.dpr,y:this.mPropGrid.y+.5*this.mPropGrid.height+15*this.dpr,text:"",style:{fontSize:16*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#FFD248"}}).setOrigin(0,.5),this.add(this.giftName),this.giftPriceImage=new r.DynamicImage(this.scene,0,this.giftName.y),this.giftPriceImage.setTexture(o.c.commonKey,"iv_coin"),this.add(this.giftPriceImage),this.giftValue=this.scene.make.text({x:0,y:this.giftName.y,text:"",style:{fontSize:16*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#FFD248"}}).setOrigin(0,.5),this.add(this.giftValue),this.sendButton=new s.NineSliceButton(this.scene,0,0,95*this.dpr,36*this.dpr,o.c.commonKey,"yellow_btn_normal_s",a.i18n.t("chat.givegift"),this.dpr,this.scale,{left:8*this.dpr,top:8*this.dpr,right:8*this.dpr,bottom:10*this.dpr}),this.add(this.sendButton),this.sendButton.setTextStyle({fontSize:16*this.dpr,color:"#996600",fontFamily:a.Font.DEFULT_FONT}),this.sendButton.setFontStyle("bold"),this.sendButton.setPosition(.5*this.width-.5*this.sendButton.width-10*this.dpr,.5*this.height-.5*this.sendButton.height-10*this.dpr),this.sendButton.on(String(s.ClickEvent.Tap),this.onSendHandler,this),this.giftDescr=this.scene.make.text({x:this.giftName.x,y:this.giftName.y+.5*this.giftName.height+15*this.dpr,text:"",style:{fontSize:14*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#999999"}}).setOrigin(0,.5),this.add(this.giftDescr)},PicaGiftPanel.prototype.onSelectItemHandler=function(t){var e=t.itemData;if(e){this.curGiftItem&&(this.curGiftItem.isSelect=!1),t.isSelect=!0,this.curGiftItem=t,this.curGiftData=e,this.giftName.text=e.name;var i=e.price[0];this.giftPriceImage.setTexture(o.c.commonKey,a.Coin.getIcon(i.coinType)),this.giftPriceImage.x=this.giftName.x+this.giftName.width+5*this.dpr+.5*this.giftPriceImage.width,this.giftValue.text=i.price+"",this.giftValue.x=this.giftPriceImage.x+.5*this.giftPriceImage.width+5*this.dpr,this.giftDescr.text=e.des}},PicaGiftPanel.prototype.onSendHandler=function(){if(this.curGiftData)if(this.curGiftData.limit>0&&this.curGiftData.remain<=0){this.emit("shownotice",a.i18n.t("party.giftsell"))}else{var t=this.getBuyPackageData(),e=a.i18n.t("chat.givegift"),i=this.curGiftData.icon,n=t.sellingPrice.price>0,s={resultHandler:{key:this.key,confirmFunc:"onUsePropHandler",confirmAddData:t},data:t,url:i,title:e,slider:n,line:!0};this.emit("showpropfun",s)}},PicaGiftPanel.prototype.getBuyPackageData=function(){var t=this.curGiftData;return{id:t.id,sellingPrice:t.price[0],name:t.name,shortName:t.shortName,category:t.category,count:t.price[0].price>0?99:1}},PicaGiftPanel}(Phaser.GameObjects.Container),c=function(t){function PicGiftItem(e,i,n,s,a){var h=t.call(this,e,i,n)||this;return h.mIsSelect=!1,h.dpr=a,h.key=s,h.bg=h.scene.make.image({key:o.c.common2Key,frame:"equp_bg"}),h.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.selectbg=h.scene.make.image({key:o.c.common2Key,frame:"selected_icon_bg"}),h.selectbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.icon=new r.DynamicImage(e,0,0),h.add([h.bg,h.selectbg,h.icon]),h.setSize(h.selectbg.width,h.selectbg.height),h}return h(PicGiftItem,t),PicGiftItem.prototype.setItemData=function(t){var e=this;if(this.isSelect=!1,this.itemData=t,!t)return this.icon.visible=!1,void(this.selectbg.visible=!1);this.icon.visible=!0,this.selectbg.visible=this.mIsSelect;var i=a.Url.getOsdRes(t.icon);this.icon.load(i,this,(function(){e.icon.scale=e.dpr})),t.limit>0&&t.remain<=0?this.icon.setTintFill(8947848):this.icon.clearTint()},Object.defineProperty(PicGiftItem.prototype,"isSelect",{get:function(){return this.mIsSelect},set:function(t){this.mIsSelect=t,this.selectbg.visible=t},enumerable:!1,configurable:!0}),PicGiftItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNewNavigatePanel",(function(){return h}));var n,s=i(5),r=i(11),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicaNewNavigatePanel(e,i,n){var s=t.call(this,e)||this;return s.dpr=n,s.key=i,s.init(),s}return a(PicaNewNavigatePanel,t),PicaNewNavigatePanel.prototype.init=function(){this.scene.make.graphics(void 0,!1);var t=this.scene.cameras.main.width;this.bg=this.scene.make.image({key:r.d.uicommon,frame:"bg"}).setOrigin(0),this.bg.displayWidth=t,this.setSize(this.bg.width,this.bg.height);var e=this.createButton("home_bag");e.x=.5*-this.width+.5*e.width+17*this.dpr,this.bagButton=e;var i=this.createButton("home_friend");i.x=e.x+.5*e.width+22*this.dpr+.5*i.width,this.friendButton=i;var n=this.createButton("home_avater");n.x=i.x+.5*i.width+22*this.dpr+.5*n.width,this.avatarButton=n;var s=this.createButton("home_shop");s.x=n.x+.5*n.width+22*this.dpr+.5*s.width,this.shopButton=s;var o=this.createButton("home_explore");o.x=s.x+.5*s.width+22*this.dpr+.5*o.width,this.exploreButton=o,this.add([this.bg,e,i,n,s,o]),this.addListen()},PicaNewNavigatePanel.prototype.addListen=function(){this.bagButton.on(s.ClickEvent.Tap,this.onBagHandler,this),this.friendButton.on(s.ClickEvent.Tap,this.onFriendHandler,this),this.avatarButton.on(s.ClickEvent.Tap,this.onAvatarHandler,this),this.shopButton.on(s.ClickEvent.Tap,this.onShopHandler,this),this.exploreButton.on(s.ClickEvent.Tap,this.onExploreHandler,this)},PicaNewNavigatePanel.prototype.removeListen=function(){this.bagButton.off(s.ClickEvent.Tap,this.onBagHandler,this),this.friendButton.off(s.ClickEvent.Tap,this.onFriendHandler,this),this.avatarButton.off(s.ClickEvent.Tap,this.onAvatarHandler,this),this.shopButton.off(s.ClickEvent.Tap,this.onShopHandler,this),this.exploreButton.off(s.ClickEvent.Tap,this.onExploreHandler,this)},PicaNewNavigatePanel.prototype.setHandler=function(t){this.sendHandler=t},PicaNewNavigatePanel.prototype.onBagHandler=function(){this.sendHandler&&this.sendHandler.runWith(["bag"])},PicaNewNavigatePanel.prototype.onFriendHandler=function(){this.sendHandler&&this.sendHandler.runWith(["friend"])},PicaNewNavigatePanel.prototype.onAvatarHandler=function(){this.sendHandler&&this.sendHandler.runWith(["avatar"])},PicaNewNavigatePanel.prototype.onShopHandler=function(){this.sendHandler&&this.sendHandler.runWith(["shop"])},PicaNewNavigatePanel.prototype.onExploreHandler=function(){this.sendHandler&&this.sendHandler.runWith(["explore"])},PicaNewNavigatePanel.prototype.createButton=function(t){this.isZh_CN&&(t+="_1");var e=new s.Button(this.scene,r.d.iconcommon,t,t);return e.y=.5*this.height,e},Object.defineProperty(PicaNewNavigatePanel.prototype,"isZh_CN",{get:function(){return"zh-CN"===o.i18n.language},enumerable:!1,configurable:!0}),PicaNewNavigatePanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"InteractionBubbleCell",(function(){return o}));var n,s=i(470),r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function InteractionBubbleCell(e,i){var n=t.call(this,e)||this;return n.mWdith=78,n.mHeight=78,n.width=n.mWdith*i,n.height=n.mHeight*i,n}return r(InteractionBubbleCell,t),InteractionBubbleCell.prototype.setContentData=function(t,e){this.content=t,this.handler&&this.handler.clear(),this.handler=e},InteractionBubbleCell.prototype.load=function(t,e,i){this.createAnimation(),this.mBubbleAni.load(t,e,i),this.mBubbleAni.play()},InteractionBubbleCell.prototype.show=function(){this.mBubbleAni&&this.add(this.mBubbleAni),this.removeDelay()},InteractionBubbleCell.prototype.hide=function(){this.mBubbleAni&&this.remove(this.mBubbleAni),this.mRemoveDelay&&(clearTimeout(this.mRemoveDelay),this.mRemoveDelay=null)},InteractionBubbleCell.prototype.destroy=function(){this.hide(),this.mBubbleAni&&this.mBubbleAni.destroy(),this.handler&&this.handler.clear(),this.mBubbleAni=null,this.handler=null,t.prototype.destroy.call(this)},InteractionBubbleCell.prototype.createAnimation=function(){this.mBubbleAni=new s.BubbleAnimation(this.scene),this.mBubbleAni.width=this.width,this.mBubbleAni.height=this.height;var t=Phaser.Input.Events.POINTER_DOWN;this.mBubbleAni.setInteractive(new Phaser.Geom.Rectangle(0,0,2*this.mBubbleAni.width,2*this.mBubbleAni.height),Phaser.Geom.Rectangle.Contains),this.mBubbleAni.on(t,this.onBubbleClick,this)},InteractionBubbleCell.prototype.onBubbleClick=function(){this.handler&&this.handler.runWith(this.content)},InteractionBubbleCell.prototype.removeDelay=function(){var t=this;this.mRemoveDelay=setTimeout((function(){t.handler&&t.handler.runWith(t.content.id),t.hide()}),this.content.duration)},InteractionBubbleCell}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"InteractionBubbleContainer",(function(){return a}));var n,s=i(489),r=i(5),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),a=function(t){function InteractionBubbleContainer(e,i){return t.call(this,e)||this}return o(InteractionBubbleContainer,t),Object.defineProperty(InteractionBubbleContainer.prototype,"show",{get:function(){return this.mShow},set:function(t){this.mShow=t},enumerable:!1,configurable:!0}),InteractionBubbleContainer.prototype.hide=function(){this.mShow=!1,this.parentContainer&&this.parentContainer.remove(this)},InteractionBubbleContainer.prototype.setFollow=function(e,i,n){t.prototype.setFollow.call(this,e,i,n)},InteractionBubbleContainer.prototype.setBubble=function(t,e){this.id=t.id;var i=t.display.resName,n=t.display.texturePath,r=t.display.dataPath;return this.mBubble||(this.mBubble=new s.InteractionBubbleCell(this.scene,this.dpr),this.mBubble.load(i,n,r),this.add(this.mBubble)),this.mBubble.setContentData(t,e),this.mBubble.show(),this.mBubble},InteractionBubbleContainer.prototype.destroy=function(){this.hide(),this.mBubble&&this.mBubble.destroy(),this.mBubble=null,t.prototype.destroy.call(this)},InteractionBubbleContainer}(r.BaseUI)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaManorChildPanel",(function(){return c}));var n,s=i(5),r=i(470),o=i(11),a=i(0),h=i(477),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaManorChildPanel(e,i,n,s,r,o,a,h,l){var c=t.call(this,e,n,s,r,o,a,l)||this;return c.zoom=h,c.render=i,c}return l(PicaManorChildPanel,t),PicaManorChildPanel.prototype.setManorInfoData=function(t){this.nameTitle.text="某某某某某";var e=2;t.alreadyBuy&&(e=t.myowner?1:3),this.setLayout(e,t)},PicaManorChildPanel.prototype.setHandler=function(t){this.sendHandler=t},PicaManorChildPanel.prototype.create=function(){var e=this;t.prototype.create.call(this);var i=.5*-this.height;this.headbg=this.scene.make.image({key:this.key,frame:"finca_master_head frame"}),this.headbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.headbg.y=i+.5*this.headbg.height+40*this.dpr,this.add(this.headbg),this.headIcon=new r.DynamicImage(this.scene,0,0,this.key,"finca_master_head"),this.add(this.headIcon),this.headIcon.x=this.headbg.x,this.headIcon.y=this.headbg.y;var n=this.headbg.y+.5*this.headbg.height+5*this.dpr;this.nameTitle=this.scene.make.text({x:this.headbg.x,y:n+10*this.dpr,text:"",style:{fontSize:17*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#000000"}}).setOrigin(.5),this.nameTitle.setFontStyle("bold"),this.add(this.nameTitle),this.contentbg=this.scene.make.image({key:this.key,frame:"finca_message_panel"}),this.contentbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.contentbg.y=this.nameTitle.y+.5*this.contentbg.height+30*this.dpr,this.add(this.contentbg),this.contentbg.visible=!1,this.detailText=new s.BBCodeText(this.scene,.5*-this.contentbg.width+20*this.dpr,this.contentbg.y,"",{fontSize:13*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#813D01",align:"left",wrap:{mode:"char",width:240*this.dpr}}).setInteractive().on("areadown",(function(t){a.Logger.getInstance().debug(t)})).on("areaup",(function(t){new r.InputView(e.scene,e.render).show({title:a.i18n.t("manor.eidtnickname"),placeholder:a.i18n.t("manor.nicknameplaceholder"),handler:new a.Handler(e,(function(t){e.sendHandler&&e.sendHandler.runWith([3,t])}))})})),this.detailText.setOrigin(0,.5),this.add(this.detailText),this.detailText.visible=!1,this.detailText.addImage("finca_compile",{key:this.key,frame:"finca_compile",y:3*this.dpr,left:10*this.dpr,right:10*this.dpr}),this.detailText.addImage("iv_coin",{key:o.c.commonKey,frame:"iv_coin",y:-1*this.dpr,left:2*this.dpr,right:5*this.dpr}),this.detailText.addImage("iv_diamond",{key:o.c.commonKey,frame:"iv_diamond",y:-1*this.dpr,left:2*this.dpr,right:5*this.dpr}),this.editorButton=this.createNineButton(130*this.dpr,45*this.dpr,o.c.commonKey,"red_btn",a.i18n.t("manor.editorbtn"),"#ffffff"),this.editorButton.x=.5*-this.editorButton.width-10*this.dpr,this.editorButton.y=.5*this.height-.5*this.editorButton.height-10*this.dpr,this.editorButton.on(String(s.ClickEvent.Tap),this.onEditorButtonHandler,this),this.add(this.editorButton),this.editorButton.visible=!1,this.shopButton=this.createNineButton(130*this.dpr,45*this.dpr,o.c.commonKey,"yellow_btn_normal",a.i18n.t("common.shop"),"#996600"),this.shopButton.x=.5*this.shopButton.width+10*this.dpr,this.shopButton.y=.5*this.height-.5*this.shopButton.height-10*this.dpr,this.shopButton.on(String(s.ClickEvent.Tap),this.onShopButtonHandler,this),this.add(this.shopButton),this.shopButton.visible=!1,this.buyButton=this.createNineButton(181*this.dpr,45*this.dpr,o.c.commonKey,"yellow_btn_normal",a.i18n.t("common.buy"),"#996600"),this.buyButton.y=.5*this.height-.5*this.buyButton.height-10*this.dpr,this.buyButton.on(String(s.ClickEvent.Tap),this.onBuyButtonHandler,this),this.add(this.buyButton),this.buyButton.visible=!1},PicaManorChildPanel.prototype.setLayout=function(t,e){3===t?(this.nameTitle.text=e.ownerName,this.nameTitle.visible=!0,this.detailText.setLineSpacing(20*this.dpr),this.headbg.visible=!0,this.headbg.y=.5*-this.height+80*this.dpr,this.headIcon.y=this.headbg.y,this.nameTitle.y=this.headbg.y+.5*this.headbg.height+16*this.dpr,this.contentbg.y=.5*this.contentbg.height+this.nameTitle.y+.5*this.nameTitle.height+10*this.dpr,this.detailText.y=this.contentbg.y):2===t?(this.nameTitle.text=a.i18n.t("manor.noowner"),this.nameTitle.visible=!0,this.detailText.setLineSpacing(9*this.dpr),this.headbg.visible=!1,this.headIcon.setTexture(this.key,"finca_dereliction_head"),this.headIcon.y=.5*-this.height+68*this.dpr,this.nameTitle.y=this.headIcon.y+.5*this.headIcon.height+16*this.dpr,this.contentbg.y=.5*this.contentbg.height+this.nameTitle.y+.5*this.nameTitle.height+10*this.dpr,this.detailText.y=this.contentbg.y,this.buyButton.y=.5*this.height-.5*this.buyButton.height-22*this.dpr):(this.nameTitle.visible=!1,this.headbg.visible=!0,this.headIcon.setTexture(this.key,"finca_master_head"),this.headIcon.y=this.headbg.y,this.contentbg.y=.5*this.contentbg.height+this.headbg.y+.5*this.headbg.height+10*this.dpr,this.detailText.y=this.contentbg.y,this.detailText.setLineSpacing(14*this.dpr),this.editorButton.y=.5*this.height-.5*this.editorButton.height-22*this.dpr,this.shopButton.y=this.editorButton.y),this.contentbg.visible=!0,this.detailText.visible=!0,this.setButtonActive(t);var i=this.getDetailText(t,e);this.detailText.setText(i)},PicaManorChildPanel.prototype.setButtonActive=function(t){1===t?(this.editorButton.setInteractive(),this.shopButton.setInteractive(),this.buyButton.disInteractive(),this.editorButton.visible=!0,this.shopButton.visible=!0,this.buyButton.visible=!1):2===t?(this.editorButton.disInteractive(),this.shopButton.disInteractive(),this.buyButton.setInteractive(),this.editorButton.visible=!1,this.shopButton.visible=!1,this.buyButton.visible=!0):(this.editorButton.disInteractive(),this.shopButton.disInteractive(),this.buyButton.disInteractive(),this.editorButton.visible=!1,this.shopButton.visible=!1,this.buyButton.visible=!1)},PicaManorChildPanel.prototype.getDetailText=function(t,e){var i="";if(3===t)i=""+a.i18n.t("manor.manorname")+e.manorName+"\n"+a.i18n.t("manor.manorarea")+e.streetName;else if(2===t){var n=e.price.price;i=""+a.i18n.t("manor.manorarea")+e.streetName+"\n"+a.i18n.t("manor.manorstatus")+"[color=#FF0000]"+a.i18n.t("manor.selling")+"[/color]\n"+a.i18n.t("manor.manorprice")+"[img=iv_coin]"+n+"\n"+a.i18n.t("manor.needlevel")+"20级"}else i=""+a.i18n.t("manor.manorname")+e.manorName+"[area=aaaa][img=finca_compile][/area]\n"+a.i18n.t("manor.manorowner")+e.ownerName+"\n"+a.i18n.t("manor.manorarea")+e.streetName;return i},PicaManorChildPanel.prototype.createNineButton=function(t,e,i,n,r,o){var h=new s.NineSliceButton(this.scene,0,0,t,e,i,n,r,this.dpr,this.zoom,a.UIHelper.button(this.dpr));return this.add(h),h.setTextStyle({fontSize:21*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:o}),h.setFontStyle("bold"),h},PicaManorChildPanel.prototype.onEditorButtonHandler=function(){this.sendHandler&&this.sendHandler.runWith([2])},PicaManorChildPanel.prototype.onShopButtonHandler=function(){this.sendHandler&&this.sendHandler.runWith([-1])},PicaManorChildPanel.prototype.onBuyButtonHandler=function(){this.sendHandler&&this.sendHandler.runWith([1])},PicaManorChildPanel}(h.PicaManorBasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaManorShopPanel",(function(){return c}));var n,s=i(5),r=i(470),o=i(11),a=i(0),h=i(478),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaManorShopPanel(e,i,n,s,r,o,a,h){var l=t.call(this,e,i,n)||this;return l.setSize(s,r),l.dpr=a,l.key=o,l.zoom=h,l.create(),l}return l(PicaManorShopPanel,t),PicaManorShopPanel.prototype.refreshMask=function(){this.shopgride.resetMask()},PicaManorShopPanel.prototype.create=function(){var t=this.width,e=this.height,i=.5*-e;this.bg=new s.NineSlicePatch(this.scene,0,0,t,e,o.c.common3Key,"bg",a.UIHelper.background_w(this.dpr)),this.add(this.bg),this.closeBtn=new s.Button(this.scene,o.c.commonKey,"close"),this.closeBtn.setDisplaySize(28*this.dpr,28*this.dpr),this.closeBtn.setPosition(.5*this.width-8*this.dpr,i+7*this.dpr),this.closeBtn.on(String(s.ClickEvent.Tap),this.onCloseHandler,this),this.add(this.closeBtn),this.titlebg=this.scene.make.image({key:this.key,frame:"tag_single"}),this.add(this.titlebg),this.titlebg.x=.5*-this.width+.5*this.titlebg.width+0*this.dpr,this.titlebg.y=.5*-this.height-.5*this.titlebg.height+14*this.dpr,this.imgtitle=new r.ImageValue(this.scene,135*this.dpr,16*this.dpr,this.key,"house_shop",this.dpr),this.imgtitle.setText(a.i18n.t("manor.manorshop")),this.imgtitle.setFontStyle("bold"),this.imgtitle.setTextStyle({fontSize:15*this.dpr}),this.imgtitle.x=this.titlebg.x-30*this.dpr,this.imgtitle.y=this.titlebg.y,this.add(this.imgtitle),this.secondMenu=new h.SecondaryMenuPanel(this.scene,0,.5*-this.height+46*this.dpr,302*this.dpr,29*this.dpr,this.dpr,this.zoom,{x:0,y:-14*this.dpr,width:this.width-32*this.dpr,height:30*this.dpr,zoom:this.zoom,dpr:this.dpr,space:6*this.dpr,orientation:1,align:2}),this.secondMenu.setHandler(new a.Handler(this,this.onTabButtonHandler)),this.secondMenu.setButtonChangeHandler(new a.Handler(this,(function(t){t.changeNormal(),t.setTextColor("#FE8737")})),new a.Handler(this,(function(t){t.changeDown(),t.setTextColor("#ffffff")}))),this.add(this.secondMenu);var n=302*this.dpr,l=324*this.dpr,c=.5*-n,p=.5*-l-20*this.dpr,d=this.scene.make.graphics(void 0,!1);d.fillStyle(16680759,1),d.fillRoundedRect(c,p,n,l,{tl:0,tr:5*this.dpr,bl:5*this.dpr,br:5*this.dpr}),this.add(d);var m=n-16*this.dpr,u=380*this.dpr,y=12*this.dpr;this.shopgride=this.createGrideTable(0,y,m,u,126*this.dpr,158*this.dpr),this.corfirmButton=this.createNineButton(o.c.commonKey,"yellow_btn_normal",a.i18n.t("common.confirm"),"#996600"),this.corfirmButton.y=.5*this.height-.5*this.corfirmButton.height-15*this.dpr,this.corfirmButton.on(String(s.ClickEvent.Tap),this.onConfirmButtonHandler,this)},PicaManorShopPanel.prototype.setShopCategories=function(t){for(var e=[],i=0,n=t.marketCategory;i<n.length;i++){var r=n[i],o={text:r.category.value,data:r};e.push(o)}this.secondMenu.setCategories(s.TabButton,e,{width:97*this.dpr,height:29*this.dpr,key:this.key,normalFrame:"manor_store_uncheck",downFrame:"manor_store_check",textStyle:{fontSize:15*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#FE8737"},bold:!0})},PicaManorShopPanel.prototype.setShopDatas=function(t){if(t.commodities){var e=t.commodities.sort((function(t,e){var i=t.id.replace(/[^0-9]/gi,""),n=e.id.replace(/[^0-9]/gi,"");return Number(i)>Number(n)?1:-1}));this.shopgride.setItems(e)}},PicaManorShopPanel.prototype.setTitleText=function(t){this.titleText.text=t},PicaManorShopPanel.prototype.setHandler=function(t,e){this.sendHandler=t,this.closeHandler=e},PicaManorShopPanel.prototype.createNineButton=function(t,e,i,n){var r=new s.NineSliceButton(this.scene,0,0,182*this.dpr,47*this.dpr,t,e,i,this.dpr,this.zoom,{left:14*this.dpr,top:14*this.dpr,right:14*this.dpr,bottom:14*this.dpr});return this.add(r),r.setTextStyle({fontSize:21*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:n}),r.setFontStyle("bold"),r},PicaManorShopPanel.prototype.createGrideTable=function(t,e,i,n,r,o){var a=this,h={x:t,y:e,table:{width:i,height:n,columns:2,cellWidth:r,cellHeight:o,reuseCellContainer:!0,tableOX:0*this.dpr,zoom:this.zoom},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&((e=new p(a.scene,0,0,r,o,a.key,a.dpr)).on("buyitem",a.onBuyItemHandler,a),l.add(e)),e.setItemData(i),a.selectedItemData&&a.selectedItemData.id===i.id&&(a.selectedItemData=i,a.selectedItem=e),e}},l=new s.GameGridTable(this.scene,h);return l.layout(),l.on("cellTap",(function(t){t&&a.onSelectItemHandler(t)})),this.add(l),l},PicaManorShopPanel.prototype.onTabButtonHandler=function(t){this.emit("queryProp",1,t.category.key)},PicaManorShopPanel.prototype.onConfirmButtonHandler=function(){this.selectedItemData&&1===this.selectedItemData.manorState&&this.sendHandler&&this.sendHandler.runWith(["usetype",this.selectedItemData.id])},PicaManorShopPanel.prototype.onBuyItemHandler=function(t){var e={id:t.id,quantity:1,category:t.category};this.sendHandler&&this.sendHandler.runWith(["buytype",e])},PicaManorShopPanel.prototype.onSelectItemHandler=function(t){t.select=!0,this.selectedItem&&(this.selectedItem.select=!1),this.selectedItem=t,this.selectedItemData=t.shopData,this.selectedItem.select||(this.selectedItem=void 0,this.selectedItemData=void 0)},PicaManorShopPanel.prototype.onCloseHandler=function(){this.closeHandler&&this.closeHandler.run()},PicaManorShopPanel}(Phaser.GameObjects.Container),p=function(t){function ManorShopItem(e,i,n,h,l,c,p){var d=t.call(this,e,i,n)||this;d.mselect=!1,d.dpr=p,d.key=c,d.setSize(h,l),d.bg=d.scene.make.image({key:c,frame:"manor_store_icon_bg"}),d.add(d.bg),d.nameText=d.scene.make.text({x:0,y:.5*-d.height+15*d.dpr,text:" ",style:{color:"#2B2B2B",fontSize:13*d.dpr,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(.5),d.add(d.nameText),d.icon=new r.DynamicImage(e,0,-20*p,d.key,"floor_01"),d.add(d.icon);var m=d.scene.make.image({key:d.key,frame:"manor_store_price_bg"});return d.imgprice=new r.ImageValue(d.scene,90*p,17*p,o.c.commonKey,"iv_coin",d.dpr),d.imgprice.setLayout(2),d.imgprice.setTextStyle({color:"#000000"}),d.imgprice.addAt(m,0),d.add(d.imgprice),d.tipsText=d.scene.make.text({x:0,y:.5*d.height-20*d.dpr,text:a.i18n.t("manor.owned"),style:{color:"#E33922",fontSize:13*d.dpr,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(.5),d.tipsText.setFontStyle("bold"),d.add(d.tipsText),d.button=new r.ThreeSliceButton(e,73*p,26*p,o.c.common3Key,a.UIHelper.threeRedNormal,a.UIHelper.threeRedNormal,a.i18n.t("manor.using")),d.button.setTextStyle(a.UIHelper.brownishStyle(p)),d.button.y=d.tipsText.y,d.button.on(s.ClickEvent.Tap,d.onButtonHandler,d),d.add(d.button),d.imgprice.y=d.button.y-.5*d.button.height-.5*d.imgprice.height-2*p,d}return l(ManorShopItem,t),ManorShopItem.prototype.setItemData=function(t){var e=this;this.shopData=t,this.setButtonState(t),this.nameText.text=t.name||t.shortName;var i=a.Url.getOsdRes(t.icon);this.icon.load(i,this,(function(){e.icon.scale=e.dpr}))},Object.defineProperty(ManorShopItem.prototype,"select",{get:function(){return this.mselect},set:function(t){this.mselect=t,this.bg.setFrame(t?"store_icon_check":"manor_store_icon_bg")},enumerable:!1,configurable:!0}),ManorShopItem.prototype.setButtonState=function(t){if(2===t.manorState)this.button.visible=!0,this.button.disInteractive(),this.button.setFrameNormal(a.UIHelper.threeGreenNormal,a.UIHelper.threeGreenNormal),this.button.setText(a.i18n.t("manor.using")),this.button.setTextColor(a.Color.black),this.tipsText.visible=!1,this.imgprice.visible=!1;else if(3===t.manorState){this.button.visible=!0,this.button.setInteractive(),this.button.setFrameNormal(a.UIHelper.threeYellowNormal,a.UIHelper.threeYellowNormal),this.button.setText(a.i18n.t("common.buy")),this.button.setTextColor(a.Color.brownish),this.tipsText.visible=!1,this.imgprice.visible=!0;var e=t.price[0];this.imgprice.setFrameValue(e.price+"",o.c.commonKey,a.Coin.getIcon(e.coinType))}else 1===t.manorState&&(this.button.visible=!1,this.button.disInteractive(),this.tipsText.visible=!0,this.imgprice.visible=!1)},ManorShopItem.prototype.onButtonHandler=function(){this.emit("buyitem",this.shopData)},ManorShopItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessChoosePlanPanel",(function(){return l}));var n,s=i(5),r=i(470),o=i(11),a=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaBusinessChoosePlanPanel(e,i,n,s,r,o,a,h){var l=t.call(this,e,i,n)||this;return l.dpr=o,l.key=h,l.zoom=a,l.setSize(s,r),l.create(),l}return h(PicaBusinessChoosePlanPanel,t),PicaBusinessChoosePlanPanel.prototype.setPlanData=function(t){this.gridtable.setItems(t);var e=this.gridtable.getCells();if(e){var i=e[0];i&&i.container&&this.onGridSelectHandler(i.container)}},PicaBusinessChoosePlanPanel.prototype.setHandler=function(t,e){this.cancelHandler=t,this.selectHandler=e},PicaBusinessChoosePlanPanel.prototype.resetMask=function(){this.gridtable.resetMask(),this.gameScroll.refreshMask()},PicaBusinessChoosePlanPanel.prototype.create=function(){var t=this,e=(this.height,this.width-29*this.dpr),i=100*this.dpr,n=.5*-this.height+.5*i+10*this.dpr;this.gridtable=this.createGrideTable(0,n,e,i,90*this.dpr,100*this.dpr),this.describleText=this.scene.make.text({x:.5*-this.width+20*this.dpr,y:n+.5*i+10*this.dpr,text:"This industry has great development potential.",style:{fontSize:11*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#0"}}).setOrigin(0),this.describleText.setWordWrapWidth(this.width-45*this.dpr,!0),this.add(this.describleText),this.effectText=this.scene.make.text({x:this.describleText.x,y:this.describleText.y+this.describleText.height+20*this.dpr,text:"55225sadffqwerqwerqwer",style:{fontSize:10*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#0",wordWrap:{width:244*this.dpr,useAdvancedWrap:!0}}}).setOrigin(0),this.add(this.effectText),this.materialTitle=this.scene.make.text({x:this.describleText.x,y:this.effectText.y+this.effectText.height+5*this.dpr,text:a.i18n.t("business_street.material_requirements"),style:{fontSize:11*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#0"}}).setOrigin(0),this.add(this.materialTitle),this.gameScroll=new s.GameScroller(this.scene,{x:0,y:this.materialTitle.y+this.materialTitle.height+22*this.dpr,width:this.width-40*this.dpr,height:60*this.dpr,zoom:this.zoom,dpr:this.dpr,align:2,orientation:1,space:10*this.dpr,cellupCallBack:function(e){t.onMaterialItemHandler(e)}}),this.add(this.gameScroll);var h=new s.NineSliceButton(this.scene,-60*this.dpr,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,o.c.commonKey,"red_btn",a.i18n.t("common.cancel"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(h),h.setTextStyle({fontSize:15*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#ffffff"}),h.on(String(s.ClickEvent.Tap),this.onCancelHandler,this);var l=new s.NineSliceButton(this.scene,60*this.dpr,h.y,92*this.dpr,34*this.dpr,o.c.commonKey,"yellow_btn",a.i18n.t("business_street.select"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(l),l.on(String(s.ClickEvent.Tap),this.onSelectHandler,this),l.setTextStyle({fontSize:15*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#996600"}),this.iteminfoTips=new r.ItemInfoTips(this.scene,121*this.dpr,46*this.dpr,o.c.common2Key,"tips_bg",this.dpr),this.iteminfoTips.setVisible(!1),this.add(this.iteminfoTips)},PicaBusinessChoosePlanPanel.prototype.createGrideTable=function(t,e,i,n,r,o){var a=this,h={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:r,cellHeight:o,reuseCellContainer:!0,tableOY:5*this.dpr,zoom:this.zoom},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&(e=new c(a.scene,0,0,r,o,a.key,a.dpr,a.zoom)),e.setData({item:i}),e.setPlanData(i),a.curSelectData&&i===a.curSelectData?e.select=!0:e.select=!1,e}},l=new s.GameGridTable(this.scene,h);return l.layout(),l.on("cellTap",(function(t){t&&a.onGridSelectHandler(t)})),this.add(l),l},PicaBusinessChoosePlanPanel.prototype.onGridSelectHandler=function(t){this.curSelectItem&&(this.curSelectItem.select=!1),t.select=!0;var e=t.palnData;this.gameScroll.clearItems();for(var i=0,n=e.requirements;i<n.length;i++){var s=n[i],r=new p(this.scene,0,0,36*this.dpr,36*this.dpr,this.key,this.dpr,this.zoom);r.setItemData(s),this.gameScroll.addItem(r)}this.gameScroll.Sort(),this.describleText.text=e.des,this.effectText.text=a.i18n.t("business_street.effect")+":"+e.buffDes,this.curSelectItem=t,this.curSelectData=e},PicaBusinessChoosePlanPanel.prototype.onCancelHandler=function(){this.cancelHandler&&this.cancelHandler.run()},PicaBusinessChoosePlanPanel.prototype.onSelectHandler=function(){this.selectHandler&&this.selectHandler.runWith(this.curSelectData.id),this.onCancelHandler()},PicaBusinessChoosePlanPanel.prototype.onMaterialItemHandler=function(t){if(this.iteminfoTips.setVisible(!this.iteminfoTips.visible),this.iteminfoTips&&this.iteminfoTips.visible){var e=t.itemData;this.iteminfoTips.setItemData(e),this.iteminfoTips.setTipsPosition(t,this,10*this.dpr)}},PicaBusinessChoosePlanPanel}(Phaser.GameObjects.Container),c=function(t){function PlanTypeItem(e,i,n,s,o,h,l,c){var p=t.call(this,e,i,n)||this;return p.isSelect=!1,p.dpr=l,p.key=h,p.setSize(s,o),p.bg=p.scene.make.image({key:h,frame:"store_bg"}),p.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),p.add(p.bg),p.storeIcon=new r.DynamicImage(p.scene,0,0),p.storeIcon.setTexture(p.key,"restaurant_icon"),p.storeIcon.setPosition(0,-8*l),p.add(p.storeIcon),p.storeName=p.scene.make.text({x:0,y:p.storeIcon.y+.5*p.storeIcon.height+10*l,text:"Restaurant",style:{color:"#0",fontSize:10*l,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(.5),p.add(p.storeName),p}return h(PlanTypeItem,t),PlanTypeItem.prototype.setPlanData=function(t){var e=this;this.palnData=t;var i=t.icon;""===i&&t.requirements&&t.requirements.length>0&&(i=t.requirements[0].display.texturePath);var n=a.Url.getOsdRes(i);this.storeIcon.load(n,this,(function(){e.storeIcon.displayWidth=46*e.dpr,e.storeIcon.scaleY=e.storeIcon.scaleX})),this.storeName.text=t.name},Object.defineProperty(PlanTypeItem.prototype,"select",{get:function(){return this.isSelect},set:function(t){this.isSelect=t;var e=t?"store_bg_click":"store_bg";this.bg.setFrame(e)},enumerable:!1,configurable:!0}),PlanTypeItem}(Phaser.GameObjects.Container),p=function(t){function MaterialItem(e,i,n,o,h,l,c,p){var d=t.call(this,e,i,n)||this;d.dpr=c,d.key=l,d.setSize(o,h);var m=d.scene.make.image({key:d.key,frame:"item_bg"});return m.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),d.add(m),d.itemIcon=new r.DynamicImage(d.scene,0,0),d.add(d.itemIcon),d.countText=new s.BBCodeText(d.scene,.5*m.width,.5*m.height).setOrigin(1,.5).setFontSize(12*c).setFontFamily(a.Font.DEFULT_FONT),d.add(d.countText),d}return h(MaterialItem,t),MaterialItem.prototype.setItemData=function(t){var e=this;this.itemData=t;var i=a.Url.getOsdRes(t.display.texturePath);this.itemIcon.load(i,this,(function(){e.itemIcon.displayWidth=29*e.dpr,e.itemIcon.scaleY=e.itemIcon.scaleX})),this.countText.text=this.getCountText(t.count,t.neededCount)},MaterialItem.prototype.getCountText=function(t,e){var i=t>=e?"#0054FF":"#FF2B2B";return"[stroke="+i+"][color="+i+"]"+t+"[/color][/stroke]"+("[stroke=#2D2D2D][color=#2D2D2D]/"+e+"[/color][/stroke]")},MaterialItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessPlanPanel",(function(){return l}));var n,s=i(5),r=i(470),o=i(11),a=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaBusinessPlanPanel(e,i,n,s,r,o,a,h){var l=t.call(this,e,i,n)||this;return l.dpr=o,l.key=h,l.zoom=a,l.setSize(s,r),l.create(),l}return h(PicaBusinessPlanPanel,t),PicaBusinessPlanPanel.prototype.setRender=function(t){this.render=t},PicaBusinessPlanPanel.prototype.setPlanData=function(t){var e=t.marketPlanPairs,i=""!==t.industryBackground?t.industryBackground:"market_b";this.topbg.setFrame(i),this.describleText.text=t.industryDes,this.planBuffText.text=t.industryBuffDes,this.gridtable.setItems(e)},PicaBusinessPlanPanel.prototype.setHandler=function(t,e){this.cancelHandler=t,this.addPlanHandler=e},PicaBusinessPlanPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicaBusinessPlanPanel.prototype.create=function(){var t=.5*-this.height,e=253*this.dpr,i=73*this.dpr;this.topbg=new s.NineSlicePatch(this.scene,0,0,e,i,this.key,"market_b",{left:6*this.dpr,top:0*this.dpr,right:6*this.dpr,bottom:0*this.dpr}),this.topbg.y=t+.5*i+10*this.dpr,this.add(this.topbg),this.describleText=this.scene.make.text({x:0,y:this.topbg.y-15*this.dpr,text:"Your store is now at a advantage",style:{fontSize:13*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#ffffff"}}).setOrigin(.5),this.describleText.setWordWrapWidth(200*this.dpr),this.add(this.describleText),this.planBuffText=new s.BBCodeText(this.scene,0,this.topbg.y+15*this.dpr,"Store prosperity -10%",{fontSize:13*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#ffffff"}).setOrigin(.5),this.add(this.planBuffText),this.planBuffText.setWrapWidth(200*this.dpr);var n=new s.NineSlicePatch(this.scene,0,0,135*this.dpr,17*this.dpr,this.key,"subtitle",{left:13*this.dpr,top:0*this.dpr,right:13*this.dpr,bottom:0*this.dpr});n.x=0,n.y=this.topbg.y+.5*this.topbg.height+40*this.dpr,this.add(n);var r=this.scene.make.text({x:0,y:n.y,text:a.i18n.t("business_street.marketing_plan"),style:{fontSize:11*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#0"}}).setOrigin(.5);this.add(r),n.resize(135*this.dpr,17*this.dpr);var h=this.width-24*this.dpr,l=this.height-200*this.dpr,c=n.y+.5*n.height+20*this.dpr+.5*l;this.gridtable=this.createGrideTable(0,c,h,l,253*this.dpr,63*this.dpr);var p=new s.NineSliceButton(this.scene,0,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,o.c.commonKey,"red_btn",a.i18n.t("common.cancel"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(p),p.setTextStyle({fontSize:15*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#ffffff"}),p.on(String(s.ClickEvent.Tap),this.onCancelHandler,this)},PicaBusinessPlanPanel.prototype.createGrideTable=function(t,e,i,n,r,o){var h=this,l={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:r,cellHeight:o,reuseCellContainer:!0,tableOY:5*this.dpr,zoom:this.zoom,cellPadX:8*this.dpr},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&(e=new c(h.scene,0,0,r,o,h.key,h.dpr,h.zoom)).setHandler(new a.Handler(h,h.onAddPlanHandler)),e.setData({item:i}),h.render.mainPeer.requestCurTime().then((function(t){e.setPlanData(i,t)})),e}},p=new s.GameGridTable(this.scene,l);return p.layout(),p.on("cellTap",(function(t){t&&h.onGridSelectHandler(t)})),this.add(p),p},PicaBusinessPlanPanel.prototype.onGridSelectHandler=function(t){},PicaBusinessPlanPanel.prototype.onAddPlanHandler=function(t){this.addPlanHandler&&this.addPlanHandler.runWith(t.marketPlanType)},PicaBusinessPlanPanel.prototype.onCancelHandler=function(){this.cancelHandler&&this.cancelHandler.run()},PicaBusinessPlanPanel}(Phaser.GameObjects.Container),c=function(t){function MarketingPlanItem(e,i,n,o,h,l,c,p){var d=t.call(this,e,i,n)||this;d.dpr=c,d.key=l,d.setSize(o,h),d.bg=new s.NineSlicePatch(d.scene,0,0,o,53*c,d.key,"no_plan_bg",{left:6*d.dpr,top:0*d.dpr,right:6*d.dpr,bottom:0*d.dpr}),d.add(d.bg);var m=d.scene.make.image({key:d.key,frame:"plan_icon_bg"});m.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),m.x=.5*-d.width+.5*m.width+5*c,d.add(m),d.planIcon=new r.DynamicImage(d.scene,0,0),d.planIcon.setPosition(m.x,0),d.add(d.planIcon),d.planText=d.scene.make.text({x:m.x+.5*m.width+10*c,y:0,style:{color:"#0",fontSize:10*c,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(0,.5),d.planText.text=a.i18n.t("business_street.plan_title"),d.add(d.planText),d.planName=d.scene.make.text({x:m.x+.5*m.width+10*c,y:.5*-d.bg.height+4*c,text:"Plane Name",style:{color:"#ffffff",fontSize:12*c,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(0),d.add(d.planName),d.planAtt=new s.BBCodeText(d.scene,d.planName.x,d.planName.y+d.planName.height+4*c,"Competitiveness +10%,  Prosperity +10%",{color:"#0",fontSize:10*d.dpr,fontFamily:a.Font.DEFULT_FONT}).setOrigin(0),d.add(d.planAtt);var u=159*c,y=8*c,f={x:0,y:0,color:"#ffffff",fontSize:9*c,fontFamily:a.Font.DEFULT_FONT,halign:.5,valign:.5};return d.progress=new s.ProgressBar(d.scene,{x:5*c,y:d.planAtt.y+d.planAtt.height+4*c+.5*y,width:u,height:y,background:{x:0,y:0,width:u,height:y,config:{top:1*c,left:5*c,right:5*c,bottom:1*c},key:l,frame:"progress_bar_bg"},bar:{x:0,y:0,width:u,height:y-c,config:{top:1*c,left:5*c,right:5*c,bottom:1*c},key:l,frame:"progress_bar_g"},dpr:c,textConfig:f}),d.progress.text.setOrigin(.5),d.add(d.progress),d.addBtn=new s.Button(d.scene,d.key,"add_plan","add_plan"),d.addBtn.x=.5*d.width-.5*d.addBtn.width-20*c,d.addBtn.on(String(s.ClickEvent.Tap),d.onAddBtnHandler,d),d.add(d.addBtn),d}return h(MarketingPlanItem,t),MarketingPlanItem.prototype.setPlanData=function(t,e){var i=this;if(t.marketPlan){this.planName.visible=!0,this.planAtt.visible=!0,this.progress.visible=!0,this.planText.visible=!1,this.bg.setFrame("has_plan_bg"),this.remove(this.addBtn);var n="progress_bar_r",s=Math.floor(t.marketPlan.endTime-e/1e3),r=Math.floor(s/t.marketPlan.totalTime*100);r>30&&r<=50?n="progress_bar_y":r>50&&(n="progress_bar_g"),this.progress.bar.setFrame(n),this.progress.setProgress(s,t.marketPlan.totalTime),this.progress.setText(this.getDataFormat(1e3*s)),this.planName.text=t.marketPlan.name,this.planAtt.text=t.marketPlan.buffDes;var o=""!==t.marketPlan.icon?t.marketPlan.icon:t.marketPlan.requirements[0].display.texturePath;(""===o||!o)&&t.marketPlan.requirements&&t.marketPlan.requirements.length>0&&(o=t.marketPlan.requirements[0].display.texturePath);var h=a.Url.getOsdRes(o);this.planIcon.load(h,this,(function(){i.planIcon.displayWidth=30*i.dpr,i.planIcon.scaleY=i.planIcon.scaleX}))}else this.planName.visible=!1,this.planAtt.visible=!1,this.progress.visible=!1,this.add(this.addBtn),this.bg.setFrame("no_plan_bg");this.planData=t},MarketingPlanItem.prototype.setHandler=function(t){this.addBtnHandler=t},MarketingPlanItem.prototype.onAddBtnHandler=function(){this.addBtnHandler&&this.addBtnHandler.runWith(this.planData)},MarketingPlanItem.prototype.getDataFormat=function(t){var e=Math.floor(t/864e5),i=Math.floor(t/36e5)%24,n=Math.floor(t/6e4)%60,s=Math.floor(t/1e3)%60,r="";return e>0?(r=e+"  "+a.i18n.t("timeuint.day"),(i>0||n>0)&&(r+=this.stringFormat(i)+":"+this.stringFormat(n))):r=i>0?n>0?this.stringFormat(i)+":"+this.stringFormat(n):this.stringFormat(i)+" "+a.i18n.t("timeuint.hour"):n>0?this.stringFormat(n)+" "+a.i18n.t("timeuint.minute"):this.stringFormat(s)+" "+a.i18n.t("timeuint.second"),r},MarketingPlanItem.prototype.stringFormat=function(t){var e=t+"";return e.length<=1&&(e="0"+e),e},MarketingPlanItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessHistoryPanel",(function(){return l}));var n,s=i(5),r=i(470),o=i(11),a=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaBusinessHistoryPanel(e,i,n,s,r,o,a,h,l){var c=t.call(this,e,i,n)||this;return c.dpr=o,c.key=h,c.key2=l,c.zoom=a,c.setSize(s,r),c.create(),c}return h(PicaBusinessHistoryPanel,t),PicaBusinessHistoryPanel.prototype.setHistoryeData=function(t){this.gridtable.setItems(t),this.titleText.text=a.i18n.t("business_street.history_title",{name:t.length})},PicaBusinessHistoryPanel.prototype.setHandler=function(t){this.backHandler=t},PicaBusinessHistoryPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicaBusinessHistoryPanel.prototype.create=function(){var t=.5*-this.height,e=.5*-this.width,i=this.scene.make.text({x:e+30*this.dpr,y:t+6*this.dpr,text:a.i18n.t("business_street.history_title"),style:{fontSize:13*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#FFC51A"}}).setOrigin(0,.5);i.setStroke("#553100",2*this.dpr),this.add(i),this.titleText=i;var n=this.width,r=this.height-80*this.dpr,h=t+33*this.dpr+.5*r;this.gridtable=this.createGrideTable(0,h,n,r,256*this.dpr,50*this.dpr);var l=new s.NineSliceButton(this.scene,0,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,o.c.commonKey,"red_btn",a.i18n.t("business_street.back"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(l),l.setTextStyle({fontSize:15*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#ffffff"}),l.on(String(s.ClickEvent.Tap),this.onBackHandler,this)},PicaBusinessHistoryPanel.prototype.createGrideTable=function(t,e,i,n,r,o){var a=this,h={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:r,cellHeight:o,reuseCellContainer:!0,tableOX:19*this.dpr,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&(e=new c(a.scene,0,0,r,o,a.key,a.key2,a.dpr,a.zoom),l.add(e)),e.setData({item:i}),e.setStoreData(i),e}},l=new s.GameGridTable(this.scene,h);return l.layout(),this.add(l),l},PicaBusinessHistoryPanel.prototype.onBackHandler=function(){this.backHandler&&this.backHandler.run()},PicaBusinessHistoryPanel}(Phaser.GameObjects.Container),c=function(t){function PicHistoryItem(e,i,n,o,h,l,c,p,d){var m=t.call(this,e,i,n)||this;m.dpr=p,m.key=l,m.key2=c,m.setSize(o,h);var u=.5*-m.width,y=.5*-m.height;m.bg=new s.NineSlicePatch(m.scene,0,0,o,45*p,m.key,"resturant_bg",{left:4*m.dpr,top:9*m.dpr,right:4*m.dpr,bottom:9*m.dpr}),m.add(m.bg);var f=m.scene.make.image({key:c,frame:"icon_bg_s"});f.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),f.setPosition(u+.5*f.width+3*p,0),m.add(f),m.storeIcon=new r.DynamicImage(m.scene,f.x,0),m.add(m.storeIcon);var g=f.x+.5*f.width+10*p;return m.storeName=m.scene.make.text({x:g,y:y+10*p,text:"Restaurant",style:{color:"#FFE11A",fontSize:12*p,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.storeName),m.playerName=m.scene.make.text({x:g,y:m.storeName.y+.5*m.storeName.height+10*p,text:"Savings: 13000",style:{color:"#ffffff",fontSize:11*p,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.playerName),m.industryIcon=m.scene.make.image({key:m.key2,frame:"entertainment_tag_s"}),m.industryIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),m.industryIcon.x=.5*m.width-.5*m.industryIcon.width,m.add(m.industryIcon),m}return h(PicHistoryItem,t),PicHistoryItem.prototype.setStoreData=function(t){this.storeData=t,this.bg.setTexture(this.key2,t.industry+"_bg"),this.storeName.text=t.name,this.playerName.text=t.ownerName,this.storeIcon.setTexture(this.key2,t.storeType+"_icon_s"),this.industryIcon.setFrame(t.industry+"_tag_s")},PicHistoryItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessMyStreetPanel",(function(){return l}));var n,s=i(5),r=i(470),o=i(11),a=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaBusinessMyStreetPanel(e,i,n,s,r,o,a,h){var l=t.call(this,e,i,n)||this;return l.isCanNewCreate=!1,l.dpr=o,l.key=h,l.zoom=a,l.setSize(s,r),l.create(),l}return h(PicaBusinessMyStreetPanel,t),PicaBusinessMyStreetPanel.prototype.setMyStoreData=function(t){var e=t.storeList;this.storelimitText.text=a.i18n.t("business_street.store_limit")+":"+e.length+"/"+t.storeLimit,this.gridtable.setItems(e),this.isCanNewCreate=e.length<t.storeLimit},PicaBusinessMyStreetPanel.prototype.setHandler=function(t,e,i,n){this.takeAllHandler=t,this.goOutHandler=e,this.newStoreHandler=i,this.enterRoomHandler=n},PicaBusinessMyStreetPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicaBusinessMyStreetPanel.prototype.create=function(){var t=.5*-this.height,e=.5*-this.width,i=this.scene.make.image({key:this.key,frame:"store_icon"});i.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),i.x=e+30*this.dpr,i.y=t+6*this.dpr,this.add(i);var n=i.x+.5*i.width+10*this.dpr,r=this.scene.make.text({x:n,y:i.y,text:a.i18n.t("business_street.my_store"),style:{fontSize:13*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#FFC51A"}}).setOrigin(0,.5);r.setStroke("#553100",2*this.dpr),this.add(r);var h=this.width,l=this.height-68*this.dpr,c=t+28*this.dpr+.5*l;this.gridtable=this.createGrideTable(0,c,h,l,256*this.dpr,87*this.dpr),this.newStoreBtn=new s.Button(this.scene,this.key,"new_store","new_store");var p=-e-.5*this.newStoreBtn.width-20*this.dpr;this.newStoreBtn.setPosition(p,t+6*this.dpr),this.newStoreBtn.on(String(s.ClickEvent.Tap),this.onNewStoreHandler,this),this.add(this.newStoreBtn),this.storelimitText=this.scene.make.text({x:p-.5*this.newStoreBtn.width-10*this.dpr,y:t+5*this.dpr,text:"store limit",style:{color:"#0",fontSize:12*this.dpr,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(1,.5),this.add(this.storelimitText),this.storeCountText=this.scene.make.text({x:p+.5*this.newStoreBtn.width+20*this.dpr,y:t,text:"",style:{fontSize:13*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#FFC51A"}}).setOrigin(1,0),this.add(this.storeCountText);var d=new s.NineSliceButton(this.scene,-60*this.dpr,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,o.c.commonKey,"red_btn",a.i18n.t("business_street.takeall"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(d),d.setTextStyle({fontSize:15*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#ffffff"}),d.on(String(s.ClickEvent.Tap),this.onTalkAllHandler,this);var m=new s.NineSliceButton(this.scene,60*this.dpr,d.y,92*this.dpr,34*this.dpr,o.c.commonKey,"yellow_btn",a.i18n.t("business_street.goout"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(m),m.on(String(s.ClickEvent.Tap),this.onGoOutHandler,this),m.setTextStyle({fontSize:15*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#996600"})},PicaBusinessMyStreetPanel.prototype.createGrideTable=function(t,e,i,n,r,o){var h=this,l={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:r,cellHeight:o,reuseCellContainer:!0,tableOX:19*this.dpr,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&((e=new c(h.scene,0,0,r,o,h.key,h.dpr,h.zoom)).setHandler(new a.Handler(h,h.onEnterHandler)),p.add(e)),e.setData({item:i}),e.setStoreData(i),e}},p=new s.GameGridTable(this.scene,l);return p.layout(),this.add(p),p},PicaBusinessMyStreetPanel.prototype.onEnterHandler=function(t){this.enterRoomHandler&&this.enterRoomHandler.runWith(t.roomId)},PicaBusinessMyStreetPanel.prototype.onTalkAllHandler=function(){this.takeAllHandler&&this.takeAllHandler.run()},PicaBusinessMyStreetPanel.prototype.onGoOutHandler=function(){this.goOutHandler&&this.goOutHandler.run()},PicaBusinessMyStreetPanel.prototype.onNewStoreHandler=function(){this.isCanNewCreate&&this.newStoreHandler&&this.newStoreHandler.run()},PicaBusinessMyStreetPanel}(Phaser.GameObjects.Container),c=function(t){function MyStoreItem(e,i,n,h,l,c,p,d){var m=t.call(this,e,i,n)||this;m.dpr=p,m.key=c,m.setSize(h,l);var u=.5*-m.width,y=.5*-m.height;m.bg=new s.NineSlicePatch(m.scene,0,0,h,80*p,m.key,"resturant_bg",{left:4*m.dpr,top:9*m.dpr,right:4*m.dpr,bottom:9*m.dpr}),m.add(m.bg);var f=m.scene.make.image({key:c,frame:"store_icon_bg"});f.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),f.setPosition(u+.5*f.width+10*p,0),m.add(f),m.storeIcon=new r.DynamicImage(m.scene,f.x,0),m.add(m.storeIcon);var g=f.x+.5*f.width+10*p;m.storeName=m.scene.make.text({x:g,y:y+5*p,text:"Restaurant",style:{color:"#FFE11A",fontSize:12*p,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.storeName),m.lvimgCon=m.scene.make.container(void 0,!1),m.lvimgCon.height=14*p,m.lvimgCon.setPosition(g+6*p,m.storeName.y+m.storeName.height+.5*m.lvimgCon.height+2*p),m.add(m.lvimgCon),m.savings=m.scene.make.text({x:g,y:m.lvimgCon.y+.5*m.lvimgCon.height+2*p,text:"Savings: 13000",style:{color:"#ffffff",fontSize:10*p,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.savings),m.competitiveness=m.scene.make.text({x:g,y:m.savings.y+m.savings.height+2*p,text:"Competitiveness: 13000",style:{color:"#ffffff",fontSize:10*p,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.competitiveness),m.turnover=m.scene.make.text({x:g,y:m.competitiveness.y+m.competitiveness.height+2*p,text:"Prosperity: +13000 / Day",style:{color:"#ffffff",fontSize:10*p,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.turnover),m.industryIcon=m.scene.make.image({key:m.key,frame:"entertainment_tag"}),m.industryIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),m.industryIcon.x=.5*m.width-.5*m.industryIcon.width,m.add(m.industryIcon);var P=new s.NineSliceButton(e,-u,0,48*p,27*p,o.c.commonKey,"yellow_btn_normal_s",a.i18n.t("business_street.enter"),m.dpr,d,{left:10*m.dpr,top:10*m.dpr,right:10*m.dpr,bottom:10*m.dpr});return P.setTextStyle({fontSize:10*p,fontFamily:a.Font.DEFULT_FONT,color:"#996600"}),P.x=-u-.5*P.width-10*p,P.on(String(s.ClickEvent.Tap),m.onEnterHandler,m),m.add(P),m}return h(MyStoreItem,t),MyStoreItem.prototype.setStoreData=function(t){var e=t.industry,i=t.storeType;this.bg.setFrame(e+"_bg"),this.storeIcon.setTexture(this.key,i+"_icon"),this.storeName.text=t.name,this.lvimgCon.removeAll(!0),this.setImageInfo(o.c.common2Key,this.getLevelImgs(t.roomLevel.level)),this.savings.text=a.i18n.t("business_street.savings")+":"+t.savings,this.competitiveness.text=a.i18n.t("business_street.competitiveness")+":"+t.competitiveness,this.turnover.text=a.i18n.t("business_street.turnover")+":"+t.turnover,this.industryIcon.setFrame(e+"_tag"),this.storeData=t},MyStoreItem.prototype.setHandler=function(t){this.enterHandler=t},MyStoreItem.prototype.setImageInfo=function(t,e){for(var i=0,n=15*this.dpr,s=0,r=e;s<r.length;s++){var o=r[s],a=this.scene.make.image({key:t,frame:o});a.x=i,i+=.5*a.width+n,this.lvimgCon.add(a)}},MyStoreItem.prototype.onEnterHandler=function(){this.enterHandler&&this.enterHandler.runWith(this.storeData)},MyStoreItem.prototype.getLevelImgs=function(t){t=t||0;for(var e=[],i=Math.floor(t/Math.pow(4,3)),n=t%Math.pow(4,3),s=Math.floor(n/Math.pow(4,2)),r=n%Math.pow(4,2),o=Math.floor(r/Math.pow(4,1)),a=r%Math.pow(4,1),h=0;h<i;h++)e.push("bear");for(h=0;h<s;h++)e.push("sun");for(h=0;h<o;h++)e.push("moon");for(h=0;h<a;h++)e.push("star");return 0===t&&e.push("star"),e},MyStoreItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessRankRewardPanel",(function(){return l}));var n,s=i(5),r=i(470),o=i(11),a=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaBusinessRankRewardPanel(e,i,n,s,r,o,a,h,l){var c=t.call(this,e,i,n)||this;return c.dpr=o,c.key=h,c.key2=l,c.zoom=a,c.setSize(s,r),c.create(),c}return h(PicaBusinessRankRewardPanel,t),PicaBusinessRankRewardPanel.prototype.setRankRewardData=function(t){this.gridtable.setItems(t)},PicaBusinessRankRewardPanel.prototype.setHandler=function(t){this.backHandler=t},PicaBusinessRankRewardPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicaBusinessRankRewardPanel.prototype.create=function(){var t=.5*-this.height,e=this.width-20*this.dpr,i=this.height-70*this.dpr,n=t+23*this.dpr+.5*i;this.gridtable=this.createGrideTable(-5*this.dpr,n,e,i,256*this.dpr,80*this.dpr);var r=new s.NineSliceButton(this.scene,0,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,o.c.commonKey,"red_btn",a.i18n.t("business_street.back"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(r),r.setTextStyle({fontSize:15*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#ffffff"}),r.on(String(s.ClickEvent.Tap),this.onBackHandler,this)},PicaBusinessRankRewardPanel.prototype.createGrideTable=function(t,e,i,n,r,o){var a=this,h={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:r,cellHeight:o,reuseCellContainer:!0,tableOX:19*this.dpr,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&(e=new c(a.scene,0,0,r,o,a.key,a.key2,a.dpr,a.zoom),l.add(e)),e.setData({item:i}),e.setRankRewardData(i),e}},l=new s.GameGridTable(this.scene,h);return l.layout(),this.add(l),l},PicaBusinessRankRewardPanel.prototype.onBackHandler=function(){this.backHandler&&this.backHandler.run()},PicaBusinessRankRewardPanel}(Phaser.GameObjects.Container),c=function(t){function PicRankRewardItem(e,i,n,s,r,o,h,l,c){var p=t.call(this,e,i,n)||this;p.rewardItems=[],p.dpr=l,p.zoom=c,p.key=o,p.key2=h,p.setSize(s,r);var d=p.scene.make.image({key:p.key2,frame:"reward_bg"});d.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),p.add(d),p.rankIcon=p.scene.make.image({key:h,frame:"1"}),p.rankIcon.x=.5*-s+.5*p.rankIcon.width+10*l,p.add(p.rankIcon);var m=p.rankIcon.x;return p.rankText=p.scene.make.text({x:m,y:0,text:"3",style:{color:"#0",fontSize:12*l,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(.5),p.add(p.rankText),p}return h(PicRankRewardItem,t),PicRankRewardItem.prototype.setRankRewardData=function(t){if(this.rewardData!==t){t.start===t.end?(this.rankIcon.visible=!0,this.rankText.visible=!1,this.rankIcon.setFrame(t.start+"")):(this.rankIcon.visible=!1,this.rankText.visible=!0,this.rankText.text=t.start+"~"+t.end);for(var e=0,i=this.rewardItems;e<i.length;e++){(s=i[e]).visible=!1}for(var n=0;n<t.rewards.length;n++){var s=void 0;n<this.rewardItems.length?s=this.rewardItems[n]:(s=new p(this.scene,0,0,50*this.dpr,50*this.dpr,this.key2,this.dpr,this.zoom),this.add(s),this.rewardItems.push(s)),s.visible=!0,s.setRewardData(t.rewards[n])}this.Sort(),this.rewardData=t}},PicRankRewardItem.prototype.Sort=function(){for(var t=10*this.dpr,e=-50*this.dpr,i=0,n=this.rewardItems;i<n.length;i++){var s=n[i];s.x=s.width*s.originX+e,e+=s.width+t}},PicRankRewardItem}(Phaser.GameObjects.Container),p=function(t){function RewardItem(e,i,n,s,o,h,l,c){var p=t.call(this,e,i,n)||this;p.dpr=l,p.key2=h,p.setSize(s,o);var d=p.scene.make.image({key:p.key2,frame:"icon_bg_m"});return d.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),p.add(d),p.itemIcon=new r.DynamicImage(p.scene,0,0),p.add(p.itemIcon),p.countText=p.scene.make.text({x:.5*d.width,y:.5*d.height,text:"4~10",style:{color:"#0",fontSize:12*l,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(1,.5),p.add(p.countText),p}return h(RewardItem,t),RewardItem.prototype.setRewardData=function(t){var e=this,i=a.Url.getOsdRes(t.display.texturePath);this.itemIcon.load(i,this,(function(){e.itemIcon.displayWidth=43*e.dpr,e.itemIcon.scaleY=e.itemIcon.scaleX})),this.countText.text=t.count+""},RewardItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessRankingDetailPanel",(function(){return l}));var n,s=i(5),r=i(470),o=i(11),a=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaBusinessRankingDetailPanel(e,i,n,s,r,o,a,h,l){var c=t.call(this,e,i,n)||this;return c.dpr=o,c.key=h,c.key2=l,c.zoom=a,c.setSize(s,r),c.create(),c}return h(PicaBusinessRankingDetailPanel,t),PicaBusinessRankingDetailPanel.prototype.setRankingDetailData=function(t){this.content=t;var e=t.stores;if(this.gridtable.setItems(e),t.playerStore){this.myRankItem.visible=!0,this.myitembg.visible=!0,this.myRankItem.setDetailData(t.playerStore);var i=.5*-this.height,n=this.width,s=this.height-125*this.dpr,r=i+30*this.dpr+.5*s;this.gridtable.y=r,this.gridtable.setSize(n,s)}else{this.myitembg.visible=!1,this.myRankItem.visible=!1;i=.5*-this.height,n=this.width,s=this.height-100*this.dpr,r=i+30*this.dpr+.5*s;this.gridtable.y=r,this.gridtable.setSize(n,s)}},PicaBusinessRankingDetailPanel.prototype.setHandler=function(t,e){this.backHandler=t,this.rankRewardHandler=e},PicaBusinessRankingDetailPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicaBusinessRankingDetailPanel.prototype.create=function(){var t=.5*-this.height,e=.5*-this.width;this.timeText=this.scene.make.text({x:0,y:t+6*this.dpr,text:a.i18n.t("6 DAY 23:24:16"),style:{fontSize:13*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#D9270F"}}).setOrigin(.5),this.timeText.setStroke("#553100",2*this.dpr),this.add(this.timeText),this.timeText.visible=!1;var i=new s.NineSliceButton(this.scene,0,this.timeText.y,60*this.dpr,26*this.dpr,o.c.commonKey,"yellow_btn_normal_s",a.i18n.t("business_street.rank_reward"),this.dpr,this.zoom,{left:10*this.dpr,top:6*this.dpr,right:10*this.dpr,bottom:6*this.dpr});i.x=-e-.5*i.width-30*this.dpr,i.setTextStyle({fontSize:10*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#996600"}),i.on(String(s.ClickEvent.Tap),this.onRankRewardHandler,this),this.add(i);var n=this.width,r=this.height-125*this.dpr,h=t+30*this.dpr+.5*r;this.gridtable=this.createGrideTable(0,h,n,r,256*this.dpr,50*this.dpr),this.myitembg=this.scene.make.image({key:this.key2,frame:"my_rank_bg"}),this.myitembg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.myitembg.y=h+.5*r+.5*this.myitembg.height-3*this.dpr,this.add(this.myitembg),this.myRankItem=new c(this.scene,0,this.myitembg.y+5*this.dpr,256*this.dpr,50*this.dpr,this.key,this.key2,this.dpr,this.zoom),this.add(this.myRankItem);var l=new s.NineSliceButton(this.scene,0,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,o.c.commonKey,"red_btn",a.i18n.t("business_street.back"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(l),l.setTextStyle({fontSize:15*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#ffffff"}),l.on(String(s.ClickEvent.Tap),this.onBackHandler,this)},PicaBusinessRankingDetailPanel.prototype.createGrideTable=function(t,e,i,n,r,o){var a=this,h={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:r,cellHeight:o,reuseCellContainer:!0,tableOX:19*this.dpr,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&(e=new c(a.scene,0,0,r,o,a.key,a.key2,a.dpr,a.zoom),l.add(e)),e.setData({item:i}),e.setDetailData(i),e}},l=new s.GameGridTable(this.scene,h);return l.layout(),this.add(l),l},PicaBusinessRankingDetailPanel.prototype.onBackHandler=function(){this.backHandler&&this.backHandler.run(),this.content=void 0},PicaBusinessRankingDetailPanel.prototype.onRankRewardHandler=function(){this.rankRewardHandler&&this.content&&this.rankRewardHandler.runWith([this.content.key,this.content.type])},PicaBusinessRankingDetailPanel}(Phaser.GameObjects.Container),c=function(t){function PicRankingDetailItem(e,i,n,o,h,l,c,p,d){var m=t.call(this,e,i,n)||this;m.dpr=p,m.key=l,m.key2=c,m.setSize(o,h);var u=.5*-m.width,y=.5*-m.height;m.bg=new s.NineSlicePatch(m.scene,0,0,o,45*p,m.key,"restaurant_bg",{left:4*m.dpr,top:9*m.dpr,right:4*m.dpr,bottom:9*m.dpr}),m.add(m.bg);var f=m.scene.make.image({key:c,frame:"icon_bg_s"});f.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),f.setPosition(u+.5*f.width+3*p,0),m.add(f),m.storeIcon=new r.DynamicImage(m.scene,f.x,0),m.add(m.storeIcon);var g=f.x+.5*f.width+10*p;return m.storeName=m.scene.make.text({x:g,y:y+10*p,text:"Restaurant",style:{color:"#FFE11A",fontSize:12*p,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.storeName),m.playerName=m.scene.make.text({x:g,y:m.storeName.y+.5*m.storeName.height+10*p,text:"Savings: 13000",style:{color:"#ffffff",fontSize:11*p,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.playerName),m.industryIcon=m.scene.make.image({key:m.key2,frame:"restaurant_tag_s"}),m.industryIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),m.industryIcon.x=.5*m.width-.5*m.industryIcon.width,m.add(m.industryIcon),m.rankIcon=m.scene.make.image({key:c,frame:"1"}),m.rankIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),m.rankIcon.x=-u-80*p,m.add(m.rankIcon),m.rankText=m.scene.make.text({x:g,y:0,text:"Restaurant",style:{color:"#ffffff",fontSize:18*p,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(.5),m.rankText.x=m.rankIcon.x,m.add(m.rankText),m.praiseCount=m.scene.make.text({x:m.rankIcon.x+.5*m.rankIcon.width+10*p,y:m.rankIcon.y,text:"66666666",style:{color:"#ffffff",fontSize:12*p,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(0,.5),m.add(m.praiseCount),m}return h(PicRankingDetailItem,t),PicRankingDetailItem.prototype.setDetailData=function(t){this.detailData=t,this.storeName.text=t.name,this.playerName.text=t.ownerName,t.index<4&&t.index>0?(this.rankIcon.visible=!0,this.rankText.visible=!1,this.rankIcon.setFrame(t.index+"")):(this.rankIcon.visible=!1,this.rankText.visible=!0,t.index<=0?this.rankText.text=a.i18n.t("business_street.onrank"):this.rankText.text=t.index+""),this.praiseCount.text=t.value+"",this.storeIcon.setTexture(this.key2,t.storeType+"_icon_s"),this.bg.setFrame(t.industryType+"_bg"),this.industryIcon.setFrame(t.industryType+"_tag_s")},PicRankingDetailItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessRankingPanel",(function(){return h}));var n,s=i(5),r=i(11),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicaBusinessRankingPanel(e,i,n,s,r,o,a,h,l){var c=t.call(this,e,i,n)||this;return c.boundOffset=85,c.dpr=o,c.key=h,c.key2=l,c.zoom=a,c.setSize(s,r),c.create(),c}return a(PicaBusinessRankingPanel,t),PicaBusinessRankingPanel.prototype.create=function(){var t=this,e=.5*-this.height,i=(this.width,this.scene.make.text({x:0,y:e+20*this.dpr,text:o.i18n.t("business_street.ranking_list"),style:{fontSize:18*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#FFC51A"}}).setOrigin(.5));i.setStroke("#553100",2*this.dpr),this.add(i),this.titleText=i;var n=this.scene.make.image({x:0,y:i.y+.5*i.height+10*this.dpr,key:this.key2,frame:"title"});n.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.add(n);var a=this.width-28*this.dpr,h=this.height-80*this.dpr;this.dpr;this.gameScroll=new s.GameScroller(this.scene,{x:0,y:0,width:a,height:h,zoom:this.zoom,dpr:this.dpr,align:2,orientation:1,space:20*this.dpr,valuechangeCallback:function(e){t.onScrollValueChange(e)},cellupCallBack:function(e){t.onScrollClickHandler(e)}}),this.add(this.gameScroll);var l=new s.NineSliceButton(this.scene,0,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,r.c.commonKey,"red_btn",o.i18n.t("business_street.back"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(l),l.setTextStyle({fontSize:15*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#ffffff"}),l.on(String(s.ClickEvent.Tap),this.onBackHandler,this)},PicaBusinessRankingPanel.prototype.setRankingData=function(t){var e=this.scene.make.container(void 0,!1);this.boundOffset=35*this.dpr,e.setSize(this.boundOffset,185*this.dpr),this.gameScroll.clearItems(),this.gameScroll.addItem(e);for(var i=0,n=t;i<n.length;i++){var s=n[i],r=new l(this.scene,0,0,133*this.dpr,185*this.dpr,this.key,this.key2,this.dpr,this.zoom);r.setRankData(s),this.gameScroll.addItem(r)}var o=this.scene.make.container(void 0,!1);o.setSize(this.boundOffset,185*this.dpr),this.gameScroll.addItem(o),this.gameScroll.Sort(),this.gameScroll.refreshMask(),this.gameScroll.setValue(this.gameScroll.bounds[1])},PicaBusinessRankingPanel.prototype.setHandler=function(t,e){this.backHandler=t,this.rankHandler=e},PicaBusinessRankingPanel.prototype.resetMask=function(){this.gameScroll.refreshMask()},PicaBusinessRankingPanel.prototype.show=function(){this.addListen(),this.visible=!0},PicaBusinessRankingPanel.prototype.hide=function(){this.removeListen()},PicaBusinessRankingPanel.prototype.onScrollValueChange=function(t){if(this.gameScroll){for(var e=133*this.dpr,i=.25*(this.gameScroll.width-e),n=0,s=this.gameScroll.getItemList();n<s.length;n++){var r=s[n],o=Math.abs(r.getWorldTransformMatrix().tx-this.getWorldTransformMatrix().tx)-.25*e;o<0&&(o=0);var a=1-Math.abs(o)/i;r instanceof l&&r.setRadio(a)}this.gameScroll.Sort(!0,!1)}},PicaBusinessRankingPanel.prototype.onScrollUpHandler=function(){var t=this;if(this.gameScroll){var e=this.gameScroll.getValue(),i=this.gameScroll.bounds[1]-e,n=Math.floor((i+66*this.dpr)/(133*this.dpr+20*this.dpr)),s=this.gameScroll.getItemList().length;if(n>=0&&n<s-1){var r=this.gameScroll.getItemAt(n+1).getWorldTransformMatrix().tx-this.getWorldTransformMatrix().tx;if((r*=this.scale)<0){var o=Math.abs(r)+e;this.timerID=setInterval((function(){e+=10*t.dpr,t.gameScroll.setValue(e),e>=o&&(t.gameScroll.setValue(o),clearInterval(t.timerID),t.timerID=void 0)}),20)}else{var a=e-Math.abs(r);this.timerID=setInterval((function(){e-=10*t.dpr,t.gameScroll.setValue(e),e<=a&&(t.gameScroll.setValue(a),clearInterval(t.timerID),t.timerID=void 0)}),20)}}this.gameScroll.Sort(!0,!1)}},PicaBusinessRankingPanel.prototype.onScrollClickHandler=function(t){if(this.timerID&&(clearInterval(this.timerID),this.timerID=void 0),this.rankHandler){var e=t.rankData;this.rankHandler.runWith([e.key,e.type])}},PicaBusinessRankingPanel.prototype.onBackHandler=function(){this.backHandler&&this.backHandler.run(),this.gameScroll.clearItems()},PicaBusinessRankingPanel.prototype.addListen=function(){this.scene&&(this.removeListen(),this.scene.input.on("pointerdown",this.pointerDownHandler,this),this.scene.input.on("pointerup",this.pointerUpHandler,this))},PicaBusinessRankingPanel.prototype.removeListen=function(){this.scene&&(this.scene.input.off("pointerdown",this.pointerDownHandler,this),this.scene.input.off("pointerup",this.pointerUpHandler,this))},PicaBusinessRankingPanel.prototype.pointerDownHandler=function(t){this.checkPointerInBounds(this.gameScroll,t)&&(this.timerID&&(clearInterval(this.timerID),this.timerID=void 0),this.moveTimerID&&(clearInterval(this.moveTimerID),this.moveTimerID=void 0))},PicaBusinessRankingPanel.prototype.pointerUpHandler=function(t){var e=this;this.checkPointerInBounds(this.gameScroll,t)&&setTimeout((function(){e.gameScroll.isSliding?e.moveTimerID=setInterval((function(){e.gameScroll.isSliding||(e.onScrollUpHandler(),clearInterval(e.moveTimerID),e.moveTimerID=void 0)}),20):e.onScrollUpHandler()}),20)},PicaBusinessRankingPanel.prototype.checkPointerInBounds=function(t,e){if(this.mRectangle||(this.mRectangle=new Phaser.Geom.Rectangle(0,0,0,0)),this.mRectangle.left=-t.width/2,this.mRectangle.right=t.width/2,this.mRectangle.top=-t.height/2,this.mRectangle.bottom=t.height/2,e){var i=t.getWorldTransformMatrix(),n=e.x-i.tx,s=e.y-i.ty;return this.mRectangle.left<=n&&this.mRectangle.right>=n&&this.mRectangle.top<=s&&this.mRectangle.bottom>=s}return!1},PicaBusinessRankingPanel}(Phaser.GameObjects.Container),l=function(t){function PicRankingItem(e,i,n,r,a,h,l,c,p){var d=t.call(this,e,i,n)||this;d.radio=0,d.imgtype=1,d.dpr=c,d.key=h,d.key2=l,d.setSize(r,a);d.width;var m=.5*-d.height;return d.bg=d.scene.make.image({key:d.key2,frame:"restaurant_rank_bg_s"}),d.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),d.add(d.bg),d.titleText=d.scene.make.text({x:0,y:m,text:"Restaurant",style:{color:"#0555AF",fontSize:14*c,fontFamily:o.Font.DEFULT_FONT}}).setOrigin(.5),d.add(d.titleText),d.storebg=new s.NineSlicePatch(d.scene,0,0,72*c,17*c,d.key2,"store_name_bg_s",{left:8*d.dpr,top:0*d.dpr,right:8*d.dpr,bottom:0*d.dpr}),d.storebg.y=d.titleText.y+10*c,d.add(d.storebg),d.storeName=d.scene.make.text({x:0,y:d.storebg.y,text:"Restaurant",style:{color:"#0",fontSize:12*c,fontFamily:o.Font.DEFULT_FONT}}).setOrigin(.5),d.add(d.storeName),d.storeIcon=d.scene.make.image({key:d.key2,frame:"restaurant_rank_icon_s"}),d.storeIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),d.storeIcon.y=-m-.5*d.storeIcon.height-5*c,d.add(d.storeIcon),d}return a(PicRankingItem,t),PicRankingItem.prototype.setRankData=function(t){this.rankData=t,this.titleText.text=t.name,this.storeName.text=t.champion,this.switchImage(1)},PicRankingItem.prototype.setRadio=function(t){var e=1;t>1&&(t=1),t>0&&(e=2),this.imgtype!==e&&(this.switchImage(e),this.imgtype=e),this.scale=2===e?1/this.radio+t*(1-1/this.radio):1,this.width=this.bg.displayWidth*this.scale,this.height=this.bg.displayHeight*this.scale},PicRankingItem.prototype.switchImage=function(t){var e,i,n,s,r,o,a,h,l=this.rankData.type,c=133*this.dpr,p=133*this.dpr;1===t?(e=l+"_rank_bg_s",i=14*this.dpr,n="store_name_bg_s",s=72*this.dpr,r=14*this.dpr,o=10*this.dpr,a=l+"_rank_icon_s",p=133*this.dpr,this.storebg.setConfig({left:8*this.dpr,top:0*this.dpr,right:8*this.dpr,bottom:0*this.dpr})):(e=l+"_rank_bg_m",i=18*this.dpr,n="store_name_bg_m",s=88*this.dpr,r=17*this.dpr,o=12*this.dpr,a=l+"_rank_icon_m",p=163*this.dpr,this.storebg.setConfig({left:11*this.dpr,top:0*this.dpr,right:11*this.dpr,bottom:0*this.dpr})),h=p/c,this.radio=h,this.bg.setFrame(e),this.titleText.setFontSize(i),this.storebg.setFrame(n),this.storebg.resize(s,r),this.storeName.setFontSize(o),this.storeIcon.setFrame(a),this.setSize(this.bg.width,this.bg.height),this.titleText.y=.5*-this.height+.5*this.titleText.height+10*this.dpr*h,this.storebg.y=this.titleText.y+.5*this.titleText.height+10*this.dpr*h,this.storeName.y=this.storebg.y,this.storeIcon.y=.5*this.height-.5*this.storeIcon.height-10*this.dpr*h},PicRankingItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessStoreCreatePanel",(function(){return h}));var n,s=i(5),r=i(11),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicaBusinessStoreCreatePanel(e,i,n,s,r,o,a,h,l){void 0===l&&(l=!0);var c=t.call(this,e,i,n)||this;return c.isFirst=!0,c.dpr=o,c.key=h,c.zoom=a,c.setSize(s,r),c.isFirst=l,c.create(),c}return a(PicaBusinessStoreCreatePanel,t),PicaBusinessStoreCreatePanel.prototype.setTypeData=function(t){t instanceof Array?this.gridtable.setItems(t):this.gridtable.setItems(t.roomModels);var e=this.gridtable.getCells()[0];e&&e.container&&this.onGridSelectHandler(e.container),this.gridtable.setT(0)},PicaBusinessStoreCreatePanel.prototype.setTypeInfo=function(t){if(this.curSelectData=t,"industryType"in t)this.recommendedText.text=t.state,this.describleText.text=t.des,this.turnoverText.setText(t.buffDes);else{var e=t;e.price&&(this.coinImg.setFrame(o.Coin.getIcon(e.price.coinType)),this.coinCount.text=e.price.price+""),this.describleText2.text=e.des}},PicaBusinessStoreCreatePanel.prototype.setHandler=function(t,e){this.cancelHandler=t,this.selectHandler=e},PicaBusinessStoreCreatePanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicaBusinessStoreCreatePanel.prototype.create=function(){var t=.5*-this.height,e=new s.NineSlicePatch(this.scene,0,0,135*this.dpr,17*this.dpr,this.key,"subtitle",{left:13*this.dpr,top:0*this.dpr,right:13*this.dpr,bottom:0*this.dpr});e.x=0,e.y=t+10*this.dpr,this.add(e);var i=this.scene.make.text({x:0,y:e.y,text:o.i18n.t("business_street.choosetheindustry"),style:{fontSize:11*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#0"}}).setOrigin(.5);this.add(i);var n=this.width-24*this.dpr,a=100*this.dpr,h=-50*this.dpr;this.gridtable=this.createGrideTable(0,h,n,a,90*this.dpr,100*this.dpr),this.isFirst?(this.recommendedText=this.scene.make.text({x:0,y:20*this.dpr,text:"Recommended",style:{fontSize:13*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#697AFF"}}).setOrigin(.5,0),this.recommendedText.setFontStyle("bold"),this.add(this.recommendedText),this.describleText=this.scene.make.text({x:0,y:this.recommendedText.y+this.recommendedText.height+10*this.dpr,text:"This industry has great development potential.",style:{fontSize:11*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#0"}}).setOrigin(.5,0),this.add(this.describleText),this.turnoverText=new s.BBCodeText(this.scene,0,this.describleText.y+this.describleText.height+10*this.dpr).setOrigin(.5,0).setFontSize(11*this.dpr).setFontFamily(o.Font.DEFULT_FONT).setColor("#0"),this.add(this.turnoverText),i.text=o.i18n.t("business_street.choosetheindustry"),e.resize(135*this.dpr,17*this.dpr)):(this.coinBg=this.scene.make.image({key:r.c.commonKey,frame:"price_bg"}),this.coinBg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.coinBg.y=30*this.dpr,this.add(this.coinBg),this.coinImg=this.scene.make.image({key:r.c.commonKey,frame:"iv_coin"}),this.coinImg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.coinImg.setPosition(this.coinBg.x-.5*this.coinImg.width-15*this.dpr,this.coinBg.y),this.add(this.coinImg),this.coinCount=this.scene.make.text({x:this.coinImg.x+.5*this.coinImg.width+10*this.dpr,y:this.coinImg.y,text:"0",style:{fontSize:11*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#0"}}).setOrigin(0,.5),this.add(this.coinCount),this.describleText2=this.scene.make.text({x:0,y:this.coinCount.y+50*this.dpr,text:"55225sadffqwerqwerqwer",style:{fontSize:10*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#0",wordWrap:{width:244*this.dpr,useAdvancedWrap:!0}}}).setOrigin(.5),this.add(this.describleText2),i.text=o.i18n.t("business_street.choosestorelike"),e.resize(155*this.dpr,17*this.dpr));var l=new s.NineSliceButton(this.scene,-60*this.dpr,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,r.c.commonKey,"red_btn",o.i18n.t("common.cancel"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(l),l.setTextStyle({fontSize:15*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#ffffff"}),l.on(String(s.ClickEvent.Tap),this.onCancelHandler,this);var c=new s.NineSliceButton(this.scene,60*this.dpr,l.y,92*this.dpr,34*this.dpr,r.c.commonKey,"yellow_btn",o.i18n.t("business_street.select"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(c),c.on(String(s.ClickEvent.Tap),this.onSelectHandler,this),c.setTextStyle({fontSize:15*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#996600"})},PicaBusinessStoreCreatePanel.prototype.createGrideTable=function(t,e,i,n,r,o){var a=this,h={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:r,cellHeight:o,reuseCellContainer:!0,tableOY:5*this.dpr,zoom:this.zoom},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&(e=new l(a.scene,0,0,r,o,a.key,a.dpr,a.zoom)),e.setData({item:i}),e.setStoreData(i),a.curSelectData&&i===a.curSelectData?e.select=!0:e.select=!1,e}},c=new s.GameGridTable(this.scene,h);return c.layout(),c.on("cellTap",(function(t){t&&a.onGridSelectHandler(t)})),this.add(c),c},PicaBusinessStoreCreatePanel.prototype.onGridSelectHandler=function(t){this.setTypeInfo(t.storeData),this.curSelectItem&&(this.curSelectItem.select=!1),t.select=!0,this.curSelectItem=t},PicaBusinessStoreCreatePanel.prototype.onCancelHandler=function(){this.cancelHandler&&this.cancelHandler.run()},PicaBusinessStoreCreatePanel.prototype.onSelectHandler=function(){this.selectHandler&&this.selectHandler.runWith(this.curSelectData)},PicaBusinessStoreCreatePanel}(Phaser.GameObjects.Container),l=function(t){function StoreTypeItem(e,i,n,s,r,a,h,l){var c=t.call(this,e,i,n)||this;return c.isSelect=!1,c.dpr=h,c.key=a,c.setSize(s,r),c.bg=c.scene.make.image({key:a,frame:"store_bg"}),c.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),c.add(c.bg),c.storeIcon=c.scene.make.image({key:a,frame:"restaurant_icon"}),c.storeIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),c.storeIcon.setPosition(0,-8*h),c.add(c.storeIcon),c.storeName=c.scene.make.text({x:0,y:c.storeIcon.y+.5*c.storeIcon.height+10*h,text:"Restaurant",style:{color:"#0",fontSize:10*h,fontFamily:o.Font.DEFULT_FONT}}).setOrigin(.5),c.add(c.storeName),c}return a(StoreTypeItem,t),StoreTypeItem.prototype.setStoreData=function(t){if(this.storeData=t,"industryType"in t)this.storeIcon.setFrame(t.industryType+"_icon"),this.storeName.text=t.name;else{var e=t;this.storeIcon.setFrame(e.storeType+"_icon"),this.storeName.text=e.name}},Object.defineProperty(StoreTypeItem.prototype,"select",{get:function(){return this.isSelect},set:function(t){this.isSelect=t;var e=t?"store_bg_click":"store_bg";this.bg.setFrame(e)},enumerable:!1,configurable:!0}),StoreTypeItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessStreetListPanel",(function(){return p}));var n,s,r=i(478),o=i(5),a=i(0),h=i(470),l=i(11),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaBusinessStreetListPanel(e,i,n,r,o,a,h,l,c){var p=t.call(this,e,i,n)||this;return p.curCategoryType=s.popularity,p.dpr=a,p.key=l,p.key2=c,p.zoom=h,p.setSize(r,o),p.create(),p}return c(PicaBusinessStreetListPanel,t),PicaBusinessStreetListPanel.prototype.setIndustryModels=function(t){for(var e=[{text:a.i18n.t("business_street.popularity"),data:{categoryType:s.popularity}},{text:a.i18n.t("business_street.praise"),data:{categoryType:s.praise}}],i=[],n=0,r=t.industry;n<r.length;n++)for(var h=0,l=r[n].roomModels;h<l.length;h++){var c=l[h];-1===i.indexOf(c.storeType)&&i.push({type:c.storeType,name:c.name})}this.secondaryPanel.setCategories(o.TabButton,e,{width:88*this.dpr,height:27*this.dpr,key:this.key2,normalFrame:"navigation_bar_click",downFrame:"navigation_bar_click",textStyle:{fontSize:14*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#ffffff"}},new a.Handler(this,(function(t){for(var e=0,i=t;e<i.length;e++){i[e].background.visible=!1}}))),this.secondaryPanel.setSubItems(i)},PicaBusinessStreetListPanel.prototype.setStreetListData=function(t){this.gridtable.setT(0),this.gridtable.setItems(t)},PicaBusinessStreetListPanel.prototype.setHandler=function(t,e,i,n,s){this.historyHandler=t,this.rankHandler=e,this.backHandler=i,this.queryHandler=n,this.enterHandler=s},PicaBusinessStreetListPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicaBusinessStreetListPanel.prototype.create=function(){var t=this,e=.5*-this.height,i=.5*-this.width,n=this.scene.make.image({key:this.key,frame:"store_icon"});n.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),n.x=i+30*this.dpr,n.y=e+6*this.dpr,this.add(n);var s=n.x+.5*n.width+10*this.dpr,c=this.scene.make.text({x:s,y:n.y,text:a.i18n.t("business_street.street"),style:{fontSize:13*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#FFC51A"}}).setOrigin(0,.5);c.setFontStyle("bold"),c.setStroke("#553100",2*this.dpr),this.add(c),this.secondaryPanel=new r.SecondaryMenuPanel(this.scene,0,e+56*this.dpr,this.width,60*this.dpr,this.dpr,this.zoom,{x:0,y:-15*this.dpr,width:this.width-30*this.dpr,height:30*this.dpr,zoom:this.zoom,dpr:this.dpr,orientation:1,align:1}),this.add(this.secondaryPanel);var p=this.scene.make.image({key:this.key2,frame:"navigation_bar"});p.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.secondaryPanel.gameScroll.addAt(p),this.secondaryPanel.createGrideTable(0,13*this.dpr,this.width-30*this.dpr,40*this.dpr,65*this.dpr,40*this.dpr,(function(e,i){var n=e.item;return i||(i=new h.TextButton(t.scene,t.dpr,t.zoom)).setFontSize(13*t.dpr),i.getData("itemData")!==n&&(i.setText(n.name),i.setData("itemData",n),t.subCategory===n.type?i.changeDown():i.changeNormal()),i})),this.secondaryPanel.setHandler(new a.Handler(this,this.onCategoryHandler),new a.Handler(this,this.onSubCategoryHandle)),this.secondaryPanel.setButtonChangeHandler(new a.Handler(this,(function(t){t.background.visible=!1})),new a.Handler(this,(function(t){t.background.visible=!0,t.changeDown()})));var d=this.scene.make.image({key:this.key2,frame:"navigation_bar_2"});d.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.secondaryPanel.gridTable.addAt(d);var m=this.width,u=this.height-130*this.dpr,y=e+88*this.dpr+.5*u;this.gridtable=this.createGrideTable(0,y,m,u,256*this.dpr,50*this.dpr);var f=new o.Button(this.scene,this.key2,"ranking","ranking"),g=-i-.5*f.width-20*this.dpr;f.setPosition(g,e+6*this.dpr),f.on(String(o.ClickEvent.Tap),this.onRankHandler,this),this.add(f);var P=new o.Button(this.scene,this.key2,"history","history");P.setPosition(g-.5*f.width-.5*P.width-10*this.dpr,e+6*this.dpr),P.on(String(o.ClickEvent.Tap),this.onHistoryHandler,this),this.add(P);var v=new o.NineSliceButton(this.scene,0,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,l.c.commonKey,"red_btn",a.i18n.t("business_street.back"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(v),v.setTextStyle({fontSize:15*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#ffffff"}),v.on(String(o.ClickEvent.Tap),this.onBackHandler,this)},PicaBusinessStreetListPanel.prototype.createGrideTable=function(t,e,i,n,s,r){var a=this,l={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:s,cellHeight:r,reuseCellContainer:!0,tableOX:19*this.dpr,zoom:this.zoom},press:{tapInterval:50},scrollMode:0,clamplChildOY:!1,interactive:!0,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&(e=new d(a.scene,0,0,s,r,a.key,a.key2,a.dpr,a.zoom),c.add(e)),e.setData({item:i}),e.setStoreData(i,a.curCategoryType),e}},c=new o.GameGridTable(this.scene,l);return c.on("cellTap",(function(t){t&&a.onSelectItemHandler(t)})),c.on("cellDown",(function(t){new h.TweenCompent(a.scene,t,{scale:.96,pingpang:!0}).tween()})),c.layout(),this.add(c),c},PicaBusinessStreetListPanel.prototype.onCategoryHandler=function(t){if(this.curCategoryType=t.categoryType,void 0!==this.subCategory){var e=this.curCategoryType===s.popularity?"popularity":"praise";this.queryHandler.runWith([e,this.subCategory])}},PicaBusinessStreetListPanel.prototype.onSubCategoryHandle=function(t){var e=t.getData("itemData");this.curSubCategoryItem&&this.curSubCategoryItem.changeNormal(),t.changeDown(),this.curSubCategoryItem=t,this.subCategory=e.type;var i=this.curCategoryType===s.popularity?"popularity":"praise";this.queryHandler&&this.queryHandler.runWith([i,this.subCategory])},PicaBusinessStreetListPanel.prototype.onSelectItemHandler=function(t){var e=t.storeData;this.enterHandler&&this.enterHandler.runWith(e.roomId)},PicaBusinessStreetListPanel.prototype.onHistoryHandler=function(){this.historyHandler&&this.historyHandler.run()},PicaBusinessStreetListPanel.prototype.onRankHandler=function(){this.rankHandler&&this.rankHandler.run()},PicaBusinessStreetListPanel.prototype.onBackHandler=function(){this.backHandler&&this.backHandler.run()},PicaBusinessStreetListPanel}(Phaser.GameObjects.Container),d=function(t){function PicStreetItem(e,i,n,s,r,l,c,p,d){var m=t.call(this,e,i,n)||this;m.dpr=p,m.key=l,m.key2=c,m.setSize(s,r);var u=.5*-m.width,y=.5*-m.height;m.bg=new o.NineSlicePatch(m.scene,0,0,s,45*p,m.key,"restaurant_bg",{left:4*m.dpr,top:9*m.dpr,right:4*m.dpr,bottom:9*m.dpr}),m.add(m.bg);var f=m.scene.make.image({key:c,frame:"icon_bg_s"});f.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),f.setPosition(u+.5*f.width+3*p,0),m.add(f),m.storeIcon=new h.DynamicImage(m.scene,f.x,0),m.add(m.storeIcon);var g=f.x+.5*f.width+10*p;return m.storeName=m.scene.make.text({x:g,y:y+10*p,text:"",style:{color:"#FFE11A",fontSize:12*p,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.storeName),m.playerName=m.scene.make.text({x:g,y:m.storeName.y+.5*m.storeName.height+10*p,text:"",style:{color:"#ffffff",fontSize:11*p,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.playerName),m.industryIcon=m.scene.make.image({key:m.key2,frame:"entertainment_tag_s"}),m.industryIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),m.industryIcon.x=.5*m.width-.5*m.industryIcon.width,m.add(m.industryIcon),m.praiseIcon=m.scene.make.image({key:c,frame:"praise"}),m.praiseIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),m.praiseIcon.x=-u-80*p,m.add(m.praiseIcon),m.praiseCount=m.scene.make.text({x:m.praiseIcon.x+.5*m.praiseIcon.width+10*p,y:m.praiseIcon.y,text:"",style:{color:"#ffffff",fontSize:12*p,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(0,.5),m.add(m.praiseCount),m}return c(PicStreetItem,t),PicStreetItem.prototype.setStoreData=function(t,e){var i=t.industry,n=t.storeType;this.bg.setFrame(i+"_bg"),this.storeIcon.setTexture(this.key2,n+"_icon_s"),this.praiseIcon.setFrame(e===s.praise?"praise":"store_popularity"),this.storeName.text=t.name,this.playerName.text=t.ownerName,this.praiseCount.text=(e===s.praise?t.praise:t.popularity)+"",this.industryIcon.setFrame(i+"_tag_s"),this.storeData=t},PicStreetItem}(Phaser.GameObjects.Container);!function(t){t[t.popularity=1]="popularity",t[t.praise=2]="praise"}(s||(s={}))},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaFurniUnlockEffectPanel",(function(){return l}));var n,s=i(5),r=i(470),o=i(11),a=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaFurniUnlockEffectPanel(e,i,n,s,r,o){var a=t.call(this,e)||this;return a.render=i,a.effectQueue=[],a.isPlaying=!1,a.setSize(n,s),a.key=r,a.dpr=o,a}return h(PicaFurniUnlockEffectPanel,t),PicaFurniUnlockEffectPanel.prototype.play=function(t){this.effectQueue=this.effectQueue.concat(t),this.playNext()},PicaFurniUnlockEffectPanel.prototype.playNext=function(){var t=this;if(!this.isPlaying&&this.effectQueue.length>0){var e=this.effectQueue.shift(),i=new c(this.scene,o.d.effectcommon,this.dpr);i.setItemData(e,a.Handler.create(this,(function(){t.isPlaying=!1,t.playNext()})));var n=.5*-this.height+100*this.dpr,s=n+.5*i.width-10*this.dpr,r=n+20*this.dpr;i.x=0,i.alpha=0,i.playMove(s,r),this.add(i),this.isPlaying=!0}},PicaFurniUnlockEffectPanel}(Phaser.GameObjects.Container),c=function(t){function PicaUnlockEffectItem(e,i,n){var o=t.call(this,e)||this;return o.relativepoints=[0,-67,-50,-59,-52,-59,-54],o.key=i,o.dpr=n,o.bg=e.make.image({key:i,frame:"repair_popup_bg"}),o.add(o.bg),o.setSize(o.bg.width,o.bg.height),o.titletext=new s.BBCodeText(e,0,0,"",{fontFamily:a.Font.DEFULT_FONT,fontSize:14*n,color:"#00CCFF",lineSpacing:4*n}).setOrigin(0),o.titletext.x=.5*-o.width+20*n,o.titletext.y=-6*n,o.add(o.titletext),o.furinIcon=new r.DynamicImage(e,.5*o.width-50*n,0),o.add(o.furinIcon),o.sprite1=o.scene.make.image({key:i,frame:"repair_popup_star1"}),o.sprite1.x=.5*o.width-.5*o.sprite1.width-20*n,o.sprite1.y=3*n,o.sprite1.alpha=0,o.sprite2=o.scene.make.image({key:i,frame:"repair_popup_star2"}),o.sprite2.x=-50*n,o.sprite2.y=-33*n,o.sprite2.alpha=0,o.add([o.sprite1,o.sprite2]),o}return h(PicaUnlockEffectItem,t),PicaUnlockEffectItem.prototype.setItemData=function(t,e){this.compl=e;var i="[b][color=#00CCFF]"+t.line1+"[/color][/b]";t.line2&&(i+="\n[b][color=#00CCFF]"+t.line2+"[/color][/b]"),this.titletext.setText(i)},PicaUnlockEffectItem.prototype.playMove=function(t,e){var i=this;if(this.scene){var n=[];this.y=t+this.relativepoints[0]*this.dpr;for(var s=0,r=this.relativepoints;s<r.length;s++){var o=r[s];n.push({y:t+o*this.dpr})}this.alpha=0;var a=this.scene.tweens.add({targets:this,alpha:{from:0,to:1,duration:200,ease:"Cubic.easeIn"},delay:50,onComplete:function(){a.stop(),a.remove()}});this.scene.tweens.timeline({targets:this,ease:"Linear",tweens:n,totalDuration:700,onComplete:function(){i.scene&&(i.playAlphaAni(i.sprite1),setTimeout((function(){i.playAlphaAni(i.sprite2)}),300),setTimeout((function(){i.playFadeout()}),3e3))}})}},PicaUnlockEffectItem.prototype.playAlphaAni=function(t,e,i,n){var s=this;if(void 0===e&&(e=!0),void 0===i&&(i=0),void 0===n&&(n=400),this.scene)var r=this.scene.tweens.add({targets:t,alpha:{from:0,to:1},ease:"Linear",duration:n,yoyo:e,onComplete:function(){r.stop(),r.remove(),++i<2?s.playAlphaAni(t,!0,i):2===i&&s.playAlphaAni(t,!1,i,400)}})},PicaUnlockEffectItem.prototype.playFadeout=function(){var t=this;if(this.scene)var e=this.scene.tweens.add({targets:this,alpha:{from:1,to:0},ease:"Linear",duration:200,onComplete:function(){e.stop(),e.remove(),t.compl&&t.compl.run(),t.destroy()}})},PicaUnlockEffectItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaEquipUpgradeItem",(function(){return h}));var n,s=i(5),r=i(0),o=i(470),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicaEquipUpgradeItem(e,i,n,s,r,o){var a=t.call(this)||this;return a.haveEquiped=!1,a.cellWidth=0,a.cellHeight=0,a.dpr=n,a.zoom=s,a.key=r,a.commonKey=o,a.mScene=e,a.mContainer=i,a.create(),a}return a(PicaEquipUpgradeItem,t),PicaEquipUpgradeItem.prototype.setEquipItems=function(t){var e=t.equipmentType,i=t.mineEquipments;this.titleName.text=e;for(var n=0,s=i;n<s.length;n++){if(s[n].selected){this.haveEquiped=!0;break}0}this.gridTable.setItems(i),this.haveEquiped&&this.setBgTexture(t.isblue)},PicaEquipUpgradeItem.prototype.setTransPosition=function(t,e){this.bg.x+=t,this.bg.y+=e,this.titleName.x+=t,this.titleName.y+=e,this.bottombg.x+=t,this.bottombg.y+=e,this.equipName.x+=t,this.equipName.y+=e,this.penetrationText.x+=t,this.penetrationText.y+=e,this.equipDes.x+=t,this.equipDes.y+=e,this.topbg.x+=t,this.topbg.y+=e,this.unlockbtn.x+=t,this.unlockbtn.y+=e,this.gridTable.refreshPos(t,e-10*this.dpr),this.gridTable.resetMask()},Object.defineProperty(PicaEquipUpgradeItem.prototype,"displayList",{get:function(){return[this.bg,this.topbg,this.bottombg,this.titleName,this.equipName,this.penetrationText,this.equipDes]},enumerable:!1,configurable:!0}),PicaEquipUpgradeItem.prototype.refreshEquipData=function(t,e){this.gridTable.items[e]=t;for(var i=0,n=this.gridTable.getCells();i<n.length;i++){var s=n[i];if(s&&s.container){var r=s.container.itemData;r.id===t.id?s.container.setItemData(t):s.container.setItemData(r)}}this.curSelectItemData.id===t.id&&(this.curSelectItemData=t),this.updateEquipItem(this.curSelectItemData)},PicaEquipUpgradeItem.prototype.destroy=function(){this.unlockbtn&&this.unlockbtn.off("pointerup",this.onUnlockEquipHandler,this),t.prototype.destroy.call(this),this.gridTable&&this.gridTable.destroy(),this.bg=null,this.topbg=null,this.bottombg=null,this.gridTable=null,this.titleName=null,this.equipName=null,this.penetrationText=null,this.equipDes=null,this.unlockbtn=null,this.costNum=null,this.diamondIcon=null,this.curEquipItem=null,this.curSelectItemData=null},PicaEquipUpgradeItem.prototype.setBgTexture=function(t){var e=t?"topbg1":"topbg",i=t?"bottombg1":"bottombg",n=t?"#0867AE":"#8F4300";this.topbg.setTexture(this.key,e),this.bottombg.setTexture(this.key,i),this.titleName.setColor(n).setStroke(n,1),this.equipName.setColor(n).setStroke(n,1),this.penetrationText.setColor(n).setStroke(n,1)},PicaEquipUpgradeItem.prototype.create=function(){this.bg=this.mScene.make.image({x:0,y:-21*this.dpr,key:this.key,frame:"bg1"}),this.topbg=this.mScene.make.image({x:0,y:-61*this.dpr,key:this.key,frame:"topbg"}),this.titleName=this.mScene.make.text({x:0,y:this.topbg.y+0*this.dpr,text:"矿镐",style:{blod:!0,color:"#8F4300",fontSize:14*this.dpr,fontFamily:r.Font.DEFULT_FONT}}).setOrigin(.5,.5),this.titleName.setFontStyle("bold"),this.bottombg=this.mScene.make.image({x:0,y:42*this.dpr,key:this.key,frame:"bottombg"}),this.equipName=this.mScene.make.text({x:-120*this.dpr,y:15*this.dpr,text:"精铁镐",style:{color:"#8F4300",fontSize:14*this.dpr,fontFamily:r.Font.DEFULT_FONT}}),this.equipName.setFontStyle("bold"),this.penetrationText=this.mScene.make.text({x:-60*this.dpr,y:16*this.dpr,text:"穿透力:10",style:{color:"#8F4300",fontSize:12*this.dpr,fontFamily:r.Font.DEFULT_FONT}}),this.equipDes=this.mScene.make.text({x:-120*this.dpr,y:35*this.dpr,text:"描述文字",style:{color:"#000000",fontSize:10*this.dpr,fontFamily:r.Font.DEFULT_FONT,wordWrap:{width:130*this.dpr,useAdvancedWrap:!0}}}),this.equipDes.setStroke("#000000",1),this.mContainer.add([this.bg,this.topbg,this.bottombg,this.titleName,this.equipName,this.penetrationText,this.equipDes]),this.createGridTable(),this.createBtn()},PicaEquipUpgradeItem.prototype.createGridTable=function(){var t=this,e=this.mScene.textures.getFrame(this.key,"equipbg"),i=e.width+10*this.dpr,n=e.height+30*this.dpr;this.cellWidth=i,this.cellHeight=n;var r={x:0,y:0,scrollMode:1,table:{width:259*this.dpr,height:77*this.dpr,columns:1,cellWidth:i,cellHeight:n,reuseCellContainer:!0,cellOriginX:0,cellOriginY:0,zoom:this.zoom},clamplChildOY:!1,createCellContainerCallback:function(e,s){var r=e.scene,o=e.item;e.index;return null===s&&((s=new l(r,t.dpr,t.key)).setSize(i,n),s.setChildPosition()),s.setData({item:o}),s.setItemData(o),t.curSelectItemData===o?(s.setSelect(!0),t.curEquipItem=s):s.setSelect(!1),null==t.curEquipItem&&(t.haveEquiped&&!o.selected||t.onSelectItemHandler(s)),s}};this.gridTable=new s.GameGridTable(this.mScene,r),this.gridTable.layout(),this.gridTable.on("cellTap",(function(e){t.onSelectItemHandler(e)})),this.mContainer.add(this.gridTable)},PicaEquipUpgradeItem.prototype.onSelectItemHandler=function(t){this.curEquipItem&&this.curEquipItem.setSelect(!1);var e=t.itemData;this.curSelectItemData=e,this.updateEquipItem(e),t.setSelect(!0),this.curEquipItem&&this.curEquipItem.setSelect(!1),this.curEquipItem=t,e.owned&&!e.selected&&this.emit("reqEquiped",e.id)},PicaEquipUpgradeItem.prototype.updateEquipItem=function(t){if(this.penetrationText.text=t.buffDisplayNames[0],this.equipDes.text=t.description,this.equipName.text=t.name,t.owned?this.unlockbtn.visible=!1:this.unlockbtn.visible=!0,t.qualified?(this.unlockCondition.visible=!1,this.unlockbtn.setInteractive(),this.unlockBg.clearTint(),this.costNum.setColor("#ffffff")):t.owned||(this.unlockCondition.visible=!0,this.unlockCondition.text=t.conditionDisplayNames[0],this.unlockbtn.disableInteractive(),this.unlockBg.setTintFill(8947848),this.costNum.setColor("#999999")),null===t.price)this.costNum.visible=!1,this.diamondIcon.visible=!1,this.btnName.setPosition(0,0*this.dpr);else{var e=t.price.price,i=Math.pow(10,t.price.displayPrecision);this.costNum.text=Math.floor(e*i)/i+"",this.costNum.visible=!0,this.diamondIcon.visible=!0,this.diamondIcon.setTexture(this.commonKey,r.Coin.getIcon(t.price.coinType)),this.diamondIcon.setDisplaySize(12*this.dpr,12*this.dpr),this.btnName.setPosition(0,6*this.dpr)}},PicaEquipUpgradeItem.prototype.onUnlockEquipHandler=function(){this.emit("reqActive",this.curEquipItem.itemData.id)},PicaEquipUpgradeItem.prototype.createBtn=function(){this.unlockCondition=new s.BBCodeText(this.mScene,0,-26*this.dpr,"",{}).setOrigin(.5).setFontSize(10*this.dpr).setFontFamily(r.Font.DEFULT_FONT),this.unlockbtn=this.mScene.make.container(void 0,!1);var t=new s.NinePatch(this.mScene,0,0,88*this.dpr,31*this.dpr,this.commonKey,"yellow_btn_normal",void 0,void 0,{left:12*this.dpr,top:12*this.dpr,right:12*this.dpr,bottom:12*this.dpr});this.unlockBg=t,this.diamondIcon=this.mScene.make.image({x:-13*this.dpr,y:-8*this.dpr,key:this.commonKey,frame:"test_diamond"}),this.costNum=this.mScene.make.text({x:-2,y:-8*this.dpr,text:"1000",style:{color:"#ffffff",fontSize:10*this.dpr,fontFamily:r.Font.DEFULT_FONT}}).setOrigin(0,.5),this.btnName=this.mScene.make.text({x:0,y:6*this.dpr,text:"立即解锁",style:{color:"#8F4300",fontSize:11*this.dpr,fontFamily:r.Font.DEFULT_FONT}}).setOrigin(.5,.5),this.costNum.setStroke("#ffffff",1),this.btnName.setStroke("#8F4300",1),this.unlockCondition.setStroke("#000000",1),this.unlockbtn.setPosition(70*this.dpr,48*this.dpr),this.unlockbtn.setSize(t.width,t.height),this.unlockbtn.add([this.unlockCondition,t,this.diamondIcon,this.costNum,this.btnName]),this.unlockbtn.on("pointerup",this.onUnlockEquipHandler,this),this.mContainer.add(this.unlockbtn)},PicaEquipUpgradeItem}(Phaser.Events.EventEmitter),l=function(t){function EquipItemCell(e,i,n){var s=t.call(this,e)||this;return s.isSelect=!1,s.isUnlock=!1,s.dpr=i,s.key=n,s.create(),s}return a(EquipItemCell,t),EquipItemCell.prototype.setItemData=function(t){var e=this;this.itemData=t;var i=r.Url.getOsdRes(t.display.texturePath);this.equipIcon.load(i,this,(function(){e.equipIcon.scale=e.dpr})),this.setEquiped(t.selected,t.owned),this.setSelect(this.isSelect)},EquipItemCell.prototype.setSelect=function(t){this.isSelect=t;var e="equipbg";t||(e=this.isUnlock?"equipbg2":"equipbg1"),this.itemData.selected&&(e="equipbg2"),this.bg.setTexture(this.key,e)},EquipItemCell.prototype.setChildPosition=function(){var t=.5*this.bg.width+10*this.dpr,e=this.height-10*this.dpr;this.bg.setPosition(t,e),t+=1*this.dpr,e=.5*this.height+2*this.dpr,this.equipIcon.setPosition(t,e),t+=22*this.dpr,e=8*this.dpr,this.unlock.setPosition(t,e)},EquipItemCell.prototype.setEquiped=function(t,e){this.isUnlock=e,this.unlock.visible=!1,t?(this.isUnlock=!0,this.unlock.visible=!0,this.unlock.setTexture(this.key,"ok")):this.isUnlock||(this.unlock.visible=!0,this.unlock.setTexture(this.key,"lock"))},EquipItemCell.prototype.create=function(){this.bg=this.scene.make.image({x:0,y:-10*this.dpr,key:this.key,frame:"equipbg"}),this.equipIcon=new o.DynamicImage(this.scene,15*this.dpr,0*this.dpr),this.unlock=this.scene.make.image({x:30*this.dpr,y:-10*this.dpr,key:this.key,frame:"lock"}),this.add([this.bg,this.equipIcon,this.unlock])},EquipItemCell}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaExploreListBottomPanel",(function(){return l}));var n,s=i(5),r=i(470),o=i(11),a=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaExploreListBottomPanel(e,i,n,s,r){var o=t.call(this,e,s,r)||this;return o.chapterItems=[],o.curChapterID=0,o.unlockChapterID=0,o.setSize(i,n),o.dpr=s,o.zoom=r,o.init(),o}return h(PicaExploreListBottomPanel,t),PicaExploreListBottomPanel.prototype.resize=function(t,e){this.setSize(t,e),this.leftButton.x=.5*-this.width+48*this.dpr,this.rightButton.x=.5*this.width-48*this.dpr},PicaExploreListBottomPanel.prototype.refreshMask=function(){for(var t=0,e=this.chapterItems;t<e.length;t++){e[t].refreshMask()}},PicaExploreListBottomPanel.prototype.setChapterDatas=function(t){this.chapterProDatas=t,this.onChapterProHandler(t.nextChapterId)},PicaExploreListBottomPanel.prototype.setHandler=function(t){this.send=t},PicaExploreListBottomPanel.prototype.setChapterProData=function(){if(this.chapterProDatas)for(var t=this.chapterProDatas.chapters,e=this.curChapterID-2,i=0;i<5;i++){var n=this.chapterItems[i];if(e>=1)if(e<=t.length){var s=t[e-1];n.setChapterData(s),-1!==s.progress&&(this.unlockChapterID=s.chapterId)}else n.setChapterData(void 0);else n.setChapterData(void 0);e+=1}},PicaExploreListBottomPanel.prototype.init=function(){this.bg=this.scene.make.image({key:o.d.explorelog,frame:"explore_nav_bg"}),this.bg.displayWidth=this.width,this.leftButton=new s.Button(this.scene,o.d.explorelog,"explore_switch_left"),this.rightButton=new s.Button(this.scene,o.d.explorelog,"explore_switch_right"),this.leftButton.on(s.ClickEvent.Tap,this.onLeftClickHandler,this),this.rightButton.on(s.ClickEvent.Tap,this.onRightClickHandler,this),this.add([this.bg,this.leftButton,this.rightButton]),this.createChapterItems(),this.resize(this.width,this.bg.height)},PicaExploreListBottomPanel.prototype.createChapterItems=function(){for(var t,e=16*this.dpr,i=-91*this.dpr,n=0;n<5;n++){var s=2===n,r=new c(this.scene,this.dpr,this.zoom,s);r.setHandler(new a.Handler(this,this.onChapterProHandler)),0!==n&&(i+=.5*r.width+e+(t?.5*t.width:.5*r.width)),r.x=i,this.chapterItems.push(r),t=r}this.add(this.chapterItems)},PicaExploreListBottomPanel.prototype.onLeftClickHandler=function(){var t=this.curChapterID;1!==t&&(--t<1&&(t=1),this.onChapterProHandler(t))},PicaExploreListBottomPanel.prototype.onRightClickHandler=function(){var t=this.curChapterID;t!==this.unlockChapterID&&(t++,this.chapterProDatas||(t=1),t>this.unlockChapterID&&(t=this.unlockChapterID),this.onChapterProHandler(t))},PicaExploreListBottomPanel.prototype.onChapterProHandler=function(t){this.curChapterID!==t&&(this.curChapterID=t,this.setChapterProData(),this.send&&this.send.runWith(["chapterdata",t]))},PicaExploreListBottomPanel}(Phaser.GameObjects.Container),c=function(t){function ChapterItemProgress(e,i,n,s){var r=t.call(this,e,0,0,!1)||this;return r.proValue=0,r.unlock=!1,r.dpr=i,r.zoom=n,r.isZoom=s,r.init(),r.setZoom(s),r}return h(ChapterItemProgress,t),ChapterItemProgress.prototype.setChapterData=function(t){this.chapterProData=t,t?(-1===this.chapterProData.progress?(this.unlock=!1,this.lockImg.visible=!0,this.finishImg.visible=!1,this.levelTex.visible=!1,this.setProgress(0)):(this.unlock=!0,100===t.progress?this.finishImg.visible=!0:this.finishImg.visible=!1,this.lockImg.visible=!1,this.levelTex.visible=!0,this.setProgress(t.progress/100)),this.levelTex.text=t.chapterId+""):(this.lockImg.visible=!1,this.setProgress(0),this.finishImg.visible=!1,this.unlock=!1,this.levelTex.visible=!1)},ChapterItemProgress.prototype.setProgress=function(t){var e=360*t-90;this.barmask.clear(),this.barmask.fillStyle(16777215),this.barmask.slice(0,0,43*this.dpr/this.zoom,Phaser.Math.DegToRad(-90),Phaser.Math.DegToRad(e),!1),this.barmask.fillPath(),this.proValue=t},ChapterItemProgress.prototype.refreshMask=function(){var t=this.getWorldTransformMatrix();this.barmask.setPosition(t.tx,t.ty)},ChapterItemProgress.prototype.destroy=function(){t.prototype.destroy.call(this),this.barmask.destroy()},ChapterItemProgress.prototype.setZoom=function(t){t?(this.bg.setFrame("explore_sequence_select_bottom"),this.lightbg.setFrame("explore_sequence_select_schedule"),this.topbg.setFrame("explore_sequence_select_top"),this.finishImg.setFrame("explore_sequence_uncheck_big"),this.levelTex.setFontSize(24*this.dpr),this.setSize(this.bg.width,this.bg.height)):(this.bg.setFrame("explore_sequence_uncheck_bottom"),this.lightbg.setFrame("explore_sequence_uncheck_schedule"),this.topbg.setFrame("explore_sequence_uncheck_top"),this.finishImg.setFrame("explore_sequence_uncheck_small"),this.levelTex.setFontSize(16*this.dpr),this.setSize(this.bg.width,this.bg.height)),this.enable=!1,this.enable=!0},ChapterItemProgress.prototype.setHandler=function(t){this.send=t},ChapterItemProgress.prototype.init=function(){this.bg=this.scene.make.image({key:o.d.explorelog,frame:"explore_sequence_uncheck_bottom"}),this.lightbg=this.scene.make.image({key:o.d.explorelog,frame:"explore_sequence_uncheck_schedule"}),this.topbg=this.scene.make.image({key:o.d.explorelog,frame:"explore_sequence_uncheck_top"}),this.levelTex=this.scene.make.text({style:a.UIHelper.whiteStyle(this.dpr,16)}).setOrigin(.5),this.levelTex.setFontStyle("bold"),this.finishImg=this.scene.make.image({key:o.d.explorelog,frame:"explore_sequence_uncheck_small"}),this.lockImg=this.scene.make.image({key:o.d.explorelog,frame:"explore_switch_lock"}),this.finishImg.y=.5*this.height,this.barmask=this.scene.make.graphics(void 0,!1),this.lightbg.mask=this.barmask.createGeometryMask(),this.add([this.bg,this.lightbg,this.topbg,this.levelTex,this.finishImg,this.lockImg]),this.setSize(this.bg.width,this.bg.height),this.on(s.ClickEvent.Tap,this.onClickHandler,this),this.finishImg.visible=!1,this.lockImg.visible=!1},ChapterItemProgress.prototype.onClickHandler=function(){this.unlock&&this.send&&this.send.runWith(this.chapterProData.chapterId)},ChapterItemProgress}(r.ButtonEventDispatcher)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaExploreListDetailPanel",(function(){return p}));var n,s=i(5),r=i(0),o=i(11),a=i(470),h=i(1),l=i(480),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaExploreListDetailPanel(e,i,n,s,r){var o=t.call(this,e,0,0)||this;return o.needItems=[],o.labels=[],o.needDatas=[],o.indexed=-1,o.labelsCount=0,o.dpr=s,o.zoom=r,o.setSize(i,n),o.init(),o.setInteractive(),o}return c(PicaExploreListDetailPanel,t),PicaExploreListDetailPanel.prototype.resize=function(t,e){this.setSize(t,e),this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.73),this.blackGraphic.fillRect(0,0,t,e),this.blackGraphic.x=.5*-t,this.blackGraphic.y=.5*-e,this.lineGraphic.clear(),this.lineGraphic.fillStyle(723723,1),this.lineGraphic.fillRect(-12*this.dpr,-this.dpr,24*this.dpr,2*this.dpr),this.mPropGrid.resetMask()},PicaExploreListDetailPanel.prototype.setHandler=function(t){this.send=t},PicaExploreListDetailPanel.prototype.setCaptoreResultData=function(t){var e="zh-CN"!==r.i18n.language?t.chapter.chapterId+"":h.ChineseUnit.numberToChinese(t.chapter.chapterId);this.titleTex.text=r.i18n.t("explore.chaptertitle",{name:e}),this.captoreTex.text=t.chapter.name,this.captoreDes.text=t.chapter.des,this.taskTex.text=r.i18n.t("explore.taskneedtips"),this.needDatas.length=0;for(var i=0,n=t.levels;i<n.length;i++)for(var s=0,o=n[i].clueItems;s<o.length;s++){var a=o[s];this.needDatas.push(a)}this.setNeedItems(this.needDatas);var l=Math.ceil(this.needDatas.length/6);this.setNeedBottomImgs(l),this.setLabelsSelect(0)},PicaExploreListDetailPanel.prototype.setNeedItems=function(t){for(var e=[],i=0;i<t.length;i+=6){for(var n=[],s=i;s<i+6;s++)s<t.length&&n.push(t[s]);e.push(n)}this.mPropGrid.setItems(e)},PicaExploreListDetailPanel.prototype.setNeedBottomImgs=function(t){this.labelsCount=t;for(var e=0,i=this.labels;e<i.length;e++){(s=i[e]).visible=!1}for(var n=0;n<t;n++){var s=void 0;n<this.labels.length?s=this.labels[n]:(s=this.scene.make.image({key:o.d.explorelog,frame:"explore_page_down"}),this.content.add(s),this.labels.push(s)),s.visible=!0}this.setLabelLayout(t)},PicaExploreListDetailPanel.prototype.init=function(){this.blackGraphic=this.scene.make.graphics(void 0,!1),this.add(this.blackGraphic),this.bg=this.scene.make.image({key:o.d.explorelog,frame:"explore_chapter_total_open"}),this.content=this.scene.make.container(void 0,!1),this.content.setSize(this.bg.width,this.bg.height),this.add(this.content),this.backButton=new s.Button(this.scene,o.d.uicommon,"close"),this.backButton.on(s.ClickEvent.Tap,this.onHideHandler,this),this.backButton.x=.5*this.content.width,this.backButton.y=.5*-this.content.height;var t=-75*this.dpr,e=75*this.dpr,i=.5*-this.content.height+20*this.dpr;this.titleTex=this.scene.make.text({style:r.UIHelper.colorStyle("#8743B9",14*this.dpr)}).setOrigin(.5),this.titleTex.setFontStyle("bold"),this.titleTex.x=t,this.titleTex.y=i,this.captoreTex=this.scene.make.text({style:r.UIHelper.blackStyle(this.dpr,14)}).setOrigin(.5),this.captoreTex.setFontStyle("bold"),this.captoreTex.y=this.titleTex.y+25*this.dpr,this.captoreTex.x=t,this.lineGraphic=this.scene.make.graphics(void 0,!1),this.lineGraphic.x=t,this.lineGraphic.y=this.captoreTex.y+15*this.dpr,this.captoreDes=this.scene.make.text({style:r.UIHelper.blackStyle(this.dpr,11)}).setOrigin(0),this.captoreDes.setWordWrapWidth(117*this.dpr,!0),this.captoreDes.x=t-58*this.dpr,this.captoreDes.y=this.lineGraphic.y+16*this.dpr,this.taskTex=this.scene.make.text({style:r.UIHelper.blackStyle(this.dpr,14)}).setOrigin(.5),this.taskTex.setFontStyle("bold"),this.taskTex.x=e,this.taskTex.y=this.captoreTex.y,this.mPropGrid=this.createGrid(),this.mPropGrid.x=e+5*this.dpr,this.mPropGrid.y=15*this.dpr,this.content.add([this.bg,this.backButton,this.titleTex,this.captoreTex,this.lineGraphic,this.captoreDes,this.taskTex,this.mPropGrid]),this.resize(this.width,this.height)},PicaExploreListDetailPanel.prototype.setLabelLayout=function(t){for(var e=6*this.dpr,i=8*this.dpr,n=.5*this.content.height-30*this.dpr,s=80*this.dpr-.5*(e*t+i*(t-1))+.5*e,r=0;r<t;r++){var o=this.labels[r];o.x=s,o.y=n,s+=e+i}},PicaExploreListDetailPanel.prototype.onHideHandler=function(){this.send&&this.send.runWith("hide")},PicaExploreListDetailPanel.prototype.createGrid=function(){var t=this,e=110*this.dpr,i=157*this.dpr,n={x:0,y:0,table:{width:110*this.dpr,height:157*this.dpr,columns:1,cellWidth:e,cellHeight:i,reuseCellContainer:!0,zoom:this.zoom,mask:!0},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(e,i){var n=e.item;return null===i&&(i=t.createGridLayout()),i.setItems(n),i},onScrollValueChange:function(e){e<0?e=0:e>1&&(e=1);var i=Math.floor(e*t.labelsCount);t.setLabelsSelect(i)}},r=new s.GameGridTable(this.scene,n);return r.layout(),r.on("cellTap",(function(e){e&&t.onSelectItemHandler(e,t.scene.input.activePointer)})),r},PicaExploreListDetailPanel.prototype.setLabelsSelect=function(t){if(this.indexed!==t){t>=this.labelsCount&&(t=this.labelsCount-1);for(var e=0;e<this.labelsCount;e++)t===e?this.labels[e].setFrame("explore_page_up"):this.labels[e].setFrame("explore_page_down");this.indexed=t}},PicaExploreListDetailPanel.prototype.createGridLayout=function(){return new d(this.scene,120*this.dpr,157*this.dpr,this.dpr,{cellSize:new Phaser.Math.Vector2(45*this.dpr,45*this.dpr),space:new Phaser.Math.Vector2(15*this.dpr,5*this.dpr),startAxis:a.AxisType.Vertical,constraint:a.ConstraintType.FixedColumnCount,constraintCount:2,alignmentType:a.AlignmentType.UpperCenter})},PicaExploreListDetailPanel.prototype.onSelectItemHandler=function(t,e){t.checkPointer(e)},PicaExploreListDetailPanel}(Phaser.GameObjects.Container),d=function(t){function ChapterGridLayout(e,i,n,s,r){var o=t.call(this,e,0,0,r)||this;return o.items=[],o.dpr=s,o.setSize(i,n),o}return c(ChapterGridLayout,t),ChapterGridLayout.prototype.setItems=function(t){for(var e=0,i=this.items;e<i.length;e++){(s=i[e]).visible=!1}for(var n=0;n<t.length;n++){var s=void 0;n<this.items.length?s=this.items[n]:(s=new l.PicaChapterLevelClue(this.scene,this.dpr,43*this.dpr,43*this.dpr),this.add(s),this.items.push(s)),s.visible=!0,s.setItemData(t[n])}this.Layout()},ChapterGridLayout.prototype.checkPointer=function(t){for(var e=0,i=this.items;e<i.length;e++){var n=i[e];n.visible&&r.Tool.checkPointerContains(n,t)&&n.showTips()}},ChapterGridLayout}(a.GridLayoutGroup)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaExploreListLevelPanel",(function(){return p}));var n,s=i(470),r=i(11),o=i(0),a=i(5),h=i(1),l=i(480),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaExploreListLevelPanel(e,i,n,s,r){var o=t.call(this,e)||this;return o.levelItems=[],o.posValue=0,o.topHeight=0,o.bottomHeight=0,o.setSize(i,n),o.dpr=s,o.zoom=r,o.init(),o}return c(PicaExploreListLevelPanel,t),PicaExploreListLevelPanel.prototype.resize=function(t,e){this.setSize(t,e),this.topbg.x=0,this.topbg.y=.5*-this.height+.5*this.topbg.height-this.topHeight,this.titlebg.x=0,this.titlebg.y=.5*-this.height+.5*this.titlebg.height,this.titleTex.x=this.titlebg.x,this.titleTex.y=this.titlebg.y;var i=e-this.titlebg.height-15*this.dpr;this.captorScroll.resetSize(t,i),this.captorScroll.x=0,this.captorScroll.y=.5*this.height-.5*i,this.refreshMask()},PicaExploreListLevelPanel.prototype.refreshMask=function(){this.captorScroll.refreshMask()},PicaExploreListLevelPanel.prototype.setHandler=function(t){this.send=t},PicaExploreListLevelPanel.prototype.setTopAndBottomHeight=function(t,e){this.topHeight=t,this.bottomHeight=e},PicaExploreListLevelPanel.prototype.setCaptoreResult=function(t,e){this.chapterResult=t;var i=t.chapter,n=t.lock,s="zh-CN"!==o.i18n.language?i.chapterId+"":h.ChineseUnit.numberToChinese(i.chapterId,!0);this.titleTex.text=o.i18n.t("explore.chaptertitle",{name:s}),this.captorScroll.clearItems(!1),this.setForwardDatas(t.chapter,n),n||this.setLevelDatas(t.levels,e),this.posValue=0,this.captorScroll.Sort(),n?this.captorScroll.setEnable(!1):(this.captorScroll.setEnable(!0),this.setIndexedLayout(e-t.levels[0].levelId))},PicaExploreListLevelPanel.prototype.setLevelDatas=function(t,e){for(var i=0,n=this.levelItems;i<n.length;i++){(r=n[i]).visible=!1}for(var s=0;s<t.length;s++){var r=void 0;s<this.levelItems.length?r=s===t.length-1?this.finalItem:this.levelItems[s]:(s===t.length-1?this.finalItem?r=this.finalItem:(r=2===t[s].levelType?new f(this.scene,this.dpr):new u(this.scene,this.dpr),this.finalItem=r):(r=new u(this.scene,this.dpr),this.levelItems.push(r)),r.setHandler(new o.Handler(this,this.onChapterLevelHandler))),this.captorScroll.addItem(r),r.visible=!0;var a=t[s],h=a.levelId>e;r.setLevelData(a,h)}},PicaExploreListLevelPanel.prototype.setForwardDatas=function(t,e){this.forewordItem||(this.forewordItem=new d(this.scene,this.dpr),this.forewordItem.on(a.ClickEvent.Tap,this.onForewordClickHandler,this)),this.forewordItem.setCaptoreData(t),this.captorScroll.addItem(this.forewordItem),e&&(this.lockItem=new y(this.scene,this.dpr),this.lockItem.setHandler(new o.Handler(this,this.onChapterLockHandler)),this.captorScroll.addItem(this.lockItem),this.lockItem.setLevelData(t,!1))},PicaExploreListLevelPanel.prototype.init=function(){var t=this;this.topbg=this.scene.make.image({key:"explore_mask"}),this.titlebg=this.scene.make.image({key:r.d.explorelog,frame:"explore_title"}),this.titleTex=this.scene.make.text({style:o.UIHelper.whiteStyle(this.dpr,18)}).setOrigin(.5),this.titleTex.setFontStyle("bold");var e=this.height-this.titlebg.height-15*this.dpr;this.captorScroll=new a.GameScroller(this.scene,{x:0,y:0,width:this.width,height:e,zoom:this.zoom,dpr:this.dpr,align:2,orientation:0,space:10*this.dpr,mask:!1,valuechangeCallback:function(e){t.onScrollValueChange(e)},cellupCallBack:function(e){t.onScrollClickHandler(e)}}),this.add([this.captorScroll,this.topbg,this.titlebg,this.titleTex]),this.resize(this.width,this.height),this.topbg.visible=!1},PicaExploreListLevelPanel.prototype.setIndexedLayout=function(t){var e,i=((e=t<this.chapterResult.levels.length-1?this.levelItems[t]:this.finalItem).getWorldTransformMatrix().ty-this.captorScroll.getWorldTransformMatrix().ty)/this.zoom-(.5*this.captorScroll.height-.5*e.height);i>0&&this.captorScroll.setValue(this.posValue-i)},PicaExploreListLevelPanel.prototype.onScrollClickHandler=function(t){t instanceof d&&this.onForewordClickHandler()},PicaExploreListLevelPanel.prototype.onScrollValueChange=function(t){0===this.posValue&&(this.posValue=t),t<this.posValue-20*this.dpr?(this.send&&this.send.runWith(["move",!0]),this.topbg.visible=!0):this.send&&(this.send.runWith(["move",!1]),this.topbg.visible=!1);for(var e=0,i=this.levelItems;e<i.length;e++){i[e].refreshMask()}},PicaExploreListLevelPanel.prototype.onForewordClickHandler=function(){this.send&&this.send.runWith(["foreword",this.chapterResult])},PicaExploreListLevelPanel.prototype.onChapterLevelHandler=function(t){this.send&&this.send.runWith(["roomid",t.roomId])},PicaExploreListLevelPanel.prototype.onChapterLockHandler=function(t,e){},PicaExploreListLevelPanel}(Phaser.GameObjects.Container),d=function(t){function ForewordChapterItem(e,i){var n=t.call(this,e,0,0,!1)||this;return n.dpr=i,n.init(),n}return c(ForewordChapterItem,t),ForewordChapterItem.prototype.setCaptoreData=function(t){this.captoreData=t;var e=o.Url.getOsdRes(t.imagePath+"_"+this.dpr+"x.png");this.icon.load(e)},ForewordChapterItem.prototype.init=function(){var t=this.scene.make.image({key:r.d.explorelog,frame:"explore_chapter_total"});this.setSize(t.width,t.height);var e=this.scene.make.text({text:o.i18n.t("explore.foreword"),style:o.UIHelper.whiteStyle(this.dpr,11)}).setOrigin(.5);e.setFontStyle("bold"),e.x=-3*this.dpr,e.y=.5*-this.height+23*this.dpr,this.icon=new s.DynamicImage(this.scene,0,0),this.add([t,e,this.icon])},ForewordChapterItem}(s.ButtonEventDispatcher),m=function(t){function ChapterLevelBaseItem(e,i){var n=t.call(this,e)||this;return n.unlock=!1,n.dpr=i,n.init(),n}return c(ChapterLevelBaseItem,t),ChapterLevelBaseItem.prototype.refreshMask=function(){},ChapterLevelBaseItem.prototype.setLevelData=function(t,e){this.chapterData=t,this.unlock=!e},ChapterLevelBaseItem.prototype.setHandler=function(t){this.send=t},ChapterLevelBaseItem.prototype.init=function(){},ChapterLevelBaseItem}(Phaser.GameObjects.Container),u=function(t){function ChapterLevelItem(e,i){var n=t.call(this,e,i)||this;return n.clueItms=[],n}return c(ChapterLevelItem,t),ChapterLevelItem.prototype.refreshMask=function(){this.starProgress.refreshMask()},ChapterLevelItem.prototype.setLevelData=function(e,i){t.prototype.setLevelData.call(this,e,i),this.levelTex.text=e.levelId+"",this.leftLine.x=this.levelTex.x-.5*this.leftLine.width-.5*this.levelTex.width-2*this.dpr,this.rightLine.x=this.levelTex.x+.5*this.rightLine.width+.5*this.levelTex.width+2*this.dpr;var n=this.getProgressValue(e.progress);this.starProgress.setProgress(n,500);var s=o.Url.getOsdRes(e.imagePath+"_"+this.dpr+"x.png");this.icon.load(s),this.nameTex.text=e.name,e.energyCost=8,this.energyImg.setText("-"+e.energyCost),this.lockimg.visible=i,this.icon.visible=!i,i?(this.unlockTex.visible=!0,this.unlockTex.text=o.i18n.t("explore.unlock"),this.openButton.setFrameNormal("butt_gray"),this.openButton.setTextStyle(o.UIHelper.whiteStyle(this.dpr,13)),this.energyImg.setTextStyle(o.UIHelper.blackStyle(this.dpr,13))):(this.unlockTex.visible=!1,this.openButton.setFrameNormal("yellow_btn_normal"),this.openButton.setTextStyle(o.UIHelper.brownishStyle(this.dpr,13)),this.energyImg.setTextStyle(o.UIHelper.brownishStyle(this.dpr,13)),this.setClueData(e.clueItems))},ChapterLevelItem.prototype.setClueData=function(t){for(var e=0,i=this.clueItms;e<i.length;e++){(s=i[e]).visible=!1}if(t){for(var n=0;n<t.length;n++){var s=void 0;n<this.clueItms.length?s=this.clueItms[n]:((s=new l.PicaChapterLevelClue(this.scene,this.dpr,43*this.dpr,43*this.dpr)).enable=!0,this.clueItms.push(s),this.add(s)),s.visible=!0,s.setItemData(t[n])}this.setLayoutItems(t.length)}},ChapterLevelItem.prototype.setLayoutItems=function(t){var e=.5*this.width-94*this.dpr,i=-15*this.dpr;if(1===t)this.clueItms[0].x=e,this.clueItms[0].y=i;else for(var n=42*this.dpr,s=16*this.dpr,r=e-.5*(n+s),o=0;o<2;o++){var a=this.clueItms[o];a.x=r,a.y=i,r+=n+s}},ChapterLevelItem.prototype.setHandler=function(t){this.send=t},ChapterLevelItem.prototype.init=function(){this.bg=this.scene.make.image({key:r.d.explorelog,frame:"explore_chapter_checkpoint"}),this.setSize(this.bg.width,this.bg.height);var t=.5*-this.width+85*this.dpr,e=.5*this.width-85*this.dpr,i=.5*-this.height+18*this.dpr;this.levelTex=this.scene.make.text({text:"",style:o.UIHelper.colorStyle("#5885FD",17*this.dpr)}).setOrigin(.5),this.levelTex.setFontStyle("bold"),this.levelTex.y=i,this.levelTex.x=t,this.leftLine=this.scene.make.image({key:r.d.explorelog,frame:"explore_chapter_explore_chapter_left"}),this.leftLine.x=t-this.leftLine.width,this.leftLine.y=i+2*this.dpr,this.rightLine=this.scene.make.image({key:r.d.explorelog,frame:"explore_chapter_explore_chapter_right"}),this.rightLine.x=t+this.rightLine.width,this.rightLine.y=this.leftLine.y,this.nameTex=this.scene.make.text({text:"",style:o.UIHelper.colorStyle("#8743B9",14*this.dpr)}).setOrigin(.5),this.nameTex.setFontStyle("bold"),this.nameTex.x=e,this.nameTex.y=i+4*this.dpr,this.starProgress=new s.ProgressMaskBar(this.scene,r.d.explorelog,"explore_star_empty","explore_star_full"),this.starProgress.x=t,this.starProgress.y=i+.5*this.leftLine.height+.5*this.starProgress.height+5*this.dpr,this.iconbg=this.scene.make.image({key:r.d.explorelog,frame:"explore_chapter_scene_bg"}),this.iconbg.x=t,this.iconbg.y=this.starProgress.y+.5*this.starProgress.height+.5*this.iconbg.height+5*this.dpr,this.icon=new s.DynamicImage(this.scene,this.iconbg.x,this.iconbg.y),this.lockimg=this.scene.make.image({key:r.d.explorelog,frame:"explore_chapter_scene_lock"}),this.lockimg.x=this.iconbg.x,this.lockimg.y=this.iconbg.y,this.unlockTex=this.scene.make.text({style:o.UIHelper.blackStyle(this.dpr,11)}).setOrigin(0),this.unlockTex.setWordWrapWidth(106*this.dpr,!0),this.unlockTex.x=e-53*this.dpr,this.unlockTex.y=i+20*this.dpr;this.openButton=new a.NineSliceButton(this.scene,0,0,88*this.dpr,32*this.dpr,r.d.uicommon,"yellow_btn_normal",o.i18n.t("explore.open"),this.dpr,1,o.UIHelper.button(this.dpr)),this.openButton.setTextStyle(o.UIHelper.brownishStyle(this.dpr,13)),this.openButton.setFontStyle("bold"),this.openButton.setTextOffset(-15*this.dpr,0),this.openButton.x=e,this.openButton.y=.5*this.height-.5*this.openButton.height-24*this.dpr,this.openButton.on(a.ClickEvent.Tap,this.onClickHandler,this),this.energyImg=new s.ImageValue(this.scene,43*this.dpr,15*this.dpr,r.d.uicommon,"explore_physical_icon",this.dpr,o.UIHelper.brownishStyle(this.dpr,14)),this.energyImg.x=14*this.dpr,this.energyImg.setOffset(-4*this.dpr,0),this.energyImg.setLayout(1),this.energyImg.setText(""),this.openButton.add(this.energyImg),this.add([this.bg,this.leftLine,this.rightLine,this.levelTex,this.nameTex,this.starProgress,this.iconbg,this.icon,this.lockimg,this.unlockTex,this.openButton])},ChapterLevelItem.prototype.getProgressValue=function(t){var e=Math.floor(t/100),i=75.75*e+30.3*e;return(i=i<0?0:i)+Math.floor(t%100)/100*75.75},ChapterLevelItem.prototype.onClickHandler=function(){this.unlock&&this.send&&this.send.runWith([this.chapterData])},ChapterLevelItem}(m),y=function(t){function ChapterLevelLockItem(e,i){return t.call(this,e,i)||this}return c(ChapterLevelLockItem,t),ChapterLevelLockItem.prototype.setLevelData=function(e,i){t.prototype.setLevelData.call(this,e,i),this.rightTex.text=o.i18n.t("explore.unlocktips",{name:e.requiredPlayerLevel})},ChapterLevelLockItem.prototype.init=function(){this.bg=this.scene.make.image({key:r.d.explorelog,frame:"explore_chapter_checkpoint"}),this.setSize(this.bg.width,this.bg.height);var t=-80*this.dpr,e=80*this.dpr,i=.5*-this.height+23*this.dpr;this.nameTex=this.scene.make.text({text:o.i18n.t("explore.nextleveltips"),style:o.UIHelper.colorStyle("#8743B9",14*this.dpr)}).setOrigin(.5),this.nameTex.setFontStyle("bold"),this.nameTex.x=0,this.nameTex.y=i,this.leftLine=this.scene.make.image({key:r.d.explorelog,frame:"explore_chapter_explore_chapter_left"}),this.leftLine.x=.5*-this.nameTex.width-.5*this.leftLine.width-5*this.dpr,this.leftLine.y=i,this.rightLine=this.scene.make.image({key:r.d.explorelog,frame:"explore_chapter_explore_chapter_right"}),this.rightLine.x=.5*this.nameTex.width+.5*this.rightLine.width+5*this.dpr,this.rightLine.y=this.leftLine.y,this.leftbg=this.scene.make.image({key:r.d.explorelog,frame:"explore_chapter_scene_bg"}),this.leftbg.x=t,this.leftbg.y=i+.5*this.leftbg.height+20*this.dpr,this.leftTex=this.scene.make.text({text:o.i18n.t("explore.finishchaptertips"),style:o.UIHelper.colorStyle("#8743B9",14*this.dpr)}).setOrigin(.5),this.leftTex.x=this.leftbg.x,this.leftTex.y=this.leftbg.y,this.rightbg=this.scene.make.image({key:r.d.explorelog,frame:"explore_chapter_scene_bg"}),this.rightbg.x=e,this.rightbg.y=i+.5*this.leftbg.height+20*this.dpr,this.rightTex=this.scene.make.text({text:"",style:o.UIHelper.colorStyle("#8743B9",14*this.dpr)}).setOrigin(.5),this.rightTex.x=this.rightbg.x,this.rightTex.y=this.rightbg.y,this.goButton=new a.NineSliceButton(this.scene,0,0,88*this.dpr,32*this.dpr,r.d.uicommon,"yellow_btn_normal",o.i18n.t("task.go"),this.dpr,1,o.UIHelper.button(this.dpr)),this.goButton.setTextStyle(o.UIHelper.brownishStyle(this.dpr,13)),this.goButton.setFontStyle("bold"),this.goButton.on(a.ClickEvent.Tap,this.onGoClickHandler,this),this.goButton.x=.5*-this.goButton.width-30*this.dpr,this.goButton.y=.5*this.height-10*this.dpr,this.finishButton=new a.NineSliceButton(this.scene,0,0,88*this.dpr,32*this.dpr,r.d.uicommon,"yellow_btn_normal",o.i18n.t("explore.finish"),this.dpr,1,o.UIHelper.button(this.dpr)),this.finishButton.setTextStyle(o.UIHelper.brownishStyle(this.dpr,13)),this.finishButton.setFontStyle("bold"),this.finishButton.on(a.ClickEvent.Tap,this.onFinishClickHandler,this),this.finishButton.x=.5*this.finishButton.width+30*this.dpr,this.finishButton.y=.5*this.height-10*this.dpr,this.add([this.bg,this.leftLine,this.rightLine,this.nameTex,this.leftbg,this.leftTex,this.rightbg,this.rightTex,this.goButton,this.finishButton])},ChapterLevelLockItem.prototype.onGoClickHandler=function(){this.send&&this.send.runWith(["lockgo",this.chapterData])},ChapterLevelLockItem.prototype.onFinishClickHandler=function(){this.send&&this.send.runWith(["lockfinish",this.chapterData])},ChapterLevelLockItem}(m),f=function(t){function ChapterLevelEventuallyItem(e,i){return t.call(this,e,i)||this}return c(ChapterLevelEventuallyItem,t),ChapterLevelEventuallyItem.prototype.setLevelData=function(e,i){t.prototype.setLevelData.call(this,e,i);var n=o.Url.getOsdRes(e.imagePath+"_"+this.dpr+"x.png");this.icon.load(n),i?(this.iconbg2.visible=!1,this.openButton.setFrameNormal("butt_gray"),this.openButton.setTextStyle(o.UIHelper.whiteStyle(this.dpr,13))):(this.iconbg2.visible=!0,this.openButton.setFrameNormal("yellow_btn_normal"),this.openButton.setTextStyle(o.UIHelper.brownishStyle(this.dpr,13)))},ChapterLevelEventuallyItem.prototype.init=function(){var t=10*this.dpr;this.bg=this.scene.make.image({key:r.d.explorelog,frame:"explore_chapter_end_checkpoint"}),this.setSize(this.bg.width,this.bg.height+2*t),this.bg.y=-t;var e=.5*-this.height+20*this.dpr;this.nameTex=this.scene.make.text({text:o.i18n.t("explore.eventuallytips"),style:o.UIHelper.colorStyle("#8743B9",14*this.dpr)}).setOrigin(.5),this.nameTex.setFontStyle("bold"),this.nameTex.y=e,this.leftLine=this.scene.make.image({key:r.d.explorelog,frame:"explore_chapter_end_left"}),this.leftLine.y=this.nameTex.y,this.leftLine.x=.5*-this.nameTex.width-.5*this.leftLine.width-10*this.dpr,this.rightLine=this.scene.make.image({key:r.d.explorelog,frame:"explore_chapter_end_right"}),this.rightLine.y=this.leftLine.y,this.rightLine.x=.5*this.nameTex.width+.5*this.rightLine.width+10*this.dpr,this.iconbg1=this.scene.make.image({key:r.d.explorelog,frame:"explore_chapter_end_close"}),this.iconbg1.y=4*this.dpr-t,this.iconbg2=this.scene.make.image({key:r.d.explorelog,frame:"explore_chapter_end_undraw"}),this.iconbg2.y=this.iconbg1.y,this.iconbg3=this.scene.make.image({key:r.d.explorelog,frame:"explore_chapter_end_curtain"}),this.iconbg3.y=this.iconbg2.y,this.icon=new s.DynamicImage(this.scene,0,0),this.icon.y=this.iconbg3.y,this.openButton=new a.NineSliceButton(this.scene,0,0,88*this.dpr,32*this.dpr,r.d.uicommon,"yellow_btn_normal",o.i18n.t("explore.open"),this.dpr,1,o.UIHelper.button(this.dpr)),this.openButton.setTextStyle(o.UIHelper.brownishStyle(this.dpr,13)),this.openButton.setFontStyle("bold"),this.openButton.on(a.ClickEvent.Tap,this.onGoClickHandler,this),this.openButton.x=0,this.openButton.y=.5*this.height-6*this.dpr-2*t,this.add([this.bg,this.iconbg1,this.icon,this.iconbg2,this.iconbg3,this.leftLine,this.rightLine,this.nameTex,this.openButton])},ChapterLevelEventuallyItem.prototype.onGoClickHandler=function(){this.send&&this.send.runWith(this.chapterData)},ChapterLevelEventuallyItem}(m)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaExploreLogSettlePanel",(function(){return c}));var n,s=i(5),r=i(0),o=i(11),a=i(472),h=i(470),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaExploreLogSettlePanel(e,i,n,r,o){var a=t.call(this,e,0,0,!1)||this;return a.tweens=[],a.curTempScore=0,a.allScore=0,a.isPlayed=!1,a.finished=!1,a.dpr=r,a.zoom=o,a.setSize(i,n),a.init(),a.enable=!0,a.on(s.ClickEvent.Tap,a.onClickHandler,a),a}return l(PicaExploreLogSettlePanel,t),PicaExploreLogSettlePanel.prototype.resize=function(t,e){this.setSize(t,e),this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.8),this.blackGraphic.fillRect(.5*-t,.5*-e,t,e)},PicaExploreLogSettlePanel.prototype.init=function(){this.blackGraphic=this.scene.make.graphics(void 0,!1),this.add(this.blackGraphic),this.content=this.scene.make.container(void 0,!1),this.content.setSize(this.width,this.height),this.add(this.content);var t=-200*this.dpr;this.titleimage=this.scene.make.image({key:o.d.explorelog,frame:"Settlement_title"},!1),this.titleimage.y=t,this.starPro=new h.ProgressMaskBar(this.scene,o.d.explorelog,"Settlement_star_default","Settlement_star_Light"),this.starPro.y=this.titleimage.y+.5*this.titleimage.height+.5*this.starPro.height+5*this.dpr,this.starText=this.scene.make.text({x:0,y:this.titleimage.y+40*this.dpr,text:"",style:r.UIHelper.whiteStyle(this.dpr,11)}).setOrigin(.5),this.starText.y=this.starPro.y+.5*this.starPro.height+10*this.dpr,this.starText.visible=!1,this.scorebg=this.scene.make.image({key:o.d.explorelog,frame:"Settlement_score_bg"}),this.scorebg.y=this.starText.y+15*this.dpr+.5*this.scorebg.height,this.scoreTex=this.scene.make.text({x:0,y:this.scorebg.y,text:"",style:r.UIHelper.colorStyle("#FFE057",39*this.dpr)}).setOrigin(.5),this.lightImg=this.scene.make.image({key:o.d.explorelog,frame:"Settlement_light"}),this.lightImg.y=this.scoreTex.y,this.lightImg.visible=!1,this.scoreTipsCon=this.scene.make.container(void 0,!1),this.scoreTipsCon.setSize(244*this.dpr,160*this.dpr),this.scoreTipsCon.y=this.scorebg.y+.5*this.scoreTipsCon.height,this.maskGraphic=this.scene.make.graphics(void 0,!1),this.maskWidth=336*this.dpr,this.maskHeight=215*this.dpr,this.content.add([this.titleimage,this.starPro,this.starText,this.scorebg,this.scoreTex,this.lightImg,this.scoreTipsCon])},PicaExploreLogSettlePanel.prototype.setHandler=function(t){this.closeHandler=t},PicaExploreLogSettlePanel.prototype.destroy=function(){if(t.prototype.destroy.call(this),this.tweens.length>0)for(var e=0,i=this.tweens;e<i.length;e++){var n=i[e];n.stop(),n.remove()}this.tweens.length=0},PicaExploreLogSettlePanel.prototype.setSettleData=function(t){if(t){this.initParam(),this.settleData=t,this.scoreDatas=this.getScoreArr(t),this.playScoreTipsAnimation(),this.curLayoutGroup=this.createLayoutGroup(t.rewards),this.curLayoutGroup.y=.5*this.height,this.curLayoutGroup.visible=!1,this.setLayoutMask(this.maskWidth,this.maskHeight);var e=this.getProgressValue(t.previousProgress);this.starPro.setProgress(e,500)}},PicaExploreLogSettlePanel.prototype.initParam=function(){this.isPlayed=!1,this.allScore=0,this.curTempScore=0,this.scoreTex.text=this.allScore+""},PicaExploreLogSettlePanel.prototype.getScoreArr=function(t){var e=[];return t.pointBase>=0&&(e.push({tip:r.i18n.t("explore.basetips"),score:t.pointBase}),this.allScore+=t.pointBase),t.pointTime>=0&&(e.push({tip:r.i18n.t("explore.timetips"),score:t.pointTime}),this.allScore+=t.pointTime),t.pointAccuracy>=0&&(e.push({tip:r.i18n.t("explore.accuracytips"),score:t.pointAccuracy}),this.allScore+=t.pointAccuracy),t.pointHint>=0&&(e.push({tip:r.i18n.t("explore.hinttips"),score:t.pointHint}),this.allScore+=t.pointHint),e},PicaExploreLogSettlePanel.prototype.setLayoutMask=function(t,e){var i=t,n=e;this.maskGraphic.clear(),this.maskGraphic.fillStyle(0),this.maskGraphic.fillRect(.5*-i*this.zoom,.5*-n*this.zoom,i*this.zoom,n*this.zoom);var s=this.getWorldTransformMatrix(),r=.5*e+30*this.dpr;this.maskGraphic.setPosition(s.tx,s.ty+r),this.curLayoutGroup.setMask(this.maskGraphic.createGeometryMask())},PicaExploreLogSettlePanel.prototype.excuteNextDatas=function(t){var e=this.scoreDatas;if(e.length>0){var i=e.shift(),n=new p(this.scene,100*this.dpr,45*this.dpr,this.dpr,this.zoom);return n.setTextData(i.tip,i.score),n.y=.5*this.scoreTipsCon.height+10*this.dpr,this.scoreTipsCon.add(n),!0===t?this.playScoreTipsFadeIn(n):!1===t&&this.playScoreTipsFadeOut(n),n.alpha=0,n}this.isPlayed=!0,t?this.curFadeInObj=void 0:this.curFadeOutObj=void 0},PicaExploreLogSettlePanel.prototype.playScoreTipsAnimation=function(){var t=this,e=this.excuteNextDatas(void 0);e.y=0,this.playAlphaTween(e,0,1,500,new r.Handler(this,(function(){t.playScoreTipsFadeOut(e)})))},PicaExploreLogSettlePanel.prototype.clearScoreAnimation=function(){if(this.tweens.length>0)for(var t=0,e=this.tweens;t<e.length;t++){var i=e[t];i.stop(),i.remove()}this.scoreTimer&&(clearInterval(this.scoreTimer),this.scoreTimer=void 0),this.tweens.length=0,this.scoreTipsCon.removeAll(!0),this.lightImg.visible=!1,this.scoreTex.text=this.allScore+"",this.starPro.setProgress(this.settleData.latestProgress,500)},PicaExploreLogSettlePanel.prototype.playCalculateScoreAnimation=function(t,e,i){var n=this,s=t/(e/30),r=this.curTempScore,o=0,a=0;this.scoreTimer=setInterval((function(){(o+=s)>=t&&(clearInterval(n.scoreTimer),o=t,n.curTempScore+=t,n.scoreTimer=void 0,i&&i.run());var e=Math.floor(o);e!==a&&(a=e,n.scoreTex.text=r+a+"")}),30),this.playLightAnimation()},PicaExploreLogSettlePanel.prototype.playScoreTipsFadeIn=function(t){var e=.5*this.scoreTipsCon.height;t.y=e,t.alpha=0,this.playtPosYTween(t,e,0,500),this.playAlphaTween(t,0,1,500),this.curFadeInObj=t},PicaExploreLogSettlePanel.prototype.playScoreTipsFadeOut=function(t){var e=this,i=.5*-this.scoreTipsCon.height;t.y=0,t.alpha=1,this.playtPosYTween(t,0,i,500,void 0),this.playAlphaTween(t,1,0,500,new r.Handler(this,(function(){e.playCalculateScoreAnimation(t.value,300,new r.Handler(e,(function(){e.isPlayed&&(e.playLayoutAnimation(),e.lightImg.visible=!1,e.playStarAnimation(e.settleData.previousProgress,e.settleData.latestProgress,500)),e.curFadeInObj&&e.playScoreTipsFadeOut(e.curFadeInObj)}))),t.destroy()}))),this.scene&&this.excuteNextDatas(!0),this.curFadeOutObj=t},PicaExploreLogSettlePanel.prototype.playStarAnimation=function(t,e,i){var n=this,s=(e-t)/i*5e3,r=Math.floor(e/100),o=Math.floor(e%100),a=this.getProgressValue(e),h=this.getProgressValue(t),l=this.scene.tweens.addCounter({from:h,to:a,ease:"Linear",duration:s,onUpdate:function(t,e){n.starPro.setProgress(e.value,i)},onComplete:function(){l.stop(),l.remove(),n.removeTween(l)}});this.tweens.push(l);var c=196*this.dpr,p=29*this.dpr,d=12*this.dpr;this.starText.text=o+"%",this.starText.x=.5*-c+r*(p+d)+.5*p,this.starText.visible=!0},PicaExploreLogSettlePanel.prototype.getProgressValue=function(t){var e=Math.floor(t/100),i=75.75*e+30.3*e;return(i=i<0?0:i)+Math.floor(t%100)/100*75.75},PicaExploreLogSettlePanel.prototype.playLayoutAnimation=function(){var t=this.curLayoutGroup,e=.5*this.maskHeight+30*this.dpr,i=e+this.maskHeight+20*this.dpr;t.y=i,this.curLayoutGroup.visible=!0,this.playItemTween(t,i,e,620)},PicaExploreLogSettlePanel.prototype.playItemTween=function(t,e,i,n){var s=this,r=this.scene.tweens.add({targets:t,y:{from:e,to:i},ease:"Back.easeOut",duration:400,delay:n,onComplete:function(){r.stop(),r.remove(),s.removeTween(r),s.finished=!0}});this.tweens.push(r)},PicaExploreLogSettlePanel.prototype.playLightAnimation=function(){var t=this;if(!this.lightImg.visible){this.lightImg.visible=!0,this.lightImg.alpha=0;var e=new r.Handler(this,(function(i){t.lightImg.visible&&(1===i?t.playAlphaTween(t.lightImg,1,.8,60,e):t.playAlphaTween(t.lightImg,.8,1,60,e))}));this.playAlphaTween(this.lightImg,0,1,100,e)}},PicaExploreLogSettlePanel.prototype.playtPosYTween=function(t,e,i,n,s,r){var o=this;if(void 0===n&&(n=500),this.scene){var a=this.scene.tweens.add({targets:t,y:{from:e,to:i},ease:"Linear",duration:n,delay:r,onComplete:function(){a.stop(),a.remove(),o.removeTween(a),s&&s.run()}});this.tweens.push(a)}},PicaExploreLogSettlePanel.prototype.playAlphaTween=function(t,e,i,n,s,r){var o=this;if(void 0===n&&(n=500),this.scene){var a=this.scene.tweens.add({targets:t,alpha:{from:e,to:i},ease:"Linear",duration:n,delay:r,onComplete:function(){a.stop(),a.remove(),o.removeTween(a),s&&s.runWith(i)}});this.tweens.push(a)}},PicaExploreLogSettlePanel.prototype.removeTween=function(t){var e=this.tweens.indexOf(t);-1!==e&&this.tweens.splice(e,1)},PicaExploreLogSettlePanel.prototype.createLayoutGroup=function(t){var e=new d(this.scene,0,this.maskHeight,235*this.dpr,this.maskHeight,this.dpr,this.zoom);return this.content.add(e),e.setRewardDatas(t),e},PicaExploreLogSettlePanel.prototype.onClickHandler=function(){this.isPlayed?this.finished&&this.closeHandler&&this.closeHandler.run():(this.clearScoreAnimation(),this.isPlayed=!0,this.playLayoutAnimation())},PicaExploreLogSettlePanel}(h.ButtonEventDispatcher),p=function(t){function ScoreTipsPanel(e,i,n,s,r){var o=t.call(this,e)||this;return o.value=0,o.dpr=s,o.zoom=r,o.setSize(i,n),o.init(),o}return l(ScoreTipsPanel,t),ScoreTipsPanel.prototype.setTextData=function(t,e){this.title.text=t,this.valueTex.text="+"+e,this.value=e},ScoreTipsPanel.prototype.init=function(){this.title=this.scene.make.text({x:0,y:0,text:"",style:r.UIHelper.whiteStyle(this.dpr)}).setOrigin(.5),this.title.y=-12*this.dpr,this.valueTex=this.scene.make.text({x:0,y:0,text:"",style:r.UIHelper.whiteStyle(this.dpr,24)}).setOrigin(.5),this.valueTex.y=11*this.dpr,this.add([this.title,this.valueTex])},ScoreTipsPanel}(Phaser.GameObjects.Container),d=function(t){function RewardLayoutGroup(e,i,n,s,r,a,h){var l=t.call(this,e,i,n)||this;return l.dpr=a,l.zoom=h,l.setSize(s,r),l.bg=l.scene.make.image({key:o.d.explorelog,frame:"Settlement_reward_bg"}),l.content=l.scene.make.container(void 0,!1),l.content.y=10*a,l.add([l.bg,l.content]),l}return l(RewardLayoutGroup,t),RewardLayoutGroup.prototype.setRewardDatas=function(t){if(t){for(var e=t.length,i=0;i<e;i++){var n=new a.ItemButton(this.scene,o.d.uicommon1,"roam_reward_ordinary_bg",this.dpr,this.zoom,!0);n.setStateFrames("roam_reward_ordinary_bg","roam_reward_rare_bg"),n.setItemData(t[i]),this.content.add(n)}this.setLayout()}},RewardLayoutGroup.prototype.setLayout=function(){var t=this.content.list;if(0!==t.length){var e=t[0],i=t.length,n=e.width,s=e.height,r=0,o=0;if(i<=3)for(var a=2===i?20*this.dpr:10*this.dpr,h=i*n+a*(i-1),l=0;l<i;l++){(P=t[l]).x=.5*-h+(n+a)*l+.5*n}else if(4===i){var c=20*this.dpr,p=15*this.dpr;for(l=0;l<2;l++)for(var d=0;d<2;d++){(P=t[2*l+d]).x=.5*-(n+c)+(n+c)*d,P.y=.5*-(s+p)+(s+p)*l}}else if(5===i){h=3*n+2*(c=10*this.dpr);var m=2*s+(p=15*this.dpr);for(l=0;l<3;l++){(P=t[l]).x=.5*-h+(n+c)*l+.5*n,P.y=.5*-m+.5*s}for(d=0;d<2;d++){(P=t[d+3]).x=.5*-(2*n+c)+.5*n+(n+c)*d,P.y=.5*m-.5*s}}else if(6===i)for(h=3*n+2*(c=10*this.dpr),m=2*s+(p=15*this.dpr),l=0;l<2;l++)for(d=0;d<3;d++){(P=t[3*l+d]).x=.5*-h+(n+c)*d+.5*n,P.y=.5*-m+(s+p)*l+.5*s}else{c=10*this.dpr,p=10*this.dpr;var u=Math.floor(t.length/4),y=t.length%4,f=(h=4*n+3*c,u+(0===y?0:1));for(m=f*s+p*(f-1),l=0;l<u;l++)for(d=0;d<4;d++){(P=t[4*l+d]).x=.5*-h+(n+c)*d+.5*n,P.y=.5*-m+(s+p)*l+.5*s}var g=y*n+c*(y-1);for(d=0;d<y;d++){var P;(P=t[d+4*u]).x=.5*-g+.5*n+(n+c)*d,P.y=.5*m-.5*s}r=h,o=m,this.width<r&&(this.width=r),this.height<o&&(this.height=o)}}},RewardLayoutGroup}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaGiftLaterctPanel",(function(){return a}));var n,s=i(0),r=i(509),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),a=function(t){function PicaGiftLaterctPanel(e,i,n,s,r,o){var a=t.call(this,e)||this;return a.render=i,a.giftQueue=[],a.isPlaying=!1,a.setSize(n,s),a.key=r,a.dpr=o,a}return o(PicaGiftLaterctPanel,t),PicaGiftLaterctPanel.prototype.play=function(t){this.giftQueue=this.giftQueue.concat(new Array(30)),this.playNext()},PicaGiftLaterctPanel.prototype.playNext=function(){var t=this;if(!this.isPlaying&&this.giftQueue.length>0){this.giftQueue.shift();var e=new r.PicaGiftLateralItem(this.scene,this.key,this.dpr);e.setItemData(s.Handler.create(this,(function(){t.isPlaying=!1,t.playNext()})));var i=.5*-this.width-.5*e.width-10*this.dpr,n=.5*-this.width+.5*e.width+10*this.dpr;e.x=i,e.y=.5*this.height-100*this.dpr,e.playMove(i,n),this.add(e),this.isPlaying=!0}},PicaGiftLaterctPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaGiftLateralItem",(function(){return h}));var n,s=i(5),r=i(470),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicaGiftLateralItem(e,i,n){var a=t.call(this,e)||this;return a.giftCount=0,a.key=i,a.dpr=n,a.bg=e.make.image({key:i,frame:"gift_bg"}),a.add(a.bg),a.setSize(a.bg.width,a.bg.height),a.headicon=e.make.image({key:i,frame:"gift_head"}),a.headicon.x=.5*-a.width+.5*a.headicon.width+2*n,a.add(a.headicon),a.titletext=new s.BBCodeText(e,0,0,"",o.UIHelper.whiteStyle(n)).setOrigin(0),a.titletext.x=a.headicon.x+.5*a.headicon.width+10*n,a.titletext.y=.5*-a.height+2*n,a.add(a.titletext),a.giftIcon=new r.DynamicImage(e,.5*a.width-50*n,0),a.add(a.giftIcon),a.countTex=a.scene.make.text({x:.5*a.width-5*n,y:0,text:"",padding:{left:0,right:10*n},style:{fontFamily:o.Font.DEFULT_FONT,fontSize:28*n,color:"#FCF863"}}).setFontStyle("bold italic").setStroke("#C25E0D",2*n).setOrigin(.5),a.add(a.countTex),a}return a(PicaGiftLateralItem,t),PicaGiftLateralItem.prototype.setItemData=function(t){this.compl=t,this.titletext.setText("一只狐狸\n"+o.i18n.t("common.give")+"[color=#FFFF41]能量电池[/color]"),this.countTex.text="",this.giftCount=Math.floor(50*Math.random())},PicaGiftLateralItem.prototype.playMove=function(t,e){var i=this,n=this.scene.tweens.add({targets:this,x:{from:t,to:e},ease:"Linear",duration:300,onComplete:function(){n.stop(),n.remove(),i.playCount()}})},PicaGiftLateralItem.prototype.playCount=function(){var t=this,e=this.getCountTweenData(this.giftCount),i=0,n=0===e.acc?1:0,tweenFun=function(){n+=e.acc,(i+=n)>t.giftCount&&(i=t.giftCount),t.countTex.text="x"+i;var s=t.scene.tweens.add({targets:t.countTex,scale:{from:.5,to:1},ease:"Linear",duration:e.duration,onComplete:function(){s.stop(),s.remove(),i<t.giftCount?setTimeout((function(){tweenFun()}),e.interval):setTimeout((function(){t.playAlpha()}),1e3)}})};tweenFun()},PicaGiftLateralItem.prototype.playAlpha=function(){var t=this,e=this.scene.tweens.add({targets:this,alpha:{from:1,to:0},ease:"Linear",duration:200,onComplete:function(){e.stop(),e.remove(),t.compl&&t.compl.run(),t.destroy()}})},PicaGiftLateralItem.prototype.getCountTweenData=function(t){var e;return t<10?e={duration:300,interval:20,acc:0}:t>=10&&t<30?e={duration:300,interval:20,acc:1}:t>=30&&(e={duration:300,interval:20,acc:2}),e},PicaGiftLateralItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaGiftPlayerPanel",(function(){return r}));var n,s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),r=function(t){function PicaGiftPlayerPanel(e,i,n,s,r,o){var a=t.call(this,e)||this;return a.render=i,a.giftQueue=[],a.isPlaying=!1,a.setSize(n,s),a.key=r,a.dpr=o,a}return s(PicaGiftPlayerPanel,t),PicaGiftPlayerPanel.prototype.play=function(t){this.giftQueue.push(new Array(30)),this.playNext()},PicaGiftPlayerPanel.prototype.playNext=function(){},PicaGiftPlayerPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaHouseInfoPanel",(function(){return l}));var n,s=i(5),r=i(0),o=i(470),a=i(11),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaHouseInfoPanel(e,i,n,s,r,o,a){var h=t.call(this,e,i,n)||this;return h.key=o,h.dpr=a,h.setSize(s,r),h.createAttribute(),h}return h(PicaHouseInfoPanel,t),PicaHouseInfoPanel.prototype.setAttributeData=function(t,e){this.roomname.setTextInfo(r.i18n.t("room_info.roomname"),t.name);var i=0,n=0,s=0;t.roomLevel&&(i=t.roomLevel.level,n=t.roomLevel.currentLevelExp?t.roomLevel.currentLevelExp:0,s=t.roomLevel.nextLevelExp?t.roomLevel.nextLevelExp:0),this.roomlevel.setImageInfo(r.i18n.t("room_info.roomlevel"),a.c.common2Key,this.getLevelImgs(i));var o="[color=#0D8288]"+n+"[/color]/"+s;if(this.expvalue.setTextInfo(r.i18n.t("room_info.expvalue"),o),this.popvalue.setTextInfo(r.i18n.t("room_info.popvalue"),t.popularity+""),this.goodvalue.setTextInfo(r.i18n.t("room_info.goodvalue"),t.praise+""),"store"===t.roomType){this.compviness.visible=!0,this.turnover.visible=!0,this.deprecia.visible=!0,this.compviness.setTextInfo(r.i18n.t("room_info.compveness"),t.competitiveness+"");var h="";h=t.turnoverProp.tempValue>0?t.turnoverProp.value+"(+"+t.turnoverProp.tempValue+")":t.turnoverProp.tempValue<0?t.turnoverProp.value+"[color=#ff0000]("+t.turnoverProp.tempValue+")[/color]":""+t.turnoverProp.value,this.turnover.setTextInfo(r.i18n.t("room_info.turnover"),h),this.deprecia.setTextInfo(r.i18n.t("room_info.depreciation"),Math.floor(100*t.undepreciated)+"%"),this.add([this.compviness,this.turnover,this.deprecia,this.helptips]),e?this.deprecia.add([this.renovateBtn,this.help]):this.deprecia.remove([this.renovateBtn,this.help])}else this.compviness.visible=!1,this.turnover.visible=!1,this.deprecia.visible=!1,this.remove([this.compviness,this.turnover,this.deprecia,this.helptips])},PicaHouseInfoPanel.prototype.setHandler=function(t){this.equirementsHandler=t},PicaHouseInfoPanel.prototype.createAttribute=function(){var t=.5*-this.height+10*this.dpr,e=20*this.dpr,i=this.width,n=20*this.dpr+e;this.roomname=new c(this.scene,0,t,i,e,this.dpr),t+=n,this.roomlevel=new c(this.scene,0,t,i,e,this.dpr),t+=n,this.expvalue=new c(this.scene,0,t,i,e,this.dpr),t+=n,this.popvalue=new c(this.scene,0,t,i,e,this.dpr),t+=n,this.goodvalue=new c(this.scene,0,t,i,e,this.dpr),t+=n,this.compviness=new c(this.scene,0,t,i,e,this.dpr),t+=n,this.turnover=new c(this.scene,0,t,i,e,this.dpr),t+=n,this.deprecia=new c(this.scene,0,t,i,e,this.dpr),this.renovateBtn=new s.Button(this.scene,a.c.commonKey,"order_yellow_butt","order_yellow_butt",r.i18n.t("room_info.renovate")),this.renovateBtn.scale=1.1,this.renovateBtn.setTextStyle({fontSize:12*this.dpr,color:"#ED7814"}),this.renovateBtn.on(String(s.ClickEvent.Tap),this.onRenovateHandler,this),this.renovateBtn.x=.5*this.width-60*this.dpr,this.help=new s.Button(this.scene,a.c.common2Key,"icon_tips","icon_tips"),this.help.x=.5*this.width-20*this.dpr,this.help.on(String(s.ClickEvent.Tap),this.onHelpHandler,this),this.deprecia.add([this.renovateBtn,this.help]),this.helptips=new o.ItemInfoTips(this.scene,140*this.dpr,46*this.dpr,a.c.common2Key,"tips_bg",this.dpr),this.helptips.x=60*this.dpr,this.helptips.y=this.deprecia.y-20*this.dpr,this.helptips.setText(r.i18n.t("room_info.helptips"),1),this.helptips.setInvalidArea(r.Tool.getRectangle(this.help,this.scene)),this.helptips.setVisible(!1),this.add([this.roomname,this.roomlevel,this.expvalue,this.popvalue,this.goodvalue])},PicaHouseInfoPanel.prototype.onRenovateHandler=function(){this.equirementsHandler&&this.equirementsHandler.run()},PicaHouseInfoPanel.prototype.onHelpHandler=function(){this.helptips.setVisible(!this.helptips.visible)},PicaHouseInfoPanel.prototype.getLevelImgs=function(t){t=t||0;for(var e=[],i=Math.floor(t/Math.pow(4,3)),n=t%Math.pow(4,3),s=Math.floor(n/Math.pow(4,2)),r=n%Math.pow(4,2),o=Math.floor(r/Math.pow(4,1)),a=r%Math.pow(4,1),h=0;h<i;h++)e.push("bear");for(h=0;h<s;h++)e.push("sun");for(h=0;h<o;h++)e.push("moon");for(h=0;h<a;h++)e.push("star");return 0===t&&e.push("star"),e},PicaHouseInfoPanel.prototype.getpopImgs=function(){return["popularity","popularity","popularity","popularity","popularity"]},PicaHouseInfoPanel.prototype.getgoodImgs=function(){return["good","good","good","good1","good1"]},PicaHouseInfoPanel}(Phaser.GameObjects.Container),c=function(t){function HouseAttributeValue(e,i,n,o,a,h){var l=t.call(this,e,i,n)||this;return l.dpr=h,l.setSize(o,a),l.nameText=l.scene.make.text({x:.5*-o+15*h,y:0,text:"",style:{fontFamily:r.Font.DEFULT_FONT,fontSize:14*h,color:"#FFC51A"}}).setOrigin(0,.5).setResolution(h),l.valueText=new s.BBCodeText(l.scene,0,0,"",{color:"#000000",fontSize:13*l.dpr,fontFamily:r.Font.DEFULT_FONT}).setOrigin(0,.5).setResolution(h),l.imgCon=l.scene.make.container(void 0,!1),l.imgCon.x=10*h,l.add([l.nameText,l.valueText,l.imgCon]),l}return h(HouseAttributeValue,t),HouseAttributeValue.prototype.setTextInfo=function(t,e){this.nameText.text=t,this.valueText.text=e},HouseAttributeValue.prototype.setImageInfo=function(t,e,i){this.nameText.text=t;for(var n=0,s=10*this.dpr,r=0,o=i;r<o.length;r++){var a=o[r],h=this.scene.make.image({key:e,frame:a});h.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.x=n,n+=.5*h.width+s,this.imgCon.add(h)}this.valueText.visible=!1},HouseAttributeValue}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaManorContentPanel",(function(){return h}));var n,s=i(5),r=i(11),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicaManorContentPanel(e,i,n,s,r,o,a){var h=t.call(this,e,i,n)||this;return h.setSize(s,r),h.dpr=o,h.key=a,h.create(),h}return a(PicaManorContentPanel,t),PicaManorContentPanel.prototype.create=function(){var t=this.width,e=this.height;this.bg=new s.NineSlicePatch(this.scene,0,0,t,e,r.c.commonKey,"bg",{left:70*this.dpr,top:30*this.dpr,right:30*this.dpr,bottom:70*this.dpr}),this.add(this.bg);var i=.5*-e;this.titlebg=this.scene.make.image({x:0,y:0,key:r.c.common2Key,frame:"title"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titlebg.y=i+3*this.dpr,this.add(this.titlebg),this.titleText=this.scene.make.text({x:0,y:this.titlebg.y+2*this.dpr,text:o.i18n.t("manor.title"),style:o.UIHelper.titleYellowStyle_m(this.dpr)}).setOrigin(.5),this.titleText.setFontStyle("bold"),this.titleText.setResolution(this.dpr),this.add(this.titleText),this.closeBtn=new s.Button(this.scene,r.c.commonKey,"close"),this.closeBtn.setDisplaySize(28*this.dpr,28*this.dpr),this.closeBtn.setPosition(.5*this.width-8*this.dpr,i+7*this.dpr),this.closeBtn.on(String(s.ClickEvent.Tap),this.onCloseHandler,this),this.add(this.closeBtn),this.setContentSize(t,e)},PicaManorContentPanel.prototype.setContentSize=function(t,e){this.setSize(t,e),this.bg.resize(t,e);var i=.5*-e;this.titlebg.y=i+5*this.dpr,this.titleText.y=this.titlebg.y+2*this.dpr,this.closeBtn.setPosition(.5*this.width-8*this.dpr,i+7*this.dpr)},PicaManorContentPanel.prototype.setTitleText=function(t){this.titleText.text=t},PicaManorContentPanel.prototype.setCloseHandler=function(t){this.closeHandler=t},PicaManorContentPanel.prototype.onCloseHandler=function(){this.closeHandler&&this.closeHandler.run()},PicaManorContentPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaManorScrollPanel",(function(){return l}));var n,s=i(5),r=i(470),o=i(11),a=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaManorScrollPanel(e,i,n,s,r,o,a,h){var l=t.call(this,e,i,n)||this;return l.dpr=o,l.key=h,l.zoom=a,l.setSize(s,r),l.create(),l}return h(PicaManorScrollPanel,t),PicaManorScrollPanel.prototype.setManorListData=function(t){var e=t.street.sort((function(t,e){return t.streetId>e.streetId?-1:1}));this.gridtable.setItems(e)},PicaManorScrollPanel.prototype.setHandler=function(t){this.sendHandler=t},PicaManorScrollPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicaManorScrollPanel.prototype.create=function(){var t=.5*-this.height,e=.5*-this.width,i=this.scene.make.image({key:this.key,frame:"finca_list_block"});i.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),i.x=e+35*this.dpr,i.y=t+30*this.dpr,this.add(i);var n=i.x+.5*i.width+5*this.dpr,s=this.scene.make.text({x:n,y:i.y,text:a.i18n.t("manor.title"),style:{fontSize:12*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#FFC51A"}}).setOrigin(0,.5);s.setFontStyle("bold"),s.setStroke("#553100",2*this.dpr),this.add(s);var r=this.scene.make.graphics(void 0,!1);r.clear(),r.fillStyle(0,.11),r.fillRect(.5*-this.width+20*this.dpr,i.y+20*this.dpr,256*this.dpr,2),this.add(r);var o=293*this.dpr,h=360*this.dpr,l=t+53*this.dpr+.5*h;this.gridtable=this.createGrideTable(0,l,o,h,293*this.dpr,58*this.dpr)},PicaManorScrollPanel.prototype.createGrideTable=function(t,e,i,n,r,o){var a=this,h={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:r,cellHeight:o,reuseCellContainer:!0,tableOX:0*this.dpr,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&(e=new c(a.scene,0,0,r,o,a.key,a.dpr,a.zoom),l.add(e)),e.setManorData(i),e}},l=new s.GameGridTable(this.scene,h);return l.layout(),l.on("cellTap",this.onGridTableHandler,this),this.add(l),l},PicaManorScrollPanel.prototype.onGridTableHandler=function(t){this.onEnterHandler(t.manorData)},PicaManorScrollPanel.prototype.onEnterHandler=function(t){this.sendHandler&&this.sendHandler.runWith(t.roomId)},PicaManorScrollPanel.prototype.onSearchBtnHandler=function(){this.sendHandler&&this.sendHandler.run()},PicaManorScrollPanel.prototype.onFiltrateHandler=function(){this.sendHandler&&this.sendHandler.run()},PicaManorScrollPanel.prototype.onSortBtnHandler=function(){this.sendHandler&&this.sendHandler.run()},PicaManorScrollPanel}(Phaser.GameObjects.Container),c=function(t){function ManorItem(e,i,n,h,l,c,p,d){var m=t.call(this,e,i,n)||this;m.dpr=p,m.key=c,m.setSize(h,l);m.width,m.height;m.bg=new s.NineSlicePatch(m.scene,0,0,h,50*p,m.key,"list_bg",{left:10*m.dpr,top:0*m.dpr,right:10*m.dpr,bottom:0*m.dpr}),m.add(m.bg);var u=.5*-m.width+10*p;return m.manorName=m.scene.make.text({x:u,y:0,text:"",style:{color:"#333333",fontSize:15*m.dpr,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(0,.5),m.manorName.setFontStyle("bold"),m.add(m.manorName),m.playerCount=new r.ImageValue(e,30*p,20*p,o.c.commonKey,"home_persons",p,{fontFamily:a.Font.DEFULT_FONT,fontSize:15*p,color:"#333333"}),m.playerCount.setFontStyle("bold"),m.playerCount.x=.5*m.width-35*p,m.add(m.playerCount),m.playerCount.setText("100"),m}return h(ManorItem,t),ManorItem.prototype.setManorData=function(t){this.manorData=t,this.manorName.text=t.name,this.playerCount.setText(t.playerCount+"")},ManorItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"ElementDetail",(function(){return c}));var n,s=i(473),r=i(5),o=i(515),a=i(0),h=i(11),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function ElementDetail(e,i,n,h,l){var c=t.call(this,e)||this;c.render=i,c.key=n,c.dpr=h,c.zoom=l,c.setPosition(0,0),c.mCounter=new o.NumberCounter(c.scene,n,360,700,c.dpr,i.uiScale);var d=c.scene.textures.getFrame(c.key,"yellow_button_normal"),m=60,u=65;d&&(m=d.width,u=d.height),c.mBuyBtn=new r.NineSliceButton(c.scene,440,700,81*c.dpr,41*c.dpr,c.key,"yellow_button",a.i18n.t("common.buy"),c.dpr,c.scale,{left:14*c.dpr,top:14*c.dpr,right:m-2-14*c.dpr,bottom:u-2-14*c.dpr}),c.mBuyBtn.setTextStyle({color:"#976400",fontSize:16*c.dpr,fontFamily:a.Font.DEFULT_FONT}),c.mBuyBtn.setFontStyle("bold"),c.mBuyBtn.on(String(r.ClickEvent.Tap),c.onBuyHandler,c),c.mPriceContainer=c.scene.make.container(void 0,!1),c.mPriceIcon=c.scene.make.image({x:-78,key:c.key,frame:"iv_coin"},!1),c.mPriceIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),c.mPriceText=c.scene.make.text({x:0,style:{fontSize:14*c.dpr,fontFamily:a.Font.NUMBER}}).setOrigin(.5);var y=c.scene.make.image({key:c.key,frame:"price_bg"});return y.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),c.mDetailDisplay=new s.DetailDisplay(c.scene,c.render),c.mDetailDisplay.setFixedScale(2*c.dpr/c.zoom),c.mDetailDisplay.y=110*c.dpr,c.mDetailBubble=new p(c.scene,c.key,c.dpr),c.mDetailBubble.x=4*c.dpr,c.mDetailBubble.y=400*c.dpr,c.add([c.mDetailDisplay,c.mPriceContainer,c.mCounter,c.mBuyBtn,c.mDetailBubble]),c.mPriceContainer.add([y,c.mPriceIcon,c.mPriceText]),c.addActionListener(),c}return l(ElementDetail,t),ElementDetail.prototype.resize=function(t,e){var i=t,n=e/2-150,s=t/2;this.mBuyBtn.x=i-this.mBuyBtn.displayWidth/2-10*this.dpr,this.mBuyBtn.y=this.height-this.y-this.mBuyBtn.displayHeight/2-12*this.dpr;var r=this.mBuyBtn.x-this.mBuyBtn.displayWidth/2-this.mCounter.displayWidth/2-17*this.dpr;this.mCounter.x=r,this.mCounter.y=this.mBuyBtn.y,this.mDetailBubble.x=4*this.dpr,this.mDetailBubble.y=this.mCounter.y-70*this.dpr,this.mPriceContainer.x=this.mCounter.x,this.mPriceContainer.y=this.mCounter.y-35*this.dpr,this.mDetailDisplay.x=s,this.mDetailDisplay.y=(this.height-this.y)/2;var o=.8*i,a=.7*n;this.setInteractive(new Phaser.Geom.Rectangle((i>>1)+(i-o>>1),n>>1,o,a),Phaser.Geom.Rectangle.Contains),this.mCounter.resize(),this.mDetailBubble.visible=!0},ElementDetail.prototype.addActionListener=function(){this.mCounter&&(this.mCounter.addActionListener(),this.mCounter.on("change",this.onChangeCounterHandler,this),this.on("pointerup",this.onPointerUpHandler,this))},ElementDetail.prototype.removeActionListener=function(){this.mCounter&&(this.mCounter.removeActionListener(),this.mCounter.off("change",this.onChangeCounterHandler,this),this.off("gameobjectup",this.onPointerUpHandler,this))},ElementDetail.prototype.setProp=function(t){var e=this;this.mSelectedProp=t,t.price&&t.price.length>0?(this.mPriceIcon.setTexture(this.key,a.Coin.getIcon(t.price[0].coinType)),this.updatePrice(t.price[0].price.toString())):this.mPriceText.setText("");var i=null;this.render.mainPeer.getUserData_PlayerProperty().then((function(t){return i=t,e.serviceTimestamp})).then((function(n){e.mDetailBubble.setProp(t,Math.floor(n/1e3),i),e.mDetailBubble.y=e.height-e.y-e.mDetailBubble.height-6*e.dpr,e.mCounter.setCounter(1)}))},ElementDetail.prototype.setResource=function(t){var e=this;t.display?this.mDetailDisplay.loadDisplay(t):t.avatar?this.render.mainPeer.getPlayerAvatar().then((function(i){var n=i.avatar,s=i.suits;for(var r in n)if(n.hasOwnProperty(r)){var o=n[r];o&&!t.avatar[r]&&(t.avatar[r]=o)}if(s)for(var a=t.suits[0],h=0,l=s;h<l.length;h++){var c=l[h];c.suit_type!==a.suit_type&&t.suits.push(c)}var p=new Phaser.Geom.Point(0,70);e.mDetailDisplay.loadAvatar(t,2*e.dpr,p)})):this.mDetailDisplay.loadUrl(this.mSelectedProp.icon)},Object.defineProperty(ElementDetail.prototype,"serviceTimestamp",{get:function(){var t=this;return new Promise((function(e,i){t.render.mainPeer.requestCurTime().then((function(t){e(t)}))}))},enumerable:!1,configurable:!0}),ElementDetail.prototype.updatePrice=function(t){this.mPriceText.setText(t),this.mPriceIcon.x=this.mPriceText.x-this.mPriceText.width/2-16*this.dpr},ElementDetail.prototype.onBuyHandler=function(){if(this.mSelectedProp){var t={id:null,quantity:null,category:null};t.id=this.mSelectedProp.id,t.quantity=this.mCounter.number,t.category=this.mSelectedProp.category,this.emit("buyItem",t)}},ElementDetail.prototype.onChangeCounterHandler=function(t){this.mSelectedProp&&(!this.mSelectedProp.price||this.mSelectedProp.price.length<1||this.updatePrice((this.mSelectedProp.price[0].price*this.mCounter.number).toString()))},ElementDetail.prototype.onPointerUpHandler=function(){this.mCounter.setBlur()},ElementDetail}(Phaser.GameObjects.Container),p=function(t){function DetailBubble(e,i,n,s){void 0===s&&(s=1);var o=t.call(this,e)||this;o.dpr=n;var l=100*n,c=96*n;return o.setSize(l,c),o.tipsbg=new r.NineSlicePatch(o.scene,0,0,l,c,h.d.uicommon,"tips_bg",{left:10*o.dpr,top:10*o.dpr,right:10*o.dpr,bottom:10*o.dpr},void 0,void 0,.5),o.tipsbg.setPosition(.5*l,.5*c),o.tipsbg.alpha=.6,o.tipsText=new r.BBCodeText(o.scene,7*n,-c+60*o.dpr,"",{color:"#333333",fontSize:10*o.dpr,fontFamily:a.Font.DEFULT_FONT,lineSpacing:6*n,padding:{top:2*n}}).setOrigin(0),o.tipsText.setWrapMode("string"),o.mExpires=new r.BBCodeText(e,7*n,85*n,"",{fontSize:10*o.dpr,fontFamily:a.Font.DEFULT_FONT}).setOrigin(0),o.add([o.tipsbg,o.tipsText,o.mExpires]),o.tipsText.addImage("iv_coin",{key:h.c.commonKey,frame:"iv_coin"}),o.tipsText.addImage("iv_diamond",{key:h.c.commonKey,frame:"iv_diamond"}),o}return l(DetailBubble,t),DetailBubble.prototype.setProp=function(t,e,i){if(t){this.tipsText.setWrapWidth(void 0);var n="",s="",r="",o="[color=#32347b][b][size="+14*this.dpr+"]"+(t.shortName||t.name)+"[/size][/b][/color]"+"\n",h=100*this.dpr;this.tipsText.text=o,h=h<this.tipsText.width?this.tipsText.width:h,t.des&&""!==t.des&&(o+="\n"+(n=t.des),this.tipsText.text=n,h=h<this.tipsText.width?this.tipsText.width:h);var l=!1;if(t.affectValues){for(var c=t.affectValues.length,p=0;p<c;p++){var d=t.affectValues[p];if(i.propertiesMap.has(d.key)){var m=i.propertiesMap.get(d.key),u=d.value>0?"[color=#ffff00]+"+d.value+"[/color]":"[color=#ff0000]"+d.value+"[/color]";s+="\n"+m.name+": "+u}}s.length>0&&(l||(l=!0,o+="\n-- -- -- -- -- -- -- --"),o+="\n[color=#ffffff]"+a.i18n.t("furni_bag.properties")+"[/color]"+s)}if(t.requireValues){for(c=t.requireValues.length,p=0;p<c;p++){var y=t.requireValues[p];if(i.propertiesMap.has(y.key)){u=((m=i.propertiesMap.get(y.key)).value,y.value,"[color=#00ff00]("+y.value+")[/color]");r+="\n"+m.name+": "+u}}r.length>0&&(l||(l=!0,o+="\n-- -- -- -- -- -- -- --"),o+="\n"+a.i18n.t("furni_bag.needproper")+":"+r)}this.tipsText.setWrapWidth(h),this.tipsText.text=o,this.width=h+14*this.dpr,this.resize()}else this.tipsText.setText(a.i18n.t("furni_bag.empty_backpack")),this.mExpires.text="",this.resize();return this},DetailBubble.prototype.resize=function(t,e){var i=96*this.dpr,n=this.tipsText.height;this.mExpires.visible&&(n+=this.mExpires.height+3*this.dpr),n=(n+=14*this.dpr)<i?i:n,this.setSize(this.width,n),this.tipsbg.resize(this.width,this.height),this.tipsbg.x=.5*this.width,this.tipsbg.y=.5*this.height,this.tipsText.y=7*this.dpr,this.mExpires.y=this.tipsText.y+this.tipsText.height+3*this.dpr},DetailBubble.prototype.getDataFormat=function(t){var e=Math.floor(t/864e5),i=Math.floor(t/36e5)%24,n=Math.floor(t/6e4)%60,s=Math.floor(t/1e3)%60,r=a.i18n.t("furni_bag.timelimit")+":  ";if(e>0)r+="[color=#FF0000]"+(e+"-"+this.stringFormat(i)+":"+this.stringFormat(n)+":"+this.stringFormat(s))+"[/color]";else if(i>0||n>0||s>0){r+="[color=#FF0000]"+(this.stringFormat(i)+":"+this.stringFormat(n)+":"+this.stringFormat(s))+"[/color]"}else{r+="[color=#FF0000]"+(""+a.i18n.t("furni_bag.expires"))+"[/color]"}return r},DetailBubble.prototype.stringFormat=function(t){var e=t+"";return e.length<=1&&(e="0"+e),e},DetailBubble.prototype.getComparTag=function(t){var e="";switch(t){case 1:e="=";case 2:e="!=";case 3:e="<=";case 4:e="<";case 5:e=">=";case 6:e=">";default:e="="}return e},DetailBubble}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"NumberCounter",(function(){return o}));var n,s=i(470),r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function NumberCounter(e,i,n,r,o,a){void 0===o&&(o=1),void 0===a&&(a=1);var h=t.call(this,e,n,r)||this;return h.pressDelay=500,h.mMinNum=1,h.mMaxNum=99,h.zoom=1,h.zoom=a,h.mBackground=h.scene.make.image({key:i,frame:"input_bg"}),h.mBackground.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.mReduceBtn=h.scene.make.image({key:i,frame:"reduce"},!1).setInteractive(),h.mReduceBtn.x=-h.mBackground.displayWidth/2-h.mReduceBtn.displayWidth/2-7*o,h.mReduceBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.mIncreaseBtn=h.scene.make.image({key:i,frame:"increase"},!1).setInteractive(),h.mIncreaseBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.mIncreaseBtn.x=(h.mBackground.displayWidth+h.mIncreaseBtn.displayWidth)/2+7*o,h.mLabelInput=new s.LabelInput(h.scene,{x:0,y:0,width:h.mBackground.height,height:26*o,fontSize:14*o+"px",color:"#666666",align:"center",type:"number"}),h.mLabelInput.setOrigin(.5),h.mLabelInput.setText("1"),h.mLabelInput.on("textchange",h.onTextChangeHandler,h),h.mLabelInput.on("blur",h.onTextBlurHandler,h),h.mLabelInput.on("focus",h.onFocusHandler,h),h.add([h.mBackground,h.mLabelInput,h.mReduceBtn,h.mIncreaseBtn]),h.setSize(h.mIncreaseBtn.displayWidth+h.mReduceBtn.displayWidth+h.mBackground.displayWidth+14*o,h.mBackground.displayHeight),h}return r(NumberCounter,t),NumberCounter.prototype.resize=function(){},NumberCounter.prototype.setMinNumber=function(t){this.mMinNum=t},NumberCounter.prototype.setMaxNumber=function(t){this.mMaxNum=t},NumberCounter.prototype.addActionListener=function(){this.mIncreaseBtn.on("pointerup",this.onIncreaseHandler,this),this.mIncreaseBtn.on("pointerdown",this.onIncreaseDownHandler,this),this.mReduceBtn.on("pointerup",this.onReduceHandler,this),this.mReduceBtn.on("pointerdown",this.onReduceDownHandler,this)},NumberCounter.prototype.removeActionListener=function(){this.mIncreaseBtn.off("pointerup",this.onIncreaseHandler,this),this.mIncreaseBtn.off("pointerdown",this.onIncreaseDownHandler,this),this.mReduceBtn.off("pointerup",this.onReduceHandler,this),this.mReduceBtn.off("pointerdown",this.onReduceDownHandler,this),this.scene&&this.scene.input.off("pointerdown",this.pointerDownHandler,this)},NumberCounter.prototype.setCounter=function(t){(isNaN(t)||t<0)&&(t=0),t>this.mMaxNum&&(t=this.mMaxNum),this.mLabelInput.setText(t.toString()),this.emit("change",t)},NumberCounter.prototype.setBlur=function(){this.mLabelInput.setBlur()},NumberCounter.prototype.destroy=function(){this.removeActionListener(),t.prototype.destroy.call(this)},Object.defineProperty(NumberCounter.prototype,"number",{get:function(){return parseInt(this.mLabelInput.text,10)},enumerable:!1,configurable:!0}),NumberCounter.prototype.onReduceHandler=function(){var t=parseInt(this.mLabelInput.text,10);--t<this.mMinNum&&(t=this.mMinNum),this.setCounter(t),this.clearTween()},NumberCounter.prototype.onIncreaseHandler=function(){var t=parseInt(this.mLabelInput.text,10);this.setCounter(++t),this.clearTween()},NumberCounter.prototype.onTextChangeHandler=function(){this.setCounter(parseInt(this.mLabelInput.text,10))},NumberCounter.prototype.onTextBlurHandler=function(){var t=parseInt(this.mLabelInput.text,0);t<this.mMinNum?t=this.mMinNum:t>this.mMaxNum&&(t=this.mMaxNum),this.mLabelInput.setText(t.toString()),this.emit("change",t)},NumberCounter.prototype.onReduceDownHandler=function(){var t=this;this.pressTimeout=setTimeout((function(){t.delayTweenNumber(t.mMinNum)}),this.pressDelay),this.setBlur()},NumberCounter.prototype.onIncreaseDownHandler=function(){var t=this;this.pressTimeout=setTimeout((function(){t.delayTweenNumber(t.mMaxNum)}),this.pressDelay),this.setBlur()},NumberCounter.prototype.delayTweenNumber=function(t){var e=this,i=this.number;this.tween=this.scene.tweens.addCounter({from:i,to:t,onUpdate:function(){e.setCounter(e.tween.getValue()>>0)},duration:50*Math.abs(i-t)})},NumberCounter.prototype.clearTween=function(){clearTimeout(this.pressTimeout),this.tween&&(this.tween.stop(),this.tween=void 0)},NumberCounter.prototype.pointerDownHandler=function(t){this.checkPointerInBounds(this,t)||(this.mLabelInput.setBlur(),this.scene.input.off("pointerdown",this.pointerDownHandler,this))},NumberCounter.prototype.onFocusHandler=function(){this.scene.input.on("pointerdown",this.pointerDownHandler,this)},NumberCounter.prototype.checkPointerInBounds=function(t,e,i){void 0===i&&(i=!1),this.mRectangle||(this.mRectangle=new Phaser.Geom.Rectangle(0,0,0,0));var n=this.zoom?this.zoom:1;if(this.mRectangle.left=-t.width/2,this.mRectangle.right=t.width/2,this.mRectangle.top=-t.height/2,this.mRectangle.bottom=t.height/2,e){var s=t.getWorldTransformMatrix(),r=(e.x-s.tx)/n,o=(e.y-s.ty)/n;return this.mRectangle.left<=r&&this.mRectangle.right>=r&&this.mRectangle.top<=o&&this.mRectangle.bottom>=o}return!1},NumberCounter}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"MarketItem",(function(){return h}));var n,s=i(470),r=i(1),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function MarketItem(e,i,n,a,h){var l=t.call(this,e,i,n)||this;l.zoom=1,l.dpr=a,l.zoom=h,l.mBackground=l.scene.make.image({key:r.ModuleName.PICAMARKET_NAME,frame:"border"},!1).setOrigin(0),l.mBackground.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.mBorder=l.scene.make.image({x:3*a,y:3*a,key:r.ModuleName.PICAMARKET_NAME,frame:"item_border"},!1).setOrigin(0),l.mBorder.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.mPropImage=new s.DynamicImage(e,0,0),l.mPropImage.scale=l.dpr/l.zoom,l.mNickName=l.scene.make.text({x:62*l.dpr,y:6*l.dpr,style:{fontSize:13*l.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#3399cc"}},!1),l.mCoinIcon=l.scene.make.image({x:45*l.dpr,y:40*l.dpr,key:r.ModuleName.PICAMARKET_NAME},!1).setOrigin(0);var c=l.scene.make.image({x:62*l.dpr,y:39*l.dpr,key:r.ModuleName.PICAMARKET_NAME,frame:"price_border"},!1).setOrigin(0);return l.mPriceText=l.scene.make.text({x:92*l.dpr,y:49*l.dpr,style:{fontSize:13*l.dpr,fontFamily:o.Font.NUMBER,color:"#996600"}}).setOrigin(.5),l.mTagIcon=l.scene.make.image({key:r.ModuleName.PICAMARKET_NAME,frame:"tip_red",x:-86*l.dpr,y:-34*l.dpr},!1).setOrigin(0),l.add([l.mBackground,l.mBorder,l.mPropImage,l.mNickName,c,l.mCoinIcon,l.mPriceText]),l.setSize(l.mBackground.displayWidth,l.mBackground.displayHeight),l}return a(MarketItem,t),MarketItem.prototype.setProp=function(t){if(this.mProp=t,t.icon){var e=o.Url.getOsdRes(t.icon);this.mPropImage.load(e,this,this.onPropLoadComplete)}else o.Logger.getInstance().error(t.name+" : "+t.id+" icon value is empty");this.mPropImage.x=this.mBorder.x+this.mBorder.displayWidth/2,this.mPropImage.y=this.mBorder.y+this.mBorder.displayHeight/2;var i=t.shortName||t.name;if(i.length>4)for(var n=50*this.dpr,s=4;s<i.length;s++){var r=i.slice(0,s);if(this.mNickName.setText(r).width>n){i=r+="...";break}}this.mNickName.setText(i),this.mPriceText.setText(t.price[0].price.toString());var a=o.Coin.getIcon(t.price[0].coinType);this.mCoinIcon.setFrame(a)},MarketItem.prototype.onPropLoadComplete=function(){if(this.mPropImage){var t=this.mPropImage.texture;t&&t.setFilter(Phaser.Textures.FilterMode.LINEAR)}},MarketItem.prototype.onPointerUpHandler=function(){this.emit("select",this.mProp)},MarketItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNewActivityPanel",(function(){return a}));var n,s=i(5),r=i(11),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),a=function(t){function PicaNewActivityPanel(e,i,n,s,r){var o=t.call(this,e)||this;return o.listPosY=[],o.isFold=!1,o.setSize(i,n),o.dpr=r,o.key=s,o.init(),o}return o(PicaNewActivityPanel,t),PicaNewActivityPanel.prototype.init=function(){var t=new s.Button(this.scene,r.d.iconcommon,"home_activity","home_activity");t.y=.5*-this.height+.5*t.height,this.activityButton=t,this.activityButton.on(s.ClickEvent.Tap,this.onActivityHandler,this);var e=new s.Button(this.scene,r.d.iconcommon,"home_indent","home_indent");e.y=t.y+.5*t.height+15*this.dpr+.5*e.height,this.indentButton=e,this.indentButton.on(s.ClickEvent.Tap,this.onIndentHandler,this);var i=new s.Button(this.scene,r.d.iconcommon,"home_recharge","home_recharge");i.y=e.y+.5*e.height+15*this.dpr+.5*i.height,this.rechargeButton=i,this.rechargeButton.on(s.ClickEvent.Tap,this.onRechargeHandler,this);var n=new s.Button(this.scene,r.d.iconcommon,"home_email","home_email");n.y=i.y+.5*i.height+15*this.dpr+.5*n.height,this.emailButton=n,this.emailButton.on(s.ClickEvent.Tap,this.onEmailHandler,this),this.roamButton=new s.Button(this.scene,r.d.iconcommon,"home_roam","home_roam"),this.roamButton.y=t.y,this.roamButton.x=t.x-.5*this.roamButton.width-.5*t.width-15*this.dpr,this.roamButton.on(s.ClickEvent.Tap,this.onRoamHandler,this),this.arrowButton=new s.Button(this.scene,r.d.uicommon,"home_more_2","home_more_2"),this.arrowButton.y=n.y+.5*n.height+10*this.dpr+.5*this.arrowButton.height,this.arrowButton.on(s.ClickEvent.Tap,this.onArrowHandler,this),this.listBtns=[t,e,i,n],this.listBtns2=[this.roamButton],this.listPosY=[t.y,e.y,i.y,n.y],this.add(this.listBtns),this.add(this.listBtns2),this.add(this.arrowButton)},PicaNewActivityPanel.prototype.addListen=function(){this.indentButton.on(s.ClickEvent.Tap,this.onIndentHandler,this),this.rechargeButton.on(s.ClickEvent.Tap,this.onRechargeHandler,this),this.emailButton.on(s.ClickEvent.Tap,this.onEmailHandler,this)},PicaNewActivityPanel.prototype.removeListen=function(){this.indentButton.off(s.ClickEvent.Tap,this.onIndentHandler,this),this.rechargeButton.off(s.ClickEvent.Tap,this.onRechargeHandler,this),this.emailButton.off(s.ClickEvent.Tap,this.onEmailHandler,this)},PicaNewActivityPanel.prototype.setHandler=function(t){this.sendHandler=t},PicaNewActivityPanel.prototype.onActivityHandler=function(){this.sendHandler&&this.sendHandler.runWith(["activity"])},PicaNewActivityPanel.prototype.onIndentHandler=function(){this.sendHandler&&this.sendHandler.runWith(["indent"])},PicaNewActivityPanel.prototype.onRechargeHandler=function(){this.sendHandler&&this.sendHandler.runWith(["recharge"])},PicaNewActivityPanel.prototype.onEmailHandler=function(){this.sendHandler&&this.sendHandler.runWith(["email"])},PicaNewActivityPanel.prototype.onRoamHandler=function(){this.sendHandler&&this.sendHandler.runWith(["roam"])},PicaNewActivityPanel.prototype.onArrowHandler=function(){this.isFold=!this.isFold,this.isFold?this.foldButtons():this.unfoldButtons()},PicaNewActivityPanel.prototype.foldButtons=function(){var t=this,e=this.listPosY[this.listPosY.length-1],i=this.listPosY[0],n=this.scene.tweens.addCounter({from:e,to:i,ease:"Linear",duration:150,onUpdate:function(e,i){t.updateAllButtons(i.value)},onComplete:function(){n.stop(),n.remove(),t.arrowButton.setFrameNormal("home_more_1"),t.removeListen()}})},PicaNewActivityPanel.prototype.unfoldButtons=function(){var t=this,e=this.listPosY[0],i=this.listPosY[this.listPosY.length-1],n=this.scene.tweens.addCounter({from:e,to:i,ease:"Linear",duration:150,onUpdate:function(e,i){t.updateAllButtons(i.value)},onComplete:function(){n.stop(),n.remove(),t.arrowButton.setFrameNormal("home_more_2"),t.addListen()}})},PicaNewActivityPanel.prototype.updateAllButtons=function(t){this.updateButtons(t,this.listBtns),this.updateButtons(t,this.listBtns2);var e=this.listBtns[this.listBtns.length-1];this.arrowButton.y=e.y+.5*e.height+10*this.dpr+.5*this.arrowButton.height,e.y===this.listPosY[0]?this.listBtns2[0].visible=!1:this.listBtns2[0].visible=!0},PicaNewActivityPanel.prototype.updateButtons=function(t,e){for(var i=this.listPosY[0],n=this.listPosY[this.listPosY.length-1]-t,s=1;s<e.length;s++){var r=e[s],o=this.listPosY[s]-n;r.y=o;var a=this.listPosY[s];o>a&&(o=a),o<i&&(o=i);var h=(o-i)/(.5*r.height);h=(h=h<0?0:h)>1?1:h,r.alpha=h,r.y=o}},PicaNewActivityPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNewChatPanel",(function(){return r}));var n,s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),r=function(t){function PicaNewChatPanel(e,i,n,s,r){var o=t.call(this,e)||this;return o.setSize(i,n),o.dpr=r,o.key=s,o}return s(PicaNewChatPanel,t),PicaNewChatPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNewHeadPanel",(function(){return l}));var n,s=i(5),r=i(470),o=i(11),a=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaNewHeadPanel(e,i,n,s,r){var o=t.call(this,e)||this;return o.money=0,o.diamond=0,o.praise=!1,o.isself=!1,o.setSize(i,n),o.dpr=r,o.key=s,o.init(),o}return h(PicaNewHeadPanel,t),PicaNewHeadPanel.prototype.init=function(){this.headCon=this.scene.make.container(void 0,!1),this.moneyCon=this.scene.make.container(void 0,!1),this.sceneCon=this.scene.make.container(void 0,!1),this.add([this.headCon,this.sceneCon]);var t=this.scene.make.image({x:0,y:0,key:o.d.iconcommon,frame:"home_head_bg"},!1),e=new r.ButtonEventDispatcher(this.scene,0,0);e.setSize(40*this.dpr,40*this.dpr),e.enable=!0,e.on(s.ClickEvent.Tap,this.onHeadHandler,this);var i=this.scene.make.image({x:0,y:10*this.dpr,key:o.d.iconcommon,frame:"home_vip_mark"},!1);this.levelTex=this.scene.make.text({x:0,y:0,text:"",style:{color:"#0089D3",fontSize:14*this.dpr,fontFamily:a.Font.NUMBER}}).setStroke("#ffffff",2*this.dpr).setFontStyle("bold").setOrigin(.5),this.powerPro=new r.ProgressMaskBar(this.scene,o.d.uicommon,"home_progress_bottom","strength_progress",void 0,{width:41*this.dpr,height:11*this.dpr,left:4*this.dpr,right:4*this.dpr,top:0,bottom:0}),this.powerPro.x=0,this.powerPro.y=.5*t.height+.5*this.powerPro.height-4*this.dpr,this.powerTex=new r.ImageValue(this.scene,43*this.dpr,15*this.dpr,o.d.uicommon,"strength_icon",this.dpr,{color:"#ffffff",fontSize:8*this.dpr,fontFamily:a.Font.NUMBER}),this.powerTex.y=this.powerPro.y,this.powerTex.x=-2*this.dpr,this.powerTex.setFontStyle("bold"),this.powerTex.setStroke("#000000",2*this.dpr),this.powerTex.setOffset(-4*this.dpr,0),this.powerTex.setLayout(2),this.powerTex.setText(""),this.powerAddBtn=new s.Button(this.scene,o.d.uicommon,"add_btn","add_btn"),this.powerAddBtn.x=this.powerPro.x+.5*this.powerPro.width+7*this.dpr,this.powerAddBtn.y=this.powerPro.y,this.powerAddBtn.on(s.ClickEvent.Tap,this.onEnergyHandler,this),this.headCon.add([this.powerPro,t,i,this.levelTex,e,this.powerTex,this.powerAddBtn]),this.headCon.x=.5*-this.width+33*this.dpr,this.headCon.y=-2*this.dpr;var n=new s.NineSlicePatch(this.scene,0,-this.dpr,190*this.dpr,28*this.dpr,o.d.uicommon,"home_assets_bg",{left:17*this.dpr,top:0*this.dpr,right:17*this.dpr,bottom:0*this.dpr});n.x=.5*-n.width;var h=this.scene.make.image({x:n.x,y:0,key:o.d.uicommon,frame:"home_assets_division"},!1);this.moneyvalue=new r.ImageValue(this.scene,60*this.dpr,26*this.dpr,o.d.uicommon,"home_silver",this.dpr,{color:"#ffffff",fontSize:15*this.dpr,fontFamily:a.Font.NUMBER}),this.moneyvalue.setLayout(1),this.moneyvalue.x=n.x-.5*n.width+22*this.dpr,this.diamondvalue=new r.ImageValue(this.scene,60*this.dpr,26*this.dpr,o.d.uicommon,"home_diamond",this.dpr,{color:"#ffffff",fontSize:15*this.dpr,fontFamily:a.Font.NUMBER}),this.diamondvalue.setLayout(1),this.diamondvalue.x=n.x+22*this.dpr,this.moneyAddBtn=new s.Button(this.scene,o.d.uicommon,"home_praise_bg","home_praise_bg");var l=this.scene.make.image({x:0,y:0,key:o.d.uicommon,frame:"home_assets_add"},!1);this.moneyAddBtn.add(l),this.moneyAddBtn.x=.5*-this.moneyAddBtn.width-4*this.dpr,this.moneyAddBtn.on(s.ClickEvent.Tap,this.onRechargeHandler,this),this.moneyCon.add([n,h,this.moneyvalue,this.diamondvalue,this.moneyAddBtn]),this.moneyCon.x=.5*this.width-10*this.dpr,this.moneyCon.y=-5*this.dpr;var c=this.scene.make.image({x:0,y:0,key:o.d.uicommon,frame:"home_persons_bg"},!1);c.x=.5*-c.width,this.peoplebg=c,this.peoplevalue=new r.ImageValue(this.scene,45*this.dpr,27*this.dpr,o.d.uicommon,"home_persons",this.dpr,{color:"#ffffff",fontSize:12*this.dpr,fontFamily:a.Font.DEFULT_FONT}),this.peoplevalue.setLayout(2),this.peoplevalue.setText("0"),this.peoplevalue.x=c.x-2*this.dpr;var p=new r.ButtonEventDispatcher(this.scene,0,0);p.setSize(40*this.dpr,40*this.dpr),p.enable=!0,p.on(s.ClickEvent.Tap,this.onOpenOnlineHandler,this),p.x=this.peoplevalue.x;var d=new s.NineSlicePatch(this.scene,0,-this.dpr,50*this.dpr,27*this.dpr,o.d.uicommon,"home_mapname_bg",{left:16*this.dpr,top:0*this.dpr,right:16*this.dpr,bottom:0*this.dpr},this.dpr,this.scale,0);d.x=-c.width-15*this.dpr-.5*d.width,this.sceneTex=this.scene.make.text({x:d.x-10*this.dpr,y:0,text:"",style:{color:"#FFF449",fontSize:11*this.dpr,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(.5),this.praisebg=d,this.praiseButton=new s.Button(this.scene,o.d.uicommon,"home_praise_bg","home_praise_bg"),this.praiseImg=this.scene.make.image({x:0,y:0,key:o.d.uicommon,frame:"home_praise"},!1),this.praiseButton.add(this.praiseImg),this.praiseButton.x=-c.width-29*this.dpr,this.praiseButton.y=0,this.praiseButton.visible=!1;var m=new r.ButtonEventDispatcher(this.scene,0,0);m.setSize(100*this.dpr,30*this.dpr),m.enable=!0,m.on(s.ClickEvent.Tap,this.onOpenHouseHandler,this),m.x=d.x,this.sceneCon.add([c,this.peoplevalue,p,d,this.sceneTex,m,this.praiseButton]),this.sceneCon.x=.5*this.width-10*this.dpr,this.sceneCon.y=-5*this.dpr},PicaNewHeadPanel.prototype.setHeadData=function(t,e,i,n){t&&(this.levelTex.text=t.value+""),e&&(this.powerTex.setText(e.value+"/"+e.max),this.powerPro.setProgress(e.value,e.max)),i=i||0,this.moneyvalue.setText(i+""),n=n||0,this.diamondvalue.setText(n+""),this.money===i&&this.diamond===n||this.moveMoneyCon(),this.money=i,this.diamond=n},PicaNewHeadPanel.prototype.setSceneData=function(t,e,i,n,r){var o;(void 0===r&&(r=!1),this.sceneTex.text=t,this.praise=e,this.isself=r,this.peoplevalue.setText(i+""),this.praiseButton.off(s.ClickEvent.Tap,this.onPraiseHandler,this),this.canPraise(n))?(this.praiseButton.visible=!0,this.praiseButton.on(s.ClickEvent.Tap,this.onPraiseHandler,this),r?this.praiseImg.setFrame("home_set"):this.praiseImg.setFrame(e?"home_praise_1":"home_praise"),o=(o=this.sceneTex.width+40*this.dpr)<60*this.dpr?60*this.dpr:o,this.praisebg.resize(o,25*this.dpr),this.praisebg.x=-this.peoplebg.width-15*this.dpr-.5*this.praisebg.width,this.sceneTex.x=this.praisebg.x-11*this.dpr):(o=(o=this.sceneTex.width+20*this.dpr)<40*this.dpr?40*this.dpr:o,this.praisebg.resize(o,25*this.dpr),this.praiseButton.visible=!1,this.praisebg.x=-this.peoplebg.width-15*this.dpr-.5*this.praisebg.width,this.sceneTex.x=this.praisebg.x)},PicaNewHeadPanel.prototype.setHandler=function(t){this.sendHandler=t},PicaNewHeadPanel.prototype.onHeadHandler=function(){this.sendHandler&&this.sendHandler.runWith(["head"])},PicaNewHeadPanel.prototype.onEnergyHandler=function(){this.sendHandler&&this.sendHandler.runWith(["energy"])},PicaNewHeadPanel.prototype.onPraiseHandler=function(){this.isself?this.sendHandler&&this.sendHandler.runWith(["party"]):this.sendHandler&&this.sendHandler.runWith(["praise",!this.praise])},PicaNewHeadPanel.prototype.onRechargeHandler=function(){this.sendHandler&&this.sendHandler.runWith(["recharge"])},PicaNewHeadPanel.prototype.onOpenHouseHandler=function(){this.sendHandler&&this.sendHandler.runWith(["room"])},PicaNewHeadPanel.prototype.onOpenOnlineHandler=function(){this.sendHandler&&this.sendHandler.runWith("online")},PicaNewHeadPanel.prototype.moveMoneyCon=function(){var t=this;if(this.scene){var e=this.width+190*this.dpr,i=.5*this.width-10*this.dpr;this.moneyCon.x=e,this.moneyCon.alpha=1,this.add(this.moneyCon),this.clearTween(),this.moneyTween=this.scene.tweens.add({targets:this.moneyCon,x:{from:e,to:i},ease:"Linear",duration:600,onComplete:function(){t.clearTween(),t.fadeOutHeadCon()}})}},PicaNewHeadPanel.prototype.fadeOutHeadCon=function(){var t=this;this.scene&&(this.moneyTween=this.scene.tweens.add({targets:this.moneyCon,alpha:{from:1,to:.2},ease:"Linear",duration:150,delay:3e3,onComplete:function(){t.clearTween(),t.remove(t.moneyCon)}}))},PicaNewHeadPanel.prototype.canPraise=function(t){return"room"===t||"store"===t},PicaNewHeadPanel.prototype.clearTween=function(){this.moneyTween&&(this.moneyTween.stop(),this.moneyTween.remove(),this.moneyTween=void 0)},PicaNewHeadPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNewLeftPanel",(function(){return a}));var n,s=i(5),r=i(11),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),a=function(t){function PicaNewLeftPanel(e,i,n,s,r){var o=t.call(this,e)||this;return o.setSize(i,n),o.dpr=r,o.key=s,o.init(),o}return o(PicaNewLeftPanel,t),PicaNewLeftPanel.prototype.init=function(){var t=new s.Button(this.scene,r.d.iconcommon,"home_map","home_map");t.y=.5*-this.height+.5*t.height,t.on(s.ClickEvent.Tap,this.onMapButtonHandler,this);var e=new s.Button(this.scene,r.d.iconcommon,"home_task","home_task");e.y=t.y+.5*t.height+20*this.dpr+.5*e.height,e.on(s.ClickEvent.Tap,this.onTaskButtonHandler,this),this.add([t,e])},PicaNewLeftPanel.prototype.setHandler=function(t){this.sendHandler=t},PicaNewLeftPanel.prototype.onMapButtonHandler=function(){this.sendHandler&&this.sendHandler.runWith(["maphome"])},PicaNewLeftPanel.prototype.onTaskButtonHandler=function(){this.sendHandler&&this.sendHandler.runWith(["task"])},PicaNewLeftPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaOpenPartyCreatePanel",(function(){return c}));var n,s=i(5),r=i(470),o=i(0),a=i(11),h=i(1),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaOpenPartyCreatePanel(e,i,n,s,r,o,a,h){var l=t.call(this,e.scene,i,n)||this;return l.uiManager=e,l.itemCount=0,l.expiredTime=0,l.key=o,l.dpr=a,l.render=e.render,l.zoom=h,l.setSize(s,r),l.create(),l}return l(PicaOpenPartyCreatePanel,t),PicaOpenPartyCreatePanel.prototype.resize=function(){this.gamegride&&this.gamegride.resetMask()},PicaOpenPartyCreatePanel.prototype.hide=function(){this.visible=!1,this.changeInputState(!1)},PicaOpenPartyCreatePanel.prototype.show=function(){this.visible=!0,this.changeInputState(!0)},PicaOpenPartyCreatePanel.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.timer&&this.timer.clear()},PicaOpenPartyCreatePanel.prototype.setPartyData=function(t,e,i){this.partyData=t,this.setPartyInfoType(!t.created);var n,s=t.ticketsCount,r=t.topics;if(this.timeSlider.setValue(0,0,1),this.partyTimevalue.text="x"+s,t.created?(this.mNameInput.text=t.name,this.describleInput.text=t.des,this.setExpiredValue(t.expired,i)):(this.mNameInput.text=o.i18n.t("party.defaultname",{name:e}),this.describleInput.text=o.i18n.t("party.describletitle")),this.gamegride.setItems(r),t.created){for(var a=t.topics,h=0,l=0,c=a;l<c.length;l++){var p=c[l];if(p.key===t.topic.key){n=p;break}h++}this.gamegride.setT(h/a.length),n=this.gamegride.getCell(h)}else n=this.gamegride.getCell(0);n&&n.container&&this.onGridTableHandler(n.container)},PicaOpenPartyCreatePanel.prototype.setExpiredValue=function(t,e){var i=this;this.expiredTime=t;var n=t-e;n<0?this.timer&&this.timer.clear():(this.timer||(this.timer=new h.TimerCountDown(new o.Handler(this,(function(t,e){i.overageValue.text=e,t<=0&&i.emit("querytheme")})))),this.timer.execute(n))},PicaOpenPartyCreatePanel.prototype.setPartyInfoType=function(t){t?(this.partyNameTitle.text="[b]"+o.i18n.t("party.partyname")+"[/b]",this.partyThemeTitle.text="[b]"+o.i18n.t("party.partytheme")+"[/b]",this.describleTitle.text="[b]"+o.i18n.t("party.partydescrible")+"[/b]",this.partyTimeTitle.text="[b]"+o.i18n.t("party.partytime")+"[/b]",this.overageTitle.visible=!1,this.overageValue.visible=!1,this.partyTimeTitle.y=this.describleTitle.y+70*this.dpr,this.timeSlider.y=this.partyTimeTitle.y,this.openBtn.setText(o.i18n.t("party.partyopen"))):(this.partyNameTitle.text="[b]"+o.i18n.t("party.modifyname")+"[/b]",this.partyThemeTitle.text="[b]"+o.i18n.t("party.modifytheme")+"[/b]",this.describleTitle.text="[b]"+o.i18n.t("party.modifydescrible")+"[/b]",this.partyTimeTitle.text="[b]"+o.i18n.t("party.suppletime")+"[/b]",this.overageTitle.visible=!0,this.overageValue.visible=!0,this.partyTimeTitle.y=this.overageValue.y+45*this.dpr,this.timeSlider.y=this.partyTimeTitle.y,this.openBtn.setText(o.i18n.t("common.confirm"))),this.partyTimeLable.y=this.partyTimeTitle.y+34*this.dpr,this.partyCardImage.y=this.partyTimeLable.y,this.partyTimevalue.y=this.partyTimeLable.y},PicaOpenPartyCreatePanel.prototype.changeInputState=function(t){this.describleInput.visible=t,this.describleInput.node.style.display=t?"true":"none",this.mNameInput.visible=t,this.mNameInput.node.style.display=t?"true":"none",t?this.openBtn.on(String(s.ClickEvent.Tap),this.onOpenPartyHandler,this):this.openBtn.off(String(s.ClickEvent.Tap),this.onOpenPartyHandler,this)},PicaOpenPartyCreatePanel.prototype.create=function(){var t=this;this.partyNameTitle=new s.BBCodeText(this.scene,.5*-this.width+10*this.dpr,.5*-this.height+10*this.dpr,o.i18n.t("party.partyname"),{fontFamily:o.Font.DEFULT_FONT,fontSize:11*this.dpr,color:"#000000"}),this.partyNameTitle.setOrigin(0,.5).setResolution(this.dpr),this.add(this.partyNameTitle),this.mNameInput=this.createInput(this.partyNameTitle.x+this.partyNameTitle.width+13*this.dpr,this.partyNameTitle.y,190*this.dpr,37*this.dpr,13*this.dpr),this.mNameInput.on("textchange",this.onTextChangeHandler,this),this.partyThemeTitle=new s.BBCodeText(this.scene,this.partyNameTitle.x,this.partyNameTitle.y+65*this.dpr,o.i18n.t("party.partytheme"),{fontFamily:o.Font.DEFULT_FONT,fontSize:11*this.dpr,color:"#000000"}),this.partyThemeTitle.setOrigin(0,.5).setResolution(this.dpr),this.add(this.partyThemeTitle);var e={x:30*this.dpr,y:this.partyThemeTitle.y+7*this.dpr,table:{width:200*this.dpr,height:90*this.dpr,columns:1,cellWidth:70*this.dpr,cellHeight:70*this.dpr,reuseCellContainer:!0,zoom:this.zoom,padding:{left:-10*this.dpr}},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(e,i){var n=e.item;return null===i&&(i=new p(t.scene,65*t.dpr,70*t.dpr,t.key,t.dpr)),i.setThemeData(n),t.curPartyData&&t.curPartyData.key===n.key&&(i.select=!0,t.curSelectItem=i),i}};this.gamegride=new s.GameGridTable(this.scene,e),this.gamegride.layout(),this.gamegride.on("cellTap",this.onGridTableHandler,this),this.add(this.gamegride),this.describleTitle=new s.BBCodeText(this.scene,this.partyThemeTitle.x,this.partyThemeTitle.y+80*this.dpr,o.i18n.t("party.partydescrible"),{fontFamily:o.Font.DEFULT_FONT,fontSize:11*this.dpr,color:"#000000"}),this.describleTitle.setOrigin(0,.5).setResolution(this.dpr),this.add(this.describleTitle),this.describleInput=this.createInput(this.describleTitle.x+this.describleTitle.width+13*this.dpr,this.describleTitle.y+10*this.dpr,190*this.dpr,52*this.dpr,12*this.dpr,"textarea"),this.overageTitle=new s.BBCodeText(this.scene,this.describleTitle.x,this.describleTitle.y+65*this.dpr,"[b]"+o.i18n.t("party.overagetime")+"[/b]",{fontFamily:o.Font.DEFULT_FONT,fontSize:11*this.dpr,color:"#000000"}),this.overageTitle.setOrigin(0,.5).setResolution(this.dpr),this.add(this.overageTitle),this.overageValue=this.scene.make.text({x:this.overageTitle.x+this.overageTitle.width+30*this.dpr,y:this.overageTitle.y,text:"",style:{fontFamily:o.Font.DEFULT_FONT,fontSize:11*this.dpr,color:"#333333"}}),this.overageValue.setOrigin(0,.5).setResolution(this.dpr),this.add(this.overageValue),this.partyTimeTitle=new s.BBCodeText(this.scene,this.overageTitle.x,this.overageTitle.y+50*this.dpr,o.i18n.t("party.partytime"),{fontFamily:o.Font.DEFULT_FONT,fontSize:11*this.dpr,color:"#000000"}),this.partyTimeTitle.setOrigin(0,.5).setResolution(this.dpr),this.add(this.partyTimeTitle);var i=190*this.dpr,n=4*this.dpr,h=this.partyTimeTitle.x+this.partyTimeTitle.width+10*this.dpr+.5*i;this.createSlider(h,this.partyTimeTitle.y,i,n),this.partyTimeLable=new s.BBCodeText(this.scene,this.partyTimeTitle.x+50*this.dpr,this.partyTimeTitle.y+40*this.dpr,o.i18n.t("party.partycardlabel"),{fontFamily:o.Font.DEFULT_FONT,fontSize:11*this.dpr,color:"#000000"}),this.partyTimeLable.setOrigin(0,.5).setResolution(this.dpr),this.partyTimeLable.x=.5*-this.partyTimeLable.width-20*this.dpr,this.add(this.partyTimeLable),this.partyCardImage=new r.DynamicImage(this.scene,0,this.partyTimeLable.y),this.partyCardImage.setTexture(this.key,"party_card"),this.partyCardImage.x=this.partyTimeLable.x+this.partyTimeLable.width+.5*this.partyCardImage.width,this.add(this.partyCardImage),this.partyTimevalue=this.scene.make.text({x:this.partyCardImage.x+.5*this.partyCardImage.width+2*this.dpr,y:this.partyCardImage.y,text:"",style:{fontFamily:o.Font.DEFULT_FONT,fontSize:14*this.dpr,color:"#000000"}}),this.partyTimevalue.setOrigin(0,.5).setResolution(this.dpr),this.partyTimevalue.setStroke("#000000",2),this.add(this.partyTimevalue),this.openBtn=new s.NineSliceButton(this.scene,0,.5*this.height+2*this.dpr,100*this.dpr,33*this.dpr,a.c.commonKey,"yellow_btn_normal",o.i18n.t("party.partyopen"),this.dpr,this.scale,{left:14*this.dpr,top:0*this.dpr,right:14*this.dpr,bottom:0*this.dpr}),this.openBtn.setTextStyle({color:"#996600",fontSize:13*this.dpr,fontFamily:o.Font.DEFULT_FONT}),this.openBtn.setFontStyle("bold"),this.add(this.openBtn)},PicaOpenPartyCreatePanel.prototype.createSlider=function(t,e,i,n){var r=new s.NineSlicePatch(this.scene,0,0,8,7*this.dpr,a.c.common2Key,"slider_bg",{left:3,top:1,right:3,bottom:1}),h=new s.NineSlicePatch(this.scene,0,0,8,7*this.dpr,a.c.common2Key,"slider_rate",{left:3,top:1,right:3,bottom:1});this.thumb=this.scene.make.image({key:a.c.common2Key,frame:"block"}),this.thumb.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.itemCountText=this.scene.make.text({x:0,y:0,style:{color:"#744803",fontSize:12*this.dpr,fontFamily:o.Font.DEFULT_FONT}},!1).setFontStyle("bold").setOrigin(.5),this.timeSlider=new s.GameSlider(this.scene,{x:t,y:e,width:i,height:n,orientation:1,background:r,indicator:h,thumb:this.thumb,offsetX:.5*this.thumb.width,valuechangeCallback:this.onSliderValueHandler,valuechangeCallbackScope:this,value:.5}),this.timeSlider.add(this.itemCountText),this.timeSlider.setValue(0),this.add(this.timeSlider)},PicaOpenPartyCreatePanel.prototype.onSliderValueHandler=function(t){var e=this.partyData?this.partyData.ticketsCount:0;this.itemCountText.x=this.thumb.x,this.itemCount=Math.ceil(t*e),this.itemCount>e&&(this.itemCount=e),this.itemCountText.text=this.itemCount+""},PicaOpenPartyCreatePanel.prototype.onTextChangeHandler=function(){var t=170*this.dpr;this.mNameInput.text.length;this.mNameInput.text=o.UIHelper.spliceText(t,this.mNameInput.text,13*this.dpr,this.scene)},PicaOpenPartyCreatePanel.prototype.onOpenPartyHandler=function(){var t=this;if(this.curPartyData){var e=this.curPartyData.key,i=this.mNameInput.text,n=this.describleInput.text,s=this.itemCount,a=this.partyData.created;s>0?(this.describleInput.node.style.display="none",this.describleInput.visible=!1,new r.AlertView(this.uiManager).show({title:o.i18n.t("main_ui.party"),text:a?o.i18n.t("party.modifyconfirm",{count:s}):o.i18n.t("party.openconfirm",{count:s}),oy:302*this.dpr*this.render.uiScale,callback:function(){t.emit("openparty",e,i,n,s,a)},cancelback:function(){t.describleInput.node.style.display="true",t.describleInput.visible=!0}})):a?this.emit("openparty",e,i,n,s,a):this.emit("showtips","PicaNotice",o.i18n.t("party.ticketinsuff"))}},PicaOpenPartyCreatePanel.prototype.onGridTableHandler=function(t){this.curSelectItem&&(this.curSelectItem.select=!1),t.select=!0,this.curPartyData=t.partyData,this.curSelectItem=t},PicaOpenPartyCreatePanel.prototype.createInput=function(t,e,i,n,r,a){void 0===a&&(a="text");var h=this.scene.make.graphics(void 0,!1);h.fillStyle(10809331,.66),h.fillRoundedRect(0,.5*-n,i,n,6*this.dpr),h.setPosition(t,e),this.add(h);var l=new s.InputText(this.scene,t+.5*i+8*this.dpr,e,i,n-10*this.dpr,{type:a,placeholder:o.i18n.t("party.partydescrible"),color:"#055C62",fontSize:r+"px"});return this.add(l),l},PicaOpenPartyCreatePanel}(Phaser.GameObjects.Container),p=function(t){function PicPartyThemeItem(e,i,n,s,a){var h=t.call(this,e)||this;return h.dpr=a,h.setSize(i,n),h.selectbg=h.scene.make.image({key:s,frame:"party_selected_bg"}),h.selectbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.icon=new r.DynamicImage(e,0,0),h.icon.setTexture(s,"party_icon_1"),h.value=e.make.text({x:0,y:0,text:"10",style:{color:"#333333",fontSize:11*a,fontFamily:o.Font.DEFULT_FONT}}),h.value.setOrigin(.5,0),h.value.y=.5*h.height-7*a,h.value.setWordWrapWidth(h.width,!0),h.add([h.selectbg,h.icon,h.value]),h.selectbg.visible=!1,h}return l(PicPartyThemeItem,t),PicPartyThemeItem.prototype.setThemeData=function(t){this.selectbg.visible=!1,this.partyData=t,this.value.text=t.name;var e=t.display.texturePath,i=e.lastIndexOf("/"),n=e.slice(i+1,e.length),s=e.slice(0,i+1),r=o.Url.getOsdRes(s+n+"_"+this.dpr+"x.png");this.icon.load(r)},Object.defineProperty(PicPartyThemeItem.prototype,"select",{set:function(t){this.selectbg.visible=t},enumerable:!1,configurable:!0}),PicPartyThemeItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRoamDrawPanel",(function(){return l}));var n,s=i(5),r=i(470),o=i(11),a=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaRoamDrawPanel(e,i,n,s,r){var o=t.call(this,e)||this;return o.money=0,o.token=0,o.setSize(i,n),o.dpr=s,o.zoom=r,o.init(),o.setInteractive(),o}return h(PicaRoamDrawPanel,t),PicaRoamDrawPanel.prototype.resize=function(t,e){var i=t||this.width,n=e||this.height;this.setSize(i,n),this.drawProgress.refreshMask()},PicaRoamDrawPanel.prototype.setHandler=function(t){this.send=t},PicaRoamDrawPanel.prototype.init=function(){this.bg=new r.CommonBackground(this.scene,0,0,this.width,this.height,o.d.roam,"roam_bg",7530491);var t=this.scene.make.image({key:"roam_topic"});t.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var e=this.scene.make.image({key:"roam_stripe"});e.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),t.y=.5*-this.height+.5*t.height,e.y=.5*-this.height+.5*e.height,this.closeBtn=new s.Button(this.scene,o.d.uicommon,"back_arrow","back_arrow"),this.closeBtn.setPosition(.5*-this.width+21*this.dpr,.5*-this.height+35*this.dpr),this.closeBtn.on(s.ClickEvent.Tap,this.onCloseHandler,this);var i=new s.NineSlicePatch(this.scene,0,-this.dpr,190*this.dpr,28*this.dpr,o.d.uicommon,"home_assets_bg",{left:17*this.dpr,top:0*this.dpr,right:17*this.dpr,bottom:0*this.dpr});i.x=.5*-i.width;var n=this.scene.make.image({x:i.x,y:0,key:o.d.uicommon,frame:"home_assets_division"},!1);this.moneyvalue=new r.ImageValue(this.scene,60*this.dpr,26*this.dpr,o.d.uicommon,"home_silver",this.dpr,{color:"#ffffff",fontSize:15*this.dpr,fontFamily:a.Font.NUMBER}),this.moneyvalue.setLayout(1),this.moneyvalue.x=i.x-.5*i.width+22*this.dpr,this.tokenvalue=new r.ImageValue(this.scene,60*this.dpr,26*this.dpr,o.d.uicommon,"roam_ordinary_icon",this.dpr,{color:"#ffffff",fontSize:15*this.dpr,fontFamily:a.Font.NUMBER}),this.tokenvalue.setLayout(1),this.tokenvalue.x=i.x+22*this.dpr,this.moneyAddBtn=new s.Button(this.scene,o.d.uicommon,"home_praise_bg","home_praise_bg");var h=this.scene.make.image({x:0,y:0,key:o.d.uicommon,frame:"home_assets_add"},!1);this.moneyAddBtn.add(h),this.moneyAddBtn.x=.5*-this.moneyAddBtn.width-4*this.dpr,this.moneyAddBtn.on(s.ClickEvent.Tap,this.onRechargeHandler,this),this.moneyCon=this.scene.make.container(void 0,!1),this.moneyCon.setSize(i.width,i.height),this.moneyCon.add([i,n,this.moneyvalue,this.tokenvalue,this.moneyAddBtn]),this.moneyCon.x=.5*this.width-20*this.dpr,this.moneyCon.y=this.closeBtn.y;var l=new s.NineSliceButton(this.scene,0,0,76*this.dpr,30*this.dpr,o.d.uicommon,"home_persons_bg",a.i18n.t("roam.previewtex"),this.dpr,this.zoom,{left:20*this.dpr,right:20*this.dpr,top:0,bottom:0});l.setTextStyle(a.UIHelper.whiteStyle(this.dpr)),l.setFontStyle("bold"),l.x=.5*this.width-.5*l.width-15*this.dpr,l.y=this.moneyCon.y+.5*this.moneyCon.height+.5*l.height+15*this.dpr,l.on(s.ClickEvent.Tap,this.onDrawPreviewHandler,this),this.cloudPanel=new m(this.scene,this.width,137*this.dpr,this.dpr),this.cloudPanel.y=.5*this.height-.5*this.cloudPanel.height,this.drawProgress=new c(this.scene,this.dpr,this.zoom),this.drawProgress.setHandler(new a.Handler(this,this.onProgressHandler)),this.drawProgress.y=t.y+.5*t.height-66*this.dpr,this.oneRoamItem=new d(this.scene,this.dpr,this.zoom),this.oneRoamItem.x=.5*-this.oneRoamItem.width-10*this.dpr,this.oneRoamItem.y=.5*this.height-.5*this.oneRoamItem.height-60*this.dpr,this.oneRoamItem.setHandler(new a.Handler(this,this.onRoamDrawHandler,["one"])),this.tenRoamItem=new d(this.scene,this.dpr,this.zoom),this.tenRoamItem.x=-this.oneRoamItem.x,this.tenRoamItem.y=this.oneRoamItem.y,this.tenRoamItem.setHandler(new a.Handler(this,this.onRoamDrawHandler,["ten"])),this.bottomtips=this.scene.make.text({text:a.i18n.t("roam.bottomtips"),style:a.UIHelper.blackStyle(this.dpr,14)}).setOrigin(.5),this.bottomtips.y=.5*this.height-20*this.dpr,this.add([this.bg,e,t,this.closeBtn,this.moneyCon,l,this.cloudPanel,this.drawProgress,this.oneRoamItem,this.tenRoamItem,this.bottomtips]),this.resize()},PicaRoamDrawPanel.prototype.setRoamDatas=function(t){this.poolDatas=t;for(var e=0,i=t;e<i.length;e++){var n=i[e];if(1===n.drawTime)this.oneRoamItem.setRoamData(n);else if(this.tenRoamItem.setRoamData(n),n.diamond)this.drawProgress.visible=!1;else{this.drawProgress.visible=!0;for(var s=0;s<n.progressAward.length;s++){var r=n.progressAward[s];if(!r.received){var o=1e3*n.progressExpireTime-n.unixTime;this.drawProgress.setRoadLvData(n.progress,o,s+1,r);break}}}}},PicaRoamDrawPanel.prototype.setMoneyData=function(t,e,i){var n="home_silver",s="roam_ordinary_icon";"IV0000002"===i&&(n="home_diamond",s="roam_advanced_icon"),this.moneyvalue.setFrameValue(t+"",o.d.uicommon,n),this.tokenvalue.setFrameValue(e+"",o.d.uicommon,s),this.money=t,this.token=e,this.tokenid=i},PicaRoamDrawPanel.prototype.onRoamDrawHandler=function(t,e){if("one"===t){if(!e.free&&this.token<e.drawTime&&this.money<e.unitPrice*e.drawTime){var i="IV0000002"===this.tokenid?a.i18n.t("coin.diamond"):a.i18n.t("coin.coin"),n=a.i18n.t("roam.moneytips",{name:i});return void(this.send&&this.send.runWith(["notice",n]))}}else if("ten"===t&&!e.free&&this.token<e.drawTime){i="IV0000002"===this.tokenid?a.i18n.t("coin.diamond"):a.i18n.t("coin.coin");var s="IV0000002"===this.tokenid?a.i18n.t("coin.gold"):a.i18n.t("coin.silver"),r=e.drawTime-this.token,o=e.unitPrice*r;if(o<=this.money){n=a.i18n.t("roam.paytips",{name:o+i,count:r,tag:s});this.send&&this.send.runWith(["pay",{tokenID:this.tokenid,id:e.id,value:o,text:n}])}else{n=a.i18n.t("roam.moneytips",{name:i});this.send&&this.send.runWith(["notice",n])}return}this.send&&this.send.runWith(["draw",e])},PicaRoamDrawPanel.prototype.onCloseHandler=function(){this.send&&this.send.runWith("close")},PicaRoamDrawPanel.prototype.onRechargeHandler=function(){},PicaRoamDrawPanel.prototype.onDrawPreviewHandler=function(){this.send&&this.send.runWith("preview")},PicaRoamDrawPanel.prototype.onProgressHandler=function(t,e){"help"===t||"reward"===t&&this.send&&this.send.runWith(["progressrewards",e])},PicaRoamDrawPanel}(Phaser.GameObjects.Container),c=function(t){function RoamDrawProgress(e,i,n){var s=t.call(this,e)||this;return s.dpr=i,s.zoom=n,s.init(),s}return h(RoamDrawProgress,t),RoamDrawProgress.prototype.refreshMask=function(){this.progreItem.refreshMask()},RoamDrawProgress.prototype.init=function(){var t=this.scene.make.image({key:o.d.roam,frame:"roam_lv_bg"});t.y=0,this.setSize(t.width,t.height),this.progreItem=new p(this.scene,this.dpr,this.zoom),this.progreItem.y=-13*this.dpr,this.progreTex=this.scene.make.text({text:"",style:a.UIHelper.whiteStyle(this.dpr)}).setOrigin(.5),this.progreTex.setFontStyle("bold"),this.progreTex.y=this.progreItem.y,this.roamLevTex=new s.BBCodeText(this.scene,0,0,"",a.UIHelper.blackStyle(this.dpr)).setOrigin(.5),this.roamLevTex.y=.5*t.height+15*this.dpr,this.roamLevHelp=new s.Button(this.scene,o.d.uicommon1,"icon_tips"),this.roamLevHelp.on(s.ClickEvent.Tap,this.onHelpHandler,this),this.roamLevHelp.y=this.roamLevTex.y,this.roamLevHelp.x=this.roamLevTex.x+.5*this.roamLevTex.width+15*this.dpr,this.roamLevTips=this.scene.make.text({text:"",style:a.UIHelper.blackStyle(this.dpr)}).setOrigin(.5),this.roamLevTips.y=this.roamLevTex.y+20*this.dpr,this.resetTimeTex=this.scene.make.text({text:"",style:a.UIHelper.redStyle(this.dpr,8)}).setOrigin(.5),this.resetTimeTex.setStroke("#ffffff",this.dpr),this.resetTimeTex.y=20*this.dpr,this.add([t,this.progreItem,this.progreTex,this.roamLevTex,this.roamLevHelp,this.roamLevTips,this.resetTimeTex]),this.on("pointerup",this.onRecivedRewardHandler,this)},RoamDrawProgress.prototype.setRoadLvData=function(t,e,i,n){this.indexed=i,this.expireTime=e,this.roamLevTex.text=a.i18n.t("roam.roamlv",{name:""})+" [color=#FF693A][size="+14*this.dpr+"][b]LV"+i+"[/b][/size][/color]",t=t>n.targetValue?t=n.targetValue:t,this.progreTex.text=t+"/"+n.targetValue,this.progreItem.setProgress(t,n.targetValue),t>=n.targetValue?this.setInteractive():this.disableInteractive(),this.roamLevTips.text=n.rewards[0].des,e>0?(this.resetTimeTex.visible=!0,this.resetTimeTex.text=a.i18n.t("roam.resettips",{name:a.TimeUtils.getDataFormat(e,!1)}),this.loopTimeOut(e)):this.resetTimeTex.visible=!1,this.roamLevHelp.x=this.roamLevTex.x+.5*this.roamLevTex.width+.5*this.roamLevHelp.width+20*this.dpr},RoamDrawProgress.prototype.setHandler=function(t){this.send=t},RoamDrawProgress.prototype.onHelpHandler=function(){this.visible&&this.send&&this.send.runWith("help")},RoamDrawProgress.prototype.onRecivedRewardHandler=function(){this.visible&&this.send&&this.send.runWith(["reward",this.indexed])},RoamDrawProgress.prototype.loopTimeOut=function(t){var e=this;this.timer&&(clearTimeout(this.timer),this.timer=void 0);var excute=function(){e.timer=setTimeout((function(){e.scene&&((t-=1e3)>0?(excute(),e.resetTimeTex.text=a.i18n.t("roam.resettips",{name:a.TimeUtils.getDataFormat(t,!1)})):e.resetTimeTex.visible=!1)}),1e3)};excute()},RoamDrawProgress}(Phaser.GameObjects.Container),p=function(t){function ProgressItem(e,i,n){var s=t.call(this,e)||this;return s.max=1,s.value=0,s.animkey="roamlv1",s.animkey2="roamlv2",s.dpr=i,s.zoom=n,s.init(),s}return h(ProgressItem,t),ProgressItem.prototype.init=function(){this.progreimg=this.scene.make.image({key:o.d.roam,frame:"roam_lv"}),this.setSize(this.progreimg.width,this.progreimg.height),this.sprite=this.createSprite(o.d.roam,this.animkey,"roam_lv_1_",[1,6],9,-1),this.sprite2=this.createSprite(o.d.roam,this.animkey2,"roam_lv_2_",[1,6],9,-1),this.graphic=this.scene.make.graphics(void 0,!1),this.graphic.clear(),this.graphic.fillStyle(16695063,1),this.graphic.fillRect(.5*-this.width,0,this.width,this.height),this.imgMask=this.scene.make.image({key:o.d.roam,frame:"roam_lv"}),this.mask=new Phaser.Display.Masks.BitmapMask(this.scene,this.imgMask),this.add([this.progreimg,this.graphic,this.sprite,this.sprite2])},ProgressItem.prototype.destroy=function(){t.prototype.destroy.call(this),this.imgMask.destroy(!0)},ProgressItem.prototype.refreshMask=function(){var t=this.getWorldTransformMatrix();this.imgMask.x=t.tx,this.imgMask.y=t.ty},ProgressItem.prototype.setProgress=function(t,e){this.value=t,this.max=e;var i=t/e*this.height,n=.5*this.height-i;this.sprite.y=n,this.sprite2.y=n,this.graphic.y=n+7*this.dpr,t>=e?(this.progreimg.visible=!0,this.sprite.visible=!1,this.sprite2.visible=!1,this.graphic.visible=!1):(this.progreimg.visible=!1,this.sprite.visible=!0,this.sprite2.visible=!0,this.graphic.visible=!0)},ProgressItem.prototype.createSprite=function(t,e,i,n,s,r){void 0===s&&(s=30),void 0===r&&(r=0);var o=this.scene.make.sprite({key:t,frame:i+"1"});return this.scene.anims.create({key:e,frames:this.scene.anims.generateFrameNames(t,{prefix:i+"",start:n[0],end:n[1]}),frameRate:s,repeat:r}),o.play(e),o},ProgressItem}(Phaser.GameObjects.Container),d=function(t){function RoamDrawItem(e,i,n){var h=t.call(this,e)||this;return h.dpr=i,h.zoom=n,h.setSize(158*i,77*i),h.drawTips=h.scene.make.text({x:0,y:.5*-h.height+5*i,text:"",style:a.UIHelper.blackStyle(i)}).setOrigin(.5),h.drawButton=new r.BackgroundScaleButton(h.scene,158*i,65*h.dpr,o.d.roam,"roam_butt_one","roam_butt_one_1",void 0,h.dpr,1,!1),h.drawButton.on(s.ClickEvent.Tap,h.onButtonHandler,h),h.drawButton.y=15*i,h.add([h.drawTips,h.drawButton]),h}return h(RoamDrawItem,t),RoamDrawItem.prototype.setHandler=function(t){this.send=t},RoamDrawItem.prototype.setRoamData=function(t){this.roamData=t;var e=1===t.drawTime?"roam_butt_one":"roam_butt_ten",i=1===t.drawTime?"roam_butt_one_1":"roam_butt_ten_1";if("IV0000002"===t.tokenId&&(e=1===t.drawTime?"roam_diamond_butt_one":"roam_diamond_butt_ten",i=1===t.drawTime?"roam_diamond_butt_one_1":"roam_diamond_butt_ten_1"),this.drawButton.setFrameNormal(e,i),t.free)this.drawTips.text=a.i18n.t("roam.drawfreetips"),this.drawTips.visible=!0;else if(void 0!==t.nextFreeTime){var n=1e3*t.nextFreeTime-t.unixTime;n>0?(this.drawTips.visible=!0,this.drawTips.text=a.i18n.t("roam.endtips",{name:a.TimeUtils.getDataFormat(n,!1)}),this.loopTimeOut(n)):(this.drawTips.visible=!0,this.drawTips.text=a.i18n.t("roam.drawfreetips"))}else this.drawTips.visible=!1},RoamDrawItem.prototype.onButtonHandler=function(){this.send&&this.send.runWith(this.roamData)},RoamDrawItem.prototype.loopTimeOut=function(t){var e=this;this.timer&&(clearTimeout(this.timer),this.timer=void 0);var excute=function(){e.timer=setTimeout((function(){e.scene&&((t-=1e3)>0?(e.drawTips.text=a.i18n.t("roam.endtips",{name:a.TimeUtils.getDataFormat(t,!1)}),excute()):(e.drawTips.text=a.i18n.t("roam.drawfreetips"),e.roamData.free=!0))}),1e3)};excute()},RoamDrawItem}(Phaser.GameObjects.Container),m=function(t){function CloudDisplayItem(e,i,n,s){var r=t.call(this,e)||this;return r.dpr=s,r.setSize(i,n),r.init(),r}return h(CloudDisplayItem,t),CloudDisplayItem.prototype.init=function(){var t=.5*this.height;this.left_in=this.scene.make.image({key:o.d.roam,frame:"rome_cloud_right_3"}),this.left_in.x=.5*-this.width+this.left_in.width,this.left_in.y=t-.5*this.left_in.height-23*this.dpr,this.center=this.scene.make.image({key:o.d.roam,frame:"rome_cloud_center"}),this.center.y=t-.5*this.center.height,this.right_in=this.scene.make.image({key:o.d.roam,frame:"rome_cloud_left_2"}),this.right_in.x=.5*this.width-.5*this.right_in.width-7*this.dpr,this.right_in.y=t-.5*this.right_in.height-30*this.dpr,this.left_out=this.scene.make.image({key:o.d.roam,frame:"rome_cloud_right_2"}),this.left_out.x=.5*-this.width+.5*this.left_out.width,this.left_out.y=t-.5*this.left_out.height,this.right_out=this.scene.make.image({key:o.d.roam,frame:"rome_cloud_left_1"}),this.right_out.x=.5*this.width-.5*this.right_out.width,this.right_out.y=t-.5*this.right_out.height,this.right_out_2=this.scene.make.image({key:o.d.roam,frame:"rome_cloud_right_1"}),this.right_out_2.x=.5*-this.width+.5*this.right_out_2.width+48*this.dpr,this.right_out_2.y=t-.5*this.right_out_2.height,this.add([this.left_in,this.center,this.right_in,this.left_out,this.right_out,this.right_out_2])},CloudDisplayItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRoamListPanel",(function(){return l}));var n,s=i(5),r=i(470),o=i(11),a=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaRoamListPanel(e,i,n,s,r){var o=t.call(this,e)||this;return o.poolsStatus=new Map,o.setSize(i,n),o.dpr=s,o.zoom=r,o.init(),o}return h(PicaRoamListPanel,t),PicaRoamListPanel.prototype.resize=function(t,e){var i=t||this.width,n=e||this.height;this.setSize(i,n),this.mGameGrid.resetMask()},PicaRoamListPanel.prototype.setHandler=function(t){this.send=t},PicaRoamListPanel.prototype.init=function(){var t=this,e=340*this.dpr,i=455*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.content.setInteractive(),this.add(this.content),this.bg=new s.NineSlicePatch(this.scene,0,0,e,i,o.d.uicommon1,"bg",{left:30*this.dpr,top:30*this.dpr,bottom:30*this.dpr,right:30*this.dpr});var n=.5*-i;this.titlebg=this.scene.make.image({x:0,y:0,key:o.d.uicommon1,frame:"title"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titlebg.y=n+3*this.dpr,this.titleTex=this.scene.make.text({x:0,y:this.titlebg.y+2*this.dpr,text:a.i18n.t("roam.title"),style:a.UIHelper.titleYellowStyle_m(this.dpr)}).setOrigin(.5),this.titleTex.setFontStyle("bold"),this.titleTex.setResolution(this.dpr),this.closeBtn=new s.Button(this.scene,o.d.uicommon,"close","close"),this.closeBtn.setPosition(.5*this.bg.width-5*this.dpr,.5*-this.bg.height+5*this.dpr),this.closeBtn.on(s.ClickEvent.Tap,this.onCloseHandler,this);var r={x:0,y:10*this.dpr,table:{width:e-10*this.dpr,height:i-50*this.dpr,columns:1,cellWidth:e-10*this.dpr,cellHeight:120*this.dpr,reuseCellContainer:!0,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(e,i){e.scene;var n=t.mGameGrid.items.length-e.index,s=e.item;return null===i&&(i=new c(t.scene,t.dpr,t.zoom)),i.setRoamData(s,n),i}};this.mGameGrid=new s.GameGridTable(this.scene,r),this.mGameGrid.layout(),this.mGameGrid.on("cellTap",(function(e){t.onSelectItemHandler(e.roamData)})),this.content.add([this.bg,this.titlebg,this.titleTex,this.closeBtn,this.mGameGrid]),this.resize()},PicaRoamListPanel.prototype.setRoamDataList=function(t){this.poolsStatus.clear();for(var e=0,i=t;e<i.length;e++){var n=i[e];if(this.poolsStatus.has(n.tokenId)){(s=this.poolsStatus.get(n.tokenId)).push(n)}else{var s=[n];this.poolsStatus.set(n.tokenId,s)}}var r=[];this.poolsStatus.forEach((function(t){r.push(t[0])})),this.mGameGrid.setItems(r),this.mGameGrid.setT(0)},PicaRoamListPanel.prototype.getRoamTokenDatas=function(){return this.poolsStatus.get(this.tokenId)},PicaRoamListPanel.prototype.onSelectItemHandler=function(t){this.tokenId=t.tokenId,this.send&&this.send.runWith(["roam",this.poolsStatus.get(t.tokenId)])},PicaRoamListPanel.prototype.onCloseHandler=function(){this.send&&this.send.runWith("close")},PicaRoamListPanel}(Phaser.GameObjects.Container),c=function(t){function RoamItem(e,i,n){var h=t.call(this,e)||this;h.dpr=i,h.zoom=n,h.setSize(302*i,110*i),h.bg=new s.NineSlicePatch(e,0,0,h.width,h.height,o.d.roam,"roam_list_bg",{left:7*i,top:0,right:7*i,bottom:0}),h.dybg=new r.DynamicImage(e,0,0),h.nameTex=h.scene.make.text({x:.5*h.width-20*i,y:-20*i,text:"",style:a.UIHelper.colorStyle("#1F95F8",22*i)}).setOrigin(1,.5),h.nameTex.setPadding(0,0,3*i,0),h.nameTex.setFontStyle("bold italic"),h.nameTex.setStroke("#ffffff",2*i),h.desTex=h.scene.make.text({x:.5*h.width-10*i,y:10*i,text:"",style:a.UIHelper.colorStyle("#FFFD50",22*i)}).setOrigin(.5),h.desTex.setPadding(0,0,3*i,0),h.desTex.setFontStyle("bold italic");var l=h.desTex.context.createLinearGradient(0,0,0,h.desTex.height);return l.addColorStop(0,"#FFFD50"),l.addColorStop(1,"#FAB600"),h.desTex.setFill(l),h.timebg=new s.NineSlicePatch(h.scene,0,0,84*i,32*i,o.d.roam,"roam_countbg",{left:3*i,top:0,right:3*i,bottom:0},0),h.timetips=h.scene.make.text({text:a.i18n.t("roam.timeendtips"),style:a.UIHelper.whiteStyle(i,11)}).setOrigin(.5),h.timeTex=new s.BBCodeText(h.scene,0,0,"",a.UIHelper.blackStyle(i,8)).setOrigin(.5),h.timeTex.setPadding(3*i,3*i,3*i,0),h.timebg.x=.5*-h.width+.5*h.timebg.width+3*i,h.timebg.y=.5*h.height-.5*h.timebg.height-5*i,h.timetips.x=h.timebg.x,h.timetips.y=h.timebg.y-8*i,h.timeTex.x=h.timebg.x,h.timeTex.y=h.timebg.y+10*i,h.add([h.bg,h.dybg,h.nameTex,h.desTex,h.timebg,h.timetips,h.timeTex]),h.desTex.visible=!1,h.nameTex.visible=!1,h}return h(RoamItem,t),RoamItem.prototype.setRoamData=function(t){if(this.roamData=t,"IV0000002"===t.tokenId){this.dybg.setTexture(o.d.roam,"roan_banner_diamond");this.timeTex.text=this.getTimeTex(6048e5),this.loopTimeOut(6048e5),this.timeTex.visible=!0,this.timebg.visible=!0}else this.dybg.setTexture(o.d.roam,"roan_banner_silver"),this.timeTex.visible=!1,this.timebg.visible=!1},RoamItem.prototype.loopTimeOut=function(t){var e=this;this.timer&&(clearTimeout(this.timer),this.timer=void 0);var excute=function(){e.timer=setTimeout((function(){e.scene&&((t-=6e4)<0&&(t=0),e.timeTex.text=e.getTimeTex(t),t>0&&excute())}),6e4)};excute()},RoamItem.prototype.getTimeTex=function(t){var e=Math.floor(t/864e5),i=Math.floor(t/36e5)%24,n=Math.floor(t/6e4)%60;return 0!==e||0!==i||0!==n?this.timeFormat(e)+a.i18n.t("timeuint.day")+this.timeFormat(i)+a.i18n.t("timeuint.hour")+this.timeFormat(n)+a.i18n.t("timeuint.minutes"):a.i18n.t("roam.timeend")},RoamItem.prototype.timeFormat=function(t){return"[color=#724DF4][size="+14*this.dpr+"][b]"+t+"[/b][/size][/color]"},RoamItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRoamPreviewPanel",(function(){return h}));var n,s=i(5),r=i(11),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicaRoamPreviewPanel(e,i,n,s,r){var o=t.call(this,e)||this;return o.poolsStatus=new Map,o.setSize(i,n),o.dpr=s,o.zoom=r,o.setInteractive(),o.init(),o}return a(PicaRoamPreviewPanel,t),PicaRoamPreviewPanel.prototype.resize=function(t,e){var i=t||this.width,n=e||this.height;this.mBackground.clear(),this.mBackground.fillStyle(0,.8),this.mBackground.fillRoundedRect(.5*-i,.5*-n,i,n),this.setSize(i,n),this.mGameGrid.resetMask()},PicaRoamPreviewPanel.prototype.setHandler=function(t){this.send=t},PicaRoamPreviewPanel.prototype.init=function(){var t=this;this.mBackground=this.scene.make.graphics(void 0,!1),this.add(this.mBackground);var e=340*this.dpr,i=455*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.content.setInteractive(),this.add(this.content),this.bg=new s.NineSlicePatch(this.scene,0,0,e,i,r.d.uicommon1,"bg",{left:30*this.dpr,top:30*this.dpr,bottom:30*this.dpr,right:30*this.dpr});var n=.5*-i;this.titlebg=this.scene.make.image({x:0,y:0,key:r.d.uicommon1,frame:"title"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titlebg.y=n+3*this.dpr,this.titleTex=this.scene.make.text({x:0,y:this.titlebg.y+2*this.dpr,text:o.i18n.t("roam.previewtex"),style:o.UIHelper.titleYellowStyle_m(this.dpr)}).setOrigin(.5),this.titleTex.setFontStyle("bold"),this.titleTex.setResolution(this.dpr),this.closeBtn=new s.Button(this.scene,r.d.uicommon,"close","close"),this.closeBtn.setPosition(.5*this.bg.width-5*this.dpr,.5*-this.bg.height+5*this.dpr),this.closeBtn.on(s.ClickEvent.Tap,this.onCloseHandler,this);var a={x:0,y:10*this.dpr,table:{width:e-10*this.dpr,height:i-50*this.dpr,columns:1,cellWidth:e-10*this.dpr,cellHeight:38*this.dpr,reuseCellContainer:!0,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(e,i){e.scene;var n=e.index,s=e.item;return null===i&&(i=new l(t.scene,t.dpr,t.zoom)),i.setRoamData(s,n%2==0?0:1),i}};this.mGameGrid=new s.GameGridTable(this.scene,a),this.mGameGrid.layout(),this.mGameGrid.on("cellTap",(function(e){t.onSelectItemHandler(e.roamData)})),this.content.add([this.bg,this.titlebg,this.titleTex,this.closeBtn,this.mGameGrid]),this.resize(),this.loadPreviewJson()},PicaRoamPreviewPanel.prototype.setRoamDrawData=function(t){this.mGameGrid.setItems(t),this.mGameGrid.setT(0)},PicaRoamPreviewPanel.prototype.loadPreviewJson=function(){var t=o.Url.getRes("ui/roampreview/preview.json");this.scene.load.json("roampreview",t),this.scene.load.on(Phaser.Loader.Events.FILE_COMPLETE,this.loadJsonComplete,this),this.scene.load.start()},PicaRoamPreviewPanel.prototype.loadJsonComplete=function(){if(this.scene.cache.json.has("roampreview")){this.scene.load.off(Phaser.Loader.Events.FILE_COMPLETE,this.loadJsonComplete,this);for(var t=this.scene.cache.json.get("roampreview"),e=[],i=0;i<t.length;i+=2){var n=[t[i],t[i+1]];e.push(n)}this.setRoamDrawData(e)}},PicaRoamPreviewPanel.prototype.onSelectItemHandler=function(t){},PicaRoamPreviewPanel.prototype.onCloseHandler=function(){this.send&&this.send.runWith("close")},PicaRoamPreviewPanel}(Phaser.GameObjects.Container),l=function(t){function RoamPreviewItem(e,i,n){var s=t.call(this,e)||this;return s.dpr=i,s.zoom=n,s.setSize(311*i,38*i),s.bg=s.scene.make.image({key:r.d.roam,frame:"roam_preview_list"}),s.bg.displayWidth=s.width,s.leftItem=new c(s.scene,155*i,38*i,i),s.rightItem=new c(s.scene,155*i,38*i,i),s.leftItem.x=.5*-s.leftItem.width,s.rightItem.x=.5*s.leftItem.width,s.add([s.bg,s.leftItem,s.rightItem]),s}return a(RoamPreviewItem,t),RoamPreviewItem.prototype.setRoamData=function(t,e){this.leftItem.setDrawData(t[0]),this.rightItem.setDrawData(t[1]),this.bg.alpha=e},RoamPreviewItem}(Phaser.GameObjects.Container),c=function(t){function PreviewCellItem(e,i,n,s){var r=t.call(this,e)||this;return r.setSize(i,n),r.dpr=s,r.init(),r}return a(PreviewCellItem,t),PreviewCellItem.prototype.init=function(){this.nameTex=this.scene.make.text({text:"",style:o.UIHelper.blackStyle(this.dpr)}).setOrigin(0,.5),this.image=this.scene.make.image({key:r.d.roam,frame:"roam_preview_star_1"}),this.value=this.scene.make.text({text:"",style:o.UIHelper.blackStyle(this.dpr)}).setOrigin(0,.5),this.add([this.nameTex,this.image,this.value])},PreviewCellItem.prototype.setDrawData=function(t){this.nameTex.text=t.name,t.star>0?(this.image.visible=!0,this.image.setFrame("roam_preview_star_"+t.star)):this.image.visible=!1,this.value.text=t.prob+"%",this.nameTex.x=.5*-this.width+15*this.dpr,this.image.x=this.nameTex.x+this.nameTex.width+.5*this.image.width+3*this.dpr,this.value.x=.5*this.width-this.value.width-15*this.dpr},PreviewCellItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaTaskItem",(function(){return p}));var n,s=i(5),r=i(470),o=i(11),a=i(2),h=i(0),l=i(472),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaTaskItem(e,i,n){var a=t.call(this,e)||this;a.mIsExtend=!1,a.zoom=1,a.dpr=i,a.zoom=n;var l=272*i,c=70*i;a.setSize(l,c),a.content=e.make.container(void 0,!1),a.content.setSize(l,c),a.bg=new s.NineSlicePatch(a.scene,0,0,l,c,o.d.uicommon,"task_list_bg",{left:6*i,top:6*i,bottom:6*i,right:6*i});var p=.5*-l,d=e.make.image({key:o.d.uicommon,frame:"task_head_frame"});return d.x=p+25*i,a.headIcon=new r.DynamicImage(e,d.x,0),a.headIcon.scale=i/a.zoom,a.headIcon.y=-10*i,a.taskName=e.make.text({text:"",style:h.UIHelper.whiteStyle(i)}).setOrigin(0,.5),a.taskName.x=a.headIcon.x+28*i,a.taskName.y=.5*-c+15*i,a.taskDes=e.make.text({text:"",style:h.UIHelper.colorStyle("#FFF449",12*i)}).setOrigin(0),a.taskDes.x=a.taskName.x,a.taskDes.y=a.taskName.y+15*i,a.taskButton=new r.ThreeSliceButton(a.scene,62*i,25*i,o.d.uicommon,h.UIHelper.threeYellowSmall,h.UIHelper.threeYellowSmall,h.i18n.t("task.receive")),a.taskButton.setFontStyle("bold"),a.taskButton.x=.5*l-.5*a.taskButton.width-10*i,a.taskButton.on(s.ClickEvent.Tap,a.onTaskButtonHandler,a),a.arrow=a.scene.make.image({key:o.d.uicommon,frame:"task_list_arrow"}),a.arrow.y=.5*c-.5*a.arrow.height,a.content.add([a.bg,d,a.headIcon,a.taskName,a.taskDes,a.taskButton,a.arrow]),a.add(a.content),a.setSize(l,c),a}return c(PicaTaskItem,t),PicaTaskItem.prototype.setTaskData=function(t){this.questData=t,this.taskName.text=t.name+this.getProgressStr(t),this.setTextLimit(this.taskName,this.taskName.text),this.setTextLimit(this.taskDes,t.detail);var e=h.Url.getOsdRes(t.display.texturePath);this.headIcon.load(e,this,(function(){})),t.stage===a.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_PROCESSING?(this.taskButton.setFrameNormal(h.UIHelper.threeGreenSmall),this.taskButton.setText(h.i18n.t("task.go")),this.taskButton.setTextStyle(h.UIHelper.colorStyle("#022B55",12*this.dpr))):t.stage!==a.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_FINISHED&&this.questData.stage!==a.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_END||(this.taskButton.setFrameNormal(h.UIHelper.threeYellowSmall),this.taskButton.setText(h.i18n.t("task.receive")),this.taskButton.setTextStyle(h.UIHelper.brownishStyle(this.dpr)))},PicaTaskItem.prototype.setTaskDetail=function(t){this.mExtend&&this.mExtend.setItemData(t)},PicaTaskItem.prototype.setHandler=function(t){this.send=t},PicaTaskItem.prototype.setExtend=function(t,e){void 0===e&&(e=!0),t?(this.openExtend(),e&&this.send&&this.send.runWith(["extend",{extend:!0,item:this}])):(this.closeExtend(),e&&this.send&&this.send.runWith(["extend",{extend:!1,item:this}]))},Object.defineProperty(PicaTaskItem.prototype,"extend",{get:function(){return this.mIsExtend},enumerable:!1,configurable:!0}),PicaTaskItem.prototype.getProgressStr=function(t){if(t.targets)for(var e=0,i=t.targets;e<i.length;e++){var n=i[e];if(n.neededCount)return" ("+n.count+"/"+n.neededCount+")"}return""},PicaTaskItem.prototype.onTaskButtonHandler=function(){this.questData.stage===a.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_PROCESSING?this.send&&this.send.runWith(["go",this.questData]):this.questData.stage===a.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_FINISHED&&this.send&&this.send.runWith(["finish",this.questData.id])},PicaTaskItem.prototype.openExtend=function(){this.mExtend||(this.mExtend=new d(this.scene,this.width,0,this.dpr,this.zoom),this.mExtend.setHandler(this.send),this.add(this.mExtend)),this.mExtend.setItemData(this.questData),this.mExtend.visible=!0,this.height=this.content.height+this.mExtend.height,this.content.y=.5*-this.height+.5*this.content.height,this.mExtend.y=this.content.y+.5*this.content.height,this.mIsExtend=!0,this.arrow.visible=!1},PicaTaskItem.prototype.closeExtend=function(){this.mExtend&&(this.mExtend.visible=!1),this.height=this.content.height,this.content.y=0,this.mIsExtend=!1,this.arrow.visible=!0},PicaTaskItem.prototype.setTextLimit=function(t,e,i){if(void 0===i&&(i=15),e.length>i)for(var n=155*this.dpr,s=4;s<e.length;s++){var r=e.slice(0,s);if(t.setText(r).width>n){r+="...",t.setText(r);break}}else t.setText(e)},PicaTaskItem}(Phaser.GameObjects.Container),d=function(t){function TaskItemExtend(e,i,n,r,a){var l=t.call(this,e)||this;l.needArr=[],l.rewardArr=[],l.dpr=0,l.zoom=1,l.width=i,l.dpr=r,l.zoom=a,l.bg=new s.NineSlicePatch(l.scene,0,0,i,n,o.d.uicommon,"task_list_unfold_bg",{left:4,top:4,right:4,bottom:4});var c=.5*-i+10*r,p=.5*-n+8*r;l.taskLabel=e.make.text({x:c,y:p,text:h.i18n.t("task.objective"),style:h.UIHelper.colorStyle("#625AC6",12*r)}),l.taskLabel.setFontStyle("bold"),l.taskTex=e.make.text({x:c,y:p+18*r,text:h.i18n.t("task.collect_materials"),style:h.UIHelper.colorStyle("#625AC6",12*r)}),l.taskTex.setWordWrapWidth(i-10*r,!0),l.rewardLabel=e.make.text({x:c,y:p+90*r,text:h.i18n.t("task.rewards"),style:h.UIHelper.colorStyle("#625AC6",12*r)}),l.rewardLabel.setFontStyle("bold");var d=e.make.image({key:o.d.uicommon,frame:"task_reward_divider"});return d.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),d.setPosition(-10*r,p+110*r),l.line=d,l.add([l.bg,l.taskLabel,l.taskTex,l.rewardLabel,d]),l.setSize(i,n),l}return c(TaskItemExtend,t),TaskItemExtend.prototype.setItemData=function(t){var e=0,i=67*this.dpr;this.taskTex.text=this.getTaskTargetText(t),this.createTaskCells(this.needArr,t.targets,!0),e=this.taskTex.y+this.taskTex.height+8*this.dpr,t.targets.length>0&&this.hasTargetWithDisplay(t)&&(e+=.5*i,this.sortItem(this.needArr,e),e+=.5*i+15*this.dpr),this.rewardLabel.y=e,e+=this.rewardLabel.height+5*this.dpr,this.line.y=e,e+=5*this.dpr,this.createTaskCells(this.rewardArr,t.rewards,!1),e+=.5*i,this.sortItem(this.rewardArr,e),this.height=e+.5*i+10*this.dpr,this.bg.resize(this.width,this.height),this.bg.y=.5*this.height},TaskItemExtend.prototype.sortItem=function(t,e){void 0===e&&(e=0);for(var i=.5*-this.width+10*this.dpr,n=t,s=0,r=10*this.dpr,o=0,a=n;o<a.length;o++){var h=a[o];h.x=i+h.width*h.originX+s,h.y=e,s+=h.width+r}},TaskItemExtend.prototype.setHandler=function(t){this.send=t},TaskItemExtend.prototype.createTaskCells=function(t,e,i){void 0===i&&(i=!0);for(var n=0,r=t;n<r.length;n++){(h=r[n]).visible=!1}for(var a=0;a<e.length;a++){var h=void 0;a<t.length?h=t[a]:e[a].display&&e[a].display.texturePath&&((h=new l.ItemButton(this.scene,o.d.uicommon,"bag_icon_common_bg",this.dpr,this.zoom,!0)).on(s.ClickEvent.Tap,this.onTaskCellHandler,this),t.push(h),this.add(h)),h&&(h.visible=!0,h.setItemData(e[a]))}return t},TaskItemExtend.prototype.hasTargetWithDisplay=function(t){for(var e=0,i=t.targets;e<i.length;e++){var n=i[e];if(n.display&&n.display.texturePath)return!0}},TaskItemExtend.prototype.getTaskTargetText=function(t){t.targets;return t.detail+this.getProgressStr(t)},TaskItemExtend.prototype.getProgressStr=function(t){if(t.targets)for(var e=0,i=t.targets;e<i.length;e++){var n=i[e];if(n.neededCount)return" ("+n.count+"/"+n.neededCount+")"}return""},TaskItemExtend.prototype.onTaskCellHandler=function(t,e){this.send&&this.send.runWith(["item",e])},TaskItemExtend}(Phaser.GameObjects.Container);!function(t){function TaskCell(e,i,n){var a=t.call(this,e,0,0)||this;return a.dpr=i,a.zoom=n,a.bg=e.make.image({key:o.d.uicommon,frame:"task_icon_bg"}),a.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),a.setSize(a.bg.width,a.bg.height),a.itemIcon=new r.DynamicImage(e,0,0),a.itemIcon.scale=a.dpr/a.zoom,a.countTex=new s.BBCodeText(a.scene,0,0,"",h.UIHelper.colorNumberStyle("#ffffff",12*i)).setOrigin(.5).setStroke("#000000",2*i),a.countTex.setPosition(.5*a.width,.5*a.height-2*i),a.add([a.bg,a.itemIcon,a.countTex]),a.enable=!0,a}c(TaskCell,t),TaskCell.prototype.setCellData=function(t,e){void 0===e&&(e=!0),this.itemData=t;var i=e?"task_icon_bg":"task_reward_bg";this.bg.setTexture(o.d.uicommon,i);var n=h.Url.getOsdRes(t.display.texturePath);this.itemIcon.load(n,this,(function(){})),e?(this.countTex.text=this.getCountText(t.count,t.neededCount),this.countTex.setOrigin(.5),this.countTex.x=0,this.countTex.y=.5*this.height+7*this.dpr):(this.countTex.text="[stroke=#2D2D2D][color=#ffffff]"+t.count+"[/color][/stroke]",this.countTex.x=.5*this.width-2*this.dpr,this.countTex.y=.5*this.height,this.countTex.setOrigin(1,1))},TaskCell.prototype.getCountText=function(t,e){return""+("[color="+(t>=e?"#0054FF":"#FF0000")+"]"+t+"[/color]")+("[color=#2D2D2D]/"+e+"[/color]")}}(r.ButtonEventDispatcher)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaTaskMainPanel",(function(){return d}));var n,s=i(5),r=i(470),o=i(11),a=i(0),h=i(2),l=i(525),c=i(527),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaTaskMainPanel(e,i,n,s,r){var o=t.call(this,e)||this;return o.taskItems=[],o.isMoveFinish=!1,o.isFinishGroup=!1,o.setSize(i,n),o.dpr=s,o.zoom=r,o.init(),o}return p(PicaTaskMainPanel,t),PicaTaskMainPanel.prototype.setHandler=function(t){this.send=t},PicaTaskMainPanel.prototype.refreshMask=function(){this.gameScroller.refreshMask(),this.mainItem&&this.mainItem.refreshMask()},PicaTaskMainPanel.prototype.setTaskDatas=function(t,e){if(this.curTaskItem&&this.curTaskItem.setExtend(!1),this.mainItem||(this.mainItem=new m(this.scene,272*this.dpr,126*this.dpr,this.dpr,this.zoom),this.gameScroller.addItem(this.mainItem),this.mainItem.setHandler(new a.Handler(this,this.onRewardHandler))),this.mainItem.setMainTaskData(t,e),this.questType!==e){var i=this.getTaskQuests(t.quests,void 0);this.setTaskItems(i);for(var n=[],s=0,r=this.taskItems;s<r.length;s++){(l=r[s]).visible&&n.push(l)}}else{i=this.getTaskQuests(t.quests,this.taskGroupData.quests);this.setTaskItems(i);n=[];for(var o=0,h=this.taskItems;o<h.length;o++){var l;(l=h[o]).visible&&n.push(l)}if(this.isFinishGroup)this.mainTaskAnimation=new u(this.scene,this.mainItem,n,this.width,this.dpr),this.isMoveFinish&&this.mainTaskAnimation.playIntoAnimation(),this.isFinishGroup=!1;else new y(this.scene,n,this.width,this.dpr).playGoOutAnimation()}this.taskGroupData=t,this.questType=e},PicaTaskMainPanel.prototype.setTaskDetail=function(t){this.curTaskItem&&t&&this.curTaskItem.questData.id===t.id&&this.curTaskItem.setTaskDetail(t)},PicaTaskMainPanel.prototype.setTaskItems=function(t){for(var e=0,i=this.taskItems;e<i.length;e++){(s=i[e]).visible=!1}for(var n=0;n<t.length;n++){var s=void 0;n<this.taskItems.length?s=this.taskItems[n]:(s=new l.PicaTaskItem(this.scene,this.dpr,this.zoom),this.gameScroller.addItem(s),s.setHandler(new a.Handler(this,this.onTaskItemHandler)),this.taskItems.push(s)),s.setTaskData(t[n]),s.visible=!0,s.x=0}this.gameScroller.Sort()},PicaTaskMainPanel.prototype.getTaskQuests=function(t,e){for(var i=[],n=0,s=t;n<s.length;n++){var r=s[n];if(r.stage===h.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_PROCESSING||r.stage===h.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_FINISHED)i.push(r);else if(r.stage===h.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_END&&e)for(var o=0,a=e;o<a.length;o++){var l=a[o];l.id===r.id&&l.stage===h.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_FINISHED&&i.push(r)}}return i},PicaTaskMainPanel.prototype.playIntoAnimation=function(){this.mainTaskAnimation&&this.mainTaskAnimation.playIntoAnimation()},PicaTaskMainPanel.prototype.playGoOutAnimation=function(){},PicaTaskMainPanel.prototype.moveFinish=function(){this.isMoveFinish=!0,this.mainTaskAnimation&&this.mainTaskAnimation.playIntoAnimation()},PicaTaskMainPanel.prototype.init=function(){var t=this;this.gameScroller=new s.GameScroller(this.scene,{x:0,y:0*this.dpr,width:this.width,height:this.height,zoom:this.zoom,dpr:this.dpr,align:2,orientation:0,space:10*this.dpr,padding:{top:2*this.dpr},selfevent:!0,cellupCallBack:function(e){t.onPointerUpHandler(e)}}),this.itemTips=new r.ItemInfoTips(this.scene,121*this.dpr,46*this.dpr,o.d.uicommon,"tips_bg",this.dpr),this.itemTips.setVisible(!1),this.add([this.gameScroller,this.itemTips])},PicaTaskMainPanel.prototype.onPointerUpHandler=function(t){if(!(t instanceof m)){var e=!t.extend;t.setExtend(e,!0)}},PicaTaskMainPanel.prototype.onTaskItemHandler=function(t,e){if("extend"===t){var i=e.extend,n=e.item;this.onExtendsHandler(i,n)}else"go"===t||("finish"===t?this.send.runWith(["finish",e]):"item"===t&&this.onMaterialItemHandler(e))},PicaTaskMainPanel.prototype.onRewardHandler=function(t){this.send&&this.send.runWith(["reward",t]),this.isFinishGroup=!0},PicaTaskMainPanel.prototype.onExtendsHandler=function(t,e){this.curTaskItem&&this.curTaskItem.setExtend(!1,!1),this.curTaskItem=t?e:null,this.gameScroller.Sort(!0)},PicaTaskMainPanel.prototype.onMaterialItemHandler=function(t){c.PicaItemTipsPanel.Inst.showTips(t,t.itemData)},PicaTaskMainPanel}(Phaser.GameObjects.Container),m=function(t){function MainTaskItem(e,i,n,s,r){var o=t.call(this,e)||this;return o.isFinish=!1,o.dpr=s,o.zoom=r,o.setSize(i,n),o.init(),o}return p(MainTaskItem,t),MainTaskItem.prototype.refreshMask=function(){},MainTaskItem.prototype.setMainTaskData=function(t,e){this.titleTex.text=t.name,this.taskDes.text=t.des;var i=t.quests.length;if(this.questType!==e){var n=this.getFinishProgress(t);this.progress.setProgress(n,i),this.progressTex.text=Math.floor(1e3*n/i)/10+"%",this.isFinish=n===i}else{var s=this.getFinishProgress(this.mainData),r=this.getFinishProgress(t),o=2e3*r/i;this.playProgressTween(s,r,i,o),this.isFinish=r===i}var h=a.Url.getOsdRes(t.reward.display.texturePath);this.rewardsImg.load(h,this,(function(){})),this.mainData=t},MainTaskItem.prototype.setHandler=function(t){this.send=t},MainTaskItem.prototype.destroy=function(){t.prototype.destroy.call(this),this.intervalTimer&&clearInterval(this.intervalTimer)},MainTaskItem.prototype.init=function(){this.bg=new s.NineSlicePatch(this.scene,0,0,this.width,this.height,o.d.uicommon,"task_chapter_bg",{left:8*this.dpr,top:8*this.dpr,right:8*this.dpr,bottom:8*this.dpr}),this.titleCon=this.scene.make.container(void 0,!1),this.titleCon.y=.5*-this.height+21*this.dpr;var t=this.scene.make.image({key:o.d.uicommon,frame:"task_chapter_title_left"}),e=this.scene.make.image({key:o.d.uicommon,frame:"task_chapter_title_right"}),i=this.scene.make.image({key:o.d.uicommon,frame:"task_chapter_title_middle"});i.y=-5*this.dpr,t.x=.5*-i.width-.5*t.width+7*this.dpr,e.x=.5*i.width+.5*e.width-7*this.dpr,this.titleTex=this.scene.make.text({text:"",style:{fontSize:12*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#FFF6CA"}}).setOrigin(.5),this.titleTex.setFontStyle("bold"),this.titleTex.y=i.y,this.titleCon.add([t,i,e,this.titleTex]),this.taskDes=this.scene.make.text({x:.5*-this.width+12*this.dpr,y:-2*this.dpr,text:"",style:{fontSize:12*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#8C6003"}}).setOrigin(0,.5),this.taskDes.setWordWrapWidth(160*this.dpr,!0);var n=this.scene.make.image({key:o.d.uicommon,frame:"task_chapter_gift_bg"});n.x=.5*this.width-10*this.dpr-.5*n.width,n.y=10*this.dpr;var h=new r.ButtonEventDispatcher(this.scene,0,0);h.setSize(n.width,n.height),h.enable=!0,h.on(s.ClickEvent.Tap,this.onReceiveAwardHandler,this),h.x=n.x,h.y=n.y,this.rewardRotateImg=this.scene.make.image({key:o.d.uicommon,frame:"task_chapter_gift_bg1"}),this.rewardRotateImg.x=n.x,this.rewardRotateImg.y=n.y,this.rewardsImg=new r.DynamicImage(this.scene,0,0),this.rewardsImg.x=n.x,this.rewardsImg.y=n.y,this.rewardsImg.scale=this.dpr/this.zoom;var l={width:153*this.dpr,height:11*this.dpr,correct:0};this.progress=new r.ProgressThreeBar(this.scene,o.d.uicommon,["task_chapter_progress_bott_left","task_chapter_progress_bott_middle","task_chapter_progress_bott_right"],["task_chapter_progress_top_left","task_chapter_progress_top_middle","task_chapter_progress_top_right"],void 0,l,l),this.progress.x=.5*-this.width+.5*this.progress.width+15*this.dpr,this.progress.y=34*this.dpr,this.progressTex=this.scene.make.text({x:this.progress.x,y:this.progress.y+15*this.dpr,text:"",style:{fontSize:12*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#794400"}}).setOrigin(.5),this.add([this.bg,this.titleCon,this.taskDes,this.progress,this.progressTex,n,this.rewardRotateImg,this.rewardsImg,h])},MainTaskItem.prototype.onReceiveAwardHandler=function(){this.isFinish&&!this.mainData.rewardsReceived&&this.send&&this.send.runWith([this.mainData.id])},MainTaskItem.prototype.getFinishProgress=function(t){for(var e=0,i=0,n=t.quests;i<n.length;i++){n[i].stage===h.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_END&&e++}return e},MainTaskItem.prototype.playProgressTween=function(t,e,i,n){var s=this;if(this.scene)var r=this.scene.tweens.addCounter({from:t,to:e,ease:"Linear",duration:n,onUpdate:function(t,e){if(!s.scene)return r.stop(),void r.remove();var n=e.value;s.progress.setProgress(n,i),s.progressTex.text=Math.floor(1e3*n/i)/10+"%"},onComplete:function(){r.stop(),e===i&&s.playRotateTween()}})},MainTaskItem.prototype.playRotateTween=function(){var t=this;this.scene&&(this.intervalTimer&&clearInterval(this.intervalTimer),this.intervalTimer=setInterval((function(){t.scene?t.rewardRotateImg.rotation+=.1:t.intervalTimer&&clearInterval(t.intervalTimer)}),30))},MainTaskItem}(Phaser.GameObjects.Container),u=function(){function MainTaskAnimation(t,e,i,n,s){this.listPosY=[],this.tempItems=[],this.isDispose=!1,this.indexed=-1,this.scene=t,this.mainItem=e,this.taskItems=i,this.width=n,this.dpr=s,this.setItemLayout()}return MainTaskAnimation.prototype.playIntoAnimation=function(){var t=this;this.mainItem.refreshMask(),this.playMoveX(this.mainItem,this.mainItem.x,0,!1),setTimeout((function(){t.mainItem.refreshMask(),t.playNextAnimation()}),300)},MainTaskAnimation.prototype.dispose=function(){this.tempItems.length=0,this.taskItems.length=0,this.mainItem=void 0,this.taskItems=void 0,this.tempItems=void 0,this.isDispose=!0},MainTaskAnimation.prototype.setItemLayout=function(){this.mainItem.x=-this.width-10*this.dpr;for(var t=0,e=this.taskItems;t<e.length;t++){var i=e[t];i.x=-this.width-10*this.dpr,this.listPosY.push(i.y)}},MainTaskAnimation.prototype.playNextAnimation=function(){if(!this.isDispose&&0!==this.taskItems.length){-1===this.indexed?this.indexed=this.taskItems.length-1:this.indexed--;var t=this.taskItems[this.indexed];t.y=this.listPosY[0],t.alpha=0,this.tempItems.push(t),this.playMoveX(t,t.x,0,!0),this.playAlpha(t,0,1,"Cubic.easeIn")}},MainTaskAnimation.prototype.playMoveX=function(t,e,i,n){var s=this;if(!this.isDispose)var r=this.scene.tweens.add({targets:t,x:{from:e,to:i},ease:"Linear",duration:300,onComplete:function(){r.stop(),r.remove(),n&&(s.indexed>0?s.playMoveY():s.dispose())}})},MainTaskAnimation.prototype.playAlpha=function(t,e,i,n){if(!this.isDispose)var s=this.scene.tweens.add({targets:t,alpha:{from:e,to:i},ease:n,duration:250,onComplete:function(){s.stop(),s.remove()}})},MainTaskAnimation.prototype.playMoveY=function(){var t=this;if(!this.isDispose)var e=this.listPosY[this.indexed]-this.listPosY[this.indexed-1],i=0,n=this.scene.tweens.addCounter({from:0,to:e,ease:"Linear",duration:200,onUpdate:function(e,n){for(var s=n.value-i,r=0,o=t.tempItems;r<o.length;r++){o[r].y+=s}i=n.value},onComplete:function(){n.stop(),n.remove(),t.playNextAnimation()}})},MainTaskAnimation}(),y=function(){function MainTaskGooutAnimation(t,e,i,n){this.listPosY=[],this.tempItems=[],this.isDispose=!1,this.scene=t,this.taskItems=e,this.width=i,this.dpr=n,this.setItemLayout()}return MainTaskGooutAnimation.prototype.playGoOutAnimation=function(){for(var t=this,e=[],i=[],n=[],s=this.taskItems.length-1;s>=0;s--){var r=this.taskItems[s];if(r.questData.stage===h.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_END&&(e.push(r),this.taskItems.splice(s,1),s<this.taskItems.length)){var o=this.taskItems.slice(s,this.taskItems.length);i.push(o),n.push(s)}}var a=this.width+10*this.dpr;e.length>0&&(this.playMoveX(e,0,a),this.playAlpha(e,0,1,"Cubic.easeOut"),setTimeout((function(){for(var e=0;e<i.length;e++){var s=i[e],r=n[e];t.playMoveGooutY(s,r)}}),300))},MainTaskGooutAnimation.prototype.dispose=function(){this.tempItems.length=0,this.taskItems.length=0,this.taskItems=void 0,this.tempItems=void 0,this.isDispose=!0},MainTaskGooutAnimation.prototype.setItemLayout=function(){for(var t=0,e=this.taskItems;t<e.length;t++){var i=e[t];this.listPosY.push(i.y)}},MainTaskGooutAnimation.prototype.playMoveX=function(t,e,i){var n=this;if(!this.isDispose)var s=this.scene.tweens.add({targets:t,x:{from:e,to:i},ease:"Linear",duration:300,onComplete:function(){if(s.stop(),s.remove(),n.scene)for(var e=0,i=t;e<i.length;e++){i[e].visible=!1}}})},MainTaskGooutAnimation.prototype.playAlpha=function(t,e,i,n){if(!this.isDispose)var s=this.scene.tweens.add({targets:t,alpha:{from:e,to:i},ease:n,duration:250,onComplete:function(){s.stop(),s.remove()}})},MainTaskGooutAnimation.prototype.playMoveGooutY=function(t,e){var i=this;if(!this.isDispose)var n=this.listPosY[e+1]-this.listPosY[e],s=0,r=this.scene.tweens.addCounter({from:0,to:n,ease:"Linear",duration:200,onUpdate:function(e,i){for(var n=i.value-s,r=0,o=t;r<o.length;r++){o[r].y-=n}s=i.value},onComplete:function(){r.stop(),r.remove(),i.isDispose||i.dispose()}})},MainTaskGooutAnimation}()},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaItemTipsPanel",(function(){return c}));var n,s=i(11),r=i(470),o=i(471),a=i(476),h=i(1),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaItemTipsPanel(e){var i=t.call(this,e)||this;return i.atlasNames=[s.d.uicommon],i.key=h.ModuleName.PICAITEMTIPSPANEL_NAME,i.uiLayer=r.MainUIScene.LAYER_TOOLTIPS,i}return l(PicaItemTipsPanel,t),Object.defineProperty(PicaItemTipsPanel,"Inst",{get:function(){return this.mInstance||(this.mInstance=a.PicaSingleManager.createSinglePanel(PicaItemTipsPanel)),this.mInstance},enumerable:!1,configurable:!0}),PicaItemTipsPanel.prototype.showTips=function(t,e){this.mInitialized?this.displayTips(t,e):this.show({gameobj:t,data:e})},PicaItemTipsPanel.prototype.destroy=function(){t.prototype.destroy.call(this),PicaItemTipsPanel.mInstance=void 0},PicaItemTipsPanel.prototype.onShow=function(){if(this.mShowData){var t=this.mShowData;this.displayTips(t.gameobj,t.data)}},PicaItemTipsPanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight;this.setSize(e,i),this.itemTips=new r.ItemInfoTips(this.scene,121*this.dpr,46*this.dpr,s.d.uicommon,"tips_bg",this.dpr),this.itemTips.setVisible(!1),this.add(this.itemTips),t.prototype.init.call(this)},PicaItemTipsPanel.prototype.displayTips=function(t,e){this.itemTips.setVisible(!0),this.itemTips.setItemData(e),this.setTipsPosition(t,.5*-t.height-5*this.dpr)},PicaItemTipsPanel.prototype.setTipsPosition=function(t,e){void 0===e&&(e=0);var i=t.getWorldTransformMatrix(),n=i.tx/this.scale,s=i.ty/this.scale,r=this.itemTips.width,o=.5*r+10*this.dpr,a=this.width-.5*r-10*this.dpr;n<o?n=o:n>a&&(n=a),s+=e,this.itemTips.x=n,this.itemTips.y=s},PicaItemTipsPanel}(o.PicaBasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaTreasureAllOpenPanel",(function(){return l}));var n,s=i(5),r=i(0),o=i(11),a=i(472),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaTreasureAllOpenPanel(e,i,n,s,r,o){var a=t.call(this,e)||this;return a.lightAniKey="treasurelight",a.starAniKey="treasurestar",a.indexed=0,a.isDispose=!1,a.tweens=[],a.maskWidth=0,a.maskHeight=0,a.dpr=r,a.zoom=o,a.key=s,a.setSize(i,n),a.init(),a}return h(PicaTreasureAllOpenPanel,t),PicaTreasureAllOpenPanel.prototype.resize=function(t,e){this.setSize(t,e);var i=this.getWorldTransformMatrix();this.maskGraphic.setPosition(i.tx,i.ty)},PicaTreasureAllOpenPanel.prototype.addListen=function(){this.confirmBtn.on(s.ClickEvent.Tap,this.onConfirmBtnClick,this)},PicaTreasureAllOpenPanel.prototype.removeListen=function(){this.confirmBtn.off(s.ClickEvent.Tap,this.onConfirmBtnClick,this)},PicaTreasureAllOpenPanel.prototype.init=function(){var t=.5*-this.height,e=this.scene.make.image({x:0,y:t+5*this.dpr,key:o.d.treasure,frame:"treasure_title_bg"},!1);this.titleimage=this.scene.make.image({x:0,y:e.y,key:o.d.treasure,frame:r.i18n.t("treasure.titleimg")},!1),this.titleimage.alpha=0,this.add([e,this.titleimage]),this.lightSprite=this.createSprite(o.d.circleeffect,this.lightAniKey,"",[1,16]),this.lightSprite.x=5*this.dpr,this.add(this.lightSprite),this.starSprite=this.createSprite(o.d.stareffect,this.starAniKey,"star",[1,18],10,-1),this.add(this.starSprite),this.starSprite.x=this.lightSprite.y;var i=this.maskWidth=this.width,n=this.maskHeight=200*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(i,n),this.add(this.content),this.maskGraphic=this.scene.make.graphics(void 0,!1),this.maskGraphic.fillStyle(0),this.maskGraphic.fillRect(.5*-i*this.zoom,.5*-n*this.zoom,i*this.zoom,n*this.zoom);var a=this.getWorldTransformMatrix();this.maskGraphic.setPosition(a.tx,a.ty),this.content.setMask(this.maskGraphic.createGeometryMask()),this.confirmBtn=new s.Button(this.scene,o.d.treasure,"butt","butt",r.i18n.t("common.confirm")),this.confirmBtn.y=-t-8*this.dpr,this.confirmBtn.setTextStyle(r.UIHelper.brownishStyle(this.dpr,20)),this.confirmBtn.setFontStyle("bold"),this.confirmBtn.alpha=0,this.add(this.confirmBtn)},PicaTreasureAllOpenPanel.prototype.setHandler=function(t){this.closeHandler=t},PicaTreasureAllOpenPanel.prototype.destroy=function(){if(t.prototype.destroy.call(this),this.isDispose=!0,this.tweens.length>0)for(var e=0,i=this.tweens;e<i.length;e++){var n=i[e];n.stop(),n.remove()}this.tweens.length=0},PicaTreasureAllOpenPanel.prototype.setTreasureData=function(t){if(t){this.treasureData=t;var e=this.getNextDatas(),i=this.createLayoutGroup(e),n=.5*(i.height-this.maskHeight);this.setLayoutPanel(i.width,i.height),this.playAnimation();var s=280*this.dpr+n;i.y=s,this.playItemTween(i,s,n,620),this.curLayoutGroup=i}},PicaTreasureAllOpenPanel.prototype.setLayoutPanel=function(t,e){var i=this.width,n=e+40*this.dpr;this.maskGraphic.clear(),this.maskGraphic.fillStyle(0),this.maskGraphic.fillRect(.5*-i*this.zoom,.5*-n*this.zoom,i*this.zoom,n*this.zoom);var s=this.getWorldTransformMatrix(),r=.5*(e-this.maskHeight);this.maskGraphic.setPosition(s.tx,s.ty+r),this.confirmBtn.y=.5*this.height+38*this.dpr+r},PicaTreasureAllOpenPanel.prototype.playAnimation=function(){var t=this;this.titleimage.alpha=0,this.lightSprite.play(this.lightAniKey),setTimeout((function(){t.starSprite.play(t.starAniKey)}),208);var e=this.scene.tweens.add({targets:this.titleimage,alpha:{from:0,to:1},duration:300,onComplete:function(){e.stop(),e.remove()}});this.tweens.push(e);var i=this.scene.tweens.add({targets:this.confirmBtn,alpha:{from:0,to:1},duration:200,delay:720,onComplete:function(){i.stop(),i.remove()}});this.tweens.push(i)},PicaTreasureAllOpenPanel.prototype.playItemTween=function(t,e,i,n){var s=this,r=this.scene.tweens.add({targets:t,y:{from:e,to:i},ease:"Back.easeOut",duration:300,delay:n,onComplete:function(){r.stop(),r.remove(),s.playPageCount()}});this.tweens.push(r);var o=this.curLayoutGroup;if(o){var a=this.scene.tweens.add({targets:o,alpha:{from:1,to:0},duration:200,onComplete:function(){a.stop(),a.remove(),o.destroy()}});this.tweens.push(a)}},PicaTreasureAllOpenPanel.prototype.playPageCount=function(){this.isDispose},PicaTreasureAllOpenPanel.prototype.getNextDatas=function(){var t=this.treasureData;if(!(this.indexed>=t.length)){var e=this.indexed,i=t.length;return this.indexed=i,t.slice(e,i)}},PicaTreasureAllOpenPanel.prototype.createLayoutGroup=function(t){var e=new c(this.scene,0,this.maskHeight,235*this.dpr,this.maskHeight,this.dpr,this.zoom);return this.content.add(e),e.setRewardDatas(t),e},PicaTreasureAllOpenPanel.prototype.createSprite=function(t,e,i,n,s,r){void 0===s&&(s=30),void 0===r&&(r=0);var o=this.scene.make.sprite({key:t,frame:i+"1"});return this.scene.anims.create({key:e,frames:this.scene.anims.generateFrameNames(t,{prefix:i+"",start:n[0],end:n[1]}),frameRate:s,repeat:r}),o},PicaTreasureAllOpenPanel.prototype.onConfirmBtnClick=function(){var t=this.getNextDatas();if(t){var e=this.createLayoutGroup(t),i=.5*(e.height-this.maskHeight),n=280*this.dpr+i;e.y=n,this.playItemTween(e,n,i,200),this.curLayoutGroup=e}else this.closeHandler&&this.closeHandler.run()},PicaTreasureAllOpenPanel}(Phaser.GameObjects.Container),c=function(t){function RewardLayoutGroup(e,i,n,s,r,o,a){var h=t.call(this,e,i,n)||this;return h.dpr=o,h.zoom=a,h.setSize(s,r),h}return h(RewardLayoutGroup,t),RewardLayoutGroup.prototype.setRewardDatas=function(t){if(t){for(var e=t.length,i=0;i<e;i++){var n=new a.ItemButton(this.scene,o.d.uicommon1,"roam_reward_ordinary_bg",this.dpr,this.zoom,!0);n.setStateFrames("roam_reward_ordinary_bg","roam_reward_rare_bg"),n.setItemData(t[i]),this.add(n)}this.setLayout()}},RewardLayoutGroup.prototype.setLayout=function(){var t=this.list;if(0!==t.length){var e=t[0],i=t.length,n=e.width,s=e.height,r=0,o=0;if(i<=3)for(var a=2===i?20*this.dpr:10*this.dpr,h=i*n+a*(i-1),l=0;l<i;l++){(P=t[l]).x=.5*-h+(n+a)*l+.5*n}else if(4===i){var c=20*this.dpr,p=15*this.dpr;for(l=0;l<2;l++)for(var d=0;d<2;d++){(P=t[2*l+d]).x=.5*-(n+c)+(n+c)*d,P.y=.5*-(s+p)+(s+p)*l}}else if(5===i){h=3*n+2*(c=10*this.dpr);var m=2*s+(p=15*this.dpr);for(l=0;l<3;l++){(P=t[l]).x=.5*-h+(n+c)*l+.5*n,P.y=.5*-m+.5*s}for(d=0;d<2;d++){(P=t[d+3]).x=.5*-(2*n+c)+.5*n+(n+c)*d,P.y=.5*m-.5*s}}else if(6===i)for(h=3*n+2*(c=10*this.dpr),m=2*s+(p=15*this.dpr),l=0;l<2;l++)for(d=0;d<3;d++){(P=t[3*l+d]).x=.5*-h+(n+c)*d+.5*n,P.y=.5*-m+(s+p)*l+.5*s}else{c=10*this.dpr,p=10*this.dpr;var u=Math.floor(t.length/4),y=t.length%4,f=(h=4*n+3*c,u+(0===y?0:1));for(m=f*s+p*(f-1),l=0;l<u;l++)for(d=0;d<4;d++){(P=t[4*l+d]).x=.5*-h+(n+c)*d+.5*n,P.y=.5*-m+(s+p)*l+.5*s}var g=y*n+c*(y-1);for(d=0;d<y;d++){var P;(P=t[d+4*u]).x=.5*-g+.5*n+(n+c)*d,P.y=.5*m-.5*s}r=h,o=m,this.width<r&&(this.width=r),this.height<o&&(this.height=o)}}},RewardLayoutGroup}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaTreasureOpenPanel",(function(){return l}));var n,s=i(5),r=i(0),o=i(11),a=i(472),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaTreasureOpenPanel(e,i,n,s,r,o){var a=t.call(this,e)||this;return a.lightAniKey="treasurelight",a.starAniKey="treasurestar",a.indexed=0,a.isDispose=!1,a.tweens=[],a.maskWidth=0,a.maskHeight=0,a.dpr=r,a.zoom=o,a.key=s,a.setSize(i,n),a.init(),a}return h(PicaTreasureOpenPanel,t),PicaTreasureOpenPanel.prototype.resize=function(t,e){this.setSize(t,e);var i=this.getWorldTransformMatrix();this.maskGraphic.setPosition(i.tx,i.ty)},PicaTreasureOpenPanel.prototype.addListen=function(){this.confirmBtn.on(s.ClickEvent.Tap,this.onConfirmBtnClick,this)},PicaTreasureOpenPanel.prototype.removeListen=function(){this.confirmBtn.off(s.ClickEvent.Tap,this.onConfirmBtnClick,this)},PicaTreasureOpenPanel.prototype.init=function(){var t=.5*-this.height,e=this.scene.make.image({x:0,y:t+5*this.dpr,key:o.d.treasure,frame:"treasure_title_bg"},!1);this.titleimage=this.scene.make.image({x:0,y:e.y,key:o.d.treasure,frame:r.i18n.t("treasure.titleimg")},!1),this.titleimage.alpha=0,this.pageCount=this.scene.make.text({x:0,y:this.titleimage.y+40*this.dpr,text:"1/6",style:{color:"#FFE400",fontFamily:r.Font.DEFULT_FONT,fontSize:16*this.dpr}}).setOrigin(.5).setFontStyle("bold"),this.pageCount.visible=!1,this.add([e,this.titleimage,this.pageCount]),this.lightSprite=this.createSprite(o.d.circleeffect,this.lightAniKey,"",[1,16]),this.lightSprite.x=5*this.dpr,this.add(this.lightSprite),this.starSprite=this.createSprite(o.d.stareffect,this.starAniKey,"star",[1,18],10,-1),this.add(this.starSprite),this.starSprite.x=this.lightSprite.y;var i=this.maskWidth=this.width,n=this.maskHeight=180*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(i,n),this.add(this.content),this.maskGraphic=this.scene.make.graphics(void 0,!1),this.maskGraphic.fillStyle(0),this.maskGraphic.fillRect(.5*-i*this.zoom,.5*-n*this.zoom,i*this.zoom,n*this.zoom);var a=this.getWorldTransformMatrix();this.maskGraphic.setPosition(a.tx,a.ty),this.content.setMask(this.maskGraphic.createGeometryMask()),this.pagedown=this.scene.make.text({x:0,y:-t-45*this.dpr,text:r.i18n.t("treasure.pagedown"),style:{color:"#96F7FF",fontFamily:r.Font.DEFULT_FONT,fontSize:12*this.dpr}}).setOrigin(.5),this.add(this.pagedown),this.pagedown.visible=!1,this.confirmBtn=new s.Button(this.scene,o.d.treasure,"butt","butt",r.i18n.t("common.confirm")),this.confirmBtn.y=-t-8*this.dpr,this.confirmBtn.setTextStyle(r.UIHelper.brownishStyle(this.dpr,20)),this.confirmBtn.setFontStyle("bold"),this.confirmBtn.alpha=0,this.add(this.confirmBtn)},PicaTreasureOpenPanel.prototype.setHandler=function(t){this.closeHandler=t},PicaTreasureOpenPanel.prototype.destroy=function(){if(t.prototype.destroy.call(this),this.isDispose=!0,this.tweens.length>0)for(var e=0,i=this.tweens;e<i.length;e++){var n=i[e];n.stop(),n.remove()}this.tweens.length=0},PicaTreasureOpenPanel.prototype.setTreasureData=function(t){if(t){this.treasureData=t;var e=this.getNextDatas(),i=this.createLayoutGroup(e);this.playAnimation();var n=160*this.dpr+.5*(i.height-this.maskHeight);this.playItemTween(i,n,620),this.curLayoutGroup=i}},PicaTreasureOpenPanel.prototype.playAnimation=function(){var t=this;this.titleimage.alpha=0,this.lightSprite.play(this.lightAniKey),setTimeout((function(){t.starSprite.play(t.starAniKey)}),208);var e=this.scene.tweens.add({targets:this.titleimage,alpha:{from:0,to:1},duration:300,onComplete:function(){e.stop(),e.remove()}});this.tweens.push(e);var i=this.scene.tweens.add({targets:this.confirmBtn,alpha:{from:0,to:1},duration:200,delay:720,onComplete:function(){i.stop(),i.remove()}});this.tweens.push(i)},PicaTreasureOpenPanel.prototype.playItemTween=function(t,e,i){var n=this,s=this.scene.tweens.add({targets:t,y:{from:e,to:0},ease:"Back.easeOut",duration:300,delay:i,onComplete:function(){s.stop(),s.remove(),n.playPageCount()}});this.tweens.push(s);var r=this.curLayoutGroup;if(r){var o=this.scene.tweens.add({targets:r,alpha:{from:1,to:0},duration:200,onComplete:function(){o.stop(),o.remove(),r.destroy()}});this.tweens.push(o)}},PicaTreasureOpenPanel.prototype.playPageCount=function(){if(!this.isDispose){var t=this.treasureData.length;if(!(t<6)){this.pageCount.visible=!0,this.pagedown.visible=!0;var e=Math.ceil(t/6),i=Math.ceil(this.indexed/6);this.pageCount.text=i+" /"+e}}},PicaTreasureOpenPanel.prototype.getNextDatas=function(){var t=this.treasureData;if(!(this.indexed>=t.length)){var e=this.indexed,i=t.length>=e+6?e+6:t.length;return this.indexed=i,t.slice(e,i)}},PicaTreasureOpenPanel.prototype.createLayoutGroup=function(t){var e=new c(this.scene,0,this.maskHeight,235*this.dpr,this.maskHeight,this.dpr,this.zoom);return this.content.add(e),e.setRewardDatas(t),e},PicaTreasureOpenPanel.prototype.createSprite=function(t,e,i,n,s,r){void 0===s&&(s=30),void 0===r&&(r=0);var o=this.scene.make.sprite({key:t,frame:i+"1"});return this.scene.anims.create({key:e,frames:this.scene.anims.generateFrameNames(t,{prefix:i+"",start:n[0],end:n[1]}),frameRate:s,repeat:r}),o},PicaTreasureOpenPanel.prototype.onConfirmBtnClick=function(){var t=this.getNextDatas();if(t){var e=this.createLayoutGroup(t),i=160*this.dpr+.5*(e.height-this.height);this.playItemTween(e,i,200),this.curLayoutGroup=e}else this.closeHandler&&this.closeHandler.run()},PicaTreasureOpenPanel}(Phaser.GameObjects.Container),c=function(t){function RewardLayoutGroup(e,i,n,s,r,o,a){var h=t.call(this,e,i,n)||this;return h.dpr=o,h.zoom=a,h.setSize(s,r),h}return h(RewardLayoutGroup,t),RewardLayoutGroup.prototype.setRewardDatas=function(t){if(t){for(var e=t.length,i=0;i<e;i++){var n=new a.ItemButton(this.scene,o.d.uicommon1,"roam_reward_ordinary_bg",this.dpr,this.zoom,!0);n.setStateFrames("roam_reward_ordinary_bg","roam_reward_rare_bg"),n.setItemData(t[i]),this.add(n)}this.setLayout()}},RewardLayoutGroup.prototype.setLayout=function(){var t=this.list;if(0!==t.length){var e=t[0],i=t.length,n=e.width,s=e.height;if(i<=3)for(var r=2===i?20*this.dpr:10*this.dpr,o=i*n+r*(i-1),a=0;a<i;a++){(d=t[a]).x=.5*-o+(n+r)*a+.5*n}else if(4===i){var h=20*this.dpr,l=15*this.dpr;for(a=0;a<2;a++)for(var c=0;c<2;c++){(d=t[2*a+c]).x=.5*-(n+h)+(n+h)*c,d.y=.5*-(s+l)+(s+l)*a}}else if(5===i){o=3*n+2*(h=10*this.dpr);var p=2*s+(l=15*this.dpr);for(a=0;a<3;a++){(d=t[a]).x=.5*-o+(n+h)*a+.5*n,d.y=.5*-p+.5*s}for(c=0;c<2;c++){(d=t[c+3]).x=.5*-(2*n+h)+.5*n+(n+h)*c,d.y=.5*p-.5*s}}else if(6===i)for(o=3*n+2*(h=10*this.dpr),p=2*s+(l=15*this.dpr),a=0;a<2;a++)for(c=0;c<3;c++){var d;(d=t[3*a+c]).x=.5*-o+(n+h)*c+.5*n,d.y=.5*-p+(s+l)*a+.5*s}}},RewardLayoutGroup}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaTreasurePreviewPanel",(function(){return c}));var n,s=i(5),r=i(475),o=i(0),a=i(11),h=i(472),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaTreasurePreviewPanel(e,i,n,s,r,o,a){var h=t.call(this,e)||this;return h.render=i,h.dpr=o,h.zoom=a,h.key=r,h.setSize(n,s),h.init(),h}return l(PicaTreasurePreviewPanel,t),PicaTreasurePreviewPanel.prototype.resize=function(t,e){this.setSize(t,e),this.rewardGameScroll.refreshMask()},PicaTreasurePreviewPanel.prototype.addListen=function(){this.confirmBtn.on(s.ClickEvent.Tap,this.onConfirmBtnClick,this),this.closeBtn.on("pointerup",this.OnClosePanel,this)},PicaTreasurePreviewPanel.prototype.removeListen=function(){this.confirmBtn.off("click",this.onConfirmBtnClick,this),this.closeBtn.on("pointerup",this.OnClosePanel,this)},PicaTreasurePreviewPanel.prototype.init=function(){var t=this;this.bg=new s.NineSlicePatch(this.scene,0,0,this.width,this.height,a.d.uicommon1,"bg1",o.UIHelper.background_w(this.dpr)),this.add(this.bg);var e=.5*-this.bg.height;this.titleimage=this.scene.make.image({x:0,y:e+5*this.dpr,key:a.d.uicommon1,frame:"title"},!1),this.titleimage.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titleName=this.scene.make.text({x:0,y:this.titleimage.y+2*this.dpr,text:"",style:o.UIHelper.titleYellowStyle_m(this.dpr)}).setOrigin(.5).setFontStyle("bold"),this.closeBtn=new s.Button(this.scene,a.c.commonKey,"close"),this.closeBtn.setDisplaySize(28*this.dpr,28*this.dpr),this.closeBtn.setPosition(.5*this.width-8*this.dpr,e+7*this.dpr),this.add([this.titleimage,this.titleName,this.closeBtn]),this.bgicon=this.scene.make.image({key:a.d.treasure,frame:"treasure_bg"}),this.bgicon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.bgicon.y=this.titleName.y+.5*this.bgicon.height+34*this.dpr,this.add([this.bg,this.bgicon]),this.mDetailDisplay=new r.a(this.scene,this.render),this.mDetailDisplay.y=this.bgicon.y,this.mDetailDisplay.setFixedScale(this.dpr/this.scale),this.mDetailDisplay.setSize(72*this.dpr,72*this.dpr),this.add(this.mDetailDisplay);var i=360*this.dpr,n=92*this.dpr;this.rewardCon=this.scene.make.container(void 0,!1).setSize(i,n),this.add(this.rewardCon),this.rewardCon.setPosition(0,-e-.5*n-68*this.dpr);var h=this.scene.make.text({x:0,y:.5*-n+8*this.dpr,text:o.i18n.t("treasure.tipslabel"),style:{color:"#253FCA",fontSize:12*this.dpr,fontFamily:o.Font.DEFULT_FONT}},!1).setOrigin(.5),l=this.scene.make.image({key:a.d.treasure,frame:"treasure_decorate_left"});l.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var c=this.scene.make.image({key:a.d.treasure,frame:"treasure_decorate_right"});c.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var p=.5*-h.width-.5*l.width-10*this.dpr;l.setPosition(p,h.y),c.setPosition(-p,h.y),this.rewardCon.add([h,l,c]),this.rewardGameScroll=new s.GameScroller(this.scene,{x:0,y:2*this.dpr,width:295*this.dpr,height:90*this.dpr,zoom:this.zoom,dpr:this.dpr,align:2,orientation:1,space:10*this.dpr,valuechangeCallback:void 0,cellupCallBack:function(e){t.onRewardItemHandler(e)}}),this.rewardCon.add(this.rewardGameScroll),this.confirmBtn=new s.Button(this.scene,a.d.treasure,"butt","butt",o.i18n.t("common.open")),this.confirmBtn.y=-e-38*this.dpr,this.confirmBtn.setTextStyle(o.UIHelper.brownishStyle(this.dpr,20)),this.confirmBtn.setFontStyle("bold"),this.add(this.confirmBtn)},PicaTreasurePreviewPanel.prototype.setHandler=function(t,e){this.sendHandler=t,this.closeHandler=e},PicaTreasurePreviewPanel.prototype.setTreasureData=function(t){this.titleName.text="某某某宝箱",this.setTreasureItems(t)},PicaTreasurePreviewPanel.prototype.setTreasureItems=function(t){this.rewardGameScroll.clearItems();for(var e=0;e<10;e++){var i=new h.ItemButton(this.scene,a.d.uicommon,"bag_icon_common_bg",this.dpr,this.zoom,!1);i.y=0,this.rewardGameScroll.addItem(i)}this.rewardGameScroll.Sort()},PicaTreasurePreviewPanel.prototype.onConfirmBtnClick=function(){this.treasureData;this.sendHandler&&this.sendHandler.run()},PicaTreasurePreviewPanel.prototype.OnClosePanel=function(){this.closeHandler&&this.closeHandler.run()},PicaTreasurePreviewPanel.prototype.onRewardItemHandler=function(t){this.selectMaterial&&this.selectMaterial!==t&&(this.selectMaterial.select=!1),t.select=!t.select,this.selectMaterial=t},PicaTreasurePreviewPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n,s=i(143),r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function RoomScene(){return null!==t&&t.apply(this,arguments)||this}return r(RoomScene,t),RoomScene.prototype.init=function(e){t.prototype.init.call(this,e),e&&(this.mRoomID=e.roomid)},RoomScene.prototype.create=function(){t.prototype.create.call(this)},RoomScene}(s.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var n,s=i(10),r=i(1),o=i(0),a=i(533),h=i(624),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function fulfilled(t){try{step(n.next(t))}catch(t){r(t)}}function rejected(t){try{step(n.throw(t))}catch(t){r(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function verb(r){return function(a){return function step(r){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(s=2&r[0]?n.return:r[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,r[1])).done)return s;switch(n=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],n=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},c=function(t){function FramesDisplay(e,i,n,s){var r=t.call(this,e,n,s)||this;return r.render=i,r.mID=void 0,r.mName=void 0,r.mID=n,r.mMovement=new h.a(e,r,i),r}return l(FramesDisplay,t),FramesDisplay.prototype.startLoad=function(){return this.scene.load.start(),Promise.resolve(null)},FramesDisplay.prototype.destroy=function(){this.mReferenceArea&&(this.mReferenceArea.destroy(),this.mReferenceArea=void 0),this.mChildMap&&(this.mChildMap.clear(),this.mChildMap=null),this.mTopDisplay&&this.mTopDisplay.destroy(),this.mMovement&&this.mMovement.destroy(),t.prototype.destroy.call(this)},Object.defineProperty(FramesDisplay.prototype,"titleMask",{get:function(){return this.mTitleMask},set:function(t){this.mTitleMask=t},enumerable:!1,configurable:!0}),FramesDisplay.prototype.setRootMount=function(e){t.prototype.setRootMount.call(this,e),this.updateTopDisplay()},FramesDisplay.prototype.showRefernceArea=function(t,e){return __awaiter(this,void 0,void 0,(function(){var i;return __generator(this,(function(n){return!t||t.length<=0||!e||(this.mReferenceArea||(this.mReferenceArea=new s.j(this.scene),this.addChildMap("reference",this.mReferenceArea)),i=this.render.mainPeer.getCurrentRoomSize(),this.mReferenceArea.draw(t,e,i.tileWidth,i.tileHeight),this.addAt(this.mReferenceArea,0)),[2]}))}))},FramesDisplay.prototype.hideRefernceArea=function(){this.mReferenceArea&&(this.mReferenceArea.destroy(),this.mReferenceArea=void 0)},FramesDisplay.prototype.updateTopDisplay=function(){this.mTopDisplay&&this.mTopDisplay.update()},FramesDisplay.prototype.showNickname=function(t){void 0===t&&(t=this.mName),this.mName=t,this.mTopDisplay||(this.mTopDisplay=new a.a(this.scene,this,this.render.scaleRatio)),this.checkShowNickname()&&this.mTopDisplay.showNickname(t)},FramesDisplay.prototype.showTopDisplay=function(t){if(!t)return this.mTopDisplay&&this.mTopDisplay.destroy(),void(this.mTopDisplay=void 0);this.mTopDisplay||(this.mTopDisplay=new a.a(this.scene,this,this.render.scaleRatio)),this.mTopDisplay.loadState(t)},FramesDisplay.prototype.showBubble=function(t,e){this.mTopDisplay||(this.mTopDisplay=new a.a(this.scene,this,this.render.scaleRatio)),this.mTopDisplay.showBubble(t,e)},FramesDisplay.prototype.clearBubble=function(){this.mTopDisplay&&this.mTopDisplay.clearBubble()},FramesDisplay.prototype.created=function(){t.prototype.created.call(this),this.render.mainPeer.elementDisplayReady(this.id)},FramesDisplay.prototype.play=function(e){if(t.prototype.play.call(this,e),this.fetchProjection(),this.mMountContainer&&this.mCurAnimation.mountLayer){var i=this.mSprites.get(r.DisplayField.STAGE);i&&i.addAt(this.mMountContainer,this.mCurAnimation.mountLayer.index)}},FramesDisplay.prototype.doMove=function(t){this.mMovement.doMove(t)},FramesDisplay.prototype.setPosition=function(e,i,n,s){return t.prototype.setPosition.call(this,e,i,n,s),this.updateTopDisplay(),this},FramesDisplay.prototype.addEffect=function(t){if(!t)return o.Logger.getInstance().error("Failed to add effect, display does not exist");var e=t.getSprite(r.DisplayField.BACKEND);e&&this.addAt(e,r.DisplayField.BACKEND);var i=t.getSprite(r.DisplayField.FRONTEND);i&&this.addAt(i,r.DisplayField.FRONTEND)},FramesDisplay.prototype.removeEffect=function(){this.mDisplayDatas.get(r.DisplayField.Effect)&&(this.mDisplayDatas.delete(r.DisplayField.Effect),this.removeDisplay(r.DisplayField.BACKEND),this.removeDisplay(r.DisplayField.FRONTEND))},FramesDisplay.prototype.mount=function(t,e){if(t&&!(this.mDisplays.length<=0)&&this.mCurAnimation)if(this.mCurAnimation.mountLayer){var i=this.mCurAnimation.mountLayer,n=i.index,s=i.mountPoint;if(void 0===e&&(e=0),e>=s.length)o.Logger.getInstance().error("mount index does not exist");else{var a=s[e].x;if(this.mAnimation.flip&&(a=0-a),t.x=a,t.y=s[e].y,this.mMountContainer||(this.mMountContainer=this.scene.make.container(void 0,!1)),!this.mMountContainer.parentContainer){var h=this.mSprites.get(r.DisplayField.STAGE);h&&h.addAt(this.mMountContainer,n)}this.mMountContainer.addAt(t,e),t.setRootMount(this),this.mMountList[e]=t,this.mMainSprite&&(this.mMainSprite.off("animationupdate",this.onAnimationUpdateHandler,this),this.mMainSprite.on("animationupdate",this.onAnimationUpdateHandler,this))}}else o.Logger.getInstance().error("mountLyaer does not exist "+this.mAnimation)},FramesDisplay.prototype.unmount=function(t){if(this.mMountContainer){this.render.displayManager.addToSurfaceLayer(t),t.setRootMount(void 0);var e=this.mMountList.indexOf(t);t.visible=!0,e>-1&&this.mMountList.splice(e,1),this.mMountContainer.list.length<=0&&this.mDisplays.length>0&&this.mDisplays[0].off("animationupdate",this.onAnimationUpdateHandler,this)}},FramesDisplay.prototype.scaleTween=function(){var t=this;if(!(this.mMountContainer&&this.mMountContainer.list.length>0||this.mScaleTween)){var e=this.scale;this.mScaleTween=this.scene.tweens.add({targets:this,duration:100,scale:1.25*e,yoyo:!0,repeat:0,onComplete:function(){t.scale=1,t.mScaleTween&&(t.mScaleTween=void 0)}})}},FramesDisplay.prototype.addChildMap=function(t,e){this.mChildMap||(this.mChildMap=new Map),this.mChildMap.set(t,e)},FramesDisplay.prototype.fetchProjection=function(){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return this.id?(t=this,[4,this.render.mainPeer.fetchProjectionSize(this.id)]):[2];case 1:return t.mProjectionSize=e.sent(),this.updateSort(),[2]}}))}))},FramesDisplay.prototype.completeFrameAnimationQueue=function(){t.prototype.completeFrameAnimationQueue.call(this),this.render.mainPeer.completeFrameAnimationQueue(this.id)},FramesDisplay.prototype.checkShowNickname=function(){return(this.mTitleMask&r.TitleMask.TQ_NickName)>0},FramesDisplay.prototype.clear=function(){t.prototype.clear.call(this),this.mMountContainer&&this.mMountContainer.parentContainer&&this.mMountContainer.parentContainer.remove(this.mMountContainer)},FramesDisplay.prototype.onAnimationUpdateHandler=function(t,e){if(this.mMountContainer&&this.mCurAnimation){var i=this.mCurAnimation.mountLayer.frameVisible;if(i){var n=e.index-1;if(!(n>i.length))for(var s=0;s<this.mMountList.length;s++)this.mMountList[s].visible=this.getMaskValue(i[n],s)}}},FramesDisplay.prototype.getMaskValue=function(t,e){return(t>>e)%2==1},Object.defineProperty(FramesDisplay.prototype,"nickname",{get:function(){return this.mName},enumerable:!1,configurable:!0}),FramesDisplay}(s.c)},function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n,s=i(0),r=i(604),o=i(10),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function ElementTopDisplay(e,i,n){var s=t.call(this,e,i,n)||this;return s.isDispose=!1,s}return a(ElementTopDisplay,t),ElementTopDisplay.prototype.showNickname=function(t){if(this.mOwner){var e=this.mFollows.get(o.f.Nickname),i=null;e?i=e.object:(i=this.scene.make.text({style:{fontSize:12*this.mDpr,fontFamily:s.Font.DEFULT_FONT}}).setOrigin(.5).setStroke("#000000",2*this.mDpr),e=new o.g(i,this.mOwner,this.mDpr),this.mFollows.set(o.f.Nickname,e)),i.text=t,this.mOwner.topPoint&&(this.addToSceneUI(i),e.setOffset(0,this.mOwner.topPoint.y),e.update())}},ElementTopDisplay.prototype.hideNickname=function(){this.removeFollowObject(o.f.Nickname)},ElementTopDisplay.prototype.showBubble=function(t,e){var i=this.scene;i&&(this.mBubble||(this.mBubble=new r.a(i,this.mDpr)),this.mBubble.addBubble(t,e),this.mBubble.follow(this.mOwner),this.addToSceneUI(this.mBubble))},ElementTopDisplay.prototype.clearBubble=function(){this.mBubble&&(this.mBubble.destroy(),this.mBubble=null)},ElementTopDisplay.prototype.loadState=function(t){var e=this,i="state_"+t;if(this.scene.cache.json.exists(i))this.showStateHandler(this.scene.cache.json.get(i));else{this.scene.load.once("filecomplete-json-"+i,(function(t){i===t&&e.showStateHandler(e.scene.cache.json.get(i))}),this),this.scene.load.json(i,s.Url.getRes("config/base/state/"+t+".json")),this.scene.load.start()}},ElementTopDisplay.prototype.showUIState=function(t){var e=this;if("text"!==t.type){var i=t.image.display.texturepath,n=t.image.display.datapath;this.loadAtals(i,n,this,(function(){var n,s,r=t.image.img;if("sprite"===t.type){var a=t.image.animation,h=a.frame;e.scene.anims.create({key:a.anikey,frames:e.scene.anims.generateFrameNames(i,{prefix:r+"_",frames:h}),duration:a.duration,repeat:a.repeat}),e.mFollows.has(o.f.Sprite)?s=(n=e.mFollows.get(o.f.Sprite)).object:(s=e.scene.make.sprite({key:i,frame:r+"_1"}),n=new o.g(s,e.mOwner,e.mDpr),e.mFollows.set(o.f.Sprite,n)),s.play(a.anikey)}else e.mFollows.has(o.f.Sprite)?(s=(n=e.mFollows.get(o.f.Sprite)).object).setTexture(i,r):(s=e.scene.make.image({key:i,frame:r}),n=new o.g(s,e.mOwner,e.mDpr),e.mFollows.set(o.f.Sprite,n));var l=e.getYOffset();n.setOffset(0,l.y),e.addToSceneUI(s),n.update()}))}},ElementTopDisplay.prototype.getYOffset=function(){var t=new Phaser.Geom.Point;return t.x=0,t.y=this.mOwner.topPoint.y,t},ElementTopDisplay.prototype.addDisplay=function(){var t=this;this.mFollows&&this.mFollows.forEach((function(e){e.object&&t.addToSceneUI(e.object)}))},ElementTopDisplay.prototype.removeDisplay=function(){this.mFollows&&this.mFollows.forEach((function(t){return t.remove()}))},ElementTopDisplay.prototype.hasTopPoint=function(){return this.mOwner&&this.mOwner.topPoint},ElementTopDisplay.prototype.hasNickName=function(){return!!this.mFollows.has(o.f.Nickname)},ElementTopDisplay.prototype.destroy=function(){this.mFollows&&(this.mFollows.forEach((function(t){return t.destroy()})),this.mFollows.clear(),this.mFollows=void 0),this.mBubble&&(this.mBubble.destroy(),this.mBubble=void 0)},ElementTopDisplay.prototype.update=function(){this.mFollows&&this.mFollows.forEach((function(t){return t.update()})),this.mBubble&&this.mBubble.follow(this.mOwner)},ElementTopDisplay.prototype.addToSceneUI=function(t){this.mOwner&&t&&this.scene.layerManager.addToLayer("sceneUILayer",t)},ElementTopDisplay.prototype.loadAtals=function(t,e,i,n){var r=this;this.scene.textures.exists(t)?!this.isDispose&&n&&n.call(i):(this.scene.load.atlas(t,s.Url.getUIRes(this.mDpr,t),s.Url.getUIRes(this.mDpr,e)),this.scene.load.once(Phaser.Loader.Events.COMPLETE,(function(){!r.isDispose&&n&&n.call(i)}),this),this.scene.load.start())},ElementTopDisplay.prototype.showStateHandler=function(t){this.showUIState(t)},ElementTopDisplay}(o.m)},function(t,e,i){"use strict";i.d(e,"a",(function(){return p}));var n,s=i(10),r=i(0),o=i(1),a=i(600),h=i(533),l=i(624),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function fulfilled(t){try{step(n.next(t))}catch(t){r(t)}}function rejected(t){try{step(n.throw(t))}catch(t){r(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function verb(r){return function(a){return function step(r){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(s=2&r[0]?n.return:r[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,r[1])).done)return s;switch(n=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],n=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},p=function(t){function DragonbonesDisplay(e,i,n,s,r){var o=t.call(this,e)||this;return o.render=i,o.uuid=s,o.mID=void 0,o.mNodeType=void 0,o.mSortX=0,o.mSortY=0,o.mName=void 0,o.mID=n,o.mNodeType=r,o.mLoadQueue=new a.a(e),o.mLoadQueue.on("QueueProgress",o.fileComplete,o),o.mLoadQueue.on("QueueError",o.fileError,o),o.mMovement=new l.a(e,o,i),o}return c(DragonbonesDisplay,t),DragonbonesDisplay.prototype.load=function(e,i){return(i=i||o.DisplayField.STAGE)!==o.DisplayField.STAGE?Promise.reject("field is not STAGE"):t.prototype.load.call(this,e)},DragonbonesDisplay.prototype.startLoad=function(){var t=this;return new Promise((function(e,i){t.mLoadQueue&&!t.mCreated?(t.mLoadQueue.once("QueueComplete",(function(){e(null)}),t),t.mLoadQueue.startLoad()):e(null)}))},DragonbonesDisplay.prototype.destroy=function(){this.mLoadQueue&&(this.mLoadQueue.off("QueueProgress",this.fileComplete,this),this.mLoadQueue.off("QueueError",this.fileError,this),this.mLoadQueue.destroy()),this.mReferenceArea&&(this.mReferenceArea.destroy(),this.mReferenceArea=void 0),this.mTopDisplay&&this.mTopDisplay.destroy(),this.mMovement&&this.mMovement.destroy(),t.prototype.destroy.call(this)},Object.defineProperty(DragonbonesDisplay.prototype,"id",{get:function(){return this.mID},enumerable:!1,configurable:!0}),Object.defineProperty(DragonbonesDisplay.prototype,"nodeType",{get:function(){return this.mNodeType},enumerable:!1,configurable:!0}),Object.defineProperty(DragonbonesDisplay.prototype,"titleMask",{get:function(){return this.mTitleMask},set:function(t){this.mTitleMask=t},enumerable:!1,configurable:!0}),DragonbonesDisplay.prototype.setRootMount=function(e){t.prototype.setRootMount.call(this,e),this.updateTopDisplay()},DragonbonesDisplay.prototype.showRefernceArea=function(t,e){return __awaiter(this,void 0,void 0,(function(){var i;return __generator(this,(function(n){switch(n.label){case 0:return!t||t.length<=0||!e?[2]:(this.mReferenceArea||(this.mReferenceArea=new s.j(this.scene)),[4,this.render.mainPeer.getCurrentRoomSize()]);case 1:return i=n.sent(),this.mReferenceArea.draw(t,e,i.tileWidth,i.tileHeight),this.addAt(this.mReferenceArea,0),[2]}}))}))},DragonbonesDisplay.prototype.hideRefernceArea=function(){this.mReferenceArea&&(this.mReferenceArea.destroy(),this.mReferenceArea=void 0)},DragonbonesDisplay.prototype.updateTopDisplay=function(){this.mTopDisplay&&this.mTopDisplay.update()},DragonbonesDisplay.prototype.showNickname=function(t){void 0===t&&(t=this.mName),this.mName=t,this.mTopDisplay||(this.mTopDisplay=new h.a(this.scene,this,this.render.scaleRatio)),this.checkShowNickname()&&this.mTopDisplay.showNickname(t)},DragonbonesDisplay.prototype.showTopDisplay=function(t){if(!t)return this.mTopDisplay&&this.mTopDisplay.destroy(),void(this.mTopDisplay=void 0);this.mTopDisplay||(this.mTopDisplay=new h.a(this.scene,this,this.render.scaleRatio)),this.mTopDisplay.loadState(t)},DragonbonesDisplay.prototype.showBubble=function(t,e){this.mTopDisplay||(this.mTopDisplay=new h.a(this.scene,this,this.render.scaleRatio)),this.mTopDisplay.showBubble(t,e)},DragonbonesDisplay.prototype.clearBubble=function(){this.mTopDisplay&&this.mTopDisplay.clearBubble()},DragonbonesDisplay.prototype.created=function(){t.prototype.created.call(this),this.render.mainPeer.elementDisplayReady(this.id),this.render.renderEmitter("dragonBones_initialized")},Object.defineProperty(DragonbonesDisplay.prototype,"projectionSize",{get:function(){return this.mProjectionSize||(this.mProjectionSize={offset:{x:0,y:0},width:0,height:0}),this.mProjectionSize},enumerable:!1,configurable:!0}),DragonbonesDisplay.prototype.play=function(e){t.prototype.play.call(this,e),this.fetchProjection()},DragonbonesDisplay.prototype.doMove=function(t){this.mMovement.doMove(t)},DragonbonesDisplay.prototype.setPosition=function(e,i,n,s){return t.prototype.setPosition.call(this,e,i,n,s),this.updateTopDisplay(),this},DragonbonesDisplay.prototype.addEffect=function(t){if(!t)return r.Logger.getInstance().error("Failed to add effect, display does not exist");var e=t.getSprite(o.DisplayField.BACKEND);e&&this.addAt(e,o.DisplayField.BACKEND);var i=t.getSprite(o.DisplayField.FRONTEND);i&&this.addAt(i,o.DisplayField.FRONTEND)},DragonbonesDisplay.prototype.removeEffect=function(){},DragonbonesDisplay.prototype.mount=function(t,e){},DragonbonesDisplay.prototype.unmount=function(t){},Object.defineProperty(DragonbonesDisplay.prototype,"sortX",{get:function(){return this.mSortX},enumerable:!1,configurable:!0}),Object.defineProperty(DragonbonesDisplay.prototype,"sortY",{get:function(){return this.mSortY},enumerable:!1,configurable:!0}),DragonbonesDisplay.prototype.loadCompleteHander=function(){this.closePlaceholder()},DragonbonesDisplay.prototype.createArmatureDisplay=function(e,i,n){this.scene&&(this.mArmatureDisplay||this.showPlaceholder(),t.prototype.createArmatureDisplay.call(this,e,i,n))},DragonbonesDisplay.prototype.refreshAvatar=function(){t.prototype.refreshAvatar.call(this)},DragonbonesDisplay.prototype.fetchProjection=function(){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return this.id?(t=this,[4,this.render.mainPeer.fetchProjectionSize(this.id)]):[2];case 1:return t.mProjectionSize=e.sent(),[2]}}))}))},DragonbonesDisplay.prototype.fileComplete=function(t,e,i){e===this.resourceName&&"image"===i&&this.createArmatureDisplay()},DragonbonesDisplay.prototype.fileError=function(t){t===this.resourceName&&this.created()},DragonbonesDisplay.prototype.onArmatureLoopComplete=function(e){t.prototype.onArmatureLoopComplete.call(this,e),this.mArmatureDisplay&&this.mAnimation&&this.render.mainPeer.completeDragonBonesAnimationQueue(this.id)},DragonbonesDisplay.prototype.loadDragonBones=function(t,e,i){this.mLoadQueue.add([{type:a.b.DRAGONBONES,key:this.resourceName,textureUrl:t,jsonUrl:e,boneUrl:i}])},DragonbonesDisplay.prototype.generateReplaceTextureKey=function(){return t.prototype.generateReplaceTextureKey.call(this)+(this.uuid||0)},DragonbonesDisplay.prototype.checkShowNickname=function(){return(this.mTitleMask&o.TitleMask.TQ_NickName)>0},DragonbonesDisplay.prototype.showPlaceholder=function(){this.mPlaceholder&&this.mPlaceholder.destroy(),this.mPlaceholder=this.scene.make.image({key:"avatar_placeholder",x:-22,y:-68}).setOrigin(0),this.add(this.mPlaceholder)},DragonbonesDisplay.prototype.closePlaceholder=function(){this.mPlaceholder&&this.mPlaceholder.destroy(),this.mPlaceholder=void 0},Object.defineProperty(DragonbonesDisplay.prototype,"nickname",{get:function(){return this.mName},enumerable:!1,configurable:!0}),DragonbonesDisplay}(s.b)},function(t,e,i){"use strict";i.r(e),i.d(e,"ItemButton",(function(){return c}));var n,s=i(15),r=i(5),o=i(11),a=i(0),h=i(475),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function ItemButton(e,i,n,h,l,c){var p=t.call(this,e,0,0)||this;return p.bgFrame="bag_icon_common_bg",p.selectFrame="bag_icon_select_bg",p.rarityFrame="bag_icon_rare_bg",p.dpr=h,p.zoom=l,p.bgFrame=n,p.key=i,p.bg=e.make.image({key:i,frame:n}),p.selectbg=e.make.image({key:o.d.uicommon,frame:p.selectFrame}),p.setSize(p.selectbg.width,p.selectbg.height),p.itemIcon=new s.DynamicImage(e,0,0),p.itemIcon.scale=p.dpr/p.zoom,p.countTex=p.scene.make.text({text:"",style:a.UIHelper.blackStyle(h)}).setOrigin(1).setPosition(.5*p.width-5*h,.5*p.height-4*h),p.starImg=p.scene.make.image({key:o.d.uicommon,frame:"bag_star_small_1"}).setOrigin(0),p.starImg.x=.5*-p.width+6*h,p.starImg.y=.5*-p.height+6*h,p.add([p.selectbg,p.bg,p.itemIcon,p.starImg,p.countTex]),p.selectbg.visible=!1,p.enable=c,p.on(r.ClickEvent.Tap,p.onTabClickHandler,p),p}return l(ItemButton,t),ItemButton.prototype.setStateFrames=function(t,e){this.bgFrame=t,this.rarityFrame=e},ItemButton.prototype.setItemData=function(t,e){var i=this;if(void 0===e&&(e=!1),this.itemData=t,this.select=!1,this.itemIcon.visible=!1,this.starImg.visible=!1,!t)return this.countTex.visible=!1,void this.bg.setTexture(this.key,this.bgFrame);5===t.rarity?this.bg.setTexture(this.key,this.rarityFrame):this.bg.setTexture(this.key,this.bgFrame);var n=a.Url.getOsdRes(t.display.texturePath);if(this.itemIcon.load(n,this,(function(){i.itemIcon.visible=!0})),e||t.count>1?(this.countTex.visible=!0,this.countTex.setText(t.count.toString())):this.countTex.visible=!1,t.grade>0){this.starImg.visible=!0;var s="bag_star_small_"+t.grade;this.starImg.setFrame(s)}else this.starImg.visible=!1},Object.defineProperty(ItemButton.prototype,"select",{set:function(t){this.selectbg.visible=t},enumerable:!1,configurable:!0}),Object.defineProperty(ItemButton.prototype,"BGVisible",{set:function(t){this.bg.visible=t},enumerable:!1,configurable:!0}),ItemButton.prototype.showTips=function(){this.onTabClickHandler()},ItemButton.prototype.onTabClickHandler=function(){h.d.Inst.showTips(this,this.itemData)},ItemButton}(s.ButtonEventDispatcher)},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n,s=i(10),r=i(0),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),a=function(t){function CamerasManager(e){var i=t.call(this)||this;return i.render=e,i.MINI_VIEW_SIZE=50,i.VIEW_PORT_SIZE=50,i.viewPort=new Phaser.Geom.Rectangle,i.miniViewPort=new Phaser.Geom.Rectangle,i.mCameras=[],i.zoom=i.render.scaleRatio,i}return o(CamerasManager,t),CamerasManager.prototype.startRoomPlay=function(t){this.mMain=t.cameras.main},CamerasManager.prototype.pan=function(t,e,i){var n=this;t*=this.zoom,e*=this.zoom;for(var s=0,r=this.mCameras;s<r.length;s++){r[s].pan(t,e,i)}return new Promise((function(t,e){n.mMain.once(Phaser.Cameras.Scene2D.Events.PAN_COMPLETE,(function(){t()}))}))},Object.defineProperty(CamerasManager.prototype,"camera",{get:function(){return this.mMain},set:function(t){this.mMain=t,this.addCamera(t),this.setViewPortSize()},enumerable:!1,configurable:!0}),CamerasManager.prototype.resize=function(t,e){r.Logger.getInstance().debug("resize"),this.resetCameraSize(t,e),r.Logger.getInstance().debug("camera ===== resize"),this.mTarget&&(r.Logger.getInstance().debug("target ===== resize"),this.startFollow(this.mTarget))},CamerasManager.prototype.scrollTargetPoint=function(t,e,i){var n=this;this.mMain&&(this.stopFollow(),i?this.pan(t,e,1e3).then((function(){n.render.syncCameraScroll()})):(this.setScroll(t,e),this.render.syncCameraScroll()))},CamerasManager.prototype.destroy=function(){r.Logger.getInstance().debug("camerasmanager destroy"),this.mMain=void 0,this.mTarget=void 0,this.mCameras=[]},CamerasManager.prototype.resetCameraSize=function(t,e){r.Logger.getInstance().debug("resetCamerSize"),this.render.mainPeer.resetGameraSize(t,e)},CamerasManager.prototype.setViewPortSize=function(){if(this.mMain){var t=this.render.getCurrentRoomSize();if(t){var e=(this.VIEW_PORT_SIZE+this.VIEW_PORT_SIZE)*(t.tileWidth/2),i=(this.VIEW_PORT_SIZE+this.VIEW_PORT_SIZE)*(t.tileHeight/2);this.viewPort.setSize(e,i);var n=(this.MINI_VIEW_SIZE+this.MINI_VIEW_SIZE)*(t.tileWidth/2),s=(this.MINI_VIEW_SIZE+this.MINI_VIEW_SIZE)*(t.tileHeight/2);this.miniViewPort.setSize(n,s)}else r.Logger.getInstance().error("room size does not exist")}else r.Logger.getInstance().error("camera does not exist")},CamerasManager}(s.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n,s=i(1),r=i(143),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),a=function(t){function LoginScene(){return t.call(this,{key:s.SceneName.LOGIN_SCENE})||this}return o(LoginScene,t),LoginScene.prototype.preload=function(){},LoginScene.prototype.create=function(){(t.prototype.create.call(this),this.render)&&(this.render.showMediator("Login",!0),this.render.uiManager.setScene(this),this.render.hideLoading())},LoginScene.prototype.init=function(e){t.prototype.init.call(this,e),e&&(this.render=e)},LoginScene.prototype.stop=function(){this.render&&this.render.showMediator("Login",!1),t.prototype.stop.call(this)},LoginScene.prototype.sleep=function(){this.render&&this.render.showMediator("Login",!1)},LoginScene}(r.a)},function(t,e,i){"use strict";i.r(e),i.d(e,"BackTextButton",(function(){return h}));var n,s=i(470),r=i(11),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function BackTextButton(e,i){var n=t.call(this,e,0,0)||this;return n.dpr=i,n.init(),n}return a(BackTextButton,t),BackTextButton.prototype.setText=function(t){this.titleTex.text=t},BackTextButton.prototype.setTextStyle=function(t){this.titleTex.setStyle(t)},BackTextButton.prototype.setFontStyle=function(t){void 0===t&&(t="bold"),this.titleTex.setFontStyle(t)},BackTextButton.prototype.init=function(){var t=100*this.dpr,e=40*this.dpr;this.setSize(t,e),this.enable=!0;var i=this.scene.make.image({key:r.d.uicommon,frame:"back_arrow"});i.x=.5*-this.width+.5*i.width+10*this.dpr;var n=this.scene.make.text({text:"",style:o.UIHelper.whiteStyle(this.dpr,20)}).setOrigin(0,.5);n.setFontStyle("bold"),n.x=i.x+.5*i.width+10*this.dpr,this.titleTex=n,this.add([i,n])},BackTextButton}(s.ButtonEventDispatcher)},function(t,e,i){"use strict";i.r(e),i.d(e,"EnergyProgressBar",(function(){return h}));var n,s=i(470),r=i(11),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function EnergyProgressBar(e,i){var n=t.call(this,e)||this;return n.dpr=i,n.init(),n}return a(EnergyProgressBar,t),EnergyProgressBar.prototype.setEnergyData=function(t,e){this.powerTex.setText(t+"/"+e),this.powerPro.setProgress(t,e)},EnergyProgressBar.prototype.init=function(){var t=83*this.dpr,e=18*this.dpr;this.setSize(t,e);var i={width:t,height:e,left:9*this.dpr,right:9*this.dpr,top:0,bottom:0};this.powerPro=new s.ProgressMaskBar(this.scene,r.d.uicommon,"explore_physical_bottom","explore_physical_top",void 0,i,i),this.powerPro.x=0,this.powerTex=new s.ImageValue(this.scene,43*this.dpr,15*this.dpr,r.d.uicommon,"explore_physical_icon",this.dpr,o.UIHelper.colorNumberStyle("#ffffff",11*this.dpr)),this.powerTex.x=.5*-t+13*this.dpr,this.powerTex.y=-1*this.dpr,this.powerTex.setFontStyle("bold"),this.powerTex.setStroke("#000000",2*this.dpr),this.powerTex.setOffset(-4*this.dpr,0),this.powerTex.setLayout(1),this.powerTex.setText(""),this.add([this.powerPro,this.powerTex])},EnergyProgressBar}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"ActivityPanel",(function(){return h}));var n,s=i(5),r=i(470),o=i(1),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function fulfilled(t){try{step(n.next(t))}catch(t){r(t)}}function rejected(t){try{step(n.throw(t))}catch(t){r(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function verb(r){return function(a){return function step(r){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(s=2&r[0]?n.return:r[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,r[1])).done)return s;switch(n=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],n=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},h=function(t){function ActivityPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=o.ModuleName.ACTIVITY_NAME,i}return a(ActivityPanel,t),ActivityPanel.prototype.resize=function(t,e){var i=this.scaleWidth;this.scaleHeight;this.content.x=i-20*this.dpr,this.content.y=.5*this.content.height+90*this.dpr,this.setSize(t,e),this.mGameScroll.refreshMask()},ActivityPanel.prototype.show=function(e){this.mInitialized&&this.setInteractive(),t.prototype.show.call(this,e),this.checkUpdateActive()},ActivityPanel.prototype.addListen=function(){this.mInitialized&&this.mGameScroll.addListen()},ActivityPanel.prototype.removeListen=function(){this.mInitialized&&this.mGameScroll.removeListen()},ActivityPanel.prototype.updateUIState=function(t){this.mInitialized&&("activity.taskbtn"===t.name&&(this.mGameScroll.getItemAt(3).visible=t.visible,this.mGameScroll.Sort()))},ActivityPanel.prototype.preload=function(){this.addAtlas(this.key,"activity/activity.png","activity/activity.json"),t.prototype.preload.call(this)},ActivityPanel.prototype.init=function(){var e=this,i=60*this.dpr,n=270*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(i,n),this.add(this.content),this.mGameScroll=new s.GameScroller(this.scene,{x:0,y:0,width:this.content.width,height:this.content.height-50*this.dpr,zoom:this.scale,dpr:this.dpr,align:2,orientation:0,space:10*this.dpr,selfevent:!0,cellupCallBack:function(t){e.onPointerUpHandler(t)}}),this.content.add(this.mGameScroll);var r=this.scene.make.image({key:this.key,frame:"home_more"});r.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.content.add(r),r.y=.5*n-.5*r.height;for(var o=0;o<4;o++){var a="icon_"+(o+1),h=this.scene.make.image({key:this.key,frame:a});h.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.name=o+1+"",this.mGameScroll.addItem(h)}this.mGameScroll.Sort(),this.resize(i,n),t.prototype.init.call(this)},ActivityPanel.prototype.onClickHandler=function(t){"4"===t?this.render.renderEmitter("showPanel",o.ModuleName.PICATASK_NAME):"3"===t?this.render.renderEmitter("showPanel",o.ModuleName.PICAFRIEND_NAME):"2"===t?this.render.renderEmitter("showPanel",o.ModuleName.PICAORDER_NAME):"1"===t&&this.render.renderEmitter("showPanel",o.ModuleName.PICARECHARGE_NAME)},ActivityPanel.prototype.checkUpdateActive=function(){return __awaiter(this,void 0,void 0,(function(){var t,e,i,n;return __generator(this,(function(s){switch(s.label){case 0:return[4,this.render.mainPeer.getActiveUIData("Activity")];case 1:if(t=s.sent())for(e=0,i=t;e<i.length;e++)n=i[e],this.updateUIState(n);return[2]}}))}))},ActivityPanel.prototype.onPointerUpHandler=function(t){var e=t.name;this.onClickHandler(e)},ActivityPanel}(r.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"CharacterInfoPanel",(function(){return u}));var n,s,r=i(485),o=i(484),a=i(5),h=i(11),l=i(0),c=i(1),p=i(470),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__spreadArrays=function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),s=0;for(e=0;e<i;e++)for(var r=arguments[e],o=0,a=r.length;o<a;o++,s++)n[s]=r[o];return n},m=Phaser.GameObjects.Container,u=function(t){function CharacterInfoPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i.commonkey="common_key",i.isOwner=!0,i.key=c.ModuleName.CHARACTERINFO_NAME,i}return d(CharacterInfoPanel,t),CharacterInfoPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,e,i),this.setSize(n,s),this.mBackGround.clear(),this.mBackGround.fillStyle(0,.66),this.mBackGround.fillRect(0,0,n,s),this.content.setPosition(n/2,s/2),this.mSkillGrideTable.resetMask(),this.content.setInteractive(),this.mCategoryScroll.refreshMask();var r=this.mFirendMenu.getWorldTransformMatrix();this.mFirendMenu.addMask(r.tx-42*this.dpr*this.scale,r.ty,200*this.dpr*this.scale,80*this.dpr*this.scale)},CharacterInfoPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,t&&t.length>0&&this.setPlayerData(t),this.setInteractive(),this.addListen()):this.preload())},CharacterInfoPanel.prototype.hide=function(){t.prototype.hide.call(this)},CharacterInfoPanel.prototype.update=function(e){t.prototype.update.call(this,e),e&&this.setPlayerData(e)},CharacterInfoPanel.prototype.addListen=function(){this.mInitialized&&(this.closeBtn.on(String(a.ClickEvent.Tap),this.OnClosePanel,this),this.nickEditor.on(String(a.ClickEvent.Tap),this.onEditorHandler,this),this.privaCharBtn.on(String(a.ClickEvent.Tap),this.onPrivateChatHandler,this),this.addFriendBtn.on(String(a.ClickEvent.Tap),this.onAddFriendHandler,this),this.mExitBtn.on(String(a.ClickEvent.Tap),this.onExitHandler,this),this.mFirendMenu.register(),this.render.emitter.on("track",this.onTrackHandler,this),this.render.emitter.on("invite",this.onIntiveHandler,this),this.mCharacterMenu.register(),this.render.emitter.on("addBlack",this.onAddBlacklistHandler,this),this.render.emitter.on("removeBlack",this.onRemoveBlacklistHandler,this))},CharacterInfoPanel.prototype.removeListen=function(){this.mInitialized&&(this.closeBtn.off(String(a.ClickEvent.Tap),this.OnClosePanel,this),this.nickEditor.off(String(a.ClickEvent.Tap),this.onEditorHandler,this),this.privaCharBtn.off(String(a.ClickEvent.Tap),this.onPrivateChatHandler,this),this.addFriendBtn.off(String(a.ClickEvent.Tap),this.onAddFriendHandler,this),this.mExitBtn.off(String(a.ClickEvent.Tap),this.onExitHandler,this),this.mFirendMenu.unregister(),this.render.emitter.off("track",this.onTrackHandler,this),this.render.emitter.off("invite",this.onIntiveHandler,this),this.mCharacterMenu.unregister(),this.render.emitter.off("addBlack",this.onAddBlacklistHandler,this),this.render.emitter.off("removeBlack",this.onRemoveBlacklistHandler,this))},CharacterInfoPanel.prototype.preload=function(){this.addAtlas(this.key,"player_info/player_info.png","player_info/player_info.json"),this.commonkey=h.c.commonKey,this.addAtlas(this.commonkey,h.d.commonUrl+".png",h.d.commonUrl+".json"),t.prototype.preload.call(this)},CharacterInfoPanel.prototype.init=function(){var e=this,i=this.scaleWidth,n=this.scaleHeight;this.mBackGround=this.scene.make.graphics(void 0,!1),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,i,n),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.add(this.mBackGround),this.bg=this.scene.make.image({x:0,y:0,key:this.key,frame:"bg"}),this.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.content=this.scene.make.container(void 0,!1),this.content.setSize(this.bg.width,this.bg.height),this.add(this.content),this.content.add(this.bg),this.mainCon=this.scene.make.container(void 0,!1),this.mainCon.setSize(this.bg.width,this.bg.height),this.content.add(this.mainCon);var s=.5*-this.bg.height+43*this.dpr,r="bold "+15*this.dpr+"px Source Han Sans";this.labelText=this.scene.make.text({x:0,y:s,text:l.i18n.t("player_info.title"),style:{font:r,bold:!0,color:"#ffffff",fontSize:15*this.dpr,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(.5,0),this.labelText.setStroke("#8F4300",1),this.closeBtn=new a.Button(this.scene,this.commonkey,"close"),this.closeBtn.setPosition(.5*this.mainCon.width-30*this.dpr,s-10*this.dpr),this.likeBtn=new a.Button(this.scene,this.key,"praise_bef","praise_bef","999"),this.likeBtn.setTextStyle({fontSize:13*this.dpr,fontFamily:l.Font.DEFULT_FONT}),this.likeBtn.text.setOrigin(0,.5).x+=10*this.dpr,this.likeBtn.setPosition(.5*this.bg.width-50*this.dpr,s+50*this.dpr),this.likeBtn.visible=!1,this.avatar=new p.UIDragonbonesDisplay(this.scene,this.render),this.avatar.scale=2*this.dpr,this.avatar.x=0,this.avatar.y=-70*this.dpr,this.avatar.once("initialized",(function(){e.avatar.play({name:"idle",flip:!1})})),this.mainCon.add([this.labelText,this.closeBtn,this.likeBtn,this.avatar]),this.mFirendMenu=new g(this.uiManager.render,this.scene,this.dpr,this.scale),this.mFirendMenu.x=.5*this.bg.width-this.mFirendMenu.width-14*this.dpr,this.mFirendMenu.y=.5*-this.bg.height+200*this.dpr,this.mCharacterMenu=new P(this.uiManager.render,this.scene,this.dpr,this.scale),this.mCharacterMenu.x=.5*this.bg.width-this.mCharacterMenu.width-14*this.dpr,this.mCharacterMenu.y=.5*-this.bg.height+100*this.dpr,this.mExitBtn=new a.NineSliceButton(this.scene,.5*-this.bg.width+40*this.dpr,this.labelText.y+.5*this.labelText.height,48*this.dpr,26*this.dpr,this.commonkey,"yellow_btn_normal_s","注销",this.dpr,this.scale,{left:8*this.dpr,top:8*this.dpr,right:8*this.dpr,bottom:10*this.dpr}),this.mExitBtn.setTextStyle({fontSize:10*this.dpr,fontFamily:l.Font.DEFULT_FONT}),this.mainCon.add([this.mFirendMenu,this.mCharacterMenu,this.mExitBtn]);var h=Math.round(.5*-this.bg.width+25*this.dpr),c=Math.round(.5*this.bg.height-324*this.dpr)+30*this.dpr,d=Math.round(13*this.dpr);this.nickName=new a.BBCodeText(this.scene,h,c,"",{}).setOrigin(0,.5).setFontSize(d).setFontFamily(l.Font.DEFULT_FONT),this.nickEditor=new a.Button(this.scene,this.key,"edit","edit"),this.nickEditor.setPosition(.5*this.bg.width-30*this.dpr,c).visible=!1;var m=this.scene.make.image({x:0,y:this.nickName.y+12*this.dpr,key:this.key,frame:"splitters"});m.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),m.scaleY=this.dpr,this.idText=new a.BBCodeText(this.scene,h,c).setFontSize(d).setOrigin(0,.5).setFontFamily(l.Font.DEFULT_FONT).setColor("#0062BC");var u=this.scene.make.image({x:0,y:this.idText.y+12*this.dpr,key:this.key,frame:"splitters"});u.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),u.scaleY=this.dpr,this.titleName=new a.BBCodeText(this.scene,h,c+30*this.dpr).setFontSize(d).setOrigin(0,.5).setFontFamily(l.Font.DEFULT_FONT);var f=this.scene.make.image({x:0,y:this.titleName.y+12*this.dpr,key:this.key,frame:"splitters"});f.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),f.scaleY=this.dpr;var v=this.scene.make.image({x:0,y:0,key:this.key,frame:"level_bg"});v.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.lvText=this.scene.make.text({x:0,y:0,text:"lv 98",style:{color:"#996600",fontSize:d,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(.5,.5),this.lvCon=this.scene.make.container(void 0,!1),this.lvCon.setSize(v.width,v.height),this.lvCon.setPosition(.5*-this.content.width+.5*this.lvCon.width+20*this.dpr,.5*-this.content.height+90*this.dpr),this.lvCon.add([v,this.lvText]),this.mainCon.add([this.nickName,this.nickEditor,m,u,f,this.titleName,this.lvCon]);var b=260*this.dpr,_=210*this.dpr;this.bottomCon=this.scene.make.container(void 0,!1),this.bottomCon.setSize(b,_),this.bottomCon.setPosition(0,.5*this.bg.height-.5*_-30*this.dpr),this.mainCon.add(this.bottomCon),this.bottombg=this.scene.make.graphics(void 0,!1);var k=32*this.dpr,w=.5*-_+.5*k-3*this.dpr;this.mCategoryScroll=new a.GameScroller(this.scene,{x:0,y:w,width:b,height:k,zoom:this.scale,orientation:1,dpr:this.dpr,space:10*this.dpr,cellupCallBack:function(t){e.onSelectSubCategoryHandler(t)}});var x=this.scene.textures.getFrame(this.key,"skill_bg"),T=x.width+5*this.dpr,C=x.height+8*this.dpr,S=this.bottomCon.width,I=200*this.dpr,B=w+.5*k+.5*I;this.mSkillGrideTable=this.createGrideTable(0,B,S,I,T,C,(function(){return new y(e.scene,0,0,e.key,e.dpr)}),new l.Handler(this,this.onSelectItemHandler));var D=150*this.dpr;this.mAttrPanel=new o.CharacterAttributePanel(this.scene,0,B,S-30*this.dpr,D,this.key,this.dpr),this.bottomCon.add([this.bottombg,this.mCategoryScroll,this.mSkillGrideTable,this.mAttrPanel]);var E=-60*this.dpr,R=.5*this.bottomCon.height-20*this.dpr;this.addFriendBtn=new a.NineSliceButton(this.scene,0,R,94*this.dpr,37*this.dpr,this.key,"button_g",l.i18n.t("player_info.add_friend"),this.dpr,this.scale,{left:12*this.dpr,top:12*this.dpr,right:12*this.dpr,bottom:12*this.dpr}),this.addFriendBtn.setFrameNormal("button_g"),this.privaCharBtn=new a.NineSliceButton(this.scene,E,R,94*this.dpr,37*this.dpr,this.commonkey,"yellow_btn",l.i18n.t("player_info.private_chat"),this.dpr,this.scale,{left:12*this.dpr,top:12*this.dpr,right:12*this.dpr,bottom:12*this.dpr}),this.addFriendBtn.setTextStyle({fontSize:16*this.dpr,color:"#000000"}),this.privaCharBtn.setTextStyle({fontSize:16*this.dpr,color:"#996600"}),this.bottomCon.add([this.addFriendBtn,this.privaCharBtn]),this.content.visible=!1,this.resize(i,n),t.prototype.init.call(this)},CharacterInfoPanel.prototype.reqPlayerInfo=function(){this.render.renderEmitter("queryOwnerInfo")},CharacterInfoPanel.prototype.setPlayerData=function(t){if(this.mInitialized){this.mCharacterData=t,this.content.visible=!0;var e=t.nickname?t.nickname:"???",i=t.currentTitle?t.currentTitle:"???",n=(t.level&&t.level.currentLevelExp&&t.level.currentLevelExp,t.level&&t.level.nextLevelExp&&t.level.nextLevelExp,t.cid,t.level&&t.level.level?t.level.level:0),r=this.getspaceStr(1*this.dpr);if(this.avatar&&t.avatarSuit){var o=c.AvatarSuitType.getSuitsFromItem(t.avatarSuit);this.avatar.setSuits(o.suits),this.avatar.load({id:0,avatar:o.avatar})}this.titleName.setText(this.getRichLabel(l.i18n.t("player_info.player_title"))+r+i);var a=t.like?t.like+"":"???";this.likeBtn.setText(a+"");var h=.5*this.bg.width-.5*this.likeBtn.width-this.likeBtn.text.width;this.likeBtn.x=h-20*this.dpr,this.lvText.text="lv "+n,this.idText.setText("(52365404)");var p=new Map,d=t.lifeSkills?t.lifeSkills:[];if(p.set(s.Skill,d),t.isUser){this.nickName.setText(this.getRichLabel(l.i18n.t("player_info.nick_name"))+r+e),this.likeBtn.setFrame("praise_aft"),p.set(s.Attribute,t.properties?t.properties:[]),p.set(s.Badge,t.badges?t.badges:[]),this.addFriendBtn.visible=!1,this.privaCharBtn.visible=!1,this.mFirendMenu.visible=!1,this.mExitBtn.visible=!0,this.bottombg.clear(),this.bottombg.fillStyle(7004927,1),this.bottombg.fillRect(.5*-this.bottomCon.width,.5*-this.bottomCon.height,this.bottomCon.width,this.bottomCon.height);var m=200*this.dpr;this.mSkillGrideTable.setSize(this.mSkillGrideTable.width,m);var u=0,y=this.mCategoryScroll.y+.5*m+0*this.dpr;this.mSkillGrideTable.refreshPos(u,y),this.mSkillGrideTable.setColumnCount(3),this.isOwner=!0,this.mCharacterMenu.visible=!1,this.mAttrPanel.setSize(this.mAttrPanel.width,m),this.mAttrPanel.y=y+15*this.dpr,this.mAttrPanel.space=20*this.dpr}else{this.nickName.setText(this.getRichLabel(l.i18n.t("player_info.nick_name"))+r+e),this.likeBtn.setFrame("praise_bef"),p.set(s.Attribute,t.properties?t.properties:[]),p.set(s.Badge,t.badges?t.badges:[]),this.addFriendBtn.visible=!!t.friend&&!t.friend,this.privaCharBtn.visible=!!t.friend&&t.friend,this.mExitBtn.visible=!1,this.bottombg.clear(),this.bottombg.fillStyle(7004927,1),this.bottombg.fillRect(.5*-this.bottomCon.width,.5*-this.bottomCon.height,this.bottomCon.width,this.bottomCon.height-55*this.dpr);m=150*this.dpr;this.mSkillGrideTable.setSize(this.mSkillGrideTable.width,m);u=0,y=this.mCategoryScroll.y+.5*m+0*this.dpr;this.mSkillGrideTable.refreshPos(u,y),this.mSkillGrideTable.setColumnCount(2),this.isOwner=!1,this.mCharacterMenu.visible=!0,this.mAttrPanel.setSize(this.mAttrPanel.width,m),this.mAttrPanel.y=y+15*this.dpr,this.mAttrPanel.space=10*this.dpr}this.idText.x=this.nickName.x+this.nickName.width*(1-this.nickName.originX)+8*this.dpr,this.mFirendMenu.visible=!1,this.setSubCategory(p),this.setFriendRelation(c.FriendRelationEnum.Null)}else this.mShowData=t},CharacterInfoPanel.prototype.setFriendRelation=function(t){this.isOwner||(this.mRelation=t,this.mFirendMenu.visible=t===c.FriendRelationEnum.Friend,this.mCharacterMenu.setIsBlack(t===c.FriendRelationEnum.Blacklist),this.addFriendBtn.visible=t!==c.FriendRelationEnum.Blacklist,t===c.FriendRelationEnum.Followed||t===c.FriendRelationEnum.Friend?this.addFriendBtn.setText(l.i18n.t("friendlist.unfollow")):this.addFriendBtn.setText(l.i18n.t("friendlist.follow")))},CharacterInfoPanel.prototype.destroy=function(){this.mSkillGrideTable.destroy(),this.mCategoryScroll.destroy(),this.mBackGround&&this.mBackGround.clear(),t.prototype.destroy.call(this)},CharacterInfoPanel.prototype.createGrideTable=function(t,e,i,n,s,r,o,h){var l=this,c={x:t,y:e,table:{width:i,height:n,columns:3,cellWidth:s,cellHeight:r,reuseCellContainer:!0,cellPadX:24*this.dpr,zoom:this.scale},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&(e=o()),e.setData({item:i}),e.setItemData(i,l.isOwner),e}},p=new a.GameGridTable(this.scene,c);return p.layout(),p.on("cellTap",(function(t){t&&h.runWith(t)})),p},CharacterInfoPanel.prototype.OnClosePanel=function(){this.render.renderEmitter("hide")},CharacterInfoPanel.prototype.setSubCategory=function(t){var e=this,i=(l.i18n.t("player_info.option_live"),l.i18n.t("player_info.option_attribute"),l.i18n.t("player_info.option_badge"),this.mScene.textures.getFrame(this.key,"title_select").width),n=this.mCategoryScroll.getItemList().concat();this.mCategoryScroll.clearItems(!1);for(var s=0,r=n;s<r.length;s++){r[s].visible=!1}var o=0;t.forEach((function(t,s){var r,h=e.getOptionName(s);o<n.length?r=n[o]:((r=new a.Button(e.scene,e.key,"title_normal","title_select",h)).width=i,r.height=41*e.dpr,n.push(r),r.setTextStyle({color:"#2B4BB5",fontSize:12*e.dpr,fontFamily:l.Font.DEFULT_FONT}),r.disInteractive(),r.removeListen()),r.visible=!0,r.setText(h),r.setData("subData",t),r.setData("optiontype",s),e.mCategoryScroll.addItem(r),o++})),n.length<=3?this.mCategoryScroll.setAlign(1):this.mCategoryScroll.setAlign(2),this.onSelectSubCategoryHandler(n[0])},CharacterInfoPanel.prototype.onSelectSubCategoryHandler=function(t){this.curSelectCategeory&&(this.curSelectCategeory.changeNormal(),this.curSelectCategeory.setTextColor("#2B4BB5")),t.changeDown(),t.setTextColor("#996600"),this.curSelectCategeory=t;var e=t.getData("subData"),i=t.getData("optiontype");i===s.Skill?(this.mSkillGrideTable.setItems(e),this.mAttrPanel.visible=!1,this.mSkillGrideTable.visible=!0):i===s.Attribute?(e&&this.mAttrPanel.setAttributeData(e),this.mAttrPanel.visible=!0,this.mSkillGrideTable.setItems([]),this.mSkillGrideTable.visible=!1):i===s.Badge&&(this.mAttrPanel.visible=!1,this.mSkillGrideTable.visible=!1)},CharacterInfoPanel.prototype.onSelectItemHandler=function(t){},CharacterInfoPanel.prototype.onEditorHandler=function(){var t=247*this.dpr,e=this.content.height;this.editorPanel||(this.editorPanel=new r.CharacterEditorPanel(this.scene,0,0,t,e,this.key,this.dpr)),this.content.add(this.editorPanel),this.editorPanel.visible=!0,this.editorPanel.on("editorHide",this.onEditorPanelHideHandler,this),this.setMainUIVisible(!1)},CharacterInfoPanel.prototype.onAddFriendHandler=function(){if(this.mCharacterData)switch(this.mRelation){case c.FriendRelationEnum.Friend:case c.FriendRelationEnum.Followed:this.render.renderEmitter("unfollow",this.mCharacterData.cid);break;case c.FriendRelationEnum.Fans:case c.FriendRelationEnum.Null:this.render.renderEmitter("follow",this.mCharacterData.cid)}},CharacterInfoPanel.prototype.onTradingHandler=function(){},CharacterInfoPanel.prototype.onPrivateChatHandler=function(){},CharacterInfoPanel.prototype.onExitHandler=function(){this.mWorld.exitUser()},CharacterInfoPanel.prototype.onEditorPanelHideHandler=function(){this.mainCon.visible=!0,this.remove(this.editorPanel),this.editorPanel.off("editorHide",this.onEditorPanelHideHandler,this),this.editorPanel.destroy(),this.editorPanel=null,this.setMainUIVisible(!0)},CharacterInfoPanel.prototype.setMainUIVisible=function(t){this.avatar.visible=t,this.mCategoryScroll.visible=t,this.mSkillGrideTable.visible=t,this.mainCon.visible=t},CharacterInfoPanel.prototype.getRichLabel=function(t,e){return void 0===e&&(e="#2B4BB5"),"[stroke="+e+"][color="+e+"]"+t+":[/color][/stroke]"},CharacterInfoPanel.prototype.getspaceStr=function(t){for(var e="",i=0;i<t;i++)e+=" ";return e},CharacterInfoPanel.prototype.getOptionName=function(t){var e="";return t===s.Skill?e=l.i18n.t("player_info.option_live"):t===s.Attribute?e=l.i18n.t("player_info.option_attribute"):t===s.Badge?e=l.i18n.t("player_info.option_badge"):t===s.Title&&(e=l.i18n.t("player_info.option_title")),e},CharacterInfoPanel.prototype.onTrackHandler=function(){this.mCharacterData&&this.render.renderEmitter("track",this.mCharacterData.cid)},CharacterInfoPanel.prototype.onIntiveHandler=function(){this.mCharacterData&&this.render.renderEmitter("invite",this.mCharacterData.cid)},CharacterInfoPanel.prototype.onAddBlacklistHandler=function(){this.mCharacterData&&this.render.renderEmitter("addBlack",this.mCharacterData.cid)},CharacterInfoPanel.prototype.onRemoveBlacklistHandler=function(){this.mCharacterData&&this.render.renderEmitter("removeBlack",this.mCharacterData.cid)},CharacterInfoPanel}(p.BasePanel);!function(t){t[t.Skill=0]="Skill",t[t.Attribute=1]="Attribute",t[t.Badge=2]="Badge",t[t.Title=3]="Title",t[t.Avatar=4]="Avatar"}(s||(s={}));var y=function(t){function CharacterOwnerItem(e,i,n,s,r){var o=t.call(this,e,i,n)||this;o.dpr=0;var h=o.scene.make.image({x:0,y:0,key:s,frame:"skill_bg"});return h.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),o.nameText=o.scene.make.text({x:-1*r,y:0,text:"",style:{color:"#996600",fontSize:12*r,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(0,.5),o.lvText=o.scene.make.text({x:-1*r,y:0,text:"",style:{color:"#996600",fontSize:12*r,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(0,.5),o.progressBar=new a.ProgressBar(o.scene,{x:48*r/2,y:15*r,width:41*r,height:4*r,background:{x:0,y:0,width:41*r,height:4*r,config:{top:1*r,left:2*r,right:2*r,bottom:1*r},key:s,frame:"slider_bg"},bar:{x:0,y:0,width:41*r,height:4*r,config:{top:1*r,left:2*r,right:2*r,bottom:1*r},key:s,frame:"slider_rate"},dpr:r,textConfig:void 0}),o.icon=new p.DynamicImage(o.scene,.5*-h.width+22*r,0),o.add([h,o.icon,o.nameText,o.lvText,o.progressBar]),o.setSize(h.width,h.height),o.dpr=r,o.key=s,o}return d(CharacterOwnerItem,t),CharacterOwnerItem.prototype.setItemData=function(t,e){var i=this;void 0===e&&(e=!1),this.itemData=t,this.nameText.text=t.name;var n=e?-16*this.dpr:-11*this.dpr,s=e?20*this.dpr:25*this.dpr,r=10*this.dpr;this.nameText.y=n+.5*r,this.icon.setTexture(this.key,"test_skillicon");var o=this.icon.width;t.level?(this.lvText.text=t.level.level,this.lvText.y=n+s,this.progressBar.setProgress(t.level.currentLevelExp,t.level.nextLevelExp),this.progressBar.visible=e):(this.progressBar.visible=!1,this.lvText.visible=!1);var a=l.Url.getOsdRes(t.display.texturePath);this.icon.load(a,this,(function(){i.icon.scale=i.dpr;var t=.5*-i.width+.5*o+6*i.dpr;i.icon.setPosition(t,0)}))},CharacterOwnerItem}(m),f=function(t){function Menu(e,i,n,s,r,o){var a=t.call(this,i)||this;return a.render=e,a.mDpr=n,a.mScale=s,a.setSize(r,o),a.draw(),a}return d(Menu,t),Menu.prototype.register=function(){},Menu.prototype.unregister=function(){},Menu.prototype.addMask=function(t,e,i,n){this.maskGraphic||(this.maskGraphic=this.scene.make.graphics(void 0,!1)),this.maskGraphic.x=t,this.maskGraphic.y=e,this.maskGraphic.fillRect(.5*-i,.5*-n,i,n),this.setMask(this.maskGraphic.createGeometryMask())},Menu.prototype.draw=function(){this.createBackground()},Menu.prototype.createBackground=function(){this.background||(this.background=this.scene.make.graphics(void 0,!1));var t=3*this.mDpr;this.background.fillStyle(7583,.2),this.background.fillRoundedRect(0,0,this.width,this.height,{tl:t,tr:0,br:0,bl:t}),this.addAt(this.background,0)},Menu}(m),g=function(t){function FriendMenu(e,i,n,s){var r=t.call(this,e,i,n,s,58*n,40*n)||this;return r.isExpand=!1,r}return d(FriendMenu,t),FriendMenu.prototype.register=function(){this.trackBtn.on(String(a.ClickEvent.Tap),this.onTrackHandler,this),this.inviteBtn.on(String(a.ClickEvent.Tap),this.onInviteHandler,this);var t=this.operation,e=t.width,i=t.height;this.operation.setInteractive(new Phaser.Geom.Rectangle(-e,-i,3*e,3*i),Phaser.Geom.Rectangle.Contains),this.operation.on("pointerup",this.onSwitchOperationHandler,this)},FriendMenu.prototype.unregister=function(){this.trackBtn.off(String(a.ClickEvent.Tap),this.onTrackHandler,this),this.inviteBtn.off(String(a.ClickEvent.Tap),this.onInviteHandler,this),this.operation.disableInteractive(),this.operation.on("pointerup",this.onSwitchOperationHandler,this)},FriendMenu.prototype.destroy=function(){this.operationContaienr&&this.operationContaienr.destroy(),this.operation&&this.operation.destroy(),this.inviteBtn&&this.inviteBtn.destroy(),this.trackBtn&&this.trackBtn.destroy(),this.tween&&this.tween.stop(),this.autoCollapseTime&&clearTimeout(this.autoCollapseTime),this.buttons=[]},FriendMenu.prototype.expand=function(){var t=this;if(!this.tween||!this.tween.isPlaying()){this.operationContaienr.remove(this.operation),this.operationContaienr.remove(this.background),this.operationContaienr.add(this.buttons);var e=this.getBounds();if(this.isExpand=!0,e){var i=e.width+8*this.mDpr;this.setSize(i,this.height),this.createBackground(),this.operationContaienr.addAt(this.background,0),this.operationContaienr.x=.5*e.width,this.tween=this.scene.tweens.add({targets:this.operationContaienr,props:{x:.5*-e.width,alpha:1},duration:100}),this.autoCollapseTime=setTimeout((function(){t.autoCollapseTime=null,t.collapse()}),3e3)}}},FriendMenu.prototype.collapse=function(){var t=this;this.tween&&this.tween.isPlaying()||(this.autoCollapseTime&&clearTimeout(this.autoCollapseTime),this.tween=this.scene.tweens.add({targets:this.operationContaienr,props:{x:.5*this.width},duration:100,onComplete:function(){t.operationContaienr.remove(__spreadArrays(t.buttons),!1),t.operationContaienr.add(t.operation),t.setSize(58*t.mDpr,40*t.mDpr),t.createBackground(),t.operationContaienr.addAt(t.background,0),t.operationContaienr.x=0,t.isExpand=!1}}))},FriendMenu.prototype.draw=function(){this.operationContaienr=this.scene.make.container(void 0,!1),this.add(this.operationContaienr),this.buttons=[],this.inviteBtn=this.createButton(l.i18n.t("player_info.invite")),this.buttons.push(this.inviteBtn),this.trackBtn=this.createButton(l.i18n.t("player_info.track")),this.buttons.push(this.trackBtn),this.operation=this.scene.make.text({x:.5*this.width,y:.5*this.height,text:l.i18n.t("player_info.operation"),style:{color:"#FFD248",fontSize:10*this.mDpr,fontFamily:l.Font.DEFULT_FONT}},!1).setOrigin(.5);for(var t=0;t<this.buttons.length;t++)this.buttons[t].x=0===t?.5*this.buttons[t].width+6*this.mDpr:this.buttons[t-1].x+.5*(this.buttons[t-1].width+this.buttons[t].width)+6*this.mDpr,this.buttons[t].y=.5*this.height;this.collapse()},FriendMenu.prototype.createBackground=function(){this.background||(this.background=this.scene.make.graphics(void 0,!1));var t=3*this.mDpr;this.background.clear(),this.background.fillStyle(7583,.2),this.background.fillRoundedRect(0,0,this.width,this.height,{tl:t,tr:0,br:0,bl:t})},FriendMenu.prototype.onTrackHandler=function(){this.render.renderEmitter("track"),this.collapse()},FriendMenu.prototype.onInviteHandler=function(){this.render.renderEmitter("invite"),this.collapse()},FriendMenu.prototype.onSwitchOperationHandler=function(){this.isExpand?this.collapse():this.expand()},FriendMenu.prototype.createButton=function(t){var e=this.mDpr,i=this.mScale,n=new a.NineSliceButton(this.scene,-0,0,48*e,26*e,h.c.commonKey,"yellow_btn_normal_s",t,e,i,{left:8*e,top:8*e,right:8*e,bottom:10*e});return n.setTextStyle({color:"#996600",fontSize:10*e,fontFamily:l.Font.DEFULT_FONT}),n},FriendMenu}(f),P=function(t){function CharacterMenu(e,i,n,s){return t.call(this,e,i,n,s,58*n,36*n)||this}return d(CharacterMenu,t),CharacterMenu.prototype.register=function(){this.addBlacklistBtn.on(String(a.ClickEvent.Tap),this.onAddBlackHandler,this)},CharacterMenu.prototype.unregister=function(){this.addBlacklistBtn.off(String(a.ClickEvent.Tap),this.onAddBlackHandler,this)},CharacterMenu.prototype.setIsBlack=function(t){this.isBlack=t,this.addBlacklistBtn.setText(l.i18n.t(t?"player_info.remove_black":"player_info.add_black"))},CharacterMenu.prototype.draw=function(){t.prototype.draw.call(this),this.addBlacklistBtn=new a.NineSliceButton(this.scene,0,0,55*this.mDpr,24*this.mDpr,h.c.commonKey,"red_btn_normal",l.i18n.t("player_info.add_black"),this.mDpr,this.mScale,{left:12*this.mDpr,top:12*this.mDpr,right:12*this.mDpr,bottom:12*this.mDpr}),this.addBlacklistBtn.setTextStyle({color:"#FFFFFF",fontSize:10*this.mDpr,fontFamily:l.Font.DEFULT_FONT}),this.addBlacklistBtn.x=.5*this.width,this.addBlacklistBtn.y=6*this.mDpr+.5*this.addBlacklistBtn.height,this.add(this.addBlacklistBtn)},CharacterMenu.prototype.onAddBlackHandler=function(){this.render.emitter.emit(this.isBlack?"removeBlack":"addBlack")},CharacterMenu}(f)},function(t,e,i){"use strict";i.r(e),i.d(e,"GraphicsProgressBar",(function(){return r}));var n,s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),r=function(t){function GraphicsProgressBar(e,i,n,s,r,o){void 0===o&&(o=!0);var a=t.call(this,e,i,n)||this;return a.value=.5,a.bgGraphics=a.scene.make.graphics(void 0,!1),a.barGraphics=a.scene.make.graphics(void 0,!1),a.add([a.bgGraphics,a.barGraphics]),a.setSize(s,r),a.bgColor=0,a.barColor=267386880,a.bgGraphics.clear(),a.bgGraphics.fillStyle(a.bgColor,1),a.bgGraphics.fillRect(0,0,a.width,a.height),a.setValue(a.value),a}return s(GraphicsProgressBar,t),GraphicsProgressBar.prototype.setColor=function(t,e){this.barColor=t,e&&(this.bgColor=e),this.bgGraphics.clear(),this.bgGraphics.fillStyle(this.bgColor,1),this.bgGraphics.fillRect(0,0,this.width,this.height),this.setValue(this.value)},GraphicsProgressBar.prototype.setValue=function(t){this.value=t;var e=this.width*(this.isHorizontal?t:1),i=this.height*(this.isHorizontal?1:t);this.barGraphics.clear(),this.barGraphics.fillStyle(this.barColor,1),this.barGraphics.fillRect(0,0,e,i)},GraphicsProgressBar.prototype.setRoundedRectValue=function(t,e){this.value=t;var i=this.width*(this.isHorizontal?t:1),n=this.height*(this.isHorizontal?1:t);this.barGraphics.clear(),this.barGraphics.fillStyle(this.barColor,1),this.barGraphics.fillRoundedRect(0,0,i,n,e)},GraphicsProgressBar}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaHandheldPanel",(function(){return l}));var n,s=i(5),r=i(0),o=i(1),a=i(470),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaHandheldPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.isExtendsGrid=!1,i.key=o.ModuleName.PICAHANDHELD_NAME,i}return h(PicaHandheldPanel,t),PicaHandheldPanel.prototype.resize=function(t,e){this.scale;var i=this.scaleWidth,n=this.scaleHeight;this.setSize(i,n),this.updateLayout(),this.isExtendsGrid=!1},PicaHandheldPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen(),this.updateData(),this.render.renderEmitter(o.ModuleName.PICAHANDHELD_NAME+"_handheldlist")):this.preload())},PicaHandheldPanel.prototype.hide=function(){this.mShow=!1,this.removeListen(),t.prototype.hide.call(this)},PicaHandheldPanel.prototype.addListen=function(){this.mInitialized&&this.handeldEqiped.addListen()},PicaHandheldPanel.prototype.removeListen=function(){this.mInitialized&&this.handeldEqiped.removeListen()},PicaHandheldPanel.prototype.destroy=function(){this.mPropGrid&&this.mPropGrid.destroy(),t.prototype.destroy.call(this)},PicaHandheldPanel.prototype.setEqipedDatas=function(t){var e=t.handheld,i=(e=e.sort((function(t,e){return t.latestUse>=e.latestUse?1:-1}))).splice(0,3);e=e.sort((function(t,e){return t.recommended>=e.recommended?1:-1})),e=i.concat(e);var n,s={id:"empty_handed",count:0};if(""!==t.currentHandheldId&&t.currentHandheldId)for(var r=0,o=e;r<o.length;r++){var a=o[r];if(a.id===t.currentHandheldId){n=a;break}}else n=s;if(e.unshift(s),this.handeldEqiped.setItemData(n),this.isExtendsGrid){var h=14-e.length,l=h>0?e.concat(new Array(h)):e;if(this.mPropGrid.setItems(l),n)for(var c=0,p=this.mPropGrid.getCells();c<p.length;c++){var d=p[c];if(d&&d.container){var m=d.container;m.itemData===n?(m.isSelect=!0,this.curHandheldItem=d):m.isSelect=!1}}}},PicaHandheldPanel.prototype.preload=function(){this.addAtlas(this.key,"hand_equp/hand_equp.png","hand_equp/hand_equp.json"),t.prototype.preload.call(this)},PicaHandheldPanel.prototype.init=function(){var e=this;if(!this.mInitialized){var i=this.scaleWidth,n=this.scaleHeight;this.gridContent=this.scene.make.container(void 0,!1),this.add(this.gridContent),this.gridContent.setSize(i,150*this.dpr),this.gridContent.x=.5*i,this.gridContent.y=n-.5*this.gridContent.height-200*this.dpr;var o=this.scene.make.graphics(void 0,!1);o.fillStyle(3355443,.5),o.fillRect(.5*-i,.5*-this.gridContent.height,i,150*this.dpr),this.gridContent.add(o),this.handeldEqiped=new p(this.scene,0,0,this.key,this.dpr),this.handeldEqiped.setClickHandler(new r.Handler(this,this.onHandheldEqipedHandler),new r.Handler(this,this.onShortcutHandler)),this.add(this.handeldEqiped);var a=this.scene.textures.getFrame(this.key,"equp_bg"),h=a.width+10*this.dpr,l=a.height+10*this.dpr,d={x:0,y:0,table:{width:i-20*this.dpr,height:120*this.dpr,columns:2,cellWidth:h,cellHeight:l,reuseCellContainer:!0,cellOriginX:.5,cellOriginY:.5,zoom:this.scale},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.scene,s=t.item;return null===i&&(i=new c(n,0,0,e.key,e.dpr)),i.setItemData(s),i}};this.mPropGrid=new s.GameGridTable(this.scene,d),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){e.onSelectItemHandler(t)})),this.gridContent.add(this.mPropGrid),this.resize(0,0),t.prototype.init.call(this)}},PicaHandheldPanel.prototype.updateData=function(){this.updateLayout()},PicaHandheldPanel.prototype.updateLayout=function(){var t=this.scaleWidth,e=this.scaleHeight,i=t-.5*this.handeldEqiped.width-8*this.dpr,n=0;this.gridContent.y=e-.5*this.gridContent.height,this.isExtendsGrid?(n=e-.5*this.handeldEqiped.height-this.gridContent.height,this.gridContent.visible=!0,this.mPropGrid.resetMask(),this.handeldEqiped.normal(),this.handeldEqiped.hideShortcut()):(n=e-.5*this.handeldEqiped.height-10*this.dpr,this.gridContent.visible=!1,this.handeldEqiped.waiting(),this.handeldEqiped.isEmptyHanded||this.handeldEqiped.showShortcut()),this.handeldEqiped.setPosition(i,n)},PicaHandheldPanel.prototype.onSelectItemHandler=function(t){var e=t.itemData;e&&(this.curHandheldItem&&(this.curHandheldItem.isSelect=!1),t.isSelect=!0,this.curHandheldItem=t,t.isEmptyHanded?this.render.renderEmitter(o.ModuleName.PICAHANDHELD_NAME+"_clearhandheld"):this.render.renderEmitter(o.ModuleName.PICAHANDHELD_NAME+"_changehandheld",e.id))},PicaHandheldPanel.prototype.onHandheldEqipedHandler=function(t){this.isExtendsGrid=!this.isExtendsGrid,this.isExtendsGrid?(this.gridContent.visible=!0,this.render.renderEmitter(o.ModuleName.PICAHANDHELD_NAME+"_handheldlist"),this.render.renderEmitter(o.ModuleName.PICAHANDHELD_NAME+"_openeqiped",!0)):(this.mPropGrid.setItems([]),this.gridContent.visible=!1,this.render.renderEmitter(o.ModuleName.PICAHANDHELD_NAME+"_openeqiped",!1)),this.updateLayout()},PicaHandheldPanel.prototype.onShortcutHandler=function(t){this.render.renderEmitter(o.ModuleName.PICAHANDHELD_NAME+"_clearhandheld")},PicaHandheldPanel}(a.BasePanel),c=function(t){function HandheldItem(e,i,n,s,r){var o=t.call(this,e,i,n)||this;return o.mIsSelect=!1,o.dpr=r,o.key=s,o.bg=o.scene.make.image({key:s,frame:"equp_bg"}),o.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),o.selectbg=o.scene.make.image({key:s,frame:"click_bg"}),o.selectbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),o.icon=new a.DynamicImage(e,0,0),o.add([o.bg,o.selectbg,o.icon]),o.setSize(o.selectbg.width,o.selectbg.height),o.isSelect=!1,o}return h(HandheldItem,t),HandheldItem.prototype.setItemData=function(t){var e=this;if(this.itemData=t,!t)return this.icon.visible=!1,void(this.selectbg.visible=!1);if(this.icon.visible=!0,this.selectbg.visible=this.mIsSelect,this.isEmptyHanded)this.icon.setTexture(this.key,"empty_handed");else{var i=t.display,n=r.Url.getOsdRes(i.texturePath);this.icon.load(n,this,(function(){e.icon.scale=1,e.icon.displayWidth=34*e.dpr,e.icon.scaleY=e.icon.scaleX}))}},Object.defineProperty(HandheldItem.prototype,"isSelect",{get:function(){return this.mIsSelect},set:function(t){this.mIsSelect=t,this.selectbg.visible=t},enumerable:!1,configurable:!0}),Object.defineProperty(HandheldItem.prototype,"isEmptyHanded",{get:function(){return!(!this.itemData||"empty_handed"!==this.itemData.id)},enumerable:!1,configurable:!0}),HandheldItem}(Phaser.GameObjects.Container),p=function(t){function HandheldEqiped(e,i,n,s,r){var o=t.call(this,e,i,n)||this;o.isExtendsGrid=!1,o.key=s,o.dpr=r,o.bg=o.scene.make.image({key:s,frame:"button_h"}),o.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),o.shortcutCon=o.scene.make.container(void 0,!1),o.shortcutbg=o.scene.make.image({key:s,frame:"superscript_h"}),o.shortcutbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),o.shortcutIcon=o.scene.make.image({key:s,frame:"hand"}),o.shortcutIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),o.shortcutCon.add([o.shortcutbg,o.shortcutIcon]);var h=40*r;return o.shortcutCon.setSize(h,h),o.shortcutbg.x=.5*-o.shortcutCon.width+.5*o.shortcutbg.width-5*r,o.shortcutbg.y=.5*o.shortcutCon.height-.5*o.shortcutbg.height+5*r,o.shortcutIcon.x=o.shortcutbg.x,o.shortcutIcon.y=o.shortcutbg.y,o.icon=new a.DynamicImage(e,0,0),o.icon.setTexture(o.key,"empty_handed"),o.shortcutCon.on("pointerup",o.onShortcutHandler,o),o.add([o.bg,o.icon,o.shortcutCon]),o.setSize(o.bg.width,o.bg.height),o.shortcutCon.setPosition(.5*o.width+.5*h-20*r,.5*-o.height-.5*h+15*r),o.on("pointerup",o.onClickHandler,o),o.hideShortcut(),o}return h(HandheldEqiped,t),HandheldEqiped.prototype.normal=function(){this.bg.setFrame("button_h"),this.setChildAlpha(1)},HandheldEqiped.prototype.waiting=function(){this.bg.setFrame("button_h"),this.setChildAlpha(.5)},HandheldEqiped.prototype.setItemData=function(t){var e=this;if(this.itemData=t,this.isEmptyHanded)this.icon.setScale(1),this.icon.setTexture(this.key,"empty_handed"),this.hideShortcut();else{var i=t.display,n=r.Url.getOsdRes(i.texturePath);this.icon.load(n,this,(function(){e.icon.displayWidth=24*e.dpr,e.icon.scaleY=e.icon.scaleX})),this.isExtendsGrid||this.showShortcut()}},HandheldEqiped.prototype.addListen=function(){this.setInteractive(),this.shortcutCon.setInteractive()},HandheldEqiped.prototype.removeListen=function(){this.disableInteractive(),this.shortcutCon.disableInteractive()},HandheldEqiped.prototype.setClickHandler=function(t,e){this.clickHandler=t,this.shortcutHandler=e},HandheldEqiped.prototype.setChildAlpha=function(t){this.bg.setAlpha(t),this.icon.setAlpha(t),this.shortcutbg.setAlpha(t),this.shortcutIcon.setAlpha(t)},HandheldEqiped.prototype.hideShortcut=function(){this.shortcutCon.visible=!1,this.shortcutCon.disableInteractive()},HandheldEqiped.prototype.showShortcut=function(){this.shortcutCon.visible=!0,this.shortcutCon.setInteractive()},Object.defineProperty(HandheldEqiped.prototype,"isCanShowShortcut",{get:function(){return!this.isEmptyHanded},enumerable:!1,configurable:!0}),Object.defineProperty(HandheldEqiped.prototype,"isEmptyHanded",{get:function(){return!this.itemData||"empty_handed"===this.itemData.id},enumerable:!1,configurable:!0}),HandheldEqiped.prototype.onShortcutHandler=function(){this.shortcutHandler&&this.shortcutHandler.runWith(this.itemData)},HandheldEqiped.prototype.onClickHandler=function(){this.isExtendsGrid=!this.isExtendsGrid,this.clickHandler&&this.clickHandler.runWith(this.itemData)},HandheldEqiped}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaChatPanel",(function(){return m}));var n,s,r=i(5),o=i(470),a=i(11),h=i(1),l=i(0),c=i(486),p=i(487),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function fulfilled(t){try{step(n.next(t))}catch(t){r(t)}}function rejected(t){try{step(n.throw(t))}catch(t){r(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function verb(r){return function(a){return function step(r){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(s=2&r[0]?n.return:r[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,r[1])).done)return s;switch(n=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],n=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};!function(t){t[t.CurrentScene=0]="CurrentScene",t[t.World=1]="World",t[t.Team=2]="Team",t[t.Private=3]="Private",t[t.System=4]="System"}(s||(s={}));var m=function(t){function PicaChatPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i.chatCatchArr=[],i.chatMaxLen=100,i.MAX_HEIGHT=460*i.dpr,i.MIN_HEIGHT=100*i.dpr,i.scale=1,i.key=h.ModuleName.PICACHAT_NAME,i.UIType=r.UIType.Scene,i}return d(PicaChatPanel,t),PicaChatPanel.prototype.show=function(e){t.prototype.show.call(this,e),this.mShowData=e,this.mInitialized&&(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen(),this.checkUpdateActive())},PicaChatPanel.prototype.resize=function(e,i){var n=this.scale,s=this.scene.cameras.main.width,r=this.scene.cameras.main.height;e=s,i=i||133*this.dpr,this.giftPanel&&this.giftPanel.visible&&(i=185*this.dpr),this.setSize(s,i);var o=this.scene.textures.getFrame(this.key,"title_bg"),a=o?s/this.scale/o.width:1;this.mTitleBg.scaleX=a,this.mTitleBg.x=s/this.scale/2,this.y=r-this.height,this.mBackground.clear(),this.mBackground.fillStyle(0,.6),this.mBackground.fillRect(0,0,s/this.scale,i/this.scale),this.mTextArea.childrenMap.child.setMinSize(e,(i-16*this.dpr)*n),this.mTextArea.layout(),this.mTextArea.setPosition(this.width/2+4*this.dpr,this.y+this.mTextArea.height/2+10*this.dpr*n),this.mTextArea.childrenMap.text.y=8*this.dpr,this.mTextArea.scrollToBottom(),this.giftPanel&&(this.giftPanel.resize(),this.giftPanel.y=this.height-.5*this.giftPanel.height,this.giftPanel.x=.5*this.width),t.prototype.resize.call(this,e,i),this.mBackground.input=void 0,this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,s/this.scale,i/this.scale),Phaser.Geom.Rectangle.Contains)},PicaChatPanel.prototype.chatHandler=function(t){return __awaiter(this,void 0,void 0,(function(){var e,i,n;return __generator(this,(function(s){switch(s.label){case 0:return[4,this.render.mainPeer.getPlayerName(t.chatSenderid)];case 1:return e=s.sent(),i="",e?i=e:t.chatSenderid&&(i=l.i18n.t("chat.mystery")),n="#ffffff",t.chatSetting&&(n=t.chatSetting.textColor),this.showChat("[color="+n+"]["+this.getChannel(t.chatChannel)+"]"+i+": "+t.chatContext+"[/color]\n"),[2]}}))}))},PicaChatPanel.prototype.showChat=function(t){this.appendChat(t)},PicaChatPanel.prototype.getChannel=function(t){switch(t){case s.CurrentScene:return l.i18n.t("chat.current");case s.World:return l.i18n.t("chat.world");default:return l.i18n.t("chat.system")}},PicaChatPanel.prototype.setGiftData=function(t){this.giftPanel.setGiftDatas(t.commodities)},PicaChatPanel.prototype.appendChat=function(t){this.chatCatchArr.push(t),this.chatCatchArr.length>this.chatMaxLen&&this.chatCatchArr.shift(),this.mTextArea&&(this.mTextArea.appendText(t),this.mTextArea.scrollToBottom()),this.mInputText&&this.mInputText instanceof c.PicaChatInputPanel&&this.mInputText.appendChat(t)},PicaChatPanel.prototype.isShowChatPanel=function(){return!(!this.mTextArea||!this.mTextArea.visible)},PicaChatPanel.prototype.hide=function(){this.mTextArea&&this.mTextArea.destroy(),this.mOutputText&&this.mOutputText.destroy(),this.mShow=!1,this.removeListen(),t.prototype.hide.call(this)},PicaChatPanel.prototype.addListen=function(){t.prototype.addListen.call(this),this.mInitialized&&(this.mChatBtn.setInteractive(),this.mEmojiBtn.setInteractive(),this.mTextArea.visible&&this.mScrollBtn.setInteractive(),this.mGiftBtn.setInteractive(),this.mTextArea.childrenMap.child.setInteractive(),this.mScrollBtn.on("drag",this.onDragHandler,this),this.scene.input.setDraggable(this.mScrollBtn,!0),this.mChatBtn.on("pointerup",this.onShowInputHanldler,this),this.mGiftBtn.on("pointerup",this.onGiftHandler,this),this.mEmojiBtn.on("pointerup",this.onEmojiHandler,this),this.render.emitter.on(h.EventType.CHAT,this.chatHandler,this),this.render.emitter.on(h.EventType.UPDATE_PARTY_STATE,this.setGiftButtonState,this))},PicaChatPanel.prototype.removeListen=function(){t.prototype.removeListen.call(this),this.mInitialized&&(this.mChatBtn.disableInteractive(),this.mEmojiBtn.disableInteractive(),this.mScrollBtn.disableInteractive(),this.mGiftBtn.disableInteractive(),this.mTextArea.childrenMap.child.disableInteractive(),this.mEmojiBtn.off("pointerup",this.onEmojiHandler,this),this.mScrollBtn.off("drag",this.onDragHandler,this),this.mChatBtn.off("pointerup",this.onShowInputHanldler,this),this.mGiftBtn.off("pointerup",this.onGiftHandler,this),this.render.emitter.off(h.EventType.CHAT,this.chatHandler,this),this.render.emitter.off(h.EventType.UPDATE_PARTY_STATE,this.setGiftButtonState,this))},PicaChatPanel.prototype.updateUIState=function(t){this.mInitialized},PicaChatPanel.prototype.destroy=function(){this.mBackground&&this.mBackground.disableInteractive(),t.prototype.destroy.call(this)},PicaChatPanel.prototype.preload=function(){this.addAtlas(this.key,"pica_chat/pica_chat.png","pica_chat/pica_chat.json"),this.addAtlas(a.c.commonKey,a.d.commonUrl+".png",a.d.commonUrl+".json"),this.addAtlas(a.c.common2Key,a.d.common2Url+".png",a.d.common2Url+".json"),t.prototype.preload.call(this)},PicaChatPanel.prototype.init=function(){var e=this.scene.cameras.main.width;this.scene.cameras.main.height;this.mBackground=this.scene.make.graphics(void 0,!1);var i=this.scale;this.setSize(e,135*this.dpr),this.mTileContainer=this.scene.make.container(void 0,!1),this.mScrollBtn=this.scene.make.image({x:21*this.dpr*i,key:this.key,frame:"scroll_btn"},!1).setScale(i),this.mScrollBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mTitleBg=this.scene.make.image({key:this.key,frame:"title_bg"},!1).setScale(i),this.mChatBtn=this.scene.make.image({x:96*this.dpr*i,key:this.key,frame:"chat_icon"},!1).setScale(i),this.mHornBtn=this.scene.make.image({x:159*this.dpr*i,key:this.key,frame:"horn_icon"},!1).setScale(i),this.mEmojiBtn=this.scene.make.image({x:218*this.dpr*i,key:this.key,frame:"emoji"},!1).setScale(i),this.mGiftBtn=this.scene.make.image({x:218*this.dpr*i,key:this.key,frame:"party_gift_icon"},!1).setScale(i);var n=20*this.dpr;this.mTitleBg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mScrollBtn.x=.5*this.mScrollBtn.width+5*this.dpr,this.mScrollBtn.y=-this.mScrollBtn.height/2+this.mTitleBg.height,this.mChatBtn.x=this.mScrollBtn.x+.5*this.mScrollBtn.width+n+.5*this.mChatBtn.width,this.mChatBtn.y=-this.mChatBtn.height/2+this.mTitleBg.height,this.mChatBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mHornBtn.x=this.mChatBtn.x+.5*this.mChatBtn.width+n+.5*this.mHornBtn.width,this.mHornBtn.y=-this.mHornBtn.height/2+this.mTitleBg.height,this.mHornBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mEmojiBtn.x=this.mHornBtn.x+.5*this.mHornBtn.width+n+.5*this.mEmojiBtn.width,this.mEmojiBtn.y=-this.mEmojiBtn.height/2+this.mTitleBg.height,this.mEmojiBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mGiftBtn.x=this.mEmojiBtn.x+.5*this.mEmojiBtn.width+n+.5*this.mGiftBtn.width,this.mGiftBtn.y=-this.mGiftBtn.height/2+this.mTitleBg.height,this.mGiftBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mOutputText=new r.BBCodeText(this.mScene,0,0,"",{fontSize:14*this.dpr/i+"px",fontFamily:l.Font.DEFULT_FONT,stroke:"#000000",strokeThickness:1*this.dpr*i,textMask:!1,shadow:{offsetX:0,offsetY:0,color:"#000",blur:4,stroke:!0,fill:!0},wrap:{mode:"char",width:e-12*this.dpr*i}}),this.mOutputText.setResolution(this.dpr);var s=this.scene.make.graphics(void 0,!1);this.mTextArea=new r.TextArea(this.mScene,{x:e/2+4*this.dpr*i,y:160*this.dpr*i,textWidth:e-4*this.dpr*i,textHeight:this.MAX_HEIGHT,text:this.mOutputText}).layout(),this.mTileContainer.add([this.mTitleBg,this.mChatBtn,this.mHornBtn,this.mEmojiBtn,this.mGiftBtn,this.mScrollBtn]),this.add([this.mBackground,this.mTileContainer,this.mTextArea,this.mOutputText,s]),this.resize(this.width,133*this.dpr),t.prototype.init.call(this)},PicaChatPanel.prototype.onDragHandler=function(t,e,i){var n=this.height+(t.prevPosition.y-t.position.y);n>this.MAX_HEIGHT||n<this.MIN_HEIGHT||this.resize(this.width,n)},PicaChatPanel.prototype.setGiftButtonState=function(t){this.giftPanel&&this.giftPanel.setGiftActive(t)},PicaChatPanel.prototype.onShowNavigateHandler=function(){this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_showNavigate")},PicaChatPanel.prototype.onEmojiHandler=function(){var t=this.render.displayManager.user.id;this.render.mainPeer.setDragonBonesQueue(t,[{animationName:"idle",scale:!1,times:1}]),this.render.physicalPeer.changePlayerState(t,"jump",1)},PicaChatPanel.prototype.onGiftHandler=function(){var t=this;this.giftPanel&&this.giftPanel.visible?(this.giftPanel.hide(),this.showChatTextArea()):(this.hideAllChildPanel(),this.giftPanel||(this.giftPanel=new p.PicaGiftPanel(this.scene,0,0,this.width,175*this.dpr,this.key,this.dpr,this.scale),this.giftPanel.y=this.height-.5*this.giftPanel.height,this.giftPanel.x=.5*this.width,this.add(this.giftPanel),this.giftPanel.resize(),this.giftPanel.on("showpropfun",this.showPropFun,this),this.giftPanel.on("buyItem",this.onBuyItemHandler,this),this.giftPanel.on("shownotice",this.showNoticeHandler,this)),this.resize(this.width,185*this.dpr),this.giftPanel.show(),this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_querymarket"),this.render.mainPeer.getCurRoom().then((function(e){var i=!!e&&e.openingParty;t.giftPanel.setGiftActive(i)})))},PicaChatPanel.prototype.onShowInputHanldler=function(){var t=this;if(this.hideAllChildPanel(),this.showChatTextArea(),!this.mInputText){var e=window.pktGlobal;if(e&&"Cordova"===e.envPlatform)if(this.scene.cache.json.has("quickchat"))setTimeout((function(){t.openAppInputPanel()}),20);else{var i=l.Url.getRes("/ui/quickchat/"+l.i18n.language+".json");this.scene.load.json("quickchat",i),this.scene.load.on(Phaser.Loader.Events.FILE_COMPLETE,this.openAppInputPanel,this),this.scene.load.start()}else this.mInputText=new o.InputPanel(this.scene,this.render),this.mInputText.once("close",this.sendChat,this)}},PicaChatPanel.prototype.sendChat=function(t){this.mInputText=void 0,t&&this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_chat",t)},PicaChatPanel.prototype.openAppInputPanel=function(){if(this.scene.cache.json.has("quickchat")){this.mInputText=new c.PicaChatInputPanel(this.scene,this.render,this.key,this.chatCatchArr.concat()),this.mInputText.once("close",this.appCloseChat,this),this.mInputText.on("send",this.appSendChat,this);var t=this.scene.cache.json.get("quickchat");this.mInputText.setQuickChatData(t.concat()),this.parentContainer&&(this.parentContainer.visible=!1),this.scene.load.off(Phaser.Loader.Events.FILE_COMPLETE,this.openAppInputPanel,this)}},PicaChatPanel.prototype.appSendChat=function(t){t&&this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_chat",t)},PicaChatPanel.prototype.appCloseChat=function(){this.mInputText.off("send",this.appSendChat,this),this.mInputText=void 0,this.parentContainer&&(this.parentContainer.visible=!0)},PicaChatPanel.prototype.checkUpdateActive=function(){var t=this;this.render.mainPeer.getCurRoom().then((function(e){e&&t.setGiftButtonState(e.openingParty)})),this.render.mainPeer.getActiveUIData(h.ModuleName.PICACHAT_NAME).then((function(e){if(e)for(var i=0,n=e;i<n.length;i++){var s=n[i];t.updateUIState(s)}}))},PicaChatPanel.prototype.hideAllChildPanel=function(){this.giftPanel&&this.giftPanel.hide(),this.mTextArea&&(this.mTextArea.visible=!1),this.mScrollBtn.disableInteractive(),this.showPanelHandler(h.ModuleName.PICAHANDHELD_NAME,!1)},PicaChatPanel.prototype.showChatTextArea=function(){this.mTextArea.visible=!0,this.mScrollBtn.setInteractive(),this.showPanelHandler(h.ModuleName.PICAHANDHELD_NAME,!0)},PicaChatPanel.prototype.onBuyItemHandler=function(t,e){var i=this,n=new o.AlertView(this.uiManager);e.count*e.sellingPrice.price>0?n.show({title:l.i18n.t("party.sendgift"),text:l.i18n.t("party.sendgifttips",{count:t.quantity,name:e.name||e.shortName}),oy:302*this.dpr*this.render.uiScale,callback:function(){i.render.renderEmitter(h.RENDER_PEER+"_"+i.key+"_buyItem",t)}}):this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_buyItem",t)},PicaChatPanel.prototype.showPropFun=function(t){this.showPanelHandler(h.ModuleName.PICAPROPFUN_NAME,!0,t)},PicaChatPanel.prototype.showNoticeHandler=function(t){var e={text:[{text:t,node:void 0}]};this.showPanelHandler(h.ModuleName.PICANOTICE_NAME,!0,e)},PicaChatPanel.prototype.showPanelHandler=function(t,e,i){this.render&&(e?this.render.mainPeer.showMediator(t,!0,i):this.render.mainPeer.showMediator(t,!1))},PicaChatPanel}(o.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaMainUIPanel",(function(){return c}));var n,s=i(5),r=i(11),o=i(470),a=i(1),h=i(0),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function fulfilled(t){try{step(n.next(t))}catch(t){r(t)}}function rejected(t){try{step(n.throw(t))}catch(t){r(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function verb(r){return function(a){return function step(r){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(s=2&r[0]?n.return:r[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,r[1])).done)return s;switch(n=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],n=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},c=function(t){function PicaMainUIPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.isSceneNameActive=!1,i.key=a.ModuleName.PICAMAINUI_NAME,i}return l(PicaMainUIPanel,t),PicaMainUIPanel.prototype.show=function(e){t.prototype.show.call(this,e),this.mInitialized&&(this.setInteractive(),this.update(this.mShowData),this.checkUpdateActive())},PicaMainUIPanel.prototype.resize=function(e,i){var n=this.scene.cameras.main.width/this.scale,s=this.scene.cameras.main.height/this.scale;t.prototype.resize.call(this,n,s),this.mCoinValue.x=n-this.mCoinValue.width/2-5*this.dpr,this.mDiamondValue.x=n-this.mDiamondValue.width/2-5*this.dpr},PicaMainUIPanel.prototype.preload=function(){this.addAtlas(this.key,"main_ui/mainui.png","main_ui/mainui.json"),this.addAtlas(r.c.commonKey,r.d.commonUrl+".png",r.d.commonUrl+".json"),t.prototype.preload.call(this)},PicaMainUIPanel.prototype.addListen=function(){t.prototype.addListen.call(this),this.mInitialized&&(this.roomCon?(this.roomCon.on("pointerup",this.onOpenRoomPanel,this),this.render.emitter.on(a.EventType.UPDATE_ROOM_INFO,this.onUpdateRoomHandler,this),this.render.emitter.on(a.EventType.UPDATE_PLAYER_INFO,this.onUpdatePlayerHandler,this),this.render.emitter.on(a.EventType.UPDATE_PARTY_STATE,this.onUpdatePartyHandler,this)):h.Logger.getInstance().fatal(PicaMainUIPanel.name+": sceneName does not exist!"))},PicaMainUIPanel.prototype.removeListen=function(){t.prototype.removeListen.call(this),this.mInitialized&&(this.roomCon?(this.roomCon.off("pointerup",this.onOpenRoomPanel,this),this.render.emitter.off(a.EventType.UPDATE_ROOM_INFO,this.onUpdateRoomHandler,this),this.render.emitter.off(a.EventType.UPDATE_PLAYER_INFO,this.onUpdatePlayerHandler,this),this.render.emitter.off(a.EventType.UPDATE_PARTY_STATE,this.onUpdatePartyHandler,this)):h.Logger.getInstance().fatal(PicaMainUIPanel.name+": sceneName does not exist!"))},PicaMainUIPanel.prototype.destroy=function(){t.prototype.destroy.call(this),this.playerInfo=void 0,this.roomInfo=void 0},PicaMainUIPanel.prototype.update=function(e){t.prototype.update.call(this),e&&(e.hasOwnProperty("roomId")?this.roomInfo=e:this.playerInfo=e),this.playerInfo&&this.updatePlayerInfo(this.playerInfo),this.roomInfo&&this.updateRoomInfo(this.roomInfo)},PicaMainUIPanel.prototype.updatePlayerInfo=function(t){if(this.playerInfo=t,this.mInitialized){if(t.level){var e=t.level;this.playerLv.text=e.level+""}if(void 0!==t.coin&&this.mCoinValue.setText(this.getCoin().value+""||"0"),void 0!==t.diamond&&this.mDiamondValue.setText(this.getDiamond().value+""||"0"),t.energy){var i=t.energy;i?this.mStrengthValue.setValue(i.currentValue,i.max):this.mStrengthValue.setValue(0,100)}this.mSceneName.rightIcon.visible=this.isSelfRoom}},PicaMainUIPanel.prototype.updateDetail=function(t){var e=this;t&&(this.headImage||(this.headImage=new o.DynamicImage(this.scene,0,0),this.headImage.setScale(this.dpr),this.add(this.headImage)),this.headImage.load(h.Url.getOsdRes(t.avatar),this,(function(){e.headImage.x=.5*e.headImage.width+4*e.dpr,e.headImage.y=.5*e.headImage.height+4*e.dpr})))},PicaMainUIPanel.prototype.getCoin=function(){for(var t=0,e=this.playerInfo.properties;t<e.length;t++){var i=e[t];if(i.hasOwnProperty("id")){if("IV0000001"===i.id)return i}else h.Logger.getInstance().error(i.key+"  缺少ID")}},PicaMainUIPanel.prototype.getDiamond=function(){for(var t=0,e=this.playerInfo.properties;t<e.length;t++){var i=e[t];if(i.hasOwnProperty("id")){if("IV0000002"===i.id)return i}else h.Logger.getInstance().error(i.key+"  缺少ID")}},PicaMainUIPanel.prototype.updateRoomInfo=function(t){this.roomInfo=t,this.mInitialized&&(this.roomCon.setSize(60*this.dpr,30*this.dpr),t.name&&(this.mSceneName.setText(t.name),this.roomCon.setSize(2*this.mSceneName.rightbound,30*this.dpr)),this.roomCon.setInteractive(),this.isSceneNameActive=!0,t.playerCount&&this.mCounter.setText(""+t.playerCount),this.mCounter.x=this.mSceneName.x+this.mSceneName.rightbound+5*this.dpr,this.praiseBtn.visible=!1,t.roomType&&("room"!==t.roomType&&"store"!==t.roomType||(this.praiseBtn.visible=!0),this.praiseBtn.setText(t.praise+""),this.praiseBtn.selected=t.hasPraised,t.hasPraised?(this.praiseBtn.setTextColor("#8E99C1"),this.praiseImg.setFrame("praise_after")):(this.praiseBtn.setTextColor("#ffffff"),this.praiseImg.setFrame("praise_before"))),this.mSceneName.rightIcon.visible=this.isSelfRoom,this.partyBtn.visible=this.isSelfRoom,t.openingParty?this.partyBtn.setText(h.i18n.t("common.manager")):this.partyBtn.setText(h.i18n.t("main_ui.party")))},Object.defineProperty(PicaMainUIPanel.prototype,"isSelfRoom",{get:function(){if(!this.playerInfo||!this.roomInfo)return!1;for(var t=this.playerInfo.rooms,e=this.roomInfo.roomId,i=0,n=t;i<n.length;i++){if(n[i].roomId===e)return!0}return!1},enumerable:!1,configurable:!0}),PicaMainUIPanel.prototype.updateUIState=function(t){this.mInitialized&&("mainui.playerinfo"===t.name&&(this.playerCon.visible=t.visible),"mainui.roominfo"===t.name&&(this.roomCon.visible=t.visible),"mainui.headbtn"===t.name&&(t.disabled?this.playerIcon.removeInteractive():this.playerIcon.setInteractive()),"mainui.entereditorbtn"===t.name&&(this.mSceneName.visible=t.visible,this.isSceneNameActive&&(t.disabled?this.roomCon.removeInteractive():(this.roomCon.setSize(2*this.mSceneName.rightbound,30*this.dpr),this.roomCon.setInteractive()))))},PicaMainUIPanel.prototype.init=function(){var e=this.scene.cameras.main.width,i=this.scene.cameras.main.height;this.playerCon=this.scene.make.container(void 0,!1),this.playerCon.y=25*this.dpr,this.add(this.playerCon),this.mCoinValue=new p(this.scene,this.key,"coin",this.dpr),this.mDiamondValue=new p(this.scene,this.key,"diamond",this.dpr),this.mDiamondValue.setHandler(new h.Handler(this,this.onOpenRechargeHandler)),this.mDiamondValue.y=35*this.dpr;var n=this.scene.textures.getFrame(this.key,"strength_progress");this.mStrengthValue=new u(this.scene,this.key,"strength_icon",this.dpr),this.mStrengthValue.x=76*this.dpr;var a=new s.NineSlicePatch(this.scene,68*this.dpr/2,this.mStrengthValue.height/2-n.height-1*this.dpr,92*this.dpr,n.height,this.key,"strength_progress",{left:8*this.dpr,top:3*this.dpr,right:n.width-2-8*this.dpr,bottom:n.height-1-3*this.dpr});this.mStrengthValue.setProgress(a,this.scale),this.playerIcon=this.scene.make.image({key:this.key,frame:"head"}),this.playerIcon.x=.5*-this.mStrengthValue.width-8*this.dpr,this.mStrengthValue.add(this.playerIcon),this.playerIcon.on("pointerup",this.onHeadHandler,this),this.playerIcon.setInteractive(),this.mStrengthValue.setValue(1e3,1e3),this.mStrengthValue.setInteractive(),this.mStrengthValue.on("pointerup",this.onStrengthHandler,this);var l=this.playerIcon.x+.5*this.playerIcon.width-2*this.dpr,c=this.playerIcon.y+.5*this.playerIcon.height-10*this.dpr;this.playerLv=this.scene.make.text({text:"0",x:l,y:c,style:{fontSize:11*this.dpr,bold:!0,fontFamily:h.Font.DEFULT_FONT,color:"#356EE3"}},!1).setOrigin(1,0),this.playerLv.setShadow(0,0,"#ffffff",2),this.playerLv.setStroke("#356EE3",2),this.playerLv.setShadowStroke(!0),this.mStrengthValue.add(this.playerLv),this.playerCon.add([this.mStrengthValue,this.mCoinValue,this.mDiamondValue]),this.roomCon=this.scene.make.container(void 0,!1),this.roomCon.y=this.playerCon.y+32*this.dpr,this.add(this.roomCon),this.mSceneName=new m(this.scene,this.key,"room_icon","setting_icon",this.dpr),this.mSceneName.setText(""),this.mSceneName.x=18*this.dpr,this.mCounter=new d(this.scene,r.c.commonKey,"home_persons",this.dpr),this.mCounter.setText(""),this.mCounter.x=this.mSceneName.x+this.mSceneName.rightbound+5*this.dpr,this.mCounter.y=this.mSceneName.y,this.mCounter.setColor("#28D5F5"),this.textToolTip=new o.TextToolTips(this.scene,r.c.commonKey,"tips_bg",this.dpr,this.scale),this.textToolTip.setSize(160*this.dpr,45).visible=!1,this.praiseBtn=new s.CheckBox(this.scene,this.key,"praise_before_bg","praise_after_bg","1"),this.praiseBtn.y=this.mSceneName.y+this.mSceneName.height+.5*this.praiseBtn.height+20*this.dpr,this.praiseBtn.x=8*this.dpr+.5*this.praiseBtn.width,this.praiseBtn.setTextStyle({fontSize:11*this.dpr,fontFamily:h.Font.DEFULT_FONT}),this.praiseBtn.setTextOffset(10*this.dpr,0),this.praiseBtn.on(String(s.ClickEvent.Tap),this.onPraiseHandler,this),this.praiseImg=this.scene.make.image({key:this.key,frame:"praise_before"}),this.praiseImg.x=-10*this.dpr,this.praiseBtn.add(this.praiseImg),this.partyBtn=new s.Button(this.scene,this.key,"home_party_bg","home_party_bg",h.i18n.t("main_ui.party")),this.partyBtn.x=this.praiseBtn.x+.5*this.praiseBtn.width+.5*this.partyBtn.width+5*this.dpr,this.partyBtn.y=this.praiseBtn.y,this.partyBtn.setTextOffset(8*this.dpr,0),this.partyBtn.setTextStyle({fontSize:11*this.dpr,fontFamily:h.Font.DEFULT_FONT}),this.partyBtn.on(String(s.ClickEvent.Tap),this.onPartyHandler,this),this.roomCon.add([this.mSceneName,this.mCounter,this.praiseBtn,this.partyBtn,this.textToolTip]),this.roomCon.setSize(2*this.mSceneName.rightbound,30*this.dpr),this.resize(e,i),t.prototype.init.call(this)},PicaMainUIPanel.prototype.onOpenRoomPanel=function(){this.render.renderEmitter("openroompanel")},PicaMainUIPanel.prototype.onHeadHandler=function(){this.render.renderEmitter("showPanel",a.ModuleName.CHARACTERINFO_NAME)},PicaMainUIPanel.prototype.onStrengthHandler=function(){var t=this;if(this.playerInfo){var e=this.playerInfo.energy,i=e.currentValue+"/"+e.max+"\n",n=h.i18n.t("main_ui.energy_tips",{name:i,interpolation:{escapeValue:!1}});this.textToolTip.visible||this.scene.input.on("pointerdown",this.onTextToolTipHandler,this),this.textToolTip.setDelayText(n,3e3,new h.Handler(this,(function(){t.scene.input.off("pointerdown",t.onTextToolTipHandler,t)}))),this.textToolTip.setPosition(120*this.dpr,20*this.dpr)}},PicaMainUIPanel.prototype.onTextToolTipHandler=function(){this.textToolTip.visible=!1,this.scene.input.off("pointerdown",this.onTextToolTipHandler,this)},PicaMainUIPanel.prototype.checkUpdateActive=function(){return __awaiter(this,void 0,void 0,(function(){var t,e,i,n;return __generator(this,(function(s){switch(s.label){case 0:return[4,this.mWorld.mainPeer.getActiveUIData("PicaMainUI")];case 1:if(t=s.sent())for(e=0,i=t;e<i.length;e++)n=i[e],this.updateUIState(n);return[2]}}))}))},PicaMainUIPanel.prototype.onUpdatePlayerHandler=function(t){this.playerInfo=t,this.updatePlayerInfo(t)},PicaMainUIPanel.prototype.onUpdateRoomHandler=function(t){this.roomInfo=t,this.updateRoomInfo(t)},PicaMainUIPanel.prototype.onUpdatePartyHandler=function(t){this.roomInfo&&this.updateRoomInfo(this.roomInfo)},PicaMainUIPanel.prototype.onPraiseHandler=function(t,e){this.render.renderEmitter(a.EventType.QUERY_PRAISE,e.selected)},PicaMainUIPanel.prototype.onPartyHandler=function(){this.render.renderEmitter("showPanel",a.ModuleName.PICAOPENPARTY_NAME)},PicaMainUIPanel.prototype.onOpenRechargeHandler=function(){this.render.renderEmitter("showPanel",a.ModuleName.PICARECHARGE_NAME)},PicaMainUIPanel}(o.BasePanel),p=function(t){function ValueContainer(e,i,n,s){void 0===s&&(s=1);var r=t.call(this,e)||this;return r.init(i,n,s),r}return l(ValueContainer,t),ValueContainer.prototype.setText=function(t){this.mText.setText(t)},ValueContainer.prototype.setHandler=function(t){this.sendHandler=t},ValueContainer.prototype.init=function(t,e,i){var n=this.scene.make.image({key:t,frame:"home_progress_bottom"},!1);n.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mLeft=this.scene.make.image({key:t,frame:e},!1),this.mLeft.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mText=this.scene.make.text({text:"0",width:n.width,height:n.height,style:{fontSize:14*i,fontFamily:h.Font.NUMBER}},!1).setOrigin(.5),this.mText.setStroke("#000000",1*i),this.mText.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mAddBtn=new s.Button(this.scene,t,"add_btn","add_btn"),this.setSize(n.width,n.height),this.mLeft.x=.5*-n.width+5*i,this.mLeft.y=n.y+.5*n.height-.5*this.mLeft.height,this.mAddBtn.x=this.width*this.originX-this.mAddBtn.width*this.originX-5*i,this.mText.x=4*i,this.add([n,this.mLeft,this.mText,this.mAddBtn]),this.mAddBtn.on(s.ClickEvent.Tap,this.onAddHandler,this)},ValueContainer.prototype.onAddHandler=function(){this.sendHandler&&this.sendHandler.run()},ValueContainer}(Phaser.GameObjects.Container),d=function(t){function IconText(e,i,n,s){void 0===s&&(s=1);var r=t.call(this,e)||this,o=e.make.image({key:i,frame:n},!1);return r.mText=e.make.text({style:{fontSize:14*s,fontFamily:h.Font.DEFULT_FONT}},!1).setOrigin(0,.5),r.mText.x=o.width/2+4*s,r.mText.setStroke("#000000",2*s),r.add([o,r.mText]),r}return l(IconText,t),IconText.prototype.setText=function(t){this.mText.setText(t)},IconText.prototype.setStroke=function(t,e){this.mText.setStroke(t,e)},IconText.prototype.setColor=function(t){this.mText.setColor(t)},IconText}(Phaser.GameObjects.Container),m=function(t){function SceneName(e,i,n,s,r){void 0===r&&(r=1);var o=t.call(this,e,i,n,r)||this;return o.mDpr=r,o.mRightIcon=e.make.image({y:2*r,key:i,frame:s},!1),o.add(o.mRightIcon),o.mRightIcon.y=8*r,o.mRightIcon.x=10*r,o}return l(SceneName,t),SceneName.prototype.setText=function(e){t.prototype.setText.call(this,e)},Object.defineProperty(SceneName.prototype,"rightbound",{get:function(){return this.mText.x+this.mText.width+10*this.mDpr},enumerable:!1,configurable:!0}),Object.defineProperty(SceneName.prototype,"rightIcon",{get:function(){return this.mRightIcon},enumerable:!1,configurable:!0}),SceneName}(d),u=(function(t){function ExpProgress(e,i,n,r,o){var a=t.call(this,e)||this,l=o.getSize().width/r,c=a.scene.textures.getFrame(i,"exp_bg");a.setSize(l,c.height);var p=a.width,d=a.height;a.mProgressBar=new y(e,n),a.mProgressBar.setSize(a.width,a.height);var m=new s.NineSlicePatch(a.scene,p/2,d/2,p,d,i,"exp_bg",{left:8*n,top:3*n,right:c.width-2-8*n,bottom:c.height-1-3*n});a.mProgressBar.setBackground(m),c=a.scene.textures.getFrame(i,"exp_progress");var u=new s.NineSlicePatch(a.scene,p/2,d/2,l,c.height,i,"exp_progress",{left:8*n,top:3*n,right:c.width-2-10*n,bottom:c.height-1-5*n});return a.mProgressBar.setProgress(u,r),a.mProgressBar.setRatio(.5),a.mCurrentLv=e.make.text({text:"57",style:{fontSize:10*n,fontFamily:h.Font.DEFULT_FONT}},!1),a.mCurrentLv.setStroke("#000000",1*n),a.mNextLv=e.make.text({text:"58",style:{fontSize:10*n,fontFamily:h.Font.DEFULT_FONT}},!1).setOrigin(0,0),a.mNextLv.setStroke("#000000",1*n),a.mNextLv.x=a.width-a.mNextLv.width,a.add([a.mProgressBar,a.mCurrentLv,a.mNextLv]),a}l(ExpProgress,t),ExpProgress.prototype.setLv=function(t,e){this.mCurrentLv.setText(t.toString()),this.mNextLv.setText((t+1).toString()),this.mNextLv.x=this.width-this.mNextLv.width,this.mProgressBar.setRatio(e)}}(Phaser.GameObjects.Container),function(t){function ProgressValue(e,i,n,s){return t.call(this,e,i,n,s)||this}return l(ProgressValue,t),ProgressValue.prototype.setProgress=function(t,e){this.mProgress.setProgress(t,e)},ProgressValue.prototype.setValue=function(t,e){this.mText&&(this.mText.text=t+"/"+e,this.mProgress.setRatio(t/e))},ProgressValue.prototype.setInteractive=function(e){return e=e||new Phaser.Geom.Rectangle(0,0,this.width,this.height),t.prototype.setInteractive.call(this,e,Phaser.Geom.Rectangle.Contains),this},ProgressValue.prototype.init=function(t,e,i){var n=this.scene.make.image({key:t,frame:"home_progress_bottom"},!1);n.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.setSize(n.width,n.height),this.mLeft=this.scene.make.image({key:t,frame:e},!1),this.mLeft.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mProgress=new y(this.scene,i),this.mProgress.x=-this.width/2+10*i,this.mProgress.y=4*i,this.mText=this.scene.make.text({text:"0",width:n.width,height:n.height,style:{fontSize:10*i,fontFamily:h.Font.NUMBER}},!1).setOrigin(.5),this.mText.setStroke("#000000",1*i),this.mText.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mAddBtn=new s.Button(this.scene,t,"add_btn","add_btn"),this.setSize(n.width,n.height),this.mLeft.x=-this.width*this.originX+13*i,this.mAddBtn.x=this.width*this.originX-10*i,this.add([n,this.mProgress,this.mLeft,this.mText,this.mAddBtn])},ProgressValue}(p)),y=function(t){function ProgressBar(e,i){var n=t.call(this,e)||this;return n.dpr=i,n}return l(ProgressBar,t),ProgressBar.prototype.setBackground=function(t){this.addAt(t,0)},ProgressBar.prototype.setProgress=function(t,e){this.mScale=e,this.mProgress=t,this.add(this.mProgress),this.setSize(t.width*this.mScale,t.height*this.mScale);var i=t.getWorldTransformMatrix();this.worldpos=new Phaser.Geom.Point(i.tx,i.ty),this.mMaskGraphics=this.scene.make.graphics(void 0,!1),this.mMaskGraphics.fillStyle(16750848),this.mMaskGraphics.fillRect(0,0,this.width,this.height+8*this.dpr),this.mProgress.mask=new Phaser.Display.Masks.GeometryMask(this.scene,this.mMaskGraphics),this.mMaskGraphics.y=i.ty+this.height+4*this.dpr,this.mMaskGraphics.x=i.tx},ProgressBar.prototype.setRatio=function(t){this.mMaskGraphics&&(this.mMaskGraphics.x=this.worldpos.x+4*this.dpr-.5*this.mProgress.width+(this.width*t-this.width))},ProgressBar}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRenderUiManager",(function(){return h}));var n,s=i(470),r=i(11),o=i(476),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicaRenderUiManager(e){var i=t.call(this,e)||this;return i.mAtalsManager=new r.a,i.singleManager=new o.PicaSingleManager(i),i.mAtalsManager.init(e),i}return a(PicaRenderUiManager,t),PicaRenderUiManager.prototype.getUrlDatas=function(t,e){return void 0===e&&(e=r.e.atlas),this.mAtalsManager.getUrlDatas(t,e)},PicaRenderUiManager.prototype.showAlertView=function(e,i,n,s){void 0===n&&(n=!1),t.prototype.showAlertView.call(this,e,i,n,s)},PicaRenderUiManager.prototype.destroy=function(){t.prototype.destroy.call(this),this.singleManager.destroy()},PicaRenderUiManager.prototype._showPanel=function(e,n){this.mPanelMap||(this.mPanelMap=new Map);var s=e+"Panel",r=new(i(642)("./"+e+"/"+s)[s])(this);if(r)return this.mPanelMap.set(e,r),r.show(n),r;t.prototype._showPanel.call(this,e,n)},PicaRenderUiManager}(s.UiManager)},function(t,e,i){"use strict";i.r(e),i.d(e,"InteractiveBubblePanel",(function(){return l}));var n,s=i(470),r=i(1),o=i(0),a=i(490),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function InteractiveBubblePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.map=new Map,i.key=r.ModuleName.BUBBLE_NAME,i}return h(InteractiveBubblePanel,t),InteractiveBubblePanel.prototype.resize=function(e,i){t.prototype.resize.call(this,e,i),this.setSize(e,i)},InteractiveBubblePanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight;this.scale;this.resize(e,i),t.prototype.init.call(this)},InteractiveBubblePanel.prototype.destroy=function(){if(this.map){for(var e in this.map){var i=this.map.get(Number(e));i&&i.destroy()}this.map.clear()}t.prototype.destroy.call(this)},InteractiveBubblePanel.prototype.clearInteractionBubble=function(t){this.map.has(t)&&(this.map.get(t).destroy(),this.map.delete(t))},InteractiveBubblePanel.prototype.showInteractionBubble=function(t,e){var i=this,n=this.dpr;t.display.resName=null,t.display.texturePath=o.Url.getUIRes(n,"bubble/bubblebg.png"),t.display.dataPath=o.Url.getUIRes(n,"bubble/tipsicon.png");var r=t.id;this.mBubble&&this.mBubble.hide(),this.map.has(r)?this.mBubble=this.map.get(r):(this.mBubble=new a.InteractionBubbleContainer(this.scene,n),this.map.set(r,this.mBubble)),this.mBubble.setBubble(t,new o.Handler(this,this.onInteractiveBubbleHandler));var h=this.render.sceneManager.getSceneByName(s.PlayScene.name);h?(this.updateBubblePos(e,h),this.mBubble.setFollow(e,h,(function(t){i.updateBubblePos(e,t.scene)})),this.mBubble.show=!0,this.add(this.mBubble)):o.Logger.getInstance().fatal("scene does not exist")},InteractiveBubblePanel.prototype.updateBubblePos=function(t,e){var i=this.dpr,n=this.render.uiScale,s=t.getDisplay();if(s){var r=s.getWorldTransformMatrix();if(r){var a=o.Tool.getPosByScenes(e,new o.Pos(r.tx,r.ty-33*i*n));this.mBubble.setPosition(a.x,a.y)}}},InteractiveBubblePanel.prototype.update=function(){this.map&&this.map.forEach((function(t){t&&t.show&&t.updatePos()}))},InteractiveBubblePanel.prototype.onInteractiveBubbleHandler=function(t){this.render.renderEmitter(r.RENDER_PEER+"_"+this.key+"_queryinteractive",t)},InteractiveBubblePanel}(s.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"CreateRolePanel",(function(){return l}));var n,s=i(5),r=i(0),o=i(1),a=i(470),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function CreateRolePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.mCurPageNum=0,i.setTween(!1),i.scene.add.container(0,0).add(i),i.scene.scale.on("resize",i.onResize,i),i.mMediator=i.render.mainPeer[o.ModuleName.CREATEROLE_NAME],i.key=o.ModuleName.CREATEROLE_NAME,i}return h(CreateRolePanel,t),CreateRolePanel.prototype.show=function(e){e&&(this.avatars=this.creatAvatars(e),t.prototype.show.call(this,e))},CreateRolePanel.prototype.preload=function(){this.addAtlas(this.key,"create_role/create_role.png","create_role/create_role.json"),t.prototype.preload.call(this)},CreateRolePanel.prototype.hide=function(){t.prototype.hide.call(this)},CreateRolePanel.prototype.resize=function(t,e){if(this.mBackground){var i=this.scale,n=this.scene.cameras.main.width/i,s=this.scene.cameras.main.height/i,r=this.scene.cameras.main.centerX/i;this.mBackground.x=r,this.mFoot.x=r,this.mFoot.y=s-(this.mFoot.height>>1),this.mBackgroundColor.clear(),this.mBackgroundColor.fillGradientStyle(7304703,7304703,314367,314367),this.mBackgroundColor.fillRect(0,0,n,s),this.mSubmit.x=r,this.inputText.x=r,this.mInputTextBg.x=r,this.dragonbones.x=r,this.mNextPageBtn.x=n-150,this.mRandomBtn.x=this.mInputTextBg.x+this.mInputTextBg.width/2-26*this.dpr}},CreateRolePanel.prototype.init=function(){var e=this.scene.cameras.main,i=e.width,n=e.height;this.mBackground=this.scene.make.image({key:this.key,frame:"bg.png",x:i>>1}),this.mBackground.y=this.mBackground.height/2+92*this.dpr,this.add(this.mBackground),this.mFoot=this.scene.make.image({key:this.key,frame:"bg_foot.png"},!1),this.add(this.mFoot),this.mBackgroundColor=this.scene.make.graphics(void 0,!1),this.mBackgroundColor.fillGradientStyle(7304703,7304703,314367,314367),this.mBackgroundColor.fillRect(0,0,i,n),this.addAt(this.mBackgroundColor,0),this.mInputTextBg=new s.NineSlicePatch(this.scene,i>>1,350*this.dpr,255*this.dpr,50*this.dpr,this.key,"input_bg.png",{left:27*this.dpr,top:24*this.dpr,right:28*this.dpr,bottom:24*this.dpr}),this.add(this.mInputTextBg),this.inputText=new s.InputText(this.scene,i>>1,350*this.dpr,160*this.dpr,80,{type:"input",fontSize:18*this.dpr+"px",color:"#717171",align:"center",placeholder:r.i18n.t("create_role.enter_nick")}).setOrigin(.5),this.add(this.inputText);var o=r.i18n.t("create_role.commit");this.mShowData&&this.mShowData.button&&(o=this.mShowData.button.text);var h=this.scene.textures.getFrame(this.key,"submit_button_normal"),l=42,c=43;h&&(l=h.width,c=h.height),this.mSubmit=new s.NineSliceButton(this.scene,i>>1,445*this.dpr,202*this.dpr,55*this.dpr,this.key,"submit_button",o,void 0,void 0,{left:19*this.dpr,top:20*this.dpr,right:l-2-19*this.dpr,bottom:c-2-20*this.dpr}),this.mSubmit.setTextStyle({color:"#976400",fontSize:18*this.dpr,fontFamily:r.Font.DEFULT_FONT}),this.mSubmit.setFontStyle("bold"),this.mSubmit.on("pointerup",this.onSubmitHandler,this),this.add(this.mSubmit),this.mPrePageBtn=this.scene.make.image({x:60*this.dpr,y:216*this.dpr,key:this.key,frame:"arrow_left.png"}).setInteractive(),this.mPrePageBtn.on("pointerup",this.onPrePageHandler,this),this.mNextPageBtn=this.scene.make.image({x:i-60*this.dpr,y:this.mPrePageBtn.y,key:this.key,frame:"arrow.png"}).setFlipX(!0).setInteractive(),this.mNextPageBtn.on("pointerup",this.onNextPageHandler,this),this.mRandomBtn=this.scene.make.image({x:this.mInputTextBg.x,y:this.mInputTextBg.y,key:this.key,frame:"random.png"}).setInteractive(),this.add([this.mPrePageBtn,this.mNextPageBtn,this.mRandomBtn]),this.mRandomBtn.on("pointerup",this.onRandomNameHandler,this),this.mErrorBg=this.scene.make.image({key:this.key,frame:"tips_bg.png",x:220*this.dpr,y:57*this.dpr}).setVisible(!1),this.mError=this.scene.make.text({x:127*this.dpr,y:30*this.dpr,style:{color:"#26265d",font:"bold 34px YaHei",wordWrap:{width:420,useAdvancedWrap:!0}}},!1).setVisible(!1),this.add([this.mErrorBg,this.mError]),this.dragonbones=new a.DragonbonesDisplay(this.scene,this.render),this.dragonbones.scale=2*this.dpr,this.dragonbones.x=i>>1,this.dragonbones.y=this.mNextPageBtn.y+70*this.dpr,this.dragonbones.on("initialized",this.loadDragonbonesComplete,this),this.add(this.dragonbones),this.setPageNum(0),t.prototype.init.call(this),this.resize(0,0)},CreateRolePanel.prototype.setAvatars=function(t){},CreateRolePanel.prototype.showError=function(t){this.mError&&(this.mError.text=t,this.mError.setVisible(!0),this.mErrorBg.setVisible(!0))},CreateRolePanel.prototype.setNickName=function(t){this.inputText&&(this.inputText.text=t)},CreateRolePanel.prototype.destroy=function(){this.scene&&this.scene.scale.off("resize",this.onResize,this),this.dragonbones&&this.dragonbones.off("initialized",this.loadDragonbonesComplete,this),t.prototype.destroy.call(this)},CreateRolePanel.prototype.creatAvatars=function(t){for(var e=[],i=0,n=t.avatarSuits;i<n.length;i++){for(var s=[],r=0,a=n[i].avatarSuit;r<a.length;r++){var h=a[r],l={id:h.id,suit_type:h.suitType,slot:h.slot,tag:h.tag,sn:h.sn};s.push(l)}var c=o.AvatarSuitType.createHasBaseAvatar(s);e.push(c)}return t.avatars=e,e},CreateRolePanel.prototype.onRandomNameHandler=function(){this.mediator.randomName(),this.inputText.setBlur()},CreateRolePanel.prototype.onSubmitHandler=function(){this.mediator.submit(this.inputText.text,this.mCurPageNum),this.inputText.setBlur(),this.mError&&(this.mError.setVisible(!1),this.mErrorBg.setVisible(!1))},CreateRolePanel.prototype.onPrePageHandler=function(){this.setPageNum(this.mCurPageNum-1),this.inputText.setBlur()},CreateRolePanel.prototype.onNextPageHandler=function(){this.setPageNum(this.mCurPageNum+1),this.inputText.setBlur()},CreateRolePanel.prototype.setPageNum=function(t){this.mCurPageNum=t,this.avatars&&(this.mCurPageNum<0?this.mCurPageNum=this.avatars.length-1:this.mCurPageNum>=this.avatars.length&&(this.mCurPageNum=0),this.dragonbones.load({id:0,avatar:this.avatars[this.mCurPageNum]}),this.dragonbones.startLoad())},CreateRolePanel.prototype.onResize=function(t){this.resize(t.width,t.height)},CreateRolePanel.prototype.loadDragonbonesComplete=function(){this.dragonbones.play({name:"idle",flip:!1})},Object.defineProperty(CreateRolePanel.prototype,"mediator",{get:function(){if(this.mMediator)return this.mMediator},enumerable:!1,configurable:!0}),CreateRolePanel}(a.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"CutInPanel",(function(){return a}));var n,s=i(470),r=i(0),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),a=function(t){function CutInPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key="cut_in",i}return o(CutInPanel,t),CutInPanel.prototype.show=function(t){var e=this;if(this.mShowData=t,this.mInitialized){if(t){var i=t.text;this.mName&&this.mName.setText(i[0].text)}else this.mName&&this.mName.setText("???");var n=this.scene.cameras.main.width;this.x=n+this.width/2;var s=this.scene.cameras.main.width/2;this.scene.tweens.timeline({targets:this,duration:300,tweens:[{x:s,alpha:1,ease:"Sine.easeInOut"},{delay:2e3,y:this.y-10*this.dpr,alpha:0}],onComplete:function(){e.emit("close")}})}else this.preload()},CutInPanel.prototype.resize=function(t,e){this.y=140*this.dpr},CutInPanel.prototype.preload=function(){this.addImage(this.key,"cut_in/cut_in_bg.png"),t.prototype.preload.call(this)},CutInPanel.prototype.init=function(){var e=this.scene.make.image({key:this.key},!1);this.setSize(e.width*this.scale,e.height*this.scale),this.mName=this.scene.make.text({style:{color:"#ffcc33",fontSize:18*this.dpr,fotnFamily:r.Font.DEFULT_FONT}},!1).setOrigin(.5),this.mName.setFontStyle("bold"),this.mName.setStroke("#000000",1*this.dpr),this.add([e,this.mName]),t.prototype.init.call(this),this.resize(this.scene.cameras.main.width,this.scene.cameras.main.height)},CutInPanel}(s.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"CutInMenuPanel",(function(){return h}));var n,s=i(470),r=i(1),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function CutInMenuPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.mapPop=new Map,i.key=r.ModuleName.CUTINMENU_NAME,i}return a(CutInMenuPanel,t),CutInMenuPanel.prototype.resize=function(e,i){t.prototype.resize.call(this,e,i),this.setSize(e,i)},CutInMenuPanel.prototype.preload=function(){this.addAtlas(this.key,"cutInmenu/cutInmenu.png","cutInmenu/cutInmenu.json"),t.prototype.preload.call(this)},CutInMenuPanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight,n=this.buttonType;this.rightPopButton="work"===n?new c(this.scene,e,this.key,this.dpr):new l(this.scene,e,this.key,this.dpr);var s=e+.5*this.rightPopButton.width-15*this.dpr;this.rightPopButton.setPosition(s,.5*i+20*this.dpr),this.rightPopButton.setClickHandler(new o.Handler(this,this.onRightClickHandler)),this.add(this.rightPopButton),this.resize(e,i),t.prototype.init.call(this),this.opneButton()},CutInMenuPanel.prototype.onShow=function(){this.setPopData(this.popData)},CutInMenuPanel.prototype.setPopData=function(t){if(this.popData=t,this.mInitialized){var e=this.buttonType;"work"===e&&this.rightPopButton.setCount(t)}},CutInMenuPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},CutInMenuPanel.prototype.opneButton=function(){this.rightPopButton.onTakeBack()},CutInMenuPanel.prototype.onRightClickHandler=function(){var t=this.buttonType;"work"===t?this.render.renderEmitter(r.ModuleName.CUTINMENU_NAME+"_openmed",r.ModuleName.PICAWORK_NAME):"minecar"===t&&this.render.renderEmitter(r.ModuleName.CUTINMENU_NAME+"_openmed",r.ModuleName.PICAMINECAR_NAME)},Object.defineProperty(CutInMenuPanel.prototype,"buttonType",{get:function(){return this.mShowData.button[0].text},enumerable:!1,configurable:!0}),CutInMenuPanel}(s.BasePanel),l=function(t){function RightPopContainer(e,i,n,s){var r=t.call(this,e)||this;r.isPop=!1,r.isPlaying=!1,r.dpr=s,r.key=n,r.scaleWidth=i;var a=r.scene.make.image({key:r.key,frame:"minebag_bg"});a.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),r.bgSprite=r.scene.make.image({key:r.key,frame:"minebag_bg_brth"},!1),r.bgSprite.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),r.imgIcon=r.scene.make.image({key:r.key,frame:"minecar"}),r.imgIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),r.imgIcon.setPosition(-12*s,.5*-r.imgIcon.height),r.text=e.make.text({x:r.imgIcon.x,y:2*s,text:o.i18n.t("common.open"),style:o.UIHelper.whiteStyle(s,12)},!1).setOrigin(.5),r.text.setFontStyle("bold"),r.text.setStroke("#2D1415",3*s);var h=r.scene.make.image({key:r.key,frame:"arow"});h.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var l=e.make.container(void 0,!1);return l.setSize(25*s,31*s),l.add(h),l.setPosition(.5*-a.width+10*s,0),r.add([r.bgSprite,a,r.imgIcon,r.text,l]),a.on("pointerup",r.onClickHandler,r),a.setInteractive(),l.on("pointerup",r.onTakeBack,r),l.setInteractive(),r.setSize(a.width,a.height),r.tween=r.scene.tweens.add({targets:r.bgSprite,alpha:{value:0,duration:500,ease:"Power1",yoyo:!0},repeat:-1}),r}return a(RightPopContainer,t),RightPopContainer.prototype.setClickHandler=function(t){this.clickHandler=t},RightPopContainer.prototype.setIconFrame=function(t){this.imgIcon.setFrame(t)},RightPopContainer.prototype.setPopData=function(t){this.popData=t},RightPopContainer.prototype.play=function(){this.bgSprite.alpha=1,this.tween.resume(),this.isPop=!1},RightPopContainer.prototype.stop=function(){this.tween.pause(),this.bgSprite.alpha=0,this.isPop=!0},RightPopContainer.prototype.onClickHandler=function(){this.clickHandler&&this.clickHandler.runWith(this.popData)},RightPopContainer.prototype.onTakeBack=function(){this.isPlaying||this.isPop?!this.isPlaying&&this.isPop&&this.takeback():this.popAnim()},RightPopContainer.prototype.popAnim=function(){this.isPlaying=!0;var t=this.scaleWidth-15*this.dpr,e=this;this.scene.tweens.add({targets:e,x:{value:t,duration:300,ease:"Bounce.easeOut"},onComplete:function(){e.stop(),e.isPlaying=!1}})},RightPopContainer.prototype.takeback=function(){this.timeID&&(clearTimeout(this.timeID),this.timeID=void 0),this.isPlaying=!0;var t=this.scaleWidth+.5*this.width-15*this.dpr,e=this;this.scene.tweens.add({targets:e,x:{value:t,duration:300,ease:"Bounce.easeOut"},onComplete:function(){e.play(),e.isPlaying=!1}})},RightPopContainer}(Phaser.GameObjects.Container),c=function(t){function WorkPopContainer(e,i,n,s){var r=t.call(this,e,i,n,s)||this;r.imgIcon.x=-22*s,r.text.x=r.imgIcon.x;var a=r.scene.make.image({key:r.key,frame:"time"});return a.x=r.imgIcon.x+.5*a.width+20*s,a.y=2*s,r.add(a),r.countTex=e.make.text({x:a.x,y:a.y,text:"",style:o.UIHelper.whiteStyle(s,10)},!1).setOrigin(.5),r.countTex.setFontStyle("bold"),r.add(r.countTex),r.setIconFrame("work_icon"),r.text.text=o.i18n.t("work.title"),r}return a(WorkPopContainer,t),WorkPopContainer.prototype.setCount=function(t){this.countTex.text=t+""},WorkPopContainer.prototype.popAnim=function(){this.isPlaying=!0;var t=this.scaleWidth-25*this.dpr,e=this;this.scene.tweens.add({targets:e,x:{value:t,duration:300,ease:"Bounce.easeOut"},onComplete:function(){e.stop(),e.isPlaying=!1}})},WorkPopContainer.prototype.takeback=function(){this.timeID&&(clearTimeout(this.timeID),this.timeID=void 0),this.isPlaying=!0;var t=this.scaleWidth+.5*this.width-15*this.dpr,e=this;this.scene.tweens.add({targets:e,x:{value:t,duration:300,ease:"Bounce.easeOut"},onComplete:function(){e.play(),e.isPlaying=!1}})},WorkPopContainer}(l)},function(t,e,i){"use strict";i.r(e),i.d(e,"DialogPanel",(function(){return d}));var n,s,r,o=i(5),a=i(0),h=i(1),l=i(470),c=i(11),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)});!function(t){t[t.HORIZONTAL_LEFT=0]="HORIZONTAL_LEFT",t[t.HORIZONTAL_CENTER=1]="HORIZONTAL_CENTER",t[t.HORIZONTAL_RIGHT=2]="HORIZONTAL_RIGHT"}(s||(s={})),function(t){t[t.VERTICAL_TOP=0]="VERTICAL_TOP",t[t.VERTICAL_CENTER=1]="VERTICAL_CENTER",t[t.VERTICAL_BOTTOM=2]="VERTICAL_BOTTOM"}(r||(r={}));var d=function(t){function DialogPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=h.ModuleName.DIALOG_NAME,i.listItems=[],i.key=h.ModuleName.DIALOG_NAME,i}return p(DialogPanel,t),DialogPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight,r=177*this.dpr;t.prototype.resize.call(this,n,s),this.content.setPosition(.5*n,s-r/2),this.setSize(n,s),this.blackBg.clear(),this.blackBg.fillStyle(0,.5),this.blackBg.fillRect(0,0,n,s),this.blackBg.setInteractive(new Phaser.Geom.Rectangle(0,0,n,s),Phaser.Geom.Rectangle.Contains),this.bg.scaleX=1.5*n,this.bg.x=0,this.bg.setInteractive(),this.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR)},DialogPanel.prototype.preload=function(){this.addAtlas(this.key,c.d.textureUrl(c.d.commonUrl),c.d.jsonUrl(c.d.commonUrl)),t.prototype.preload.call(this)},DialogPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen(),this.setDialogData(this.mShowData)):this.preload())},DialogPanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight,n=177*this.dpr;this.blackBg=this.scene.make.graphics(void 0,!1),this.add(this.blackBg),this.content=this.scene.make.container({x:0*this.dpr,y:(i-n)/2,width:e,height:n},!1),this.content.setSize(e,n),this.bg=this.scene.make.image({x:0,y:0,key:this.key,frame:"menu_bg_l"}),this.bg.scaleY=this.scale,this.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.bg.displayWidth=e,this.bg.displayHeight=n;var s=this.scene.make.graphics(void 0,!1),r=e-30*this.dpr,h=122*this.dpr;s.setPosition(-r>>1,.5*-h+13*this.dpr),s.clear(),s.fillStyle(16777215,1),s.fillRoundedRect(0,0,r,h,8*this.dpr),this.text=this.scene.make.text({x:.5*-r+20*this.dpr,y:.5*-h+30*this.dpr,text:"",style:{color:"#000000",fontSize:15*this.dpr,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(0).setWordWrapWidth(r-35*this.dpr,!0);var c=.5*-e+38*this.dpr,p=.5*-n+25*this.dpr;this.npcIcon=new l.DynamicImage(this.scene,c,p-20*this.dpr);var d=this.scene.make.image({x:c+135*this.dpr,y:p,key:this.key,frame:"name_bg"});this.npcName=this.scene.make.text({x:d.x,y:d.y,text:"",style:{fontSize:15*this.dpr,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(.5);var m=new o.Button(this.scene,this.key,"close_1","close_1");m.setPosition(.5*e-30*this.dpr,.5*-n+10*this.dpr),m.on(o.ClickEvent.Tap,this.onCloseHandler,this),m.visible=!1,this.content.add([this.bg,this.npcIcon,s,this.text,d,this.npcName,m]),this.bg.setInteractive(),this.bg.on("pointerdown",this.onNextDialogHandler,this),this.add(this.content),this.resize(0,0),t.prototype.init.call(this),this.mScene.layerManager.addToLayer(l.MainUIScene.LAYER_DIALOG,this)},DialogPanel.prototype.setLayoutItems=function(t){var e=t.length,i=e>4?2:1,n=(this.dpr,295*this.dpr),s=27*this.dpr,r=n/i,o=4*this.dpr;2===e?o=15*this.dpr:3===e&&(o=10*this.dpr);for(var h=(124*this.dpr-(o+s)*(e<4?e:4)-o)/2-42*this.dpr,l=0,c=this.listItems;l<c.length;l++){(d=c[l]).visible=!1}for(var p=0;p<e;p++){var d=void 0;p<this.listItems.length?d=this.listItems[p]:(d=new m(this.scene,this.dpr,this.scale,this.key),this.content.add(d),this.listItems.push(d),d.setHandler(new a.Handler(this,this.onItemHandler)));var u=.5*(n-r)*(p<4?-1:1),y=h+.5*s+(s+o)*(p%4);d.setItemSize(r,s),d.setPosition(u,y),d.setItemData(t[p]),d.visible=!0}},DialogPanel.prototype.setDialogData=function(t){var e=this;if(t.text&&t.text[1]&&(this.npcName.text=t.text[1].text),t.display&&t.display[0]){this.npcIcon.visible=!0;var i=t.display[0],n=a.Url.getOsdRes(i.texturePath);this.npcIcon.load(n,this,(function(){var t=e.content.width,n=e.content.height,r=e.npcIcon.width,o=(e.npcIcon.height,e.npcIcon.x),a=.5*-n-50*e.dpr;i.horizontal===s.HORIZONTAL_LEFT?o=.5*-t+.5*r:i.horizontal===s.HORIZONTAL_CENTER?o=0:i.horizontal===s.HORIZONTAL_RIGHT&&(o=.5*t-.5*r-20*e.dpr),e.npcIcon.displayWidth=212*e.dpr,e.npcIcon.scaleY=e.npcIcon.scaleX,e.npcIcon.x=o,e.npcIcon.y=a}))}else this.npcIcon.visible=!1;if(t.button&&t.button.length>0)this.setLayoutItems(t.button),this.text.visible=!1;else{for(var r=0,o=this.listItems;r<o.length;r++){o[r].visible=!1}this.text.text=t.text[0].text,this.text.visible=!0}},DialogPanel.prototype.update=function(t){this.mShowData=t,this.setDialogData(t)},DialogPanel.prototype.onItemHandler=function(t){for(var e=0,i=this.listItems;e<i.length;e++){i[e].select=!1}t.select=!0;var n=this.showData;this.render.renderEmitter(this.key+"_querydialog",{id:n.id,nodeid:t.itemData.node.id})},DialogPanel.prototype.onNextDialogHandler=function(){var t=this.showData;this.render.renderEmitter(this.key+"_querydialog",{id:t.id,nodeid:0})},DialogPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(this.key+"_hide")},DialogPanel}(l.BasePanel),m=function(t){function NpcDialogueItem(e,i,n,s){var r=t.call(this,e)||this;return r.dpr=0,r.zoom=0,r.zoom=n,r.dpr=i,r.selectBg=r.scene.make.image({x:0,y:0,key:s,frame:"select_bg"}),r.arrImg=r.scene.make.image({x:.5*-r.selectBg.width,y:0,key:s,frame:"arrow_r"}),r.content=r.scene.make.text({x:0,y:0,text:"",style:{color:"#000000",fontSize:15*i,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(0,.5),r.add([r.selectBg,r.arrImg,r.content]),r.width=r.selectBg.width,r.height=r.selectBg.height,r.on("pointerdown",r.onClickHandler,r),r}return p(NpcDialogueItem,t),NpcDialogueItem.prototype.setItemData=function(t){this.itemData=t,this.content.text=t.text,this.select=!1},NpcDialogueItem.prototype.setHandler=function(t){this.handler=t},Object.defineProperty(NpcDialogueItem.prototype,"select",{set:function(t){this.selectBg.visible=t},enumerable:!1,configurable:!0}),NpcDialogueItem.prototype.setItemSize=function(e,i){t.prototype.setSize.call(this,e,i),this.selectBg.displayWidth=e,this.arrImg.x=.5*-e*.9,this.content.x=this.arrImg.x+20*this.dpr*this.zoom,this.setInteractive(new Phaser.Geom.Rectangle(0,0,e,i),Phaser.Geom.Rectangle.Contains)},NpcDialogueItem.prototype.onClickHandler=function(){this.handler&&this.handler.runWith(this)},NpcDialogueItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"LoginPanel",(function(){return c}));var n,s=i(5),r=i(11),o=i(470),a=i(1),h=i(0),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function LoginPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.areaCode="86",i.downcount=-1,i.mMediator=i.render.mainPeer[a.ModuleName.LOGIN_NAME],i.key=a.ModuleName.LOGIN_NAME,i}return l(LoginPanel,t),LoginPanel.prototype.show=function(){t.prototype.show.call(this),this.mInitialized&&this.setInputVisible(!0)},LoginPanel.prototype.hide=function(){t.prototype.hide.call(this)},LoginPanel.prototype.setInputVisible=function(t){this.mPhoneCodeInput&&(this.mPhoneCodeInput.visible=t,this.mPhoneInput.visible=t)},LoginPanel.prototype.destroy=function(){t.prototype.destroy.call(this),this.fetchTime&&clearTimeout(this.fetchTime)},LoginPanel.prototype.setLoginEnable=function(t){this.loginBtn.enable=t},LoginPanel.prototype.preload=function(){this.addAtlas(this.key,"login/login.png","login/login.json"),this.addAtlas(r.c.commonKey,r.d.commonUrl+".png",r.d.commonUrl+".json"),t.prototype.preload.call(this)},LoginPanel.prototype.init=function(){var e=this.scene.cameras.main.width/this.scale,i=this.scene.cameras.main.height/this.scale,n=(this.scene.add.container(0,0,this),this.scale,this.scene.make.graphics(void 0,!1));n.fillRect(0,0,e,i),n.fillGradientStyle(7304703,7304703,118271,118271);var o=this.scene.make.image({x:0,y:0,key:this.key,frame:"cloud_left"},!1).setOrigin(0);o.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var a=this.scene.make.image({x:e,y:0,key:this.key,frame:"cloud_right"},!1).setOrigin(1,0);a.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var l=this.scene.make.image({x:.5*e,y:44*this.dpr,key:this.key,frame:"logo"},!1).setOrigin(.5,0);l.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var c=this.scene.make.image({key:this.key,frame:"bg"});c.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),c.x=.5*e,c.y=i-.5*c.height,this.mPhoneInput=new s.InputText(this.scene,0,0,256*this.dpr,40*this.dpr,{type:"tel",maxLength:11,placeholder:"请输入手机号",color:"#717171",fontSize:16*this.dpr+"px"});var p=this.createInput(this.mPhoneInput,.5*e,97*this.dpr+l.y+l.height),d=localStorage.getItem("accountphone");if(d)try{this.mPhoneInput.text=JSON.parse(d).account}catch(t){}this.mPhoneCodeInput=new s.InputText(this.scene,0,0,156*this.dpr,40*this.dpr,{type:"tel",maxLength:4,placeholder:"验证码",color:"#717171",text:"",fontSize:16*this.dpr+"px"}).setOrigin(0,.5);var m=this.createInput(this.mPhoneCodeInput,.5*e,172*this.dpr+l.y+l.height,256*this.dpr);this.mPhoneCodeInput.x=-m.width/2+8*this.dpr;var u=this.scene.make.text({x:.5*e,text:"抵制不良游戏，拒绝盗版游戏。注意自我保护，谨防受骗上当。\n适度游戏益脑，沉迷游戏伤身。合理安排时间，享受健康生活。",style:{color:"#FFEC48",align:"center",fontSize:11*this.dpr+"px",fontFamily:h.Font.DEFULT_FONT}},!1).setOrigin(.5);u.y=i-50*this.dpr-.5*u.height;var y=this.scene.make.text({x:.5*e,text:"本网络游戏适合年满16周岁以上的用户，请您确认已如实进行\n实名注册，为了您的健康，请合理控制游戏时间。",style:{color:"#FFFFFF",align:"center",fontSize:9.33*this.dpr,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(.5);y.y=i-16*this.dpr-.5*y.height;var f=this.scene.make.image({x:12*this.dpr,key:this.key,frame:"line"},!1);f.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.fetchCode=this.scene.make.text({text:"获取验证码",style:{fontSize:14*this.dpr+"px",fontFamily:h.Font.DEFULT_FONT,color:"#2B5AF3"}},!1).setOrigin(.5).setInteractive(),this.fetchCode.x=.5*(m.width-this.fetchCode.width)-22*this.dpr,this.fetchCode.on("pointerup",this.onFetchCodeHandler,this),this.fetchCode.on("pointerdown",this.onFetchCodeDownHandler,this),m.add([f,this.fetchCode]),this.loginBtn=new s.NineSliceButton(this.scene,.5*e,m.y+m.height+33*this.dpr,191*this.dpr,50*this.dpr,r.c.commonKey,"yellow_btn","登 录",this.dpr,1,{left:12*this.dpr,top:12*this.dpr,right:14*this.dpr,bottom:12*this.dpr}),this.loginBtn.setTextStyle({color:"#995E00",fontSize:22*this.dpr,fontFamily:h.Font.DEFULT_FONT}),this.loginBtn.setFontStyle("bold"),this.loginBtn.on(String(s.ClickEvent.Down),this.LoginDownHandler,this),this.loginBtn.on(String(s.ClickEvent.Tap),this.tryLogin,this);var g=new s.BBCodeText(this.scene,0,0,"我已阅读并同意皮卡堂的[area=userService][color=#FFEC48]《用户服务协议》[/color][/area]和[area=privacy][color=#FFEC48]《隐私与保护政策》[/color][/area]",{color:"#ffffff",fontSize:11*this.dpr,fontFamily:h.Font.DEFULT_FONT}).setOrigin(.5,.5).setInteractive().on("areadown",(function(t){h.Helpers.openUrl("https://picatown.com/con_news/news.php?nid=1201")}));this.acceptBtn=new s.CheckBox(this.scene,this.key,"accept_unchecked","accept_checked").on(String(s.ClickEvent.Tap),this.onCheckboxHandler,this),g.x=this.loginBtn.x+8*this.dpr,g.y=this.loginBtn.y+.5*this.loginBtn.height+24*this.dpr,this.acceptBtn.x=g.x-.5*g.width-8*this.dpr,this.acceptBtn.y=g.y,this.acceptBtn.selected=!0,this.add([n,c,o,a,l,p,m,u,y,this.loginBtn,this.acceptBtn,g]),t.prototype.init.call(this)},LoginPanel.prototype.createInput=function(t,e,i,n){var r=this.scene.make.container({x:e,y:i},!1),o=this.scene.textures.getFrame(this.key,"input_bg"),a=new s.NineSlicePatch(this.scene,t.x-8*this.dpr,t.y,(n||t.width)+14*this.dpr,o.height,this.key,"input_bg",{left:27*this.dpr,top:0*this.dpr,right:28*this.dpr,bottom:0*this.dpr},this.dpr,1);return r.add([t,a]),r.setSize(a.width,a.height),r},LoginPanel.prototype.onFetchCodeDownHandler=function(){this.mPhoneInput&&(this.mPhoneCodeInput.setBlur(),this.mPhoneInput.setBlur())},LoginPanel.prototype.onFetchCodeHandler=function(){var t=this;11===this.mPhoneInput.text.length?this.fetchTime||(this.downcount=60,this.fetchTime=setInterval((function(){--t.downcount<=0&&(clearInterval(t.fetchTime),t.fetchTime=void 0),t.downcount>0?t.fetchCode.setText("获取验证码("+t.downcount+")"):t.fetchCode.setText("获取验证码")}),1e3),this.render.remote[a.MAIN_WORKER].onFetchCodeHandler()):this.render.onLoginErrorHanler("error","手机格式错误")},LoginPanel.prototype.tryLogin=function(){var t=this.mPhoneInput.text,e=this.mPhoneCodeInput.text;11===t.length?e?(this.mMediator||(this.mMediator=this.render.mainPeer[a.ModuleName.LOGIN_NAME]),this.mMediator.login(t,e,this.areaCode)):this.render.onLoginErrorHanler("error","验证码格式错误"):this.render.onLoginErrorHanler("error","手机格式错误")},LoginPanel.prototype.LoginDownHandler=function(){this.mPhoneInput&&(this.mPhoneCodeInput.setBlur(),this.mPhoneInput.setBlur())},LoginPanel.prototype.onCheckboxHandler=function(){this.tryLogin&&(this.loginBtn.enable=this.acceptBtn.selected)},LoginPanel}(o.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"VerifiedPanel",(function(){return c}));var n,s=i(5),r=i(470),o=i(11),a=i(0),h=i(1),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function VerifiedPanel(e,i){var n=t.call(this,e,i)||this;return n.isIDCard=/^[1-9]\d{5}(19|20|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/,n.key=h.ModuleName.VERIFIED_NAME,n}return l(VerifiedPanel,t),VerifiedPanel.prototype.setVerifiedEnable=function(t){this.mIDCardInput&&(this.mNameInput.visible=t,this.mIDCardInput.visible=t,this.mVerifiedBtn.enable=t)},VerifiedPanel.prototype.preload=function(){this.addAtlas(o.c.commonKey,o.d.commonUrl+".png",o.d.commonUrl+".json"),this.addAtlas(o.c.common2Key,o.d.common2Url+".png",o.d.common2Url+".json"),t.prototype.preload.call(this)},VerifiedPanel.prototype.init=function(){var e=this.scene.cameras.main,i=e.width,n=e.height,r=this.scene.make.graphics(void 0,!1);r.fillStyle(0,.6),r.fillRect(.5*-i,.5*-n,i,n).setInteractive(new Phaser.Geom.Rectangle(.5*-i,.5*-n,i,n),Phaser.Geom.Rectangle.Contains);var h=this.scene.make.container({},!1),l=this.scene.make.image({key:o.c.common2Key,frame:"bg"},!1);h.setSize(l.width,l.height);var c=this.scene.make.image({y:-16.33*this.dpr-.5*h.height,key:o.c.common2Key,frame:"title"},!1).setOrigin(.5,0),p=this.scene.make.text({y:c.y+14.67*this.dpr,text:"实名注册",style:{color:"#905B06",fontSize:16*this.dpr,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(.5,0);this.mNameInput=new s.InputText(this.scene,0,0,160*this.dpr,36*this.dpr,{type:"text",placeholder:"请输入真实姓名",color:"#838383",fontSize:10*this.dpr+"px"}).setOrigin(0,.5),this.mIDCardInput=new s.InputText(this.scene,0,0,160*this.dpr,36*this.dpr,{type:"tel",maxLength:18,placeholder:"请输入有效身份证号",color:"#838383",fontSize:10*this.dpr+"px"}).setOrigin(0,.5);var d=this.createInput(this.mNameInput,"*真实姓名：",0,0);d.x=.5*-d.width,d.y=95*this.dpr+.5*d.height-.5*h.height;var m=this.createInput(this.mIDCardInput,"*身份证号：",0,d.y+d.height+15*this.dpr);m.x=d.x;var u=this.scene.make.text({y:40*this.dpr-.5*h.height,text:"根据国家新闻出版署发布《关于未成年人沉迷网络\n游戏的通知》规定，网络游戏用户需要使用有效期\n身份证进行实名注册才能体验游戏。",style:{align:"center",fontSize:10*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#111111"}},!1).setOrigin(.5,0),y=this.scene.make.text({y:.5*h.height-75*this.dpr,text:"请务必保证您的身份信息确实无误，此信息仅作实名认证，我们将严格\n按照有关法律法规妥善保存、保护，不会用做其他用途。",style:{align:"center",fontSize:8*this.dpr,fontFamily:a.Font.DEFULT_FONT,color:"#FF0000"}},!1).setOrigin(.5,1);this.add([r,h]),this.mVerifiedBtn=new s.NineSliceButton(this.scene,0,.5*h.height-16*this.dpr,110*this.dpr,34*this.dpr,o.c.commonKey,"yellow_btn","提交认证",this.dpr,this.scale,{left:12*this.dpr*this.scale,top:12*this.dpr*this.scale,right:12*this.dpr*this.scale,bottom:12*this.dpr*this.scale}),this.mVerifiedBtn.setTextStyle({color:"#996600",fontSize:14*this.dpr,fontFamily:a.Font.DEFULT_FONT}),this.mVerifiedBtn.on(String(s.ClickEvent.Down),this.onVerifiedDownHandler,this),this.mVerifiedBtn.on(String(s.ClickEvent.Tap),this.onVerifiedHandler,this),this.mVerifiedBtn.y-=this.mVerifiedBtn.height/2,this.mVerifiedBtn.setFontStyle("bold"),h.add([l,c,p,d,m,u,y,this.mVerifiedBtn]),t.prototype.init.call(this),this.x=i*this.originX,this.y=n*this.originY,h.y=.3*-this.y},VerifiedPanel.prototype.onVerifiedHandler=function(){var t=this.mNameInput.text,e=this.mIDCardInput.text;t?e&&18===e.length?this.checkIdCard()?(this.render.onLoginErrorHanler("error","[color=#F9361B]实名认证失败，身份证号码有误\n请如实进行实名认证！[/color]"),this.render.remote[h.MAIN_WORKER].onVerifiedHandler(t,e)):this.render.onLoginErrorHanler("error","[color=#F9361B]实名认证失败，身份证号码有误\n请如实进行实名认证！[/color]"):this.render.onLoginErrorHanler("error","[color=#F9361B]证件格式有误[/color]"):this.render.onLoginErrorHanler("error","[color=#F9361B]名字不能为空[/color]")},VerifiedPanel.prototype.onVerifiedDownHandler=function(){this.mNameInput&&(this.mNameInput.setBlur(),this.mIDCardInput.setBlur())},VerifiedPanel.prototype.createInput=function(t,e,i,n){var s=this.scene.make.container({x:i,y:n},!1),r=this.scene.make.text({text:e,style:{color:"#ff0000",fontSize:10*this.dpr,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(0,.5),o=this.scene.make.graphics(void 0,!1),h=189*this.dpr,l=36.67*this.dpr;return o.fillStyle(14540253),o.lineStyle(2*this.dpr,10592673),o.fillRoundedRect(r.width,.5*-l,h,l,2*this.dpr),t.x=r.width+10*this.dpr,s.add([r,o,t]),s.setSize(h+t.x,l),s},VerifiedPanel.prototype.checkIdCard=function(){var t=this.mIDCardInput.text;if(this.isIDCard.test(t)&&18===t.length){for(var e=t.split(""),i=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],n=0,s=0;s<17;s++)n+=e[s]*i[s];return["1","0","X","9","8","7","6","5","4","3","2"][n%11]===e[17].toLocaleUpperCase()}return!1},Object.defineProperty(VerifiedPanel.prototype,"verifiedBtn",{get:function(){return this.mVerifiedBtn},enumerable:!1,configurable:!0}),VerifiedPanel}(r.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicManorInfoPanel",(function(){return p}));var n,s=i(491),r=i(492),o=i(470),a=i(1),h=i(11),l=i(0),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicManorInfoPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=a.ModuleName.PICAMANORINFO_NAME,i}return c(PicManorInfoPanel,t),PicManorInfoPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,e,i),this.setSize(n,s),this.mBackGround.clear(),this.mBackGround.fillStyle(0,.66),this.mBackGround.fillRect(0,0,n,s),this.content.x=.5*n,this.content.y=.5*s},PicManorInfoPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen(),this.mShowData&&this.setManorInfo(this.mShowData)):this.preload())},PicManorInfoPanel.prototype.addListen=function(){this.mInitialized},PicManorInfoPanel.prototype.removeListen=function(){this.mInitialized},PicManorInfoPanel.prototype.preload=function(){this.addAtlas(this.key,"manor/manor.png","manor/manor.json"),this.addAtlas(h.c.commonKey,h.d.commonUrl+".png",h.d.commonUrl+".json"),this.addAtlas(h.c.common2Key,h.d.common2Url+".png",h.d.common2Url+".json"),this.addAtlas(h.c.common3Key,h.d.textureUrl(h.d.common3Url),h.d.jsonUrl(h.d.common3Url)),t.prototype.preload.call(this)},PicManorInfoPanel.prototype.init=function(){var e=this.scale,i=this.scaleWidth,n=this.scaleHeight;this.mBackGround=this.scene.make.graphics(void 0,!1),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,i*e,n*e),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.add(this.mBackGround),this.content=this.scene.make.container(void 0,!1),this.add(this.content),this.resize(i,n),this.openManorChild(),t.prototype.init.call(this)},PicManorInfoPanel.prototype.setManorInfo=function(t){this.manorInfo=t,this.picChildPanel&&this.picChildPanel.setManorInfoData(t)},PicManorInfoPanel.prototype.setShopCategories=function(t){this.picShopPanel&&this.picShopPanel.setShopCategories(t)},PicManorInfoPanel.prototype.setShopDatas=function(t){this.picShopPanel&&this.picShopPanel.setShopDatas(t)},PicManorInfoPanel.prototype.setManorTips=function(){this.picTipsPanel.setManorTipsData(l.i18n.t("manor.successtitle"))},PicManorInfoPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicManorInfoPanel.prototype.openManorChild=function(){this.showChildPanel(),this.picChildPanel.setTitleText(l.i18n.t("manor.landstatus"))},PicManorInfoPanel.prototype.openManorShop=function(){this.showShopPanel(),this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_getCategories",this.manorInfo.manorIndex)},PicManorInfoPanel.prototype.showChildPanel=function(){var t=this;if(!this.picChildPanel){var e=334*this.dpr,i=353*this.dpr;this.picChildPanel=new s.PicaManorChildPanel(this.scene,this.render,0,0,e,i,this.dpr,this.scale,this.key),this.picChildPanel.setHandler(new l.Handler(this,(function(e,i){-1!==e?t.manorInfo&&t.render.mainPeer.getUserData_CurRoomID().then((function(n){t.render.renderEmitter(a.RENDER_PEER+"_"+t.key+"_buyeditor",{roomid:n,index:t.manorInfo.manorIndex,type:e,manorName:i})})):(t.openManorShop(),t.hideChildPanel())}))),this.picChildPanel.setCloseHandler(new l.Handler(this,this.OnCloseHandler))}this.content.add(this.picChildPanel)},PicManorInfoPanel.prototype.hideChildPanel=function(){this.content.remove(this.picChildPanel)},PicManorInfoPanel.prototype.showShopPanel=function(){var t=this;if(!this.picShopPanel){var e=334*this.dpr,i=455*this.dpr;this.picShopPanel=new r.PicaManorShopPanel(this.scene,0,0,e,i,this.key,this.dpr,this.scale),this.picShopPanel.setHandler(new l.Handler(this,(function(e,i){"usetype"===e?t.render.renderEmitter(a.RENDER_PEER+"_"+t.key+"_usingitem",i):"buytype"===e&&t.render.renderEmitter(a.RENDER_PEER+"_"+t.key+"_buyItem",i)})),new l.Handler(this,(function(){t.hideShopPanel(),t.openManorChild()}))),this.picShopPanel.on("queryProp",(function(e,i,n){t.render.renderEmitter(a.RENDER_PEER+"_"+t.key+"_queryProp",{page:e,category:i,subCategory:n})}),this)}this.content.add(this.picShopPanel),this.picShopPanel.refreshMask()},PicManorInfoPanel.prototype.hideShopPanel=function(){this.content.remove(this.picShopPanel)},PicManorInfoPanel.prototype.OnCloseHandler=function(){this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_hide")},PicManorInfoPanel}(o.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaManorTipsPanel",(function(){return l}));var n,s=i(5),r=i(11),o=i(0),a=i(477),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaManorTipsPanel(e,i,n,s,r,o,a,h){return t.call(this,e,i,n,s,r,o,h)||this}return h(PicaManorTipsPanel,t),PicaManorTipsPanel.prototype.setManorTipsData=function(t){this.contentText.text=t;this.nineButton.setFrameNormal("red_btn_normal"),this.nineButton.setText(o.i18n.t("manor.otherbtn")),this.nineButton.setTextColor("#ffffff")},PicaManorTipsPanel.prototype.setHandler=function(t){this.sendHandler=t},PicaManorTipsPanel.prototype.create=function(){t.prototype.create.call(this);this.contentText=this.scene.make.text({x:0,y:-10*this.dpr,text:o.i18n.t(""),style:{fontSize:18*this.dpr,align:"center",fontFamily:o.Font.DEFULT_FONT,color:"#111111"}}).setOrigin(.5),this.contentText.setLineSpacing(20*this.dpr),this.add(this.contentText),this.nineButton=new s.NineSliceButton(this.scene,0,0,110*this.dpr,35*this.dpr,r.c.commonKey,"red_btn_normal",o.i18n.t("business_street.takeall"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr}),this.add(this.nineButton),this.nineButton.y=.5*this.height-.5*this.nineButton.height-15*this.dpr,this.nineButton.setTextStyle({fontSize:15*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#ffffff"}),this.nineButton.setFontStyle("bold"),this.nineButton.on(String(s.ClickEvent.Tap),this.onNineButtonHandler,this)},PicaManorTipsPanel.prototype.createBackground=function(t,e){this.bg=this.scene.make.image({key:r.c.common2Key,frame:"bg_universal_box"}),this.add(this.bg)},PicaManorTipsPanel.prototype.onNineButtonHandler=function(){this.sendHandler&&this.sendHandler.run()},PicaManorTipsPanel}(a.PicaManorBasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicRoomUpgradePanel",(function(){return h}));var n,s=i(470),r=i(1),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicRoomUpgradePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.MAX_TIMES=4,i.key=r.ModuleName.PICAROOMUPGRADE_NAME,i}return a(PicRoomUpgradePanel,t),PicRoomUpgradePanel.prototype.resize=function(t,e){var i=this.scaleWidth,n=this.scaleHeight;this.content.x=.5*i,this.content.y=.5*n,this.setSize(i,n)},PicRoomUpgradePanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen(),this.updateData()):this.preload())},PicRoomUpgradePanel.prototype.hide=function(){this.mShow=!1,this.removeListen()},PicRoomUpgradePanel.prototype.updateData=function(){var t=this.mShowData;this.mTitleName.text=t.text[0].text;var e=t.data[0];this.roomIcon.on(Phaser.Animations.Events.SPRITE_ANIMATION_REPEAT,this.animationRepeat,this),this.mPlayedTimes=0,this.roomIcon.play("lv"+e)},PicRoomUpgradePanel.prototype.addListen=function(){this.mInitialized&&(this.setInteractive(new Phaser.Geom.Rectangle(.5*this.width,.5*this.height,this.width,this.height),Phaser.Geom.Rectangle.Contains),this.on("pointerup",this.onClickHandler,this))},PicRoomUpgradePanel.prototype.removeListen=function(){this.mInitialized&&(this.removeInteractive(),this.off("pointerup",this.onClickHandler,this))},PicRoomUpgradePanel.prototype.destroy=function(){this.mPlayedTimes=0,t.prototype.destroy.call(this)},PicRoomUpgradePanel.prototype.preload=function(){this.addAtlas(this.key,"e_roomupgrade/e_roomupgrade.png","e_roomupgrade/e_roomupgrade.json"),t.prototype.preload.call(this)},PicRoomUpgradePanel.prototype.init=function(){if(!this.mInitialized){var e=this.scaleWidth,i=this.scaleHeight;this.mBackground=this.scene.make.graphics(void 0,!1),this.mBackground.clear(),this.mBackground.fillStyle(0,.66),this.mBackground.fillRect(0,0,e,i),this.add(this.mBackground),this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,462*this.dpr);var n=this.scene.make.image({x:0,y:-20*this.dpr,key:this.key,frame:"effect_bg"});this.content.add(n);var s=this.scene.make.image({key:this.key,frame:"tittle_bg"});s.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),s.y=.5*-this.content.height;var r=22*this.dpr+"px "+o.Font.DEFULT_FONT;this.mTitleName=this.scene.make.text({x:0,y:s.y,text:"",style:{font:r,fill:"#FFF36D"}}).setOrigin(.5),this.mTitleName.setStroke("#471C1E",8),this.mTitleName.setShadow(2,2,"#471C1E",2,!0,!0),this.mTitleName.setTint(16773997,16773997,16756224,16756224),this.content.add([s,this.mTitleName]);var a=this.scene.make.text({x:0,y:.5*this.content.height-40*this.dpr,text:o.i18n.t("room_upgrade.clicktocontinue"),style:{fontFamily:o.Font.DEFULT_FONT,fontSize:16*this.dpr,color:"#FFF000"}}).setOrigin(.5);this.roomIcon=this.scene.make.sprite({key:this.key,frame:"lv1"}),this.roomIcon.y=-40*this.dpr,this.content.add([this.roomIcon,a]),this.add(this.content),this.createAnimations(),this.resize(0,0),t.prototype.init.call(this)}},PicRoomUpgradePanel.prototype.onClickHandler=function(){if(!(this.mPlayedTimes<this.MAX_TIMES)){var t=this.mShowData;this.render.renderEmitter(r.ModuleName.PICAROOMUPGRADE_NAME+"_querytargetui",t.id)}},PicRoomUpgradePanel.prototype.createAnimations=function(){for(var t=1;t<=4;t++)this.scene.anims.create({key:"lv"+t,frames:this.scene.anims.generateFrameNames(this.key,{prefix:"lv",frames:[t-1,t]}),duration:500,repeat:-1})},PicRoomUpgradePanel.prototype.animationRepeat=function(){this.mPlayedTimes++,this.mPlayedTimes>=this.MAX_TIMES&&this.roomIcon.off(Phaser.Animations.Events.SPRITE_ANIMATION_REPEAT,this.animationRepeat,this)},PicRoomUpgradePanel}(s.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaAvatarPanel",(function(){return m}));var n,s=i(5),r=i(470),o=i(475),a=i(11),h=i(1),l=i(0),c=i(2),p=i(471),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function fulfilled(t){try{step(n.next(t))}catch(t){r(t)}}function rejected(t){try{step(n.throw(t))}catch(t){r(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function verb(r){return function(a){return function step(r){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(s=2&r[0]?n.return:r[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,r[1])).done)return s;switch(n=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],n=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},m=function(t){function PicaAvatarPanel(e,i){var n=t.call(this,e)||this;return n.mSelectedItemData=[],n.mSelectedItems=[],n.dressAvatarIDS=[],n.dressAvatarDatas=[],n.isInitAvatar=!1,n.avatarDirection=0,n.key=h.ModuleName.PICAAVATAR_NAME,n.mSceneType=i,n.atlasNames=[a.d.uicommon],n.textures=[{atlasName:"avater_bg_adorn",folder:"texture"},{atlasName:"avater_bg_stripe",folder:"texture"}],n}return d(PicaAvatarPanel,t),PicaAvatarPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,n,s),this.mBackground.clear(),this.mBackground.fillStyle(118271),this.mBackground.fillRect(0,0,n,s),this.mShelfContainer.setSize(n,295*this.dpr),this.mShelfContainer.y=s-this.mShelfContainer.height+6*this.dpr,this.mDetailBubble.y=this.mShelfContainer.y-10*this.dpr-this.mDetailBubble.height,this.mCategoryScroll.x=.5*n,this.mCategoryScroll.y=this.mShelfContainer.y+20*this.dpr,this.mBg.x=n/2,this.mBg.y=this.mBg.height/2+10*this.dpr;var r=s-this.mShelfContainer.height-80*this.dpr;this.mDetailDisplay.x=n/2,this.mDetailDisplay.y=.5*r+80*this.dpr,this.mDetailDisplay.setInteractive(new Phaser.Geom.Rectangle(0,0,110*this.dpr,r),Phaser.Geom.Rectangle.Contains),this.rotateAvatarBtn.x=n/2+100*this.dpr,this.rotateAvatarBtn.y=this.mDetailDisplay.y,this.mPropGrid.x=n/2+3*this.dpr,this.mPropGrid.y=this.mShelfContainer.y+.5*this.mPropGrid.height+48*this.dpr,this.mPropGrid.layout(),this.mPropGrid.resetMask(),this.mCategoryScroll.refreshMask(),this.setSize(n,s),this.setInteractive()},PicaAvatarPanel.prototype.setCategories=function(t){this.mPreCategoryBtn=null,this.mSelectedCategeories=null;var e=60*this.dpr,i=41*this.dpr,n=[];this.mCategoryScroll.clearItems();var s={value:"",key:""};s.value=l.i18n.t("common.all"),s.key="alltype",t.unshift(s);for(var o=0;o<t.length;o++){var a=new r.TextButton(this.scene,this.dpr,1,t[o].value,0,0);a.x=o*e,a.y=i-a.text.height-20*this.dpr,a.setData("item",t[o]),a.setSize(e,i),this.mCategoryScroll.addItem(a),a.setChangeColor("#FFD248"),n[o]=a,a.setFontSize(17*this.dpr),a.setFontStyle("bold")}n.length>1&&this.onSelectSubCategoryHandler(n[0]),this.updateCategeoriesLoc(!1)},PicaAvatarPanel.prototype.setProp=function(t,e){void 0===e&&(e=!1),t=t||[],this.mSelectedItems.length=0;var i=t.length;if(i<24&&(t=t.concat(new Array(24-i))),this.mPropGrid.setItems(t),0===this.dressAvatarDatas.length){for(var n=0,s=t;n<s.length;n++){var r=s[n];r&&r.rightSubscript===c.op_pkt_def.PKT_Subscript.PKT_SUBSCRIPT_CHECKMARK&&this.dressAvatarDatas.push(r)}this.isInitAvatar&&this.initBaseAvatar(),this.isInitAvatar=!0}},PicaAvatarPanel.prototype.setDressAvatarIds=function(t){this.dressAvatarIDS=t,this.isInitAvatar&&this.initBaseAvatar(),this.isInitAvatar=!0},PicaAvatarPanel.prototype.initBaseAvatar=function(){var t=this;if(this.isInitAvatar){for(var e=[],i=0,n=this.dressAvatarIDS;i<n.length;i++)for(var s=n[i],r=0,o=this.dressAvatarDatas;r<o.length;r++){var a=o[r];a.id===s&&(e.push(a),this.mSelectedItemData.push(a))}this.dressAvatarDatas.length=0,this.dressAvatarDatas=e,this.displayAvatar(),this.mDetailBubble.visible=!1}else{var h=null;this.render.mainPeer.getUserData_PlayerProperty().then((function(e){return h=e,t.serviceTimestamp})).then((function(e){t.mDetailBubble.setProp(null,Math.floor(e/1e3),h),t.mDetailBubble.y=t.mShelfContainer.y-10*t.dpr-t.mDetailBubble.height}))}},PicaAvatarPanel.prototype.displayAvatar=function(t){var e=this;t||(t={avatar:{}}),this.render.mainPeer.getPlayerAvatar().then((function(i){var n=i.avatar;i.suits;for(var s in n=n||h.AvatarSuitType.createBaseAvatar()){if(n.hasOwnProperty(s))(p=n[s])&&(t.avatar[s]=p)}for(var r=0,o=e.mSelectedItemData;r<o.length;r++){var a=o[r],c=h.AvatarSuitType.createAvatarBySn(a.suitType,a.sn,a.slot,a.tag,a.version);for(var s in c){var p;if(c.hasOwnProperty(s))(p=c[s])&&(t.avatar[s]=p)}if("weapon"===a.suitType){var d={suit_type:a.suitType,tag:a.tag};t.suits=[d]}}var m=new Phaser.Geom.Point(0,50*e.dpr);e.mDetailDisplay.loadAvatar(t,2*e.dpr,m),l.Logger.getInstance().error("测试调用+++++装扮重置问题",e.mSelectedItemData)}))},PicaAvatarPanel.prototype.setSelectedResource=function(t){t.display?this.mDetailDisplay.loadDisplay(t):t.avatar&&this.displayAvatar()},PicaAvatarPanel.prototype.resetAvatar=function(t){var e={avatar:null};e.avatar=t.avatar;var i=new Phaser.Geom.Point(0,50*this.dpr);this.mDetailDisplay.loadAvatar(e,2*this.dpr,i),this.mSelectedItemData.length=0},PicaAvatarPanel.prototype.addListen=function(){this.mInitialized&&(this.mCloseBtn.on(s.ClickEvent.Tap,this.onCloseHandler,this),this.saveBtn.on(s.ClickEvent.Tap,this.onSaveBtnHandler,this),this.resetBtn.on(s.ClickEvent.Tap,this.onResetBtnHandler,this),this.rotateAvatarBtn.on(s.ClickEvent.Tap,this.onRotateAvatarHandler,this))},PicaAvatarPanel.prototype.removeListen=function(){this.mInitialized&&(this.mCloseBtn.off(s.ClickEvent.Tap,this.onCloseHandler,this),this.saveBtn.off(s.ClickEvent.Tap,this.onSaveBtnHandler,this),this.resetBtn.off(s.ClickEvent.Tap,this.onResetBtnHandler,this),this.rotateAvatarBtn.off(s.ClickEvent.Tap,this.onRotateAvatarHandler,this))},PicaAvatarPanel.prototype.fetchCategory=function(){this.onSelectedCategory(c.op_pkt_def.PKT_PackageType.AvatarPackage)},PicaAvatarPanel.prototype.destroy=function(){this.mCategoryScroll&&this.mCategoryScroll.destroy(),this.mPropGrid&&this.mPropGrid.destroy(),t.prototype.destroy.call(this)},PicaAvatarPanel.prototype.queryRefreshPackage=function(t){void 0===t&&(t=!1),this.queryPackege(t)},PicaAvatarPanel.prototype.init=function(){var e=this,i=this.scaleWidth,n=this.scaleHeight;this.mBackground=this.scene.make.graphics(void 0,!1);var r=this.scene.make.image({key:a.d.uicommon,frame:"avater_bg"});r.displayWidth=i,r.x=.5*i,this.mBg=this.scene.make.image({key:"avater_bg_stripe"},!1),this.mBg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mShelfContainer=this.scene.make.container(void 0,!1),this.mShelfContainer.setSize(i,295*this.dpr),this.mShelfContainer.y=n-this.mShelfContainer.height;var h=this.scene.make.image({key:a.d.uicommon,frame:"avater_nav"});h.displayWidth=i,h.x=.5*i,h.y=.5*h.height,this.mShelfContainer.add(h),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.mCloseBtn=new s.Button(this.scene,a.d.uicommon,"back_arrow","back_arrow"),this.mCloseBtn.setPosition(21*this.dpr,50*this.dpr),this.mCloseBtn.setInteractive(new Phaser.Geom.Rectangle(-28*this.dpr,-20*this.dpr,56*this.dpr,40*this.dpr),Phaser.Geom.Rectangle.Contains);var c=this.scene.make.image({key:a.d.uicommon,frame:"avater_name_bg"});c.x=.5*i,c.y=this.mCloseBtn.y,this.nameText=this.scene.make.text({x:c.x,y:c.y,text:"",style:l.UIHelper.whiteStyle(this.dpr,14)}).setOrigin(.5);var p=this.scene.make.image({key:"avater_bg_adorn"});p.x=.5*p.width,p.y=.5*p.height,p.scaleX=-1;var d=this.scene.make.image({key:"avater_bg_adorn"});d.x=i-.5*p.width,d.y=.5*p.height;var m=90*this.dpr,f=38*this.dpr,g=i-m/2-20*this.dpr,P=this.mShelfContainer.y-25*this.dpr;this.saveBtn=this.createNineButton(g,P,m,f,a.d.uicommon,"yellow_btn",l.i18n.t("common.save"),"#996600"),this.resetBtn=new s.Button(this.scene,a.d.uicommon,"avater_repeal"),this.resetBtn.x=i-30*this.dpr,this.resetBtn.y=this.mCloseBtn.y,this.rotateAvatarBtn=new s.Button(this.scene,a.d.uicommon,"avater_turn_back","avater_turn_back"),this.mDetailDisplay=new o.a(this.scene,this.render),this.mDetailDisplay.setComplHandler(new l.Handler(this,(function(){e.mDetailDisplay.visible=!0}))),this.mDetailDisplay.setTexture(a.d.uicommon,"bag_nothing",1),this.mDetailDisplay.setNearest(),this.mDetailDisplay.on("pointerup",this.onAvatarClickHandler,this),this.mDetailDisplay.y=this.mBg.y+this.mBg.height/2,this.mDetailBubble=new u(this.scene,a.d.uicommon,this.dpr),this.mDetailBubble.x=10*this.dpr,this.mCategoryScroll=new s.GameScroller(this.scene,{x:.5*i,y:this.mShelfContainer.y+20*this.dpr,width:i,height:41*this.dpr,zoom:this.scale,orientation:1,dpr:this.dpr,cellupCallBack:function(t){e.onSelectSubCategoryHandler(t)}}),this.add([this.mBackground,r,p,d,this.mBg,this.mCloseBtn,c,this.nameText,this.mDetailDisplay,this.mDetailBubble]),this.add([this.mShelfContainer,this.mCategoryScroll,this.saveBtn,this.resetBtn,this.rotateAvatarBtn]);var v=this.scene.textures.getFrame(a.d.uicommon,"avater_icon_check"),b=v.width+2*this.dpr,_=v.height+2*this.dpr,k={x:0,y:0,table:{width:i,height:260*this.dpr,columns:3,cellWidth:b,cellHeight:_,reuseCellContainer:!0,zoom:this.scale,mask:!1},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.scene,s=t.item;if(null===i&&(i=new y(n,0,0,a.d.uicommon,e.dpr,e.scale)),i.setData({item:s}),i.setProp(s),s&&e.isSelectedItemData(s))i.isSelect=!0,e.mSelectedItems.push(i);else{var r=e.mSelectedItems.indexOf(i);-1!==r&&e.mSelectedItems.splice(r,1)}return i}};this.mPropGrid=new s.GameGridTable(this.scene,k),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){t&&e.onSelectItemHandler(t)})),this.add(this.mPropGrid),this.resize(0,0),t.prototype.init.call(this)},PicaAvatarPanel.prototype.createNineButton=function(t,e,i,n,r,o,a,h){var c=new s.NineSliceButton(this.scene,t,e,i,n,r,o,a,this.dpr,1,{left:14*this.dpr,top:14*this.dpr,right:15*this.dpr,bottom:14*this.dpr});return a&&(c.setTextStyle({color:h,fontSize:16*this.dpr,fontFamily:l.Font.DEFULT_FONT}),c.setFontStyle("bold")),c},PicaAvatarPanel.prototype.setSelectAvatarSuitItem=function(t,e){var i=t.suitType;if(i){for(var n=0,s=this.mSelectedItems;n<s.length;n++){s[n].isSelect=!1}for(var r=[],o=0,a=this.mSelectedItemData;o<a.length;o++){var p=a[o];h.SuitAlternativeType.checkAlternative(i,p.suitType)&&r.push(p)}for(var d=0,m=r;d<m.length;d++){p=m[d];var u=this.mSelectedItemData.indexOf(p);this.mSelectedItemData.splice(u,1);for(var y=0;y<this.mSelectedItems.length;y++){if(this.mSelectedItems[y].propData===p){this.mSelectedItems.splice(y,1);break}}}this&&this.mSelectedItemData.push(t),this.mSelectedItems.push(e),e.isSelect=!0;var f=new c.op_client.OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE_ITEM_RESOURCE;f.avatar=h.AvatarSuitType.createAvatarBySn(t.suitType,t.sn,t.slot,t.tag,t.version),f.animations=t.animations,this.setSelectedResource(f)}else l.Logger.getInstance().error("CountablePackageItem avatar does not exist",t)},PicaAvatarPanel.prototype.isSelectedItemData=function(t){if(this.mSelectedItemData.length>0&&this.mSelectedItemData[this.mSelectedItemData.length-1].indexId===t.indexId)return!0;return!1},PicaAvatarPanel.prototype.onSelectSubCategoryHandler=function(t){var e=t.getData("item");if(e){this.mPreCategoryBtn&&this.mPreCategoryBtn instanceof r.TextButton&&this.mPreCategoryBtn.changeNormal(),t instanceof r.TextButton&&t.changeDown(),this.mSelectedCategeories=e,this.mPropGrid.setT(0);var i=0!==this.mSelectedItemData.length;this.queryPackege(i),this.mPreCategoryBtn=t}this.mPropGrid.setT(0)},PicaAvatarPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(this.key+"_close")},PicaAvatarPanel.prototype.queryPackege=function(t){void 0===t&&(t=!1),this.mSelectedCategeories&&this.render.renderEmitter(this.key+"_queryPackage",{packType:this.categoryType,key:this.mSelectedCategeories.key,isupdate:t})},PicaAvatarPanel.prototype.onSelectItemHandler=function(t){var e=this,i=t.getData("item");if(i)if(this.isSelectedItemData(i))t.isSelect=!0;else{this.mDetailBubble.visible=!0;var n=null;this.render.mainPeer.getUserData_PlayerProperty().then((function(t){return n=t,e.serviceTimestamp})).then((function(t){e.mDetailBubble.setProp(i,Math.floor(t/1e3),n),e.mDetailBubble.y=e.mShelfContainer.y-10*e.dpr-e.mDetailBubble.height})),i&&(this.avatarDirection=0,this.setSelectAvatarSuitItem(i,t),this.nameText.text=i.name)}},PicaAvatarPanel.prototype.onSelectedCategory=function(t){this.categoryType=t,this.render.renderEmitter(this.key+"_queryDressAvatarIDS"),this.render.renderEmitter(this.key+"_getCategories",t)},PicaAvatarPanel.prototype.onSaveBtnHandler=function(){return __awaiter(this,void 0,void 0,(function(){var t,e,i,n,s,r,o,a,l,c;return __generator(this,(function(p){switch(p.label){case 0:for(this.dressAvatarIDS.length=0,this.dressAvatarDatas.length=0,t=[],e=0,i=this.mSelectedItemData;e<i.length;e++)n=i[e],t.push(n.id),this.dressAvatarIDS.push(n.id),this.dressAvatarDatas.push(n);for(this.render.renderEmitter(this.key+"_querySaveAvatar",t),s=[],r=h.AvatarSuitType.suitPart,o=0,a=this.dressAvatarDatas;o<a.length;o++)l=a[o],s.push({parts:r[l.suitType],id:l.sn});return[4,this.render.editorCanvasManager.createHeadIcon(s)];case 1:return c=p.sent(),this.render.mainPeer.uploadHeadImage(c),[2]}}))}))},PicaAvatarPanel.prototype.onResetBtnHandler=function(){this.mSelectedItemData.length=0;for(var t=0,e=this.dressAvatarDatas;t<e.length;t++){var i=e[t];this.mSelectedItemData.push(i)}this.displayAvatar(),this.mPropGrid.refresh()},PicaAvatarPanel.prototype.onRotateAvatarHandler=function(){this.avatarDirection++,this.avatarDirection>=2&&(this.avatarDirection=0);var t=this.getAvatarAni(),e={name:"idle",flip:t.flip},i=t.back;this.mDetailDisplay.setPlayAnimation(e,i)},PicaAvatarPanel.prototype.onAvatarClickHandler=function(){var t=["idle","run","mining","crafting"],e=t[Math.floor(Math.random()*t.length)],i=this.getAvatarAni(),n={name:e,flip:i.flip,times:1,playingQueue:{name:"idle",playTimes:-1}},s=i.back;this.mDetailDisplay.setPlayAnimation(n,s)},PicaAvatarPanel.prototype.getAvatarAni=function(){var t=!1,e=!1;switch(this.avatarDirection){case 0:t=!1,e=!1;break;case 1:case 2:t=!0,e=!0;break;case 3:t=!1,e=!0}return{back:t,flip:e}},PicaAvatarPanel.prototype.updateCategeoriesLoc=function(t){for(var e=this.mCategoryScroll.getItemList(),i=(this.dpr,null),n=30*this.dpr,s=(this.mScene.cameras.main.width,n),r=0;r<e.length;r++){var o=e[r];r>0?(i=e[r-1],o.x=i.x+i.width):o.x=s,s+=o.width}this.mCategoryScroll.setAlign()},Object.defineProperty(PicaAvatarPanel.prototype,"serviceTimestamp",{get:function(){var t=this;return new Promise((function(e,i){t.render.mainPeer.requestCurTime().then((function(t){e(t)}))}))},enumerable:!1,configurable:!0}),PicaAvatarPanel}(p.PicaBasePanel),u=function(t){function DetailBubble(e,i,n,r){void 0===r&&(r=1);var o=t.call(this,e)||this;o.dpr=n;var h=100*n,c=96*n;return o.setSize(h,c),o.tipsbg=new s.NineSlicePatch(o.scene,0,0,h,c,a.d.uicommon,"tips_bg",{left:10*o.dpr,top:10*o.dpr,right:10*o.dpr,bottom:10*o.dpr},void 0,void 0,0),o.tipsbg.setPosition(.5*h,.5*c),o.tipsbg.alpha=.6,o.tipsText=new s.BBCodeText(o.scene,7*n,-c+60*o.dpr,"",{color:"#333333",fontSize:12*o.dpr,fontFamily:l.Font.DEFULT_FONT,lineSpacing:6*n,padding:{top:2*n}}).setOrigin(0),o.tipsText.setWrapMode("string"),o.mExpires=new s.BBCodeText(e,7*n,85*n,"",{fontSize:12*o.dpr,fontFamily:l.Font.DEFULT_FONT}).setOrigin(0),o.add([o.tipsbg,o.tipsText,o.mExpires]),o.tipsText.addImage("iv_coin",{key:a.d.uicommon,frame:"home_silver",y:-3*o.dpr}),o.tipsText.addImage("iv_diamond",{key:a.d.uicommon,frame:"home_diamond",y:-3*o.dpr}),o}return d(DetailBubble,t),DetailBubble.prototype.setProp=function(t,e,i){var n=this;if(t){this.tipsText.setWrapWidth(void 0);var s="",r="",o="",a="",h="[color=#32347b][b][size="+14*this.dpr+"]"+(t.shortName||t.name)+"[/size][/b][/color]"+"\n",c=100*this.dpr;this.tipsText.text=h,c=c<this.tipsText.width?this.tipsText.width:c,t.source&&(s=""+t.source,h+="[color=#ffffff][size="+12*this.dpr+"]"+s+"[/size][/color]",this.tipsText.text=s,c=c<this.tipsText.width?this.tipsText.width:c),t.des&&""!==t.des&&(h+="\n"+(r=t.des),this.tipsText.text=r,c=c<this.tipsText.width?this.tipsText.width:c);var p=!1;if(t.affectValues){for(var d=t.affectValues.length,m=0;m<d;m++){var u=t.affectValues[m];if(i.hasProperty(u.key)){var y=i.getProperty(u.key),f=u.value>0?"[color=#ffff00]+"+u.value+"[/color]":"[color=#ff0000]"+u.value+"[/color]";o+="\n"+y.name+": "+f}}o.length>0&&(p||(p=!0,h+="\n-- -- -- -- -- -- -- --"),h+="\n[color=#ffffff]"+l.i18n.t("furni_bag.properties")+"[/color]"+o)}if(t.requireValues){for(d=t.requireValues.length,m=0;m<d;m++){var g=t.requireValues[m];if(i.hasProperty(g.key)){f=(y=i.propertiesMap.get(g.key)).value>=g.value?"[color=#00ff00]("+g.value+")[/color]":"[color=#ff0000]("+g.value+")[/color]";a+="\n"+y.name+": "+f}}a.length>0&&(p||(p=!0,h+="\n-- -- -- -- -- -- -- --"),h+="\n"+l.i18n.t("furni_bag.needproper")+":"+a)}if(this.tipsText.setWrapWidth(c),this.tipsText.text=h,this.width=c+14*this.dpr,t.expiredTime>0){p||(p=!0,h+="\n-- -- -- -- -- -- -- --");var P=t.expiredTime-e,timeout_1=function(){n.mExpires.visible=!0,n.mExpires.text=n.getDataFormat(1e3*P),n.timeID=P>0?setTimeout((function(){P-=1,timeout_1()}),1e3):void 0};timeout_1()}else this.mExpires.visible=!1,this.timeID&&clearTimeout(this.timeID);this.resize()}else this.tipsText.setText(l.i18n.t("furni_bag.empty_backpack")),this.mExpires.text="",this.resize();return this},DetailBubble.prototype.resize=function(t,e){var i=96*this.dpr,n=this.tipsText.height;this.mExpires.visible&&(n+=this.mExpires.height+3*this.dpr),n=(n+=14*this.dpr)<i?i:n,this.setSize(this.width,n),this.tipsbg.resize(this.width,this.height),this.tipsbg.x=.5*this.width,this.tipsbg.y=.5*this.height,this.tipsText.y=7*this.dpr,this.mExpires.y=this.tipsText.y+this.tipsText.height+3*this.dpr},DetailBubble.prototype.getDataFormat=function(t){var e=Math.floor(t/864e5),i=Math.floor(t/36e5)%24,n=Math.floor(t/6e4)%60,s=Math.floor(t/1e3)%60,r=l.i18n.t("furni_bag.timelimit")+":  ";if(e>0)r+="[color=#FF0000]"+(e+"-"+this.stringFormat(i)+":"+this.stringFormat(n)+":"+this.stringFormat(s))+"[/color]";else if(i>0||n>0||s>0){r+="[color=#FF0000]"+(this.stringFormat(i)+":"+this.stringFormat(n)+":"+this.stringFormat(s))+"[/color]"}else{r+="[color=#FF0000]"+(""+l.i18n.t("furni_bag.expires"))+"[/color]"}return r},DetailBubble.prototype.stringFormat=function(t){var e=t+"";return e.length<=1&&(e="0"+e),e},DetailBubble}(Phaser.GameObjects.Container),y=function(t){function Item(e,i,n,s,o,a){var h=t.call(this,e,i,n)||this;h.zoom=1,h.dpr=o,h.zoom=a,h.key=s;var c=e.make.image({key:s,frame:"avater_icon_uncheck"},!1);return c.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.selectbg=e.make.image({key:s,frame:"avater_icon_check"},!1),h.selectbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.setSize(c.displayWidth,c.displayHeight),h.selectIcon=e.make.image({key:s,frame:"selected"},!1).setOrigin(1).setPosition(.5*h.width,.5*h.height),h.selectIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.mPropImage=new r.DynamicImage(h.scene,0,0),h.mPropImage.scale=o/h.zoom,h.mCounter=e.make.text({x:.5*h.width-2*o,y:.5*h.height,style:{fontSize:12*o,fontFamily:l.Font.DEFULT_FONT}},!1).setOrigin(1),h.add([c,h.selectbg,h.selectIcon,h.mPropImage,h.mCounter]),h.isSelect=!1,h.isEquip=!1,h}return d(Item,t),Item.prototype.setProp=function(t){this.propData=t,this.isSelect=!1,this.isEquip=!1,this.mPropImage.visible=!1,t?(t.tag&&"remove"===JSON.parse(t.tag).type?(this.mPropImage.setTexture(a.d.uicommon,"backpack_close"),this.mPropImage.scale=1,this.mPropImage.visible=!0):(this.mPropImage.scale=this.dpr/this.zoom,this.mPropImage.load(l.Url.getOsdRes(t.display.texturePath),this,this.onPropLoadCompleteHandler)),t.count>1?(this.mCounter.visible=!0,this.mCounter.setText(t.count.toString())):this.mCounter.visible=!1,1===t.rightSubscript?this.isEquip=!0:this.isEquip=!1):this.mCounter.visible=!1},Item.prototype.onPropLoadCompleteHandler=function(){if(this.mPropImage&&this.mPropImage.texture){var t=this.mPropImage.texture;this.mPropImage.visible=!0,t&&t.setFilter(Phaser.Textures.FilterMode.NEAREST)}},Object.defineProperty(Item.prototype,"isSelect",{set:function(t){this.selectbg.visible=t},enumerable:!1,configurable:!0}),Object.defineProperty(Item.prototype,"isEquip",{set:function(t){this.selectIcon.visible=t},enumerable:!1,configurable:!0}),Item}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBagPanel",(function(){return m}));var n,s=i(5),r=i(470),o=i(475),a=i(11),h=i(1),l=i(0),c=i(2),p=i(471),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),m=function(t){function PicaBagPanel(e){var i=t.call(this,e)||this;return i.topBtns=[],i.mEnableEdit=!1,i.mAttributes=[],i.atlasNames=[a.d.uicommon],i.textures=[{atlasName:"bag_bg",folder:"texture"}],i.key=h.ModuleName.PICABAG_NAME,i}return d(PicaBagPanel,t),PicaBagPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,n,s),this.mBackground.x=.5*n,this.mBackground.y=.5*s,this.mCategoryCon.setSize(n,79*this.dpr),this.mCategoryCon.y=s-this.mPropGrid.height-.5*this.mCategoryCon.height-47*this.dpr,this.mCategoryCon.x=.5*n,this.mDetailBubble.y=this.mCategoryCon.y-10*this.dpr-this.mDetailBubble.height,this.mCategoriesBar.y=40*this.dpr,this.mCategoriesBar.x=.5*-n,this.mCategoriesBar.clear(),this.mCategoriesBar.fillStyle(4121087),this.mCategoriesBar.fillRect(0,0,n,40*this.dpr),this.mCategoriesBar.fillStyle(439765),this.mCategoriesBar.fillRect(0,40*this.dpr,n,3*this.dpr),this.useBtn.x=n-this.useBtn.width/2-10*this.dpr,this.useBtn.y=this.mCategoryCon.y-this.useBtn.height/2,this.recasteBtn.x=this.useBtn.x,this.recasteBtn.y=this.useBtn.y-this.recasteBtn.height-15*this.dpr,this.mDetailDisplay.x=n/2,this.mDetailDisplay.y=.5*(s-296*this.dpr-60*this.dpr)+60*this.dpr,this.mIconBg.x=this.mDetailDisplay.x,this.mIconBg.y=this.mDetailDisplay.y,this.mPropGridBg.clear(),this.mPropGridBg.fillStyle(8250878),this.mPropGridBg.fillRect(0,0,this.mPropGrid.width,this.mPropGrid.height+10*this.dpr),this.mPropGridBg.y=s-this.mPropGrid.height-4*this.dpr,this.mPropGrid.x=n/2+3*this.dpr,this.mPropGrid.y=s-.5*this.mPropGrid.height,this.mPropGrid.layout(),this.mPropGrid.resetMask(),this.mCategoryScroll.refreshMask(),this.setSize(n,s),this.setInteractive()},PicaBagPanel.prototype.setCategories=function(t){this.mPreCategoryBtn=null,this.mSelectedCategeories=null;var e=60*this.dpr,i=41*this.dpr,n=[];this.mCategoryScroll.clearItems();var s={value:l.i18n.t("common.all"),key:"alltype"};t.unshift(s);for(var o=0;o<t.length;o++){var a=new r.TextButton(this.scene,this.dpr,1,t[o].value,0,0);a.setData("item",t[o]),a.setSize(e,i),this.mCategoryScroll.addItem(a),n[o]=a,a.setFontSize(18*this.dpr),a.setFontStyle("bold")}this.mCategoryScroll.Sort(),this.mCategoryScroll.refreshMask(),n.length>1&&this.onSelectSubCategoryHandler(n[0]),this.updateCategeoriesLoc(!1)},PicaBagPanel.prototype.setProp=function(t,e){void 0===e&&(e=!1),t=t||[];var i=[],n=this.mSelectedCategeories.key;this.mSelectedItem=void 0;for(var s=!1,r=0,o=t;r<o.length;r++){var a=o[r];this.mSelectedItemData&&a.indexId===this.mSelectedItemData.indexId&&(this.mSelectedItemData=a,s=!0),"alltype"!==n&&n!==a.subcategory||i.push(a)}e&&(this.mSelectedItemData||(e=!1),s||(e=!1));var h=i.length;if(h<18&&(i=i.concat(new Array(18-h))),this.mPropGrid.setItems(i),!e){this.mSelectedItemData=void 0;var l=this.mPropGrid.getCell(0);l.container&&this.onSelectItemHandler(l.container)}},PicaBagPanel.prototype.setMoneyData=function(t,e){t=t||0,e=e||0,this.moneyData={money:t,diamond:e},this.mInitialized&&(this.moneyvalue.setText(t+""),this.diamondvalue.setText(e+""))},PicaBagPanel.prototype.setSceneData=function(t,e){this.mSceneType=t,this.mEnableEdit=e,this.sceneData={sceneType:t,editor:e},this.mInitialized&&this.createCategory(t,e)},PicaBagPanel.prototype.setSelectedResource=function(t){t.display&&this.mDetailDisplay.loadDisplay(t)},PicaBagPanel.prototype.addListen=function(){this.mInitialized&&(this.mCloseBtn.on(s.ClickEvent.Tap,this.onCloseHandler,this),this.useBtn.on(s.ClickEvent.Tap,this.onUseBtnHandler,this),this.recasteBtn.on(s.ClickEvent.Tap,this.onRecasteHandler,this))},PicaBagPanel.prototype.removeListen=function(){this.mInitialized&&(this.mCloseBtn.off(s.ClickEvent.Tap,this.onCloseHandler,this),this.useBtn.off(s.ClickEvent.Tap,this.onUseBtnHandler,this),this.recasteBtn.off(s.ClickEvent.Tap,this.onRecasteHandler,this))},PicaBagPanel.prototype.destroy=function(){this.mCategoryScroll&&this.mCategoryScroll.destroy(),this.mPropGrid&&this.mPropGrid.destroy(),t.prototype.destroy.call(this)},PicaBagPanel.prototype.queryRefreshPackage=function(t){void 0===t&&(t=!1),this.queryPackege(t)},PicaBagPanel.prototype.onSellPropsHandler=function(t,e,i){this.mCategoryScroll.addListen(),this.render.renderEmitter(this.key+"_sellProps",{prop:e,count:i,category:t})},PicaBagPanel.prototype.onSellPropsFailedHandler=function(t){this.mCategoryScroll.addListen()},PicaBagPanel.prototype.onUsePropsHandler=function(t,e){this.mCategoryScroll.addListen(),this.render.renderEmitter(this.key+"_useprops",{itemid:t.id,count:e})},PicaBagPanel.prototype.onUsePropsFailedHandler=function(t){this.mCategoryScroll.addListen()},PicaBagPanel.prototype.onInitialized=function(){this.moneyData&&(this.moneyvalue.setText(this.moneyData.money+""),this.diamondvalue.setText(this.moneyData.diamond+"")),this.sceneData&&this.createCategory(this.sceneData.sceneType,this.sceneData.editor)},PicaBagPanel.prototype.init=function(){var e=this,i=this.scaleWidth,n=this.scaleHeight;this.mBackground=new r.CommonBackground(this.scene,0,0,i,n),this.mIconBg=this.scene.make.image({key:"bag_bg"},!1),this.mIconBg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mCategoryCon=this.scene.make.container(void 0,!1),this.mCategoryCon.setSize(i,295*this.dpr),this.mCategoryCon.y=n-this.mCategoryCon.height,this.mCategoriesBar=this.scene.make.graphics(void 0,!1),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.mCloseBtn=new s.Button(this.scene,a.d.uicommon,"back_arrow","back_arrow"),this.mCloseBtn.setPosition(21*this.dpr,35*this.dpr),this.mCloseBtn.setInteractive(new Phaser.Geom.Rectangle(-28*this.dpr,-20*this.dpr,56*this.dpr,40*this.dpr),Phaser.Geom.Rectangle.Contains);var h=new s.NineSlicePatch(this.scene,0,-this.dpr,190*this.dpr,28*this.dpr,a.d.uicommon,"home_assets_bg",{left:17*this.dpr,top:0*this.dpr,right:17*this.dpr,bottom:0*this.dpr});h.x=.5*-h.width;var c=this.scene.make.image({x:h.x,y:0,key:a.d.uicommon,frame:"home_assets_division"},!1);this.moneyvalue=new r.ImageValue(this.scene,60*this.dpr,26*this.dpr,a.d.uicommon,"home_silver",this.dpr,{color:"#ffffff",fontSize:15*this.dpr,fontFamily:l.Font.NUMBER}),this.moneyvalue.setLayout(1),this.moneyvalue.x=h.x-.5*h.width+22*this.dpr,this.diamondvalue=new r.ImageValue(this.scene,60*this.dpr,26*this.dpr,a.d.uicommon,"home_diamond",this.dpr,{color:"#ffffff",fontSize:15*this.dpr,fontFamily:l.Font.NUMBER}),this.diamondvalue.setLayout(1),this.diamondvalue.x=h.x+22*this.dpr,this.moneyAddBtn=new s.Button(this.scene,a.d.uicommon,"home_praise_bg","home_praise_bg");var p=this.scene.make.image({x:0,y:0,key:a.d.uicommon,frame:"home_assets_add"},!1);this.moneyAddBtn.add(p),this.moneyAddBtn.x=.5*-this.moneyAddBtn.width-4*this.dpr,this.moneyAddBtn.on(s.ClickEvent.Tap,this.onRechargeHandler,this),this.moneyCon=this.scene.make.container(void 0,!1),this.moneyCon.setSize(h.width,h.height),this.moneyCon.add([h,c,this.moneyvalue,this.diamondvalue,this.moneyAddBtn]),this.moneyCon.x=i-20*this.dpr,this.moneyCon.y=this.mCloseBtn.y;var d=this.scene.make.image({key:a.d.uicommon,frame:"avater_name_bg"});d.x=.5*i,d.y=this.mCloseBtn.y+40*this.dpr,this.nameText=this.scene.make.text({x:d.x,y:d.y,text:"",style:l.UIHelper.whiteStyle(this.dpr,14)}).setOrigin(.5),this.nameText.setFontStyle("bold"),this.starImage=this.scene.make.image({key:a.d.uicommon,frame:"bag_star_big_1"}),this.starImage.x=d.x,this.starImage.y=d.y+.5*d.height+15*this.dpr,this.moreButton=new s.Button(this.scene,a.d.uicommon,"online_more"),this.moreButton.x=i-.5*this.moreButton.width-20*this.dpr,this.moreButton.y=d.y,this.moreButton.on(s.ClickEvent.Tap,this.onMoreHandler,this),this.moreButton.visible=!1;var m=100*this.dpr,y=40*this.dpr,f=i-m/2-20*this.dpr,g=this.mCategoryCon.y-25*this.dpr;this.useBtn=this.createNineButton(f+100*this.dpr,g,m,y,a.d.uicommon,"yellow_btn",l.i18n.t("common.use"),"#996600"),this.recasteBtn=this.createNineButton(this.useBtn.x,this.useBtn.y,m,y,a.d.uicommon,"yellow_btn",l.i18n.t("furni_bag.recaste"),"#996600"),this.recasteBtn.visible=!1,this.mDetailDisplay=new o.a(this.scene,this.render),this.mDetailDisplay.setFixedScale(2*this.dpr/this.scale),this.mDetailDisplay.setComplHandler(new l.Handler(this,(function(){e.mDetailDisplay.visible=!0}))),this.mDetailDisplay.setTexture(a.d.uicommon,"bag_nothing",1),this.mDetailDisplay.setNearest(),this.mDetailDisplay.y=this.mIconBg.y+this.mIconBg.height/2,this.mDetailBubble=new u(this.scene,a.d.uicommon,this.dpr),this.mDetailBubble.x=10*this.dpr,this.mCategoryScroll=new s.GameScroller(this.scene,{x:0,y:60*this.dpr,width:i,height:41*this.dpr,zoom:this.scale,orientation:1,dpr:this.dpr,space:10*this.dpr,selfevent:!0,cellupCallBack:function(t){e.onSelectSubCategoryHandler(t)}}),this.mPropGridBg=this.scene.make.graphics(void 0,!1),this.mCategoryCon.add([this.mCategoriesBar,this.mCategoryScroll]),this.add([this.mBackground,this.mPropGridBg,this.mIconBg,this.mCloseBtn,this.moneyCon,this.mDetailDisplay,d,this.nameText,this.starImage,this.moreButton,this.mDetailBubble,this.mCategoryCon,this.useBtn,this.recasteBtn]);var P=this.scene.textures.getFrame(a.d.uicommon,"bag_icon_common_bg"),v=P.width+9*this.dpr,b=P.height+9*this.dpr,_={x:0,y:0,table:{width:i,height:231*this.dpr,columns:3,cellWidth:v,cellHeight:b,reuseCellContainer:!0,zoom:this.scale,mask:!1},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.scene,s=t.item;return null===i&&(i=new o.c(n,a.d.uicommon,"bag_icon_common_bg",e.dpr,e.scale,!1)),i.setData({item:s}),i.setItemData(s),s&&e.isSelectedItemData(s)&&(i.isSelect=!0,e.mSelectedItem=i,e.mSelectedItemData=s),i}};this.mPropGrid=new s.GameGridTable(this.scene,_),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){t&&e.onSelectItemHandler(t)})),this.add(this.mPropGrid),this.resize(0,0),t.prototype.init.call(this)},PicaBagPanel.prototype.createCategory=function(t,e){var i=this.scaleWidth,n=90*this.dpr,o=35*this.dpr,h=23*this.dpr;this.topCheckBox=new r.CheckboxGroup;var c=[3,1],p=[l.i18n.t("furni_bag.Props"),l.i18n.t("furni_bag.furni")];2===t&&(c=[5],p=[l.i18n.t("furni_bag.furni")]);var d=.5*-i+.5*n+1*this.dpr,m=this.scene.textures.getFrame(a.d.uicommon,"bag_tab_uncheck"),u=60;m&&(u=m.width,m.height);var y={left:u/2,top:12*this.dpr,right:4*this.dpr,bottom:2*this.dpr};for(var f in c){var g=c[v=Number(f)],P=new s.NinePatchTabButton(this.scene,n,o,a.d.uicommon,"bag_tab_uncheck","bag_tab_select",p[v],[y]);P.tweenScale=1,P.setTextStyle(l.UIHelper.whiteStyle(this.dpr,18)),P.setData("data",g),P.setSize(n,o),P.setFontStyle("bold"),P.y=h,P.x=d,d+=n+3*this.dpr,this.topBtns.push(P)}if(this.topCheckBox.appendItemAll(this.topBtns),this.topCheckBox.on("selected",this.onTopCategoryHandler,this),this.mCategoryCon.add(this.topBtns),e){var v=c.indexOf(5);this.topCheckBox.selectIndex(v)}else this.topCheckBox.selectIndex(0)},PicaBagPanel.prototype.createNineButton=function(t,e,i,n,r,o,a,h){var c=new s.NineSliceButton(this.scene,t,e,i,n,r,o,a,this.dpr,1,{left:14*this.dpr,top:14*this.dpr,right:15*this.dpr,bottom:14*this.dpr});return a&&(c.setTextStyle({color:h,fontSize:16*this.dpr,fontFamily:l.Font.DEFULT_FONT}),c.setFontStyle("bold")),c},PicaBagPanel.prototype.setSelectedItem=function(t,e){if(this.mSelectedItem&&(this.mSelectedItem.isSelect=!1),this.nameText.text=t.name||t.shortName,t.grade>0){this.starImage.visible=!0;var i="bag_star_big_"+t.grade;this.starImage.setFrame(i)}else this.starImage.visible=!1;this.mSelectedItemData=t,this.mSelectedItem=e,e.isSelect=!0,this.mDetailDisplay.displayLoading("loading_ui",l.Url.getUIRes(this.dpr,"loading_ui"),l.Url.getUIRes(this.dpr,"loading_ui"));var n=new c.op_client.OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE_ITEM_RESOURCE;n.display=1===this.categoryType?t.animationDisplay:t.display,n.animations=t.animations,this.setSelectedResource(n)},PicaBagPanel.prototype.isSelectedItemData=function(t){return!!this.mSelectedItemData&&this.mSelectedItemData.indexId===t.indexId},PicaBagPanel.prototype.onSelectSubCategoryHandler=function(t){var e=t.getData("item");if(e){this.mPreCategoryBtn&&this.mPreCategoryBtn instanceof r.TextButton&&this.mPreCategoryBtn.changeNormal(),t instanceof r.TextButton&&t.changeDown(),this.mSelectedCategeories=e,this.mPropGrid.setT(0);var i=void 0!==this.mSelectedItemData;this.queryPackege(i),this.mPreCategoryBtn=t}this.mPropGrid.setT(0)},PicaBagPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(this.key+"_close")},PicaBagPanel.prototype.queryPackege=function(t){void 0===t&&(t=!1),this.mSelectedCategeories&&this.render.renderEmitter(this.key+"_queryPackage",{packType:this.categoryType,key:this.mSelectedCategeories.key,isupdate:t})},PicaBagPanel.prototype.onSelectItemHandler=function(t){var e=this,i=t.getData("item");if(!(i&&this.mSelectedItemData===i||this.mSelectedItemData&&!i)){this.mDetailBubble.visible=!0;var n=null;this.render.mainPeer.getUserData_PlayerProperty().then((function(t){return n=t,e.serviceTimestamp})).then((function(t){e.mDetailBubble.setProp(i,Math.floor(t/1e3),n),e.mDetailBubble.y=e.mCategoryCon.y-10*e.dpr-e.mDetailBubble.height,i&&e.setItemAttribute(i,n)})),i?(3===this.categoryType&&"pkt_market_tag_20013"!==i.subcategory?this.useBtn.visible=!1:this.useBtn.visible=!0,this.setSelectedItem(i,t)):2!==this.categoryType&&void 0===this.mSelectedItemData&&(this.useBtn.visible=!1,this.mDetailDisplay.setTexture(a.d.uicommon,"bag_nothing",1),this.mDetailDisplay.setNearest(),this.nameText.text="")}},PicaBagPanel.prototype.setItemAttribute=function(t,e){for(var i=0,n=this.mAttributes;i<n.length;i++){(p=n[i]).visible=!1}if(t.affectValues){for(var o=t.affectValues.length>=6?6:t.affectValues.length,h=0;h<o;h++){var c=t.affectValues[h],p=void 0;if(h<this.mAttributes.length)(p=this.mAttributes[h]).visible=!0;else{var d=new s.NineSlicePatch(this.scene,0,0,56*this.dpr,22*this.dpr,a.d.uicommon,"bag_attribute_bg",{left:12*this.dpr,right:12*this.dpr,top:0,bottom:0});(p=new r.DynamicImageValue(this.scene,56*this.dpr,22*this.dpr,a.d.uicommon,"",this.dpr)).setOffset(-3*this.dpr,0),p.addAt(d,0),p.setLayout(2),this.add(p),this.mAttributes.push(p)}if(e.propertiesMap){var m=e.propertiesMap.get(c.key);if(m){var u=c.value>0?"+"+c.value:c.value+"";m.display?(p.load(l.Url.getOsdRes(m.display.texturePath)),p.setText(u),p.setOffset(-3*this.dpr,0)):(p.setText(u),p.setOffset(-10*this.dpr,0))}else p.visible=!1}else p.visible=!1}this.setLayoutAttribute()}},PicaBagPanel.prototype.setLayoutAttribute=function(){var t=[];if(this.mAttributes.forEach((function(e){e.visible&&t.push(e)})),0!==t.length){for(var e=56*this.dpr,i=21*this.dpr,n=23*this.dpr,s=.5*this.scaleWidth,r=this.nameText.y+30*this.dpr,o=t.length>3?3:t.length,a=e*o+n*(o-1),h=s-.5*a,l=0,c=0,p=t;c<p.length;c++){var d=p[c];d.x=h+.5*e,d.y=r,h+=e+n,3===++l&&(h=s-.5*a,r+=13*this.dpr+i)}t.length=0}},PicaBagPanel.prototype.onAddFurniToSceneHandler=function(){if(this.mSelectedItemData)if(this.mSceneType===c.op_def.SceneTypeEnum.EDIT_SCENE_TYPE||this.mEnableEdit)this.render.renderEmitter(this.key+"_addFurniToScene",this.mSelectedItemData.id);else{var t={text:[{text:l.i18n.t("furni_bag.placetips"),node:void 0}]};this.render.mainPeer.showMediator(h.ModuleName.PICANOTICE_NAME,!0,t),this.mCategoryScroll.addListen()}},PicaBagPanel.prototype.onTopCategoryHandler=function(t){var e=t.getData("data");this.clearCategoryData(),this.recasteBtn.visible=!1,e&&(this.onSelectedCategory(e),1===e||5===e?(this.useBtn.setText(l.i18n.t("furni_bag.add")),1===e&&(this.moreButton.visible=!0)):(this.useBtn.setText(l.i18n.t("common.use")),this.moreButton.visible=!1))},PicaBagPanel.prototype.clearCategoryData=function(){this.mSelectedItemData=void 0},PicaBagPanel.prototype.onSelectedCategory=function(t){this.categoryType=t,this.render.renderEmitter(this.key+"_getCategories",t)},PicaBagPanel.prototype.getPropResource=function(t){var e={};return t.suitType?e.avatar=h.AvatarSuitType.createAvatarBySn(t.suitType,t.sn,t.slot,t.tag,t.version):e.display=t.display,e.suit=[{suit_type:t.suitType,sn:t.sn,tag:t.tag,version:t.version}],e.animations=t.animations,e},PicaBagPanel.prototype.onMoreButtonHandler=function(t){"place"===t?this.onAddFurniToSceneHandler():"sell"===t&&this.onSellBtnHandler()},PicaBagPanel.prototype.onSellBtnHandler=function(){if(this.mCategoryScroll.removeListen(),this.mSelectedItemData){var t=this.mSelectedItemData;if(!t.recyclable)return;var e=l.i18n.t("common.sold"),i=this.getPropResource(t);t.avatar?i.avatar=t.avatar:i.display=t.display,i.animations=t.animations;var n={key:this.key,confirmFunc:"onSellPropsHandler",cancelFunc:"onSellPropsFailedHandler",confirmAddData:this.categoryType};this.showPropFun({resultHandler:n,data:t,title:e,resource:i})}},PicaBagPanel.prototype.onUseBtnHandler=function(){if(this.mCategoryScroll.removeListen(),this.mSelectedItemData)if(1===this.categoryType||5===this.categoryType)this.onAddFurniToSceneHandler();else{var t=this.mSelectedItemData,e=l.i18n.t("common.use"),i=this.getPropResource(t),n={key:this.key,confirmFunc:"onUsePropsHandler",cancelFunc:"onUsePropsFailedHandler"};this.showPropFun({resultHandler:n,data:t,price:!1,title:e,resource:i})}},PicaBagPanel.prototype.onRechargeHandler=function(){},PicaBagPanel.prototype.onRecasteHandler=function(){if(5!==this.mSelectedItemData.rarity){var t=this.mSelectedItemData;this.render.mainPeer.showMediator(h.ModuleName.PICARECASTE_NAME,!0,t)}else{var e={text:[{text:l.i18n.t("recaste.raritytips"),node:void 0}]};this.render.mainPeer.showMediator(h.ModuleName.PICANOTICE_NAME,!0,e)}},PicaBagPanel.prototype.onMoreHandler=function(){this.recasteBtn.visible=!0,this.moreButton.visible=!1},PicaBagPanel.prototype.updateCategeoriesLoc=function(t){for(var e=this.mCategoryScroll.getItemList(),i=(this.dpr,null),n=30*this.dpr,s=(this.mScene.cameras.main.width,n),r=0;r<e.length;r++){var o=e[r];r>0?(i=e[r-1],o.x=i.x+i.width):o.x=s,s+=o.width}this.mCategoryScroll.setAlign()},PicaBagPanel.prototype.showPropFun=function(t){this.render.mainPeer.showMediator(h.ModuleName.PICAPROPFUN_NAME,!0,t)},Object.defineProperty(PicaBagPanel.prototype,"serviceTimestamp",{get:function(){var t=this;return new Promise((function(e,i){t.render.mainPeer.requestCurTime().then((function(t){e(t)}))}))},enumerable:!1,configurable:!0}),PicaBagPanel}(p.PicaBasePanel),u=function(t){function DetailBubble(e,i,n,r){void 0===r&&(r=1);var o=t.call(this,e)||this;o.dpr=n,o.key=i;var a=100*n,h=96*n;return o.setSize(a,h),o.tipsbg=new s.NineSlicePatch(o.scene,0,0,a,h,o.key,"tips_bg",{left:10*o.dpr,top:10*o.dpr,right:10*o.dpr,bottom:10*o.dpr},void 0,void 0,0),o.tipsbg.setPosition(.5*a,.5*h),o.tipsbg.alpha=.6,o.tipsText=new s.BBCodeText(o.scene,7*n,-h+60*o.dpr,"",{color:"#333333",fontSize:12*o.dpr,fontFamily:l.Font.DEFULT_FONT,lineSpacing:6*n,padding:{top:2*n}}).setOrigin(0),o.tipsText.setWrapMode("string"),o.mExpires=new s.BBCodeText(e,7*n,85*n,"",{fontSize:12*o.dpr,fontFamily:l.Font.DEFULT_FONT}).setOrigin(0),o.add([o.tipsbg,o.tipsText,o.mExpires]),o.tipsText.addImage("iv_coin",{key:o.key,frame:"home_silver",y:-3*o.dpr}),o.tipsText.addImage("iv_diamond",{key:o.key,frame:"home_diamond",y:-3*o.dpr}),o}return d(DetailBubble,t),DetailBubble.prototype.setProp=function(t,e,i){var n=this;if(t){this.tipsText.setWrapWidth(void 0);var s="",r="",o="",a="",h="[color=#32347b][b][size="+14*this.dpr+"]"+(t.shortName||t.name)+"[/size][/b][/color]"+"\n",c=100*this.dpr;this.tipsText.text=h,c=c<this.tipsText.width?this.tipsText.width:c,t.source&&(s=""+t.source,h+="[color=#ffffff][size="+12*this.dpr+"]"+s+"[/size][/color]",this.tipsText.text=s,c=c<this.tipsText.width?this.tipsText.width:c),t.des&&""!==t.des&&(h+="\n"+(r=t.des),this.tipsText.text=r,c=c<this.tipsText.width?this.tipsText.width:c);var p=!1;if(t.affectValues){for(var d=t.affectValues.length,m=0;m<d;m++){var u=t.affectValues[m];if(i.propertiesMap)if(f=i.propertiesMap.get(u.key)){var y=u.value>0?"[color=#ffff00]+"+u.value+"[/color]":"[color=#ff0000]"+u.value+"[/color]";o+="\n"+f.name+": "+y}}o.length>0&&(p||(p=!0,h+="\n-- -- -- -- -- -- -- --"),h+="\n[color=#ffffff]"+l.i18n.t("furni_bag.properties")+"[/color]"+o)}if(t.requireValues){for(d=t.requireValues.length,m=0;m<d;m++){var f,g=t.requireValues[m];if(i.propertiesMap)if(f=i.propertiesMap.get(g.key)){y=f.value>=g.value?"[color=#00ff00]("+g.value+")[/color]":"[color=#ff0000]("+g.value+")[/color]";a+="\n"+f.name+": "+y}}a.length>0&&(p||(p=!0,h+="\n-- -- -- -- -- -- -- --"),h+="\n"+l.i18n.t("furni_bag.needproper")+":"+a)}if(this.tipsText.setWrapWidth(c),this.tipsText.text=h,this.width=c+14*this.dpr,t.expiredTime>0){p||(p=!0,h+="\n-- -- -- -- -- -- -- --");var P=t.expiredTime-e,timeout_1=function(){n.mExpires.visible=!0,n.mExpires.text=n.getDataFormat(1e3*P),n.timeID=P>0?setTimeout((function(){P-=1,timeout_1()}),1e3):void 0};timeout_1()}else this.mExpires.visible=!1,this.timeID&&clearTimeout(this.timeID);this.resize()}else this.tipsText.setText(l.i18n.t("furni_bag.empty_backpack")),this.mExpires.text="",this.resize();return this},DetailBubble.prototype.resize=function(t,e){var i=96*this.dpr,n=this.tipsText.height;this.mExpires.visible&&(n+=this.mExpires.height+3*this.dpr),n=(n+=14*this.dpr)<i?i:n,this.setSize(this.width,n),this.tipsbg.resize(this.width,this.height),this.tipsbg.x=.5*this.width,this.tipsbg.y=.5*this.height,this.tipsText.y=7*this.dpr,this.mExpires.y=this.tipsText.y+this.tipsText.height+3*this.dpr},DetailBubble.prototype.getDataFormat=function(t){var e=Math.floor(t/864e5),i=Math.floor(t/36e5)%24,n=Math.floor(t/6e4)%60,s=Math.floor(t/1e3)%60,r=l.i18n.t("furni_bag.timelimit")+":  ";if(e>0)r+="[color=#FF0000]"+(e+"-"+this.stringFormat(i)+":"+this.stringFormat(n)+":"+this.stringFormat(s))+"[/color]";else if(i>0||n>0||s>0){r+="[color=#FF0000]"+(this.stringFormat(i)+":"+this.stringFormat(n)+":"+this.stringFormat(s))+"[/color]"}else{r+="[color=#FF0000]"+(""+l.i18n.t("furni_bag.expires"))+"[/color]"}return r},DetailBubble.prototype.stringFormat=function(t){var e=t+"";return e.length<=1&&(e="0"+e),e},DetailBubble}(Phaser.GameObjects.Container);!function(t){function Item(e,i,n,s,o,a){void 0===a&&(a=1);var h=t.call(this,e,i,n)||this;h.dpr=o,h.zoom=a,h.key=s;var c=e.make.image({key:s,frame:"grid_bg"},!1);return c.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.selectbg=e.make.image({key:s,frame:"grid_choose"},!1),h.selectbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.setSize(c.displayWidth,c.displayHeight),h.selectIcon=e.make.image({key:s,frame:"selected"},!1).setOrigin(1).setPosition(.5*h.width,.5*h.height),h.selectIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.mPropImage=new r.DynamicImage(h.scene,0,0),h.mPropImage.scale=o/h.zoom,h.timeIcon=e.make.image({key:s,frame:"time"}),h.timeIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.timeIcon.setPosition(.5*-h.width+.5*h.timeIcon.width,.5*-h.height+.5*h.timeIcon.height),h.mCounter=e.make.text({x:.5*h.width-2*o,y:.5*h.height,style:{fontSize:12*o,fontFamily:l.Font.DEFULT_FONT}},!1).setOrigin(1),h.add([c,h.selectbg,h.selectIcon,h.mPropImage,h.timeIcon,h.mCounter]),h.isSelect=!1,h.isEquip=!1,h}d(Item,t),Item.prototype.setProp=function(t){if(this.propData=t,this.isSelect=!1,this.isEquip=!1,this.mPropImage.visible=!1,!t)return this.mCounter.visible=!1,void(this.timeIcon.visible=!1);t.tag&&"remove"===JSON.parse(t.tag).type?(this.mPropImage.setTexture(a.d.uicommon,"backpack_close"),this.mPropImage.scale=1,this.mPropImage.visible=!0):(this.mPropImage.scale=this.dpr/this.zoom,this.mPropImage.load(l.Url.getOsdRes(t.display.texturePath),this,this.onPropLoadCompleteHandler)),this.timeIcon.visible=t.expiredTime>0,t.count>1?(this.mCounter.visible=!0,this.mCounter.setText(t.count.toString())):this.mCounter.visible=!1,1===t.rightSubscript?this.isEquip=!0:this.isEquip=!1},Item.prototype.onPropLoadCompleteHandler=function(){if(this.mPropImage&&this.mPropImage.texture){var t=this.mPropImage.texture;this.mPropImage.visible=!0,t&&t.setFilter(Phaser.Textures.FilterMode.NEAREST)}},Object.defineProperty(Item.prototype,"isSelect",{set:function(t){this.selectbg.visible=t},enumerable:!1,configurable:!0}),Object.defineProperty(Item.prototype,"isEquip",{set:function(t){this.selectIcon.visible=t},enumerable:!1,configurable:!0})}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessMarketingPlanPanel",(function(){return d}));var n,s=i(494),r=i(493),o=i(470),a=i(479),h=i(1),l=i(11),c=i(0),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaBusinessMarketingPlanPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key2="c_street_2",i.key=h.ModuleName.PICABUSINESSMARKETINGPLAN_NAME,i}return p(PicaBusinessMarketingPlanPanel,t),PicaBusinessMarketingPlanPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,e,i),this.setSize(n,s),this.mBackGround.clear(),this.mBackGround.fillStyle(0,.66),this.mBackGround.fillRect(0,0,n,s)},PicaBusinessMarketingPlanPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicaBusinessMarketingPlanPanel.prototype.addListen=function(){this.mInitialized},PicaBusinessMarketingPlanPanel.prototype.removeListen=function(){this.mInitialized},PicaBusinessMarketingPlanPanel.prototype.preload=function(){this.addAtlas(this.key,"c_street_1/c_street_1.png","c_street_1/c_street_1.json"),this.addAtlas(this.key2,"c_street_2/c_street_2.png","c_street_2/c_street_2.json"),this.addAtlas(l.c.commonKey,l.d.commonUrl+".png",l.d.commonUrl+".json"),this.addAtlas(l.c.common2Key,l.d.common2Url+".png",l.d.common2Url+".json"),t.prototype.preload.call(this)},PicaBusinessMarketingPlanPanel.prototype.init=function(){var e=this.scale,i=this.scaleWidth,n=this.scaleHeight;this.mBackGround=this.scene.make.graphics(void 0,!1),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,i*e,n*e),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.add(this.mBackGround);var s=90*this.dpr,r=74*this.dpr,o=295*this.dpr,h=n-s-r,l=s+.5*h,p=.5*i;this.content=new a.PicaBusinessContentPanel(this.scene,p,l,o,h,this.dpr,this.key,this.key2),this.content.setCloseHandler(new c.Handler(this,this.OnCloseHandler)),this.add(this.content),this.resize(i,n),t.prototype.init.call(this),this.setLinear(this.key2),this.openPlanPanel()},PicaBusinessMarketingPlanPanel.prototype.setPlanModels=function(t){this.picChoosePlanPanel.setPlanData(t.marketPlan)},PicaBusinessMarketingPlanPanel.prototype.setEquipedPlan=function(t){this.picBusinessPlanPanel.setPlanData(t)},PicaBusinessMarketingPlanPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaBusinessMarketingPlanPanel.prototype.openPlanPanel=function(){this.showMarketingPlanPanel(),this.picBusinessPlanPanel.setRender(this.render),this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_querymarketplan")},PicaBusinessMarketingPlanPanel.prototype.openChoosePlanPanel=function(){this.showChoosePlanPanel(),this.picChoosePlanPanel.resetMask()},PicaBusinessMarketingPlanPanel.prototype.showMarketingPlanPanel=function(){var t=this,e=90*this.dpr,i=74*this.dpr;if(this.setContentSize(e,i),!this.picBusinessPlanPanel){var n=this.content.width,r=this.content.height-50*this.dpr;this.picBusinessPlanPanel=new s.PicaBusinessPlanPanel(this.scene,0,0,n,r,this.dpr,this.scale,this.key),this.picBusinessPlanPanel.setHandler(new c.Handler(this,(function(){t.hideMarketingPlanPanel(),t.OnCloseHandler()})),new c.Handler(this,(function(e){t.hideMarketingPlanPanel(),t.openChoosePlanPanel(),t.render.renderEmitter(h.RENDER_PEER+"_"+t.key+"_queryplanmodels",e)})))}this.content.add(this.picBusinessPlanPanel),this.picBusinessPlanPanel.resetMask()},PicaBusinessMarketingPlanPanel.prototype.hideMarketingPlanPanel=function(){this.content.remove(this.picBusinessPlanPanel)},PicaBusinessMarketingPlanPanel.prototype.showChoosePlanPanel=function(){var t=this,e=this.scaleWidth,i=this.scaleHeight,n=295*this.dpr,s=320*this.dpr,o=.5*i,a=.5*e;if(this.content.setPosition(a,o),this.content.setContentSize(n,s),!this.picChoosePlanPanel){var l=this.content.width,p=this.content.height-50*this.dpr;this.picChoosePlanPanel=new r.PicaBusinessChoosePlanPanel(this.scene,0,0,l,p,this.dpr,this.scale,this.key),this.picChoosePlanPanel.setHandler(new c.Handler(this,(function(){t.hideChoosePlanPanel(),t.openPlanPanel()})),new c.Handler(this,(function(e){t.render.renderEmitter(h.RENDER_PEER+"_"+t.key+"_queryselectplan",e)})))}this.content.add(this.picChoosePlanPanel),this.picBusinessPlanPanel.resetMask()},PicaBusinessMarketingPlanPanel.prototype.hideChoosePlanPanel=function(){this.content.remove(this.picChoosePlanPanel)},PicaBusinessMarketingPlanPanel.prototype.setContentSize=function(t,e){var i=this.scaleWidth,n=this.scaleHeight,s=295*this.dpr,r=n-t-e,o=t+.5*r,a=.5*i;this.content.setPosition(a,o),this.content.setContentSize(s,r)},PicaBusinessMarketingPlanPanel.prototype.OnCloseHandler=function(){this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_hide")},PicaBusinessMarketingPlanPanel}(o.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessStreetPanel",(function(){return g}));var n,s=i(479),r=i(496),o=i(500),a=i(501),h=i(495),l=i(499),c=i(498),p=i(497),d=i(470),m=i(1),u=i(11),y=i(0),f=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),g=function(t){function PicaBusinessStreetPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key2="c_street_2",i.key=m.ModuleName.PICABUSINESSSTREET_NAME,i}return f(PicaBusinessStreetPanel,t),PicaBusinessStreetPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,e,i),this.setSize(n,s),this.mBackGround.clear(),this.mBackGround.fillStyle(0,.66),this.mBackGround.fillRect(0,0,n,s)},PicaBusinessStreetPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicaBusinessStreetPanel.prototype.addListen=function(){this.mInitialized},PicaBusinessStreetPanel.prototype.removeListen=function(){this.mInitialized},PicaBusinessStreetPanel.prototype.preload=function(){this.addAtlas(this.key,"c_street_1/c_street_1.png","c_street_1/c_street_1.json"),this.addAtlas(this.key2,"c_street_2/c_street_2.png","c_street_2/c_street_2.json"),this.addAtlas(u.c.commonKey,u.d.commonUrl+".png",u.d.commonUrl+".json"),this.addAtlas(u.c.common2Key,u.d.common2Url+".png",u.d.common2Url+".json"),t.prototype.preload.call(this)},PicaBusinessStreetPanel.prototype.init=function(){var e=this.scale,i=this.scaleWidth,n=this.scaleHeight;this.mBackGround=this.scene.make.graphics(void 0,!1),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,i*e,n*e),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.add(this.mBackGround);var r=90*this.dpr,o=74*this.dpr,a=295*this.dpr,h=n-r-o,l=r+.5*h,c=.5*i;this.content=new s.PicaBusinessContentPanel(this.scene,c,l,a,h,this.dpr,this.key,this.key2),this.content.setCloseHandler(new y.Handler(this,this.OnCloseHandler)),this.add(this.content),this.resize(i,n),t.prototype.init.call(this),this.setLinear(this.key2),this.openMyStreet()},PicaBusinessStreetPanel.prototype.setMyStore=function(t){this.picMyStreetPanel.setMyStoreData(t)},PicaBusinessStreetPanel.prototype.setCommercialStreet=function(t){this.picStreetListPanel&&this.picStreetListPanel.setStreetListData(t.commercialStreet)},PicaBusinessStreetPanel.prototype.setIndustryModels=function(t){this.industryModels=t,this.picStoreCreatePanel&&this.picStoreCreatePanel.parentContainer&&this.picStoreCreatePanel.setTypeData(t.industry),this.picStreetListPanel&&this.picStreetListPanel.parentContainer&&this.picStreetListPanel.setIndustryModels(this.industryModels)},PicaBusinessStreetPanel.prototype.setStoreRankingList=function(t){this.picStreetRankingPanel.setRankingData(t.rankChampions)},PicaBusinessStreetPanel.prototype.setStoreRankingDetial=function(t){this.picRankingDetailPanel.setRankingDetailData(t)},PicaBusinessStreetPanel.prototype.setStoreRankingReward=function(t){this.picRankRewardPanel.setRankRewardData(t.rewardStage)},PicaBusinessStreetPanel.prototype.setEnterHistory=function(t){this.picStreetHistoryPanel.setHistoryeData(t.history)},PicaBusinessStreetPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaBusinessStreetPanel.prototype.setSecondStore=function(t){this.picSecondStorePanel.setTypeData(t)},PicaBusinessStreetPanel.prototype.openMyStreet=function(){this.render.renderEmitter(m.RENDER_PEER+"_"+this.key+"_querymystore"),this.showMyStreetPanel(),this.content.setTitleText(y.i18n.t("business_street.commercial_street"))},PicaBusinessStreetPanel.prototype.openStoreCreatePanel=function(){this.render.renderEmitter(m.RENDER_PEER+"_"+this.key+"_querymodels"),this.showStoreCreatePanel(),this.content.setTitleText(y.i18n.t("business_street.newstore"))},PicaBusinessStreetPanel.prototype.openSecondStorePanel=function(){this.showSecondStorePanel(),this.content.setTitleText(y.i18n.t("business_street.newstore"))},PicaBusinessStreetPanel.prototype.openStoreStreetPanel=function(){this.showStreetListPanel(),this.industryModels?this.picStreetListPanel.setIndustryModels(this.industryModels):this.render.renderEmitter(m.RENDER_PEER+"_"+this.key+"_querymodels"),this.content.setTitleText(y.i18n.t("business_street.commercial_street"))},PicaBusinessStreetPanel.prototype.openStreetHistoryPanel=function(){this.showStreetHistoryPanel(),this.content.setTitleText(y.i18n.t("business_street.history"))},PicaBusinessStreetPanel.prototype.openStreetRankingPanel=function(){this.showStreetRankingPanel(),this.content.setTitleText(y.i18n.t("business_street.ranking"))},PicaBusinessStreetPanel.prototype.openRankingDetailPanel=function(){this.showRankingDetailPanel(),this.content.setTitleText(y.i18n.t("business_street.ranking"))},PicaBusinessStreetPanel.prototype.openRankRewardPanel=function(){this.showRankRewardPanel(),this.content.setTitleText(y.i18n.t("business_street.rankreward"))},PicaBusinessStreetPanel.prototype.showMyStreetPanel=function(){var t=this,e=90*this.dpr,i=74*this.dpr;if(this.setContentSize(e,i),!this.picMyStreetPanel){var n=this.content.width,s=this.content.height-50*this.dpr;this.picMyStreetPanel=new r.PicaBusinessMyStreetPanel(this.scene,0,0,n,s,this.dpr,this.scale,this.key),this.picMyStreetPanel.setHandler(new y.Handler(this,(function(){t.render.renderEmitter(m.RENDER_PEER+"_"+t.key+"_queryallsaves")})),new y.Handler(this,(function(){t.openStoreStreetPanel(),t.hideMyStreetPanel()})),new y.Handler(this,(function(){t.hideMyStreetPanel(),t.openStoreCreatePanel()})),new y.Handler(this,(function(e,i){t.render.renderEmitter(m.RENDER_PEER+"_"+t.key+"_queryenterroom",{roomid:e,password:i})})))}this.content.add(this.picMyStreetPanel),this.picMyStreetPanel.resetMask()},PicaBusinessStreetPanel.prototype.hideMyStreetPanel=function(){this.content.remove(this.picMyStreetPanel)},PicaBusinessStreetPanel.prototype.showStoreCreatePanel=function(){var t=this,e=this.scaleWidth,i=this.scaleHeight,n=295*this.dpr,s=320*this.dpr,r=.5*i,a=.5*e;if(this.content.setPosition(a,r),this.content.setContentSize(n,s),!this.picStoreCreatePanel){var h=this.content.width,l=this.content.height-50*this.dpr;this.picStoreCreatePanel=new o.PicaBusinessStoreCreatePanel(this.scene,0,0,h,l,this.dpr,this.scale,this.key),this.picStoreCreatePanel.setHandler(new y.Handler(this,(function(){t.openMyStreet(),t.hideStoreCreatePanel()})),new y.Handler(this,(function(e){t.openSecondStorePanel(),t.hideStoreCreatePanel(),t.setSecondStore(e)})))}this.content.add(this.picStoreCreatePanel),this.picStoreCreatePanel.resetMask()},PicaBusinessStreetPanel.prototype.hideStoreCreatePanel=function(){this.content.remove(this.picStoreCreatePanel)},PicaBusinessStreetPanel.prototype.showSecondStorePanel=function(){var t=this,e=this.scaleWidth,i=this.scaleHeight,n=295*this.dpr,s=320*this.dpr,r=.5*i,a=.5*e;if(this.content.setPosition(a,r),this.content.setContentSize(n,s),!this.picSecondStorePanel){var h=this.content.width,l=this.content.height-50*this.dpr;this.picSecondStorePanel=new o.PicaBusinessStoreCreatePanel(this.scene,0,0,h,l,this.dpr,this.scale,this.key,!1),this.picSecondStorePanel.setHandler(new y.Handler(this,(function(){t.openStoreCreatePanel(),t.hideSecondStorePanel()})),new y.Handler(this,(function(e){t.render.renderEmitter(m.RENDER_PEER+"_"+t.key+"_querycreatestore",e.modelId)})))}this.content.add(this.picSecondStorePanel),this.picSecondStorePanel.resetMask()},PicaBusinessStreetPanel.prototype.hideSecondStorePanel=function(){this.content.remove(this.picSecondStorePanel)},PicaBusinessStreetPanel.prototype.showStreetListPanel=function(){var t=this,e=90*this.dpr,i=74*this.dpr;if(this.setContentSize(e,i),!this.picStreetListPanel){var n=this.content.width,s=this.content.height-50*this.dpr;this.picStreetListPanel=new a.PicaBusinessStreetListPanel(this.scene,0,0,n,s,this.dpr,this.scale,this.key,this.key2),this.picStreetListPanel.setHandler(new y.Handler(this,(function(){t.openStreetHistoryPanel(),t.hideStreetListPanel(),t.render.renderEmitter(m.RENDER_PEER+"_"+t.key+"_queryenterhistory")})),new y.Handler(this,(function(){t.openStreetRankingPanel(),t.hideStreetListPanel(),t.render.renderEmitter(m.RENDER_PEER+"_"+t.key+"_queryranklist")})),new y.Handler(this,(function(){t.hideStreetListPanel(),t.openMyStreet()})),new y.Handler(this,(function(e,i){t.render.renderEmitter(m.RENDER_PEER+"_"+t.key+"_querystreet",{storeby:e,storetype:i})})),new y.Handler(this,(function(e,i){t.render.renderEmitter(m.RENDER_PEER+"_"+t.key+"_queryenterroom",{roomid:e,password:i})})))}this.content.add(this.picStreetListPanel),this.picStreetListPanel.resetMask()},PicaBusinessStreetPanel.prototype.hideStreetListPanel=function(){this.content.remove(this.picStreetListPanel)},PicaBusinessStreetPanel.prototype.showStreetHistoryPanel=function(){var t=this,e=90*this.dpr,i=74*this.dpr;if(this.setContentSize(e,i),!this.picStreetHistoryPanel){var n=this.content.width,s=this.content.height-50*this.dpr;this.picStreetHistoryPanel=new h.PicaBusinessHistoryPanel(this.scene,0,0,n,s,this.dpr,this.scale,this.key,this.key2),this.picStreetHistoryPanel.setHandler(new y.Handler(this,(function(){t.hideStreetHistoryPanel(),t.openStoreStreetPanel()})))}this.content.add(this.picStreetHistoryPanel),this.picStreetHistoryPanel.resetMask()},PicaBusinessStreetPanel.prototype.hideStreetHistoryPanel=function(){this.content.remove(this.picStreetHistoryPanel)},PicaBusinessStreetPanel.prototype.showStreetRankingPanel=function(){var t=this,e=110*this.dpr,i=94*this.dpr;if(this.setContentSize(e,i),!this.picStreetRankingPanel){var n=this.content.width,s=this.content.height-50*this.dpr;this.picStreetRankingPanel=new l.PicaBusinessRankingPanel(this.scene,0,0,n,s,this.dpr,this.scale,this.key,this.key2),this.picStreetRankingPanel.setHandler(new y.Handler(this,(function(){t.hideStreetRankingPanel(),t.openStoreStreetPanel()})),new y.Handler(this,(function(e,i){t.openRankingDetailPanel(),t.hideStreetRankingPanel(),t.render.renderEmitter(m.RENDER_PEER+"_"+t.key+"_queryrankdetail",{key:e,type:i})})))}this.content.add(this.picStreetRankingPanel),this.picStreetRankingPanel.show(),this.picStreetRankingPanel.resetMask()},PicaBusinessStreetPanel.prototype.hideStreetRankingPanel=function(){this.content.remove(this.picStreetRankingPanel),this.picStreetRankingPanel.hide()},PicaBusinessStreetPanel.prototype.showRankingDetailPanel=function(){var t=this,e=90*this.dpr,i=74*this.dpr;if(this.setContentSize(e,i),!this.picRankingDetailPanel){var n=this.content.width,s=this.content.height-50*this.dpr;this.picRankingDetailPanel=new c.PicaBusinessRankingDetailPanel(this.scene,0,0,n,s,this.dpr,this.scale,this.key,this.key2),this.picRankingDetailPanel.setHandler(new y.Handler(this,(function(){t.hideRankingDetailPanel(),t.openStreetRankingPanel()})),new y.Handler(this,(function(e,i){t.hideRankingDetailPanel(),t.openRankRewardPanel(),t.render.renderEmitter(m.RENDER_PEER+"_"+t.key+"_queryrankreward",{key:e,type:i})})))}this.content.add(this.picRankingDetailPanel),this.picRankingDetailPanel.resetMask()},PicaBusinessStreetPanel.prototype.hideRankingDetailPanel=function(){this.content.remove(this.picRankingDetailPanel)},PicaBusinessStreetPanel.prototype.showRankRewardPanel=function(){var t=this,e=90*this.dpr,i=74*this.dpr;if(this.setContentSize(e,i),!this.picRankRewardPanel){var n=this.content.width,s=this.content.height-50*this.dpr;this.picRankRewardPanel=new p.PicaBusinessRankRewardPanel(this.scene,0,0,n,s,this.dpr,this.scale,this.key,this.key2),this.picRankRewardPanel.setHandler(new y.Handler(this,(function(){t.hideRankRewardPanel(),t.openRankingDetailPanel()})))}this.content.add(this.picRankRewardPanel),this.picRankRewardPanel.resetMask()},PicaBusinessStreetPanel.prototype.hideRankRewardPanel=function(){this.content.remove(this.picRankRewardPanel)},PicaBusinessStreetPanel.prototype.setContentSize=function(t,e){var i=this.scaleWidth,n=this.scaleHeight,s=295*this.dpr,r=n-t-e,o=t+.5*r,a=.5*i;this.content.setPosition(a,o),this.content.setContentSize(s,r)},PicaBusinessStreetPanel.prototype.OnCloseHandler=function(){this.render.renderEmitter(m.RENDER_PEER+"_"+this.key+"_hide")},PicaBusinessStreetPanel.prototype.onSelectItemHandler=function(t){},PicaBusinessStreetPanel.prototype.getRichLabel=function(t,e){return void 0===e&&(e="#2B4BB5"),"[stroke="+e+"][color="+e+"]"+t+":[/color][/stroke]"},PicaBusinessStreetPanel.prototype.getspaceStr=function(t){for(var e="",i=0;i<t;i++)e+=" ";return e},PicaBusinessStreetPanel}(d.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaComposePanel",(function(){return d}));var n,s=i(2),r=i(5),o=i(470),a=i(473),h=i(1),l=i(11),c=i(0),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaComposePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=h.ModuleName.PICACOMPOSE_NAME,i}return p(PicaComposePanel,t),PicaComposePanel.prototype.resize=function(e,i){t.prototype.resize.call(this,e,i),this.content.x=.5*e,this.content.y=.5*i,this.mGrideTable.resetMask(),this.materialGameScroll.refreshMask(),this.setSize(e,i)},PicaComposePanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicaComposePanel.prototype.addListen=function(){this.mInitialized&&this.makeBtn.on(String(r.ClickEvent.Tap),this.onMakeHandler,this)},PicaComposePanel.prototype.removeListen=function(){this.mInitialized&&this.makeBtn.off(String(r.ClickEvent.Tap),this.onMakeHandler,this)},PicaComposePanel.prototype.preload=function(){this.addAtlas(this.key,"compose/compose.png","compose/compose.json"),this.addAtlas(l.c.commonKey,l.d.commonUrl+".png",l.d.commonUrl+".json"),t.prototype.preload.call(this)},PicaComposePanel.prototype.init=function(){var e=this,i=this.scaleWidth,n=this.scaleHeight;this.content=this.scene.make.container(void 0,!1),this.content.setSize(i,n),this.add(this.content);var s=this.scene.make.graphics(void 0,!1);s.clear(),s.fillGradientStyle(7365356,7365356,13408757,13408757),s.fillRect(.5*-i,.5*-n,i,n);var h=this.scene.make.image({key:this.key,frame:"main_bg"});h.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.y=.5*-n+.5*h.height,h.setInteractive(new Phaser.Geom.Rectangle(0,0,this.cameraWidth,this.cameraHeight),Phaser.Geom.Rectangle.Contains),h.displayWidth=i,this.content.add([s,h]);var p=this.scene.make.image({key:this.key,frame:"title_bg"});p.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),p.y=.5*-n+23*this.dpr;var d=this.scene.make.text({x:0,y:p.y,text:c.i18n.t("compose.title"),style:{color:"#8B5603",fontSize:15*this.dpr,fontFamily:c.Font.DEFULT_FONT}}).setOrigin(.5);d.setFontStyle("bold"),this.content.add([p,d]);var y=new r.Button(this.scene,l.c.commonKey,"back_arrow","back_arrow");y.setPosition(.5*-i+20*this.dpr,.5*-n+30*this.dpr),y.on(r.ClickEvent.Tap,this.onBackHandler,this),this.content.add(y),this.mDetailDisplay=new a.DetailDisplay(this.scene,this.render),this.mDetailDisplay.y=-140*this.dpr,this.mDetailDisplay.setFixedScale(2*this.dpr/this.scale),this.content.add(this.mDetailDisplay),this.mDetailBubble=new m(this.scene,this.dpr),this.mDetailBubble.x=.5*-i,this.mDetailBubble.y=.5*n-360*this.dpr,this.content.add(this.mDetailBubble),this.makeBtn=new r.NineSliceButton(this.scene,Math.ceil(.5*i-60*this.dpr),Math.ceil(.5*n-310*this.dpr),106*this.dpr,40*this.dpr,l.c.commonKey,"yellow_btn",c.i18n.t("compose.make"),this.dpr,1,{left:12*this.dpr,top:12*this.dpr,right:12*this.dpr,bottom:12*this.dpr}),this.makeBtn.setTextStyle({fontSize:16*this.dpr,color:"#996600"}),this.content.add(this.makeBtn);var f=360*this.dpr,g=92*this.dpr;this.materialCon=this.scene.make.container(void 0,!1).setSize(f,g),this.content.add(this.materialCon),this.materialCon.setPosition(0,.5*n-230*this.dpr);var P=this.scene.make.image({x:0,y:0,key:this.key,frame:"sourcelist_bg"});P.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),P.displayWidth=i;var v=this.scene.make.text({x:0,y:.5*-g+12*this.dpr,text:c.i18n.t("compose.needMaterials"),style:{color:"#ffffff",fontSize:13*this.dpr,fontFamily:c.Font.DEFULT_FONT,wordWrap:{width:90*this.dpr,useAdvancedWrap:!0}}},!1).setOrigin(.5),b=this.scene.make.image({x:-10*this.dpr,y:v.y,key:this.key,frame:"sourcelist_title_1"});b.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var _=this.scene.make.image({x:10*this.dpr,y:v.y,key:this.key,frame:"sourcelist_title_1"});_.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var k=.5*-v.width-.5*b.width-10*this.dpr;b.setPosition(k,v.y),_.setPosition(-k,v.y).rotation=-Math.PI;var w=this.scene.make.image({x:0,y:v.y+12*this.dpr,key:this.key,frame:"separator"});w.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.materialCon.add([P,v,b,_,w]),this.materialGameScroll=new r.GameScroller(this.scene,{x:0,y:10*this.dpr,width:i,height:70*this.dpr,zoom:this.scale,align:2,orientation:1,dpr:this.dpr,space:10*this.dpr,padding:{left:10*this.dpr},cellupCallBack:function(t){e.onMaterialItemHandler(t)}}),this.materialCon.add(this.materialGameScroll),this.itemtips=new o.ItemInfoTips(this.scene,121*this.dpr,46*this.dpr,l.c.commonKey,"tips_bg",this.dpr),this.itemtips.setVisible(!1),this.content.add(this.itemtips);var x=this.scene.textures.getFrame(this.key,"bprint_bg_2"),T=x.width+10*this.dpr,C=x.height+12*this.dpr,S=190*this.dpr,I={x:0,y:.5*n-.5*S+20*this.dpr,table:{width:i,height:S,columns:2,cellWidth:T,cellHeight:C,reuseCellContainer:!0,zoom:this.scale},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.scene,s=t.item;return null===i&&(i=new u(n,e.key,e.dpr,e.scale)),i.setItemData(s),s&&e.mSelectItemData&&s.skill.id===e.mSelectItemData.skill.id&&(i.select=!0,e.mSelectItem=i),i}};this.mGrideTable=new r.GameGridTable(this.scene,I),this.mGrideTable.layout(),this.mGrideTable.on("cellTap",(function(t){t&&e.onSelectItemHandler(t)})),this.content.add(this.mGrideTable),this.resize(i,n),t.prototype.init.call(this),this.mShowData&&this.setComposeData(this.mShowData.skills)},PicaComposePanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaComposePanel.prototype.setComposeData=function(t){if(t&&t.length>0){this.mGrideTable.setItems(t);var e=this.mSelectItem?this.mSelectItem:this.mGrideTable.getCell(0).container;this.onSelectItemHandler(e)}},PicaComposePanel.prototype.setComposeDetialData=function(t){this.mDetailBubble.setDetailData(t.productName,t.productDes),this.setDetailDisplay(t),this.setMaterialItems(t.materials)},PicaComposePanel.prototype.setDetailDisplay=function(t){this.mDetailDisplay.loadSprite("loading_ui",c.Url.getUIRes(this.dpr,"loading_ui"),c.Url.getUIRes(this.dpr,"loading_ui"));var e=new s.op_client.OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE_ITEM_RESOURCE;if(e.animations=t.productAnimations,e.display=t.productDisplay,e.avatar=t.productAvatar,e.display)this.mDetailDisplay.loadDisplay(e);else if(e.avatar){var i=new Phaser.Geom.Point;i.x=0,i.y=20*this.dpr,this.mDetailDisplay.loadAvatar(e,2*this.dpr,i)}},PicaComposePanel.prototype.onSelectItemHandler=function(t){var e=t.itemData;this.mSelectItemData=t.itemData,this.makeBtn.enable=e.skill.active&&e.skill.qualified,this.mSelectItem&&(this.mSelectItem.select=!1),this.mSelectItem=t,t.select=!0,this.setComposeDetialData(e)},PicaComposePanel.prototype.setMaterialItems=function(t){var e=t.length,i=[];this.materialGameScroll.clearItems();for(var n=0;n<e;n++){var s=new y(this.scene,this.key,this.dpr);s.y=0,i.push(s),s.setItemData(t[n]),s.setData("itemData",t[n]),this.materialGameScroll.addItem(s)}this.materialGameScroll.Sort()},PicaComposePanel.prototype.onMaterialItemHandler=function(t){this.itemtips.setVisible(!0),this.itemtips.setItemData(t.itemData),this.itemtips.setTipsPosition(t,this.content,-10*this.dpr)},PicaComposePanel.prototype.onMakeHandler=function(){if(this.mSelectItemData){var t={text:[{text:c.i18n.t("compose.confirmation",{name:this.mSelectItemData.productName})}],title:[{text:c.i18n.t("compose.synthesis")}],button:[{text:c.i18n.t("common.cancel"),local:!0,param:0},{text:c.i18n.t("common.confirm"),local:!0,clickhandler:{key:this.key,clickfun:"onConfirmMakeHandler"},param:1}]};this.render.renderEmitter(h.ModuleName.PICACOMPOSE_NAME+"_showpanel",{panel:h.ModuleName.PICAMESSAGEBOX_NAME,data:t})}},PicaComposePanel.prototype.onConfirmMakeHandler=function(){this.render.renderEmitter(h.ModuleName.PICACOMPOSE_NAME+"_reqUseFormula",this.mSelectItemData.skill.id)},PicaComposePanel.prototype.onBackHandler=function(){this.render.renderEmitter(h.ModuleName.PICACOMPOSE_NAME+"_hide")},PicaComposePanel}(o.BasePanel),m=function(t){function DetailBubble(e,i){var n=t.call(this,e)||this;n.dpr=i,n.mDetailBubble=n.scene.make.graphics(void 0,!1);var s=198*i,r=96*i;return n.mDetailBubble=n.scene.make.graphics(void 0,!1),n.mDetailBubble.fillStyle(16777215,.1),n.mDetailBubble.fillRoundedRect(0,0,s,r),n.mItemName=n.scene.make.text({x:7*n.dpr,y:9*n.dpr,text:"道具名称道具名称",style:{fontSize:12*n.dpr,fontFamily:c.Font.DEFULT_FONT,color:"#8C55E1",align:"center"}}),n.mDesText=n.scene.make.text({x:8*i,y:30*i,style:{color:"#ffffff",fontSize:10*i,fontFamily:c.Font.DEFULT_FONT,wordWrap:{width:180*i,useAdvancedWrap:!0}}},!1),n.add([n.mDetailBubble,n.mItemName,n.mDesText]),n.setSize(s,r),n}return p(DetailBubble,t),DetailBubble.prototype.setDetailData=function(t,e){this.mItemName.setText(t),this.mDesText.setText(e),this.resize()},DetailBubble.prototype.resize=function(t,e){void 0===t&&(t=this.width);var i=this.mDesText.height+60*this.dpr;t===this.width&&i===this.height||(this.mDetailBubble.clear(),this.mDetailBubble.fillStyle(16777215,.1),this.mDetailBubble.fillRoundedRect(0,0,t,i),this.setSize(t,i))},DetailBubble}(Phaser.GameObjects.Container),u=function(t){function ComposeItem(e,i,n,s){var r=t.call(this,e)||this;r.zoom=1,r.dpr=n,r.key=i,r.zoom=s,r.bg=r.scene.make.image({key:r.key,frame:"bprint_bg_1"}),r.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),r.setSize(r.bg.width,r.bg.height),r.itemIcon=new o.DynamicImage(r.scene,0,0),r.itemIcon.scale=r.dpr/r.zoom;var a=r.width,h=r.height;return r.newIcon=r.scene.make.image({key:r.key,frame:"tag_new"}),r.newIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),r.newIcon.setPosition(.5*-a+3*n,.5*-h+3*n),r.newText=r.scene.make.text({x:r.newIcon.x,y:r.newIcon.y,text:"N",style:{fontSize:11*r.dpr,fontFamily:c.Font.DEFULT_FONT,color:"#ffffff",align:"center"}}).setOrigin(.5),r.qualityIcon=r.scene.make.image({key:r.key,frame:"tag_rank_a"}),r.qualityIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),r.qualityIcon.setPosition(.5*-a+.5*r.qualityIcon.width-2*n,.5*h-.5*r.qualityIcon.height),r.qualityTex=r.scene.make.text({x:r.qualityIcon.x,y:r.qualityIcon.y,text:"A",style:{fontSize:11*r.dpr,fontFamily:c.Font.DEFULT_FONT,color:"#ffffff",align:"center"}}).setOrigin(.5),r.qualifiedIcon=r.scene.make.image({key:r.key,frame:"tag_ready"},!1),r.qualifiedIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),r.qualifiedIcon.setOrigin(1).setPosition(.5*a-3*n,.5*h-3*n),r.lockbg=r.scene.make.image({key:r.key,frame:"bprint_mask"}),r.lockbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),r.lockIcon=r.scene.make.image({key:r.key,frame:"lock"}),r.lockIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),r.add([r.bg,r.itemIcon,r.newIcon,r.newText,r.qualityIcon,r.qualityTex,r.lockbg,r.lockIcon]),r}return p(ComposeItem,t),ComposeItem.prototype.setItemData=function(t){this.itemData=t;var e=t.skill,i=e.active;this.newIcon.visible=i,this.newText.visible=i,this.qualityIcon.visible=i,this.qualityTex.visible=i,this.qualityTex.text=e.quality,this.qualifiedIcon.visible=i&&e.qualified,this.lockbg.visible=!e.active,this.lockIcon.visible=!e.active,this.setQualityTexture(e.quality),e.display&&this.setItemIcon(e.display),this.select=!1},Object.defineProperty(ComposeItem.prototype,"select",{set:function(t){t?this.bg.setFrame("bprint_bg_2"):this.bg.setFrame("bprint_bg_1")},enumerable:!1,configurable:!0}),ComposeItem.prototype.setItemIcon=function(t){var e=this,i=c.Url.getOsdRes(t.texturePath);this.itemIcon.load(i,this,(function(){e.itemIcon.setPosition(0,0)}))},ComposeItem.prototype.setQualityTexture=function(t){this.qualityIcon.visible=!0,"A"===t?this.qualityIcon.setFrame("tag_rank_a"):"B"===t?this.qualityIcon.setFrame("tag_rank_b"):"C"===t?this.qualityIcon.setFrame("tag_rank_c"):this.qualityIcon.visible=!1},ComposeItem}(Phaser.GameObjects.Container),y=function(t){function ComposeMaterialItem(e,i,n){var s=t.call(this,e)||this;s.dpr=n,s.key=i;var a=s.scene.make.image({key:s.key,frame:"source_bg"});return a.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),s.itemIcon=new o.DynamicImage(e,0,0),s.itemCount=new r.BBCodeText(s.scene,0,0,"",{}).setOrigin(.5).setFontSize(11*n).setFontFamily(c.Font.NUMBER),s.add([a,s.itemIcon,s.itemCount]),s.setSize(a.width,a.height),s.itemCount.y=.5*s.height,s}return p(ComposeMaterialItem,t),ComposeMaterialItem.prototype.setItemData=function(t){var e=this;this.itemData=t,this.itemCount.text=this.getCountText(t.count,t.neededCount);var i=c.Url.getOsdRes(t.display.texturePath);this.itemIcon.load(i,this,(function(){e.itemIcon.scale=e.dpr,e.itemIcon.setPosition(0,0)}))},ComposeMaterialItem.prototype.getCountText=function(t,e){var i=t>=e?"#ffffff":"#ff0000";return"[stroke="+i+"][color="+i+"]"+t+"[/color][/stroke]/"+e},ComposeMaterialItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaCreateRolePanel",(function(){return d}));var n,s=i(5),r=i(0),o=i(1),a=i(470),h=i(471),l=i(11),c=i(2),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaCreateRolePanel(e){var i=t.call(this,e)||this;return i.suitDatasMap=new Map,i.curSuitMap=new Map,i.suitItemMap=new Map,i.setTween(!1),i.scene.add.container(0,0).add(i),i.scene.scale.on("resize",i.onResize,i),i.atlasNames=[l.d.uicommon],i.textures=[{atlasName:"Create_bg_texture",folder:"texture"},{atlasName:"Create_role_bg",folder:"texture"}],i.mMediator=i.render.mainPeer[o.ModuleName.PICACREATEROLE_NAME],i.key=o.ModuleName.PICACREATEROLE_NAME,i}return p(PicaCreateRolePanel,t),PicaCreateRolePanel.prototype.resize=function(t,e){var i=this.scaleWidth,n=this.scaleHeight;this.content.x=.5*i,this.content.y=.5*n},PicaCreateRolePanel.prototype.onShow=function(){this.showData&&this.showData.avatars&&this.setSuitDatas(this.showData.avatars)},PicaCreateRolePanel.prototype.onResize=function(t){this.resize(t.width,t.height)},PicaCreateRolePanel.prototype.setSuitDatas=function(t){var e=this;this.suitDatasMap.clear();for(var i=0,n=t;i<n.length;i++){var s=n[i],r=this.suitDatasMap.get(s.suitType);r||(r=[],this.suitDatasMap.set(s.suitType,r)),r.push(s)}this.suitDatasMap.forEach((function(t,i){"base"!==i&&"costume"!==i?e.suitItemMap.get(i).setSuitDatas(t):"base"===i?e.curSuitMap.set(i,t[1]):"costume"===i&&e.curSuitMap.set(i,t[0])})),this.onSkinHandler(void 0,this.skinCon.getAt(1)),this.onSixHandler(void 0,this.manButton)},PicaCreateRolePanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight;this.content=this.scene.make.container(void 0,!1),this.add(this.content),this.commonBackground=new a.CommonBackground(this.scene,0,0,e,i),this.mBottomBg=this.scene.make.image({key:"Create_bg_texture"}),this.mBottomBg.y=.5*i-.5*this.mBottomBg.height;var n=this.scene.make.image({key:"Create_role_bg"});n.y=-150*this.dpr,this.dragonbones=new a.UIDragonbonesDisplay(this.scene,this.render),this.dragonbones.scale=2.2*this.dpr,this.dragonbones.y=n.y+45*this.dpr,this.dragonbones.on("initialized",this.loadDragonbonesComplete,this);var r=new a.ButtonEventDispatcher(this.scene,0,0);r.setSize(130*this.dpr,130*this.dpr),r.enable=!0,r.on(s.ClickEvent.Tap,this.onAvatarClickHandler,this),r.y=this.dragonbones.y-65*this.dpr,this.backButton=new s.Button(this.scene,l.d.uicommon,"back_arrow"),this.backButton.x=.5*-e+.5*this.backButton.width+20*this.dpr,this.backButton.y=.5*-i+.5*this.backButton.height+23*this.dpr,this.backButton.on(s.ClickEvent.Tap,this.onBackHandler,this),this.content.add([this.commonBackground,this.mBottomBg,n,this.dragonbones,r]),this.createSixCon(),this.createSuitCon(),t.prototype.init.call(this),this.resize(0,0)},PicaCreateRolePanel.prototype.createSixCon=function(){this.sixCon=this.scene.make.container(void 0,!1),this.sixCon.y=70*this.dpr,this.manButton=new a.ToggleButton(this.scene,0,0,l.d.uicommon,"Create_gender_uncheck","Create_gender_select",this.dpr),this.manButton.on(s.ClickEvent.Tap,this.onSixHandler,this),this.manIcon=this.scene.make.image({key:l.d.uicommon,frame:"Create_gender_boy"}),this.manButton.add(this.manIcon),this.manButton.x=-60*this.dpr,this.manButton.y=-60*this.dpr,this.womanButton=new a.ToggleButton(this.scene,0,0,l.d.uicommon,"Create_gender_uncheck","Create_gender_select",this.dpr),this.womanButton.on(s.ClickEvent.Tap,this.onSixHandler,this),this.womanIcon=this.scene.make.image({key:l.d.uicommon,frame:"Create_gender_girl"}),this.womanButton.add(this.womanIcon),this.womanButton.x=-this.manButton.x,this.womanButton.y=this.manButton.y,this.nextButton=new s.NineSliceButton(this.scene,0,70*this.dpr,191*this.dpr,55*this.dpr,l.d.uicommon,"yellow_btn_normal",r.i18n.t("creatrole.next"),this.dpr,this.scale,r.UIHelper.button(this.dpr)),this.nextButton.setTextStyle(r.UIHelper.brownishStyle(this.dpr,23)),this.nextButton.on(s.ClickEvent.Tap,this.onNextHandler,this),this.sixCon.add([this.manButton,this.womanButton,this.nextButton]),this.content.add(this.sixCon)},PicaCreateRolePanel.prototype.createSuitCon=function(){var t=-40*this.dpr,e=-115*this.dpr;this.skinCon=this.scene.make.container(void 0,!1);for(var i=0;i<5;i++){var n=i+1,o="Create_complexion_"+n,a=new s.Button(this.scene,l.d.uicommon,o);a.name=n+"",a.y=t,a.x=e,a.on(s.ClickEvent.Tap,this.onSkinHandler,this),this.skinCon.add(a),e+=25*this.dpr+32*this.dpr}this.selectSkinBg=this.scene.make.image({key:l.d.uicommon,frame:"Create_complexion_select"}),this.skinCon.add(this.selectSkinBg),t+=56*this.dpr,this.suitCon=this.scene.make.container(void 0,!1);var h=["hair","eye","mouse"],c=[r.i18n.t("creatrole.hair"),r.i18n.t("creatrole.eye"),r.i18n.t("creatrole.mouth")];for(i=0;i<h.length;i++){var p=h[i],d=c[i],u=new m(this.scene,264*this.dpr,33*this.dpr,this.dpr,p,d);u.setHandler(new r.Handler(this,this.onSuitDataHandler)),u.y=t,t+=60*this.dpr,this.suitCon.add(u),this.suitItemMap.set(p,u)}this.enterButton=new s.NineSliceButton(this.scene,0,t+48*this.dpr,191*this.dpr,55*this.dpr,l.d.uicommon,"yellow_btn_normal",r.i18n.t("creatrole.gointo"),this.dpr,this.scale,r.UIHelper.button(this.dpr)),this.enterButton.setTextStyle(r.UIHelper.brownishStyle(this.dpr,23)),this.enterButton.setFontStyle("bold"),this.enterButton.on(s.ClickEvent.Tap,this.onSubmitHandler,this),this.suitCon.add([this.skinCon,this.enterButton])},PicaCreateRolePanel.prototype.onSubmitHandler=function(){var t=[];this.curSuitMap.forEach((function(e,i){t.push(e.id)})),this.mediator.submit(this.mgender,t)},PicaCreateRolePanel.prototype.onNextHandler=function(){this.suitCon.visible=!0,this.content.add(this.suitCon),this.content.remove(this.sixCon),this.content.add(this.backButton)},PicaCreateRolePanel.prototype.onAvatarClickHandler=function(){var t=["walk","run","greet01"],e={name:t[Math.floor(Math.random()*t.length)],flip:!1,times:1,playingQueue:{name:"idle",playTimes:-1}};this.dragonbones.play(e)},PicaCreateRolePanel.prototype.onSixHandler=function(t,e){this.manButton===e?(this.mgender=c.op_def.Gender.Male,this.womanButton.isOn=!1):this.womanButton===e&&(this.mgender=c.op_def.Gender.Female,this.manButton.isOn=!1),e.isOn=!0,this.setSixedSuitsData(this.mgender)},PicaCreateRolePanel.prototype.setSixedSuitsData=function(t){var e=t===c.op_def.Gender.Female?3:0,i=t===c.op_def.Gender.Female?2:0,n=t===c.op_def.Gender.Female?3:1;this.suitItemMap.get("hair").setInexed(e),this.suitItemMap.get("eye").setInexed(i),this.suitItemMap.get("mouse").setInexed(n),this.displayAvatar()},PicaCreateRolePanel.prototype.onBackHandler=function(){this.suitCon.parentContainer&&(this.suitCon.visible=!1,this.content.remove(this.suitCon)),this.content.add(this.sixCon),this.content.remove(this.backButton)},PicaCreateRolePanel.prototype.onSkinHandler=function(t,e){var i=Number(e.name)-1,n=this.suitDatasMap.get("base")[i];this.curSuitMap.set("base",n),this.selectSkinBg.x=e.x,this.selectSkinBg.y=e.y,this.displayAvatar()},PicaCreateRolePanel.prototype.onSuitDataHandler=function(t,e){this.curSuitMap.set(t,e),this.suitCon.visible&&this.displayAvatar()},PicaCreateRolePanel.prototype.displayAvatar=function(){var t=Array.from(this.curSuitMap.values()),e=this.creatAvatars(t);this.dragonbones.load({id:0,avatar:e}),this.dragonbones.startLoad()},PicaCreateRolePanel.prototype.loadDragonbonesComplete=function(){this.dragonbones.play({name:"idle",flip:!1})},PicaCreateRolePanel.prototype.creatAvatars=function(t){for(var e=[],i=0,n=t;i<n.length;i++){var s=n[i],r={id:s.id,suit_type:s.suitType,slot:s.slot,tag:s.tag,sn:s.sn};e.push(r)}return o.AvatarSuitType.createHasBaseAvatar(e)},Object.defineProperty(PicaCreateRolePanel.prototype,"mediator",{get:function(){if(this.mMediator)return this.mMediator},enumerable:!1,configurable:!0}),PicaCreateRolePanel}(h.PicaBasePanel),m=function(t){function SelectSuitAvatarItem(e,i,n,s,r,o){var a=t.call(this,e)||this;return a.indexed=0,a.setSize(i,n),a.dpr=s,a.tag=r,a.text=o,a.init(),a}return p(SelectSuitAvatarItem,t),SelectSuitAvatarItem.prototype.setSuitDatas=function(t){this.suitDatas=t},SelectSuitAvatarItem.prototype.setInexed=function(t){this.indexed=t,this.updateCurrentSuitData()},SelectSuitAvatarItem.prototype.setHandler=function(t){this.send=t},SelectSuitAvatarItem.prototype.init=function(){this.leftButton=new s.Button(this.scene,l.d.uicommon,"Create_arrow_left"),this.leftButton.x=.5*-this.width+.5*this.leftButton.width,this.leftButton.on(s.ClickEvent.Tap,this.onLeftButtonHandler,this),this.midBackground=this.scene.make.image({key:l.d.uicommon,frame:"Create_name_bg"}),this.nameTex=this.scene.make.text({text:"",style:r.UIHelper.whiteStyle(this.dpr,18)}).setOrigin(.5),this.rightButton=new s.Button(this.scene,l.d.uicommon,"Create_arrow_right"),this.rightButton.x=.5*this.width-.5*this.rightButton.width,this.rightButton.on(s.ClickEvent.Tap,this.onRightButtonHandler,this),this.add([this.leftButton,this.midBackground,this.nameTex,this.rightButton])},SelectSuitAvatarItem.prototype.onLeftButtonHandler=function(){this.indexed--,-1===this.indexed&&(this.indexed=this.suitDatas.length-1),this.updateCurrentSuitData()},SelectSuitAvatarItem.prototype.onRightButtonHandler=function(){this.indexed++,this.indexed===this.suitDatas.length&&(this.indexed=0),this.updateCurrentSuitData()},SelectSuitAvatarItem.prototype.updateCurrentSuitData=function(){var t=this.suitDatas[this.indexed];this.nameTex.text=this.text+(this.indexed+1),this.send&&this.send.runWith([this.tag,t])},SelectSuitAvatarItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaDecorateControlPanel",(function(){return h}));var n,s=i(5),r=i(470),o=i(1),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicaDecorateControlPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.mSaving=!1,i.key=o.ModuleName.PICADECORATECONTROL_NAME,i}return a(PicaDecorateControlPanel,t),PicaDecorateControlPanel.prototype.addListen=function(){this.mInitialized&&(this.mExitBtn.on(s.ClickEvent.Tap,this.onExitHandler,this),this.mRecycleAllBtn.on(s.ClickEvent.Tap,this.onRecycleAllHandler,this),this.mRedoBtn.on(s.ClickEvent.Tap,this.onRedoHandler,this),this.mFurniBtn.on(s.ClickEvent.Tap,this.onShowFurniHandler,this),this.mSaveBtn.on(s.ClickEvent.Tap,this.onSaveHandler,this),this.mDoorBtn.on(s.ClickEvent.Tap,this.onGetDoorHandler,this))},PicaDecorateControlPanel.prototype.removeListen=function(){this.mInitialized&&(this.mExitBtn.off(s.ClickEvent.Tap,this.onExitHandler,this),this.mRecycleAllBtn.off(s.ClickEvent.Tap,this.onRecycleAllHandler,this),this.mRedoBtn.off(s.ClickEvent.Tap,this.onRedoHandler,this),this.mFurniBtn.off(s.ClickEvent.Tap,this.onShowFurniHandler,this),this.mSaveBtn.off(s.ClickEvent.Tap,this.onSaveHandler,this),this.mDoorBtn.off(s.ClickEvent.Tap,this.onGetDoorHandler,this))},PicaDecorateControlPanel.prototype.resize=function(e,i){this.setSize(e,131*this.dpr),this.mBackground.clear(),this.mBackground.fillStyle(0,.6),this.mBackground.fillRect(0,0,this.width,this.height),t.prototype.resize.call(this,e,i)},PicaDecorateControlPanel.prototype.preload=function(){this.addAtlas(this.key,"decorate_control/decorate_control.png","decorate_control/decorate_control.json"),t.prototype.preload.call(this)},PicaDecorateControlPanel.prototype.init=function(){var e=this.scene.cameras.main.width,i=this.scene.cameras.main.height;this.mBackground=this.scene.make.graphics(void 0,!1),this.mTopBtns=[],this.mExitBtn=new s.Button(this.scene,this.key,"exitBtn.png"),this.mRecycleAllBtn=new s.Button(this.scene,this.key,"recycleAllBtn.png"),this.mRedoBtn=new s.Button(this.scene,this.key,"redoBtn.png"),this.mFurniBtn=new s.Button(this.scene,this.key,"furniBtn.png"),this.mSaveBtn=new s.Button(this.scene,this.key,"saveBtn.png"),this.mDoorBtn=new s.Button(this.scene,this.key,"doorBtn.png"),this.mDoorBtn.setPosition(10*this.dpr+.5*this.mDoorBtn.width,83*this.dpr+.5*this.mDoorBtn.height),this.mStairBtn=new s.Button(this.scene,this.key,"stairBtn.png"),this.mStairBtn.setPosition(64*this.dpr+.5*this.mStairBtn.width,83*this.dpr+.5*this.mStairBtn.height),this.mTopBtns=[this.mExitBtn,this.mRecycleAllBtn,this.mRedoBtn,this.mFurniBtn,this.mSaveBtn],this.add(this.mBackground),this.add(this.mTopBtns),this.add([this.mDoorBtn,this.mStairBtn]);var n=this.render.uiScale,r=e-20*this.dpr*n;this.mTopBtns.map((function(t){return r-=t.width*n}));for(var o=r/(this.mTopBtns.length-1)/n,a=0;a<this.mTopBtns.length;a++)this.mTopBtns[a].x=a>0?o+.5*this.mTopBtns[a-1].width+this.mTopBtns[a-1].x+.5*this.mTopBtns[a].width:10*this.dpr+.5*this.mTopBtns[a].width,this.mTopBtns[a].y=11*this.dpr+.5*this.mTopBtns[a].height;this.resize(e,i),this.mSaving=!1,t.prototype.init.call(this)},PicaDecorateControlPanel.prototype.onExitHandler=function(){this.mSaving||(this.mSaving=!0,this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_exit"))},PicaDecorateControlPanel.prototype.onRecycleAllHandler=function(){this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_recycleAll")},PicaDecorateControlPanel.prototype.onRedoHandler=function(){this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_redo")},PicaDecorateControlPanel.prototype.onShowFurniHandler=function(){this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_showFurni")},PicaDecorateControlPanel.prototype.onSaveHandler=function(){this.mSaving||(this.mSaving=!0,this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_save"))},PicaDecorateControlPanel.prototype.onGetDoorHandler=function(){this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_getDoor")},PicaDecorateControlPanel}(r.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaEffectMgrPanel",(function(){return l}));var n,s=i(11),r=i(1),o=i(471),a=i(502),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaEffectMgrPanel(e){var i=t.call(this,e)||this;return i.tempQueue=new Map,i.key=r.ModuleName.PICAEFFECTMGR_NAME,i.atlasNames=[s.d.effectcommon],i}return h(PicaEffectMgrPanel,t),PicaEffectMgrPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;this.content.x=n/2,this.content.y=s/2,t.prototype.resize.call(this,n,s),this.setSize(n,s)},PicaEffectMgrPanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight;this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.add(this.content),this.furniEffectPanel=new a.PicaFurniUnlockEffectPanel(this.scene,this.render,e,i,this.key,this.dpr),this.content.add(this.furniEffectPanel),this.resize(0,0),t.prototype.init.call(this)},PicaEffectMgrPanel.prototype.play=function(t,e){if(this.mInitialized)"unlock"===e&&this.furniEffectPanel.play(t);else{var i=this.tempQueue.get(e);i=i?i.concat(t):t,this.tempQueue.set(e,i)}},PicaEffectMgrPanel.prototype.onShow=function(){var t=this;this.tempQueue.size>0&&this.tempQueue.forEach((function(e,i){t.play(e,i)}))},PicaEffectMgrPanel}(o.PicaBasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaElementStoragePanel",(function(){return c}));var n,s=i(617),r=i(5),o=i(470),a=i(1),h=i(0),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaElementStoragePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.mExpaned=!0,i.mItemNum=32,i.key=a.ModuleName.PICAELEMENTSTORAGE_NAME,i.setTween(!1),i.dpr/=2,i}return l(PicaElementStoragePanel,t),PicaElementStoragePanel.prototype.show=function(e){t.prototype.show.call(this,e),this.mInitialized&&this.setPackageNum(1)},PicaElementStoragePanel.prototype.resize=function(t){var e=this.render.getSize();if(this.scale=this.dpr,this.render.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE){this.setSize(341,450),this.x=e.width-this.width*this.dpr-10,this.y=e.height-this.height*this.dpr>>1,this.mBackground.resize(this.width,this.height),this.mBackground.x=this.mBackground.width>>1,this.mBackground.y=this.mBackground.height>>1,this.mBorder.resize(327,423),this.mBorder.x=7+(this.mBorder.width>>1),this.mBorder.y=19+(this.mBorder.height>>1),this.mSearchInput.x=145,this.mSearchInput.y=40,this.mDragBtn.x=-this.mDragBtn.height,this.mDragBtn.y=this.height>>1;for(var i=this.mProps.length,n=0;n<i;n++)this.mProps[n].x=n%4*60+20,this.mProps[n].y=60*Math.floor(n/4)+80}else{this.setSize(510,329),this.mBackground.resize(this.width,this.height),this.mBackground.x=this.mBackground.width>>1,this.mBackground.y=this.mBackground.height>>1,this.mBorder.resize(496,303),this.mBorder.x=7+(this.mBorder.width>>1),this.mBorder.y=19+(this.mBorder.height>>1),this.mSearchInput.x=270,this.mSearchInput.y=33,this.x=e.width-this.width*this.dpr>>1,this.y=e.height-this.height*this.dpr-10,this.mDragBtn.x=this.width>>1,this.mDragBtn.y=-this.mDragBtn.height>>1;for(i=this.mProps.length,n=0;n<i;n++)this.mProps[n].x=n%8*60+20,this.mProps[n].y=60*Math.floor(n/8)+80}this.mPrePageBtn.y=this.height>>1,this.mNextPageBtn.x=this.width,this.mNextPageBtn.y=this.height>>1,this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,this.width,this.height),Phaser.Geom.Rectangle.Contains)},PicaElementStoragePanel.prototype.addListen=function(){t.prototype.addListen.call(this),this.mBackground&&this.mBackground.on("pointerout",this.onPointerOutHandler,this),this.mDragBtn&&this.mDragBtn.on("pointerup",this.switchExpand,this),this.mPrePageBtn&&this.mPrePageBtn.on("pointerup",this.onPrePageHandler,this),this.mNextPageBtn&&this.mNextPageBtn.on("pointerup",this.onNextPageHandler,this),this.mCloseBtn&&this.mCloseBtn.on("pointerup",this.onCloseHandler,this),this.scene&&(this.scene.input.on("dragstart",this.onDragStartHandler,this),this.scene.input.on("dragend",this.onDragEndHandler,this),this.scene.input.on("drag",this.onDragHandler,this))},PicaElementStoragePanel.prototype.removeListen=function(){t.prototype.removeListen.call(this),this.mBackground&&this.mBackground.off("pointerout",this.onPointerOutHandler,this),this.mDragBtn&&this.mDragBtn.off("pointerup",this.switchExpand,this),this.mPrePageBtn&&this.mPrePageBtn.off("pointerup",this.onPrePageHandler,this),this.mNextPageBtn&&this.mNextPageBtn.off("pointerup",this.onNextPageHandler,this),this.mCloseBtn&&this.mCloseBtn.off("pointerup",this.onCloseHandler,this),this.scene&&(this.scene.input.off("dragstart",this.onDragStartHandler,this),this.scene.input.off("dragend",this.onDragEndHandler,this),this.scene.input.off("drag",this.onDragHandler,this))},PicaElementStoragePanel.prototype.setProps=function(t){var e=t.items;this.clearItem();for(var i=0;i<e.length;i++){if(i>=this.mProps.length)return;this.mProps[i].setProp(e[i])}},PicaElementStoragePanel.prototype.expand=function(){if(!this.mExpaned){var t=this.render.getSize(),e=null;e=this.render.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE?{x:t.width-this.width*this.dpr-10}:{y:t.height-this.height*this.dpr-10},this.scene.tweens.add({targets:this,duration:200,ease:"Linear",props:e}),this.remove(this.mDragBtn),this.add([this.mPrePageBtn,this.mNextPageBtn]),this.mExpaned=!0}},PicaElementStoragePanel.prototype.collapse=function(){if(this.mExpaned){var t=this.render.getSize(),e=null;e=this.render.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE?{x:t.width}:{y:t.height},this.scene.tweens.add({targets:this,duration:200,ease:"Linear",props:e}),this.addAt(this.mDragBtn,0),this.remove([this.mPrePageBtn,this.mNextPageBtn]),this.mExpaned=!1}},PicaElementStoragePanel.prototype.destroy=function(){this.scene&&(this.scene.input.off("dragstart",this.onDragStartHandler,this),this.scene.input.off("dragend",this.onDragEndHandler,this),this.scene.input.off("drag",this.onDragHandler,this)),t.prototype.destroy.call(this)},PicaElementStoragePanel.prototype.preload=function(){this.scene.load.image(h.Border.getName(),h.Border.getPNG()),this.scene.load.image("button",h.Url.getRes("ui/common/button.png")),this.scene.load.image("prop_background",h.Url.getRes("ui/common/prop_background.png")),this.scene.load.atlas("slip",h.Url.getRes("ui/bag/slip.png"),h.Url.getRes("ui/bag/slip.json")),this.mScene.load.atlas("clsBtn",h.Url.getRes("ui/common/common_clsBtn.png"),h.Url.getRes("ui/common/common_clsBtn.json")),this.scene.load.image(h.Background.getName(),h.Background.getPNG()),t.prototype.preload.call(this)},PicaElementStoragePanel.prototype.init=function(){this.mBackground=new o.NinePatch(this.scene,0,0,this.width,this.height,h.Background.getName(),null,h.Background.getConfig()),this.mBorder=new o.NinePatch(this.scene,7,19,327,423,h.Border.getName(),null,h.Border.getConfig()),this.mSearchInput=new r.InputText(this.scene,145,40,210,26,{type:"input",fontSize:"14px",color:"#808080",placeholder:"输入关键词进行搜索"});this.mDragBtn=new r.NineSliceButton(this.scene,0,-20,80,40,"button","","物件容器",this.dpr,this.scale,{left:4,top:4,right:4,bottom:4}),this.mPrePageBtn=this.scene.make.sprite({key:"slip"},!1),this.mPrePageBtn.setInteractive(),this.mNextPageBtn=this.scene.make.sprite({key:"slip"},!1).setFlipX(!0),this.mNextPageBtn.setInteractive(),this.mProps=[],this.add([this.mBackground,this.mBorder,this.mSearchInput]);for(var e=0;e<this.mItemNum;e++){var i=new s.Item(this.scene);this.mProps[e]=i}this.add(this.mProps),this.add([this.mPrePageBtn,this.mNextPageBtn]),this.mCloseBtn=this.scene.make.image({key:"clsBtn",frame:"btn_normal"},!1).setInteractive().setScale(2),this.add(this.mCloseBtn),t.prototype.init.call(this),this.resize(),this.expand()},PicaElementStoragePanel.prototype.onPrePageHandler=function(){this.setPackageNum(this.mPacgeNum-1)},PicaElementStoragePanel.prototype.onNextPageHandler=function(){this.setPackageNum(this.mPacgeNum+1)},PicaElementStoragePanel.prototype.setPackageNum=function(t){this.mPacgeNum=t<1?1:t,this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_queryElement",{page:this.mPacgeNum,perPage:32})},PicaElementStoragePanel.prototype.switchExpand=function(){this.mExpaned?this.collapse():this.expand()},PicaElementStoragePanel.prototype.onSelectedHandler=function(){},PicaElementStoragePanel.prototype.onClick=function(t){},PicaElementStoragePanel.prototype.onDragStartHandler=function(t,e,i,n){var r=e.parentContainer;r instanceof s.Item&&(this.mDragData=r.prop),this.mDragImage||(this.mDragImage=this.scene.make.image(void 0,!1),this.add(this.mDragImage)),this.mDragImage.x=r.x,this.mDragImage.y=r.y,this.mDragImage.setTexture(e.texture.key),this.mDragging=!0},PicaElementStoragePanel.prototype.onDragEndHandler=function(){this.mDragImage&&(this.mDragImage.setTexture(void 0),this.mDragging=!1)},PicaElementStoragePanel.prototype.onDragHandler=function(t,e,i,n){this.mDragImage&&(this.mDragImage.x+=t.x-t.prevPosition.x,this.mDragImage.y+=t.y-t.prevPosition.y)},PicaElementStoragePanel.prototype.onPointerOutHandler=function(){this.mDragImage&&this.mDragging&&(this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_selectedElement",this.mDragData),this.mDragImage.setTexture(void 0),this.mDragging=!1)},PicaElementStoragePanel.prototype.clearItem=function(){this.mProps&&this.mProps.map((function(t){return t.clear()}))},PicaElementStoragePanel.prototype.onCloseHandler=function(){this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_hide")},PicaElementStoragePanel}(o.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaElevatorPanel",(function(){return c}));var n,s=i(5),r=i(470),o=i(11),a=i(1),h=i(0),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaElevatorPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=a.ModuleName.PICAELEVATOR_NAME,i}return l(PicaElevatorPanel,t),PicaElevatorPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,n,s),this.setSize(n,s),this.mBackground.clear(),this.mBackground.fillStyle(0,.5),this.mBackground.fillRoundedRect(-this.x,-this.y,n,s),this.content.x=.5*n,this.content.y=.5*s,this.mGameGrid.resetMask(),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,n,s),Phaser.Geom.Rectangle.Contains)},PicaElevatorPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen(),this.setElevtorDataList(this.mShowData[0])):this.preload())},PicaElevatorPanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.OnClosePanel,this)},PicaElevatorPanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.OnClosePanel,this)},PicaElevatorPanel.prototype.preload=function(){this.addAtlas(o.c.commonKey,o.d.commonUrl+".png",o.d.commonUrl+".json"),this.addAtlas(o.c.common2Key,o.d.common2Url+".png",o.d.common2Url+".json"),t.prototype.preload.call(this)},PicaElevatorPanel.prototype.init=function(){var e=this;this.mBackground=this.scene.make.graphics(void 0,!1),this.add(this.mBackground);var i=295*this.dpr,n=405*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(i,n),this.add(this.content),this.bg=new s.NineSlicePatch(this.scene,0,0,i,n,o.c.commonKey,"bg",{left:30*this.dpr,top:30*this.dpr,bottom:30*this.dpr,right:30*this.dpr}),this.content.add(this.bg),this.closeBtn=new s.Button(this.scene,o.c.commonKey,"close","close"),this.closeBtn.setPosition(.5*this.bg.width-5*this.dpr,.5*-this.bg.height+5*this.dpr),this.content.add(this.closeBtn);var r={x:0,y:0,table:{width:i-20*this.dpr,height:n-30*this.dpr,columns:1,cellWidth:i-20*this.dpr,cellHeight:85*this.dpr,reuseCellContainer:!0,zoom:this.scale},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,i){t.scene;var n=e.mGameGrid.items.length-t.index,s=t.item;return null===i&&(i=new p(e.scene,e.key,e.dpr)),i.setFloorData(s,n),i}};this.mGameGrid=new s.GameGridTable(this.scene,r),this.mGameGrid.layout(),this.mGameGrid.on("cellTap",(function(t){e.onSelectItemHandler(t.floorData)})),this.content.add(this.mGameGrid),this.resize(),t.prototype.init.call(this)},PicaElevatorPanel.prototype.setElevtorDataList=function(t){var e=t.button.reverse();this.mGameGrid.setItems(e),this.mGameGrid.setT(1)},PicaElevatorPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaElevatorPanel.prototype.OnClosePanel=function(){this.render.renderEmitter(a.RENDER_PEER+this.key+"_hide")},PicaElevatorPanel.prototype.onSendHandler=function(){},PicaElevatorPanel.prototype.onSelectItemHandler=function(t){var e=this.showData[0];t.text.split("#")[1];this.render.renderEmitter(a.RENDER_PEER+this.key+"_queryui",{uiId:e.id,componentId:t.node.id})},PicaElevatorPanel}(r.BasePanel),p=function(t){function ElevatorItem(e,i,n){var a=t.call(this,e)||this;return a.key=i,a.dpr=n,a.bg=new r.DynamicImage(e,0,0),a.add(a.bg),a.setSize(268*n,81*n),a.namebg=new s.NineSlicePatch(a.scene,0,0,82*n,22*n,o.c.common2Key,"floor_title_bg",{left:15*a.dpr,top:0*a.dpr,right:15*a.dpr,bottom:0*a.dpr},void 0,void 0,0),a.namebg.x=.5*a.width-.5*a.namebg.width-10*n,a.namebg.y=.5*-a.height+.5*a.namebg.height+10*n,a.add(a.namebg),a.nameTex=a.scene.make.text({x:a.namebg.x,y:a.namebg.y,text:"",style:{color:"#22E2FF",fontFamily:h.Font.DEFULT_FONT,fontSize:12*a.dpr}}).setOrigin(.5),a.add(a.nameTex),a.levelbg=a.scene.make.image({key:o.c.common2Key,frame:"floor_number_unlock"}),a.levelbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),a.levelbg.x=.5*-a.width+.5*a.levelbg.width+5*n,a.levelbg.y=.5*a.height-.5*a.levelbg.height-5*n,a.add(a.levelbg),a.levelTex=a.scene.make.text({x:a.levelbg.x,y:a.levelbg.y,text:"",style:{color:"#FAD555",fontFamily:h.Font.NUMBER,fontSize:17*a.dpr}}).setOrigin(.5),a.add(a.levelTex),a}return l(ElevatorItem,t),ElevatorItem.prototype.setFloorData=function(t,e){this.floorData=t;var i=t.text.split("#");"false"!==i[1]?(this.levelbg.setFrame("floor_number_unlock"),this.levelTex.setColor("#FAD555"),this.nameTex.setColor("#22E2FF")):(this.levelbg.setFrame("floor_number_lock"),this.levelTex.setColor("#BDBDBD"),this.nameTex.setColor("#DDDDDD")),this.levelTex.text=e+h.i18n.t("picelevator.floor"),this.nameTex.text=i[0];var n=t.tips.lastIndexOf("/"),s=t.tips.slice(n+1,t.tips.length),r=t.tips.slice(0,n+1),o=h.Url.getOsdRes(r+s+"_"+this.dpr+"x.png");this.bg.load(o,this,(function(){}))},ElevatorItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaEquipUpgradePanel",(function(){return p}));var n,s=i(470),r=i(5),o=i(1),a=i(11),h=i(0),l=i(503),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaEquipUpgradePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.commonkey="common_key",i.equipItems=[],i.key=o.ModuleName.PICAEQUIPUPGRADE_NAME,i}return c(PicaEquipUpgradePanel,t),PicaEquipUpgradePanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,e,i),this.setSize(n,s),this.bg.x=n/2,this.bg.y=s/2,this.tilteName.x=this.bg.x,this.tilteName.y=this.bg.y-this.bg.height/2,this.titlebg.x=this.bg.x,this.titlebg.y=this.bg.y-this.bg.height/2,this.closeBtn.x=this.bg.x+this.bg.width/2-10*this.dpr,this.closeBtn.y=this.bg.y-this.bg.height/2+10*this.dpr,this.blackBg.clear(),this.blackBg.fillStyle(0,.5),this.blackBg.fillRoundedRect(-this.x,-this.y,n,s),this.add([this.blackBg,this.bg,this.closeBtn,this.titlebg,this.tilteName])},PicaEquipUpgradePanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.refreshData(),this.addListen()):this.preload())},PicaEquipUpgradePanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.OnClosePanel,this)},PicaEquipUpgradePanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.OnClosePanel,this)},PicaEquipUpgradePanel.prototype.preload=function(){this.commonkey=a.c.commonKey,this.addAtlas(this.key,"equip_upgrade/mine_eqpm.png","equip_upgrade/mine_eqpm.json"),this.addAtlas(a.c.commonKey,a.d.commonUrl+".png",a.d.commonUrl+".json"),t.prototype.preload.call(this)},PicaEquipUpgradePanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight;this.setSize(e,i),this.blackBg=this.scene.make.graphics(void 0,!1),this.blackBg.clear(),this.blackBg.fillStyle(0,.5),this.blackBg.fillRoundedRect(0,0,e,i),this.blackBg.setInteractive(new Phaser.Geom.Rectangle(0,0,this.scene.cameras.main.width,this.scene.cameras.main.height),Phaser.Geom.Rectangle.Contains),this.bg=new r.NinePatch(this.scene,0,0,300*this.dpr,300*this.dpr,this.commonkey,"bg",void 0,void 0,{left:40,top:40,bottom:40,right:40});var n=.5*-this.bg.height;this.titlebg=this.scene.make.image({x:0,y:n,key:this.key,frame:"titlebg"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.tilteName=this.scene.make.text({x:0,y:n,text:h.i18n.t("equipupgrade.title"),style:{color:"#8F4300",fontSize:15*this.dpr,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(.5,0),this.tilteName.setFontStyle("bold"),this.closeBtn=this.scene.make.image({x:.5*this.bg.width-5*this.dpr,y:n+5*this.dpr,key:this.commonkey,frame:"close"}),this.closeBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.tilteName.setStroke("#8F4300",1),this.closeBtn.setInteractive(),this.add([this.blackBg,this.bg,this.closeBtn,this.titlebg,this.tilteName]),this.resize(this.scene.cameras.main.width,this.scene.cameras.main.height),t.prototype.init.call(this)},PicaEquipUpgradePanel.prototype.setEquipDatas=function(t){if(this.content=t,this.mInitialized){var e=this.scaleWidth,i=this.scaleHeight,n=t.mineEquipments,s=175*this.dpr*n.length-(n.length>=2?40*(n.length-2):0),r=155*this.dpr;this.resetPosition(this.bg.width,s);for(var o=.5*-s+100*this.dpr,a=0,h=0,c=n;h<c.length;h++){var p=c[h];p.isblue=a%2!=0;var d=new l.PicaEquipUpgradeItem(this.scene,this,this.dpr,this.scale,this.key,this.commonkey);d.on("reqActive",this.onReqActiveEquipment,this),d.on("reqEquiped",this.onReqEquipedEquipment,this),d.setEquipItems(p),d.setTransPosition(e/2,o+i/2),this.equipItems.push(d),o+=r,a++}this.resize(e,i)}},PicaEquipUpgradePanel.prototype.setActiveEquipment=function(t){for(var e=0,i=0,n=this.content.mineEquipments;i<n.length;i++){for(var s=n[i],r=this.equipItems[e],o=-1,a=0;a<s.mineEquipments.length;a++){var h=s.mineEquipments[a];h.id===t.id?(s.mineEquipments[a]=t,r.refreshEquipData(t,a),o=a):h.selected&&(h.selected=!1)}o>=0&&r.refreshEquipData(t,o),e++}},PicaEquipUpgradePanel.prototype.destroy=function(){if(this.equipItems){for(var e=0,i=this.equipItems;e<i.length;e++){i[e].destroy()}this.equipItems.length=0}this.equipItems=null,this.content=null,t.prototype.destroy.call(this)},PicaEquipUpgradePanel.prototype.getEuipDatas=function(){for(var t=[],e=0;e<3;e++){var i={};i.name=0===e?"矿镐":"矿车",i.items=[],i.isblue=!(e%2==0);for(var n=0;n<15;n++){var s={};s.name="矿镐"+n,s.penetration=10+n,s.des="describle",s.cost=100*n,s.unlock=!1,i.items.push(s)}t.push(i)}return t},PicaEquipUpgradePanel.prototype.refreshData=function(){var t=this.getData("upgradeData");t&&this.setEquipDatas(t)},PicaEquipUpgradePanel.prototype.resetPosition=function(t,e){this.bg.resize(t,e);var i=.5*-e;this.titlebg.setPosition(0,i),this.tilteName.setPosition(0,i),this.closeBtn.setPosition(.5*t-8*this.dpr,i+8*this.dpr)},PicaEquipUpgradePanel.prototype.OnClosePanel=function(){this.render.renderEmitter(o.ModuleName.PICAEQUIPUPGRADE_NAME+"_hide")},PicaEquipUpgradePanel.prototype.onReqActiveEquipment=function(t){this.render.renderEmitter(o.ModuleName.PICAEQUIPUPGRADE_NAME+"_reqActive",t)},PicaEquipUpgradePanel.prototype.onReqEquipedEquipment=function(t){this.render.renderEmitter(o.ModuleName.PICAEQUIPUPGRADE_NAME+"_reqEquiped",t)},PicaEquipUpgradePanel}(s.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaExploreListPanel",(function(){return y}));var n,s=i(470),r=i(5),o=i(1),a=i(11),h=i(0),l=i(471),c=i(505),p=i(472),d=i(504),m=i(506),u=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),y=function(t){function PicaExploreListPanel(e){var i=t.call(this,e)||this;return i.atlasNames=[a.d.explorelog,a.d.uicommon1,a.d.uicommon],i.textures=[{atlasName:"explore_bg_stripe_top",folder:a.d.explorelog},{atlasName:"explore_bg_stripe_middle",folder:a.d.explorelog},{atlasName:"explore_mask",folder:a.d.explorelog}],i.key=o.ModuleName.PICAEXPLORELIST_NAME,i}return u(PicaExploreListPanel,t),PicaExploreListPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,n,s),this.setSize(n,s),this.bg.x=.5*n,this.bg.y=.5*s,this.topbg.y=.5*this.topbg.height,this.topbg.x=.5*n,this.midbg.y=this.topbg.y+.5*this.midbg.height,this.midbg.x=this.topbg.x,this.mBackBtn.x=.5*this.mBackBtn.width+8*this.dpr,this.mBackBtn.y=.5*this.mBackBtn.height+12*this.dpr,this.energyProgress.x=n-.5*this.energyProgress.width-17*this.dpr,this.energyProgress.y=this.mBackBtn.y;var r=63*this.dpr,o=56*this.dpr,a=s-r-o;this.levelPanel.x=.5*n,this.levelPanel.y=r+.5*a,this.levelPanel.setTopAndBottomHeight(r,o),this.levelPanel.resize(n,a),this.bottomPanel.x=.5*n,this.bottomPanel.y=s-.5*this.bottomPanel.height,this.bottomPanel.resize(n,57*this.dpr)},PicaExploreListPanel.prototype.addListen=function(){this.mInitialized&&this.mBackBtn.on(r.ClickEvent.Tap,this.onBackHandler,this)},PicaExploreListPanel.prototype.removeListen=function(){this.mInitialized&&this.mBackBtn.off(r.ClickEvent.Tap,this.onBackHandler,this)},PicaExploreListPanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight,n=63*this.dpr,r=56*this.dpr;this.setSize(e,i),this.bg=new s.CommonBackground(this.scene,0,0,e,i,a.d.explorelog,"explore_bg",16183516),this.topbg=this.scene.make.image({key:"explore_bg_stripe_top"}),this.midbg=this.scene.make.image({key:"explore_bg_stripe_middle"}),this.mBackBtn=new p.BackTextButton(this.scene,this.dpr),this.mBackBtn.setText(h.i18n.t("explore.title")),this.energyProgress=new p.EnergyProgressBar(this.scene,this.dpr);var o=i-n-r;this.levelPanel=new m.PicaExploreListLevelPanel(this.scene,this.width,o,this.dpr,this.scale),this.levelPanel.setHandler(new h.Handler(this,this.onLevelPanelHandler)),this.bottomPanel=new d.PicaExploreListBottomPanel(this.scene,this.width,57*this.dpr,this.dpr,this.scale),this.bottomPanel.setHandler(new h.Handler(this,this.onBottomPanelHandler)),this.add([this.bg,this.topbg,this.midbg,this.levelPanel,this.mBackBtn,this.energyProgress,this.bottomPanel]),this.resize(e,i),t.prototype.init.call(this)},PicaExploreListPanel.prototype.onShow=function(){this.mShowData&&this.setExploreChapters(this.mShowData),this.tempDatas&&this.setEnergyData(this.tempDatas.value,this.tempDatas.max)},PicaExploreListPanel.prototype.setExploreChapterResult=function(t){var e=this.mShowData.nextLevelId;this.levelPanel.setCaptoreResult(t,e)},PicaExploreListPanel.prototype.setExploreChapters=function(t){this.mShowData=t,this.mInitialized&&this.bottomPanel.setChapterDatas(t)},PicaExploreListPanel.prototype.setEnergyData=function(t,e){this.tempDatas={value:t,max:e},this.mInitialized&&this.energyProgress.setEnergyData(t,e)},PicaExploreListPanel.prototype.openDetialPanel=function(){var t=this.width,e=this.height;this.detialPanel||(this.detialPanel=new c.PicaExploreListDetailPanel(this.scene,t,e,this.dpr,this.scale),this.detialPanel.setHandler(new h.Handler(this,this.onDetialHandler)),this.detialPanel.y=-20*this.dpr),this.add(this.detialPanel),this.detialPanel.visible=!0,this.detialPanel.x=.5*t,this.detialPanel.y=.5*e,this.detialPanel.resize(t,e)},PicaExploreListPanel.prototype.hideDetailPanel=function(){this.detialPanel.visible=!1},PicaExploreListPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaExploreListPanel.prototype.onBackHandler=function(){this.render.renderEmitter(o.ModuleName.PICAEXPLORELIST_NAME+"_hide")},PicaExploreListPanel.prototype.onDetialHandler=function(t,e){"hide"===t&&this.hideDetailPanel()},PicaExploreListPanel.prototype.onLevelPanelHandler=function(t,e){"foreword"===t?(this.openDetialPanel(),this.detialPanel.setCaptoreResultData(e)):"roomid"===t?this.render.renderEmitter(o.ModuleName.PICAEXPLORELIST_NAME+"_queyenterroom",e):"move"===t&&(e?(this.topbg.visible=!1,this.midbg.visible=!1):(this.topbg.visible=!0,this.midbg.visible=!0))},PicaExploreListPanel.prototype.onBottomPanelHandler=function(t,e){"chapterdata"===t&&this.render.renderEmitter(o.ModuleName.PICAEXPLORELIST_NAME+"_queyexplorechapter",e)},PicaExploreListPanel}(l.PicaBasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaExploreLogPanel",(function(){return d}));var n,s=i(470),r=i(5),o=i(1),a=i(11),h=i(0),l=i(471),c=i(507),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaExploreLogPanel(e){var i=t.call(this,e)||this;return i.atlasNames=[a.d.explorelog,a.d.uicommon1],i.key=o.ModuleName.PICAEXPLORELOG_NAME,i}return p(PicaExploreLogPanel,t),PicaExploreLogPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,e,i),this.setSize(n,s),this.goOutBtn.x=n-.5*this.goOutBtn.width-10*this.dpr,this.goOutBtn.y=.5*this.goOutBtn.height+10*this.dpr,this.continueProgress.x=.5*n,this.continueProgress.y=.5*-this.continueProgress.height,this.continueText.x=this.continueProgress.x+.5*this.continueProgress.width+5*this.dpr,this.continueText.y=this.continueProgress.y,this.expProgress.x=n-.5*this.expProgress.width-40*this.dpr,this.expProgress.y=s-240*this.dpr,this.textCon.y=this.expProgress.y+55*this.dpr,this.textCon.x=.5*n,this.expProgress.refreshMask(),this.textCon.refreshMask()},PicaExploreLogPanel.prototype.addListen=function(){this.mInitialized&&this.goOutBtn.on(r.ClickEvent.Tap,this.onGoOutHandler,this)},PicaExploreLogPanel.prototype.removeListen=function(){this.mInitialized&&this.goOutBtn.off(r.ClickEvent.Tap,this.onGoOutHandler,this)},PicaExploreLogPanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight;this.setSize(e,i),this.goOutBtn=new r.Button(this.scene,a.d.explorelog,"checkpoint_abort"),this.expProgress=new m(this.scene,this.dpr,this.scale),this.expProgress.setHandler(new h.Handler(this,this.onProClickHandler)),this.continueProgress=new s.ProgressMaskBar(this.scene,a.d.explorelog,"checkpoint_progress bar_bottom","checkpoint_progress bar_top"),this.continueProgress.visible=!1,this.continueText=this.scene.make.text({style:h.UIHelper.yellowStyle(this.dpr,24)}).setOrigin(0,.5),this.continueText.setFontStyle("bold italic"),this.textCon=new u(this.scene,e,138*this.dpr,this.dpr,this.scale),this.add([this.goOutBtn,this.expProgress,this.continueProgress,this.continueText,this.textCon]),this.resize(e,i),t.prototype.init.call(this),this.setTimeProgress(3e4)},PicaExploreLogPanel.prototype.setExploreDatas=function(t){this.textCon.setTextTips(t)},PicaExploreLogPanel.prototype.setExploreCountDown=function(t){var e=this;if(this.continueProgress.visible)this.playRotateTween(0,100,1e3*t.seconds),this.continueText.scale=.1,this.continueText.alpha=1,h.UIHelper.playScaleTween(this.scene,this.continueText,.1,1,200,"Linear",void 0);else{this.continueProgress.visible=!0;var i=.5*this.continueProgress.height+20*this.dpr;this.continueProgress.setProgress(100,100),this.continueText.text="x"+t.combo,this.continueText.scale=.01,h.UIHelper.playtPosYTween(this.scene,this.continueProgress,0,i,300,"Bounce.easeOut",void 0,new h.Handler(this,(function(){e.scene&&(e.playRotateTween(0,100,1e3*t.seconds),e.continueText.alpha=1,h.UIHelper.playScaleTween(e.scene,e.continueText,.1,1,200,"Back.easeInOut",void 0))})),new h.Handler(this,(function(){e.scene&&(e.continueProgress.refreshMask(),e.continueText.y=e.continueProgress.y)})))}},PicaExploreLogPanel.prototype.setExploreSettleDatas=function(t){this.openSettlePanel(),this.settlePanel.setSettleData(t)},PicaExploreLogPanel.prototype.setTimeProgress=function(t){var e=this;this.expProgress.setProgress(0),this.clearTimer();var i=0;this.timer=setInterval((function(){var n=i/t;i+=20,e.expProgress.setProgress(n),n>=1&&e.clearTimer()}),20)},PicaExploreLogPanel.prototype.openSettlePanel=function(){var t=this.width,e=this.height;this.settlePanel||(this.settlePanel=new c.PicaExploreLogSettlePanel(this.scene,t,e,this.dpr,this.scale),this.settlePanel.setHandler(new h.Handler(this,this.onSettleHandler)),this.settlePanel.y=-20*this.dpr),this.add(this.settlePanel),this.settlePanel.x=.5*t,this.settlePanel.y=.5*e,this.settlePanel.resize(t,e)},PicaExploreLogPanel.prototype.hideSettlePanel=function(){this.settlePanel.visible=!1},PicaExploreLogPanel.prototype.setTipsLayout=function(t){var e=t?this.scaleHeight-360*this.dpr:this.scaleHeight-240*this.dpr;this.expProgress.y=e,this.textCon.y=this.expProgress.y+55*this.dpr,this.expProgress.refreshMask(),this.textCon.refreshMask()},PicaExploreLogPanel.prototype.destroy=function(){t.prototype.destroy.call(this),this.clearTimer()},PicaExploreLogPanel.prototype.onProClickHandler=function(){this.render.renderEmitter(o.ModuleName.PICAEXPLORELOG_NAME+"_queryexplorehint"),this.setTimeProgress(3e4)},PicaExploreLogPanel.prototype.onGoOutHandler=function(){var t=this;h.UIHelper.createMessageBox(this.render,this,this.key,h.i18n.t("explore.exit"),h.i18n.t("explore.exittips"),(function(){t.render.renderEmitter(o.ModuleName.PICAEXPLORELOG_NAME+"_querygohome")}))},PicaExploreLogPanel.prototype.onSettleHandler=function(){this.render.renderEmitter(o.ModuleName.PICAEXPLORELOG_NAME+"_querygohome"),this.hideSettlePanel()},PicaExploreLogPanel.prototype.clearTimer=function(){this.timer&&(clearInterval(this.timer),this.timer=void 0)},PicaExploreLogPanel.prototype.playRotateTween=function(t,e,i){var n=this;this.scene&&(this.rotateTween&&(this.rotateTween.stop(),this.rotateTween.remove(),this.rotateTween=void 0),this.rotateTween=this.scene.tweens.addCounter({from:t,to:e,ease:"Linear",duration:i,onUpdate:function(t,i){n.scene||(n.rotateTween.stop(),n.rotateTween.remove()),n.continueProgress.setProgress(e-i.value,e),i.value===e&&h.UIHelper.playAlphaTween(n.scene,n.continueProgress,1,0,500,"Linear",void 0,new h.Handler(n,(function(){n.scene&&(n.continueProgress.visible=!1,n.continueProgress.y=.5*-n.continueProgress.height,n.continueProgress.alpha=1)})),new h.Handler(n,(function(t){n.continueText.alpha=t})))},onComplete:function(){n.rotateTween.stop(),n.rotateTween.remove(),n.rotateTween=void 0}}))},PicaExploreLogPanel}(l.PicaBasePanel),m=function(t){function ExploreTimeProgress(e,i,n){var s=t.call(this,e,0,0,!1)||this;return s.proValue=0,s.dpr=i,s.zoom=n,s.init(),s.enable=!0,s}return p(ExploreTimeProgress,t),ExploreTimeProgress.prototype.setProgress=function(t){var e=360*t-90;this.barmask.clear(),this.barmask.fillStyle(16777215),this.barmask.slice(0,0,43*this.dpr/this.zoom,Phaser.Math.DegToRad(-90),Phaser.Math.DegToRad(e),!1),this.barmask.fillPath(),t>=1?this.lightIcon.setFrame("checkpoint_prompt_icon_light"):this.lightIcon.setFrame("checkpoint_prompt_icon_gray"),this.proValue=t},ExploreTimeProgress.prototype.refreshMask=function(){var t=this.getWorldTransformMatrix();this.barmask.setPosition(t.tx,t.ty)},ExploreTimeProgress.prototype.destroy=function(){t.prototype.destroy.call(this),this.barmask.destroy()},ExploreTimeProgress.prototype.setHandler=function(t){this.send=t},ExploreTimeProgress.prototype.init=function(){this.bg=this.scene.make.image({key:a.d.explorelog,frame:"checkpoint_prompt_bottom"}),this.lightbg=this.scene.make.image({key:a.d.explorelog,frame:"checkpoint_prompt_schedule"}),this.topbg=this.scene.make.image({key:a.d.explorelog,frame:"checkpoint_prompt_top"}),this.lightIcon=this.scene.make.image({key:a.d.explorelog,frame:"checkpoint_prompt_icon_gray"}),this.barmask=this.scene.make.graphics(void 0,!1),this.lightbg.mask=this.barmask.createGeometryMask(),this.add([this.bg,this.lightbg,this.topbg,this.lightIcon]),this.setSize(this.bg.width,this.bg.height),this.on(r.ClickEvent.Tap,this.onClickHandler,this)},ExploreTimeProgress.prototype.onClickHandler=function(){this.send&&this.proValue>=1&&this.send.run()},ExploreTimeProgress}(s.ButtonEventDispatcher),u=function(t){function ExploreTipsTextsCon(e,i,n,s,r){var o=t.call(this,e)||this;return o.tipsItems=[],o.tweens=[],o.texts=[],o.dpr=s,o.zoom=r,o.setSize(i,n),o.maskGrap=o.scene.make.graphics(void 0,!1),o.maskGrap.clear(),o.maskGrap.fillStyle(0,1),o.maskGrap.fillRect(.5*-i*r,.5*-n*r,i*r,n*r),o.mask=o.maskGrap.createGeometryMask(),o}return p(ExploreTipsTextsCon,t),ExploreTipsTextsCon.prototype.refreshMask=function(){var t=this.getWorldTransformMatrix();this.maskGrap.setPosition(t.tx,t.ty)},ExploreTipsTextsCon.prototype.setTextTips=function(t){for(var e=107*this.dpr,i=25*this.dpr,n=.5*-this.width+.5*e+7*this.dpr,s=0===this.tipsItems.length,o=0;o<t.length;o++){var l=t[o];if(this.texts[o]!==l&&""!==l){var c=new r.NineSliceButton(this.scene,0,0,e,i,a.d.explorelog,"checkpoint_aims_bg",l,this.dpr,this.scale,{left:10*this.dpr,right:10*this.dpr,top:0*this.dpr,bottom:0*this.dpr});c.setTextStyle(h.UIHelper.colorStyle("#FFEE5D",11*this.dpr)),c.x=n;var p=this.tipsItems[o];s||this.replaceAnimation(c,p),this.add(c),this.tipsItems[o]=c}else if(""===l){p=this.tipsItems[o];s||this.replaceAnimation(void 0,p)}n+=e+12*this.dpr,this.texts[o]=l}s&&this.firstAnimation()},ExploreTipsTextsCon.prototype.firstAnimation=function(){for(var t=0,e=0,i=this.tipsItems;e<i.length;e++){var n=i[e];n.y=.5*this.height,this.playtPosYTween(n,.5*this.height,0,600,void 0,t),t+=50}},ExploreTipsTextsCon.prototype.replaceAnimation=function(t,e){e&&(e.y=0,this.playtPosYTween(e,0,.5*-this.height,600*this.dpr,new h.Handler(this,(function(){e.destroy()}))),this.playAlphaTween(e,1,0,500)),t&&(t.y=.5*this.height,this.playtPosYTween(t,.5*this.height,0,600))},ExploreTipsTextsCon.prototype.playtPosYTween=function(t,e,i,n,s,r){var o=this;if(void 0===n&&(n=500),this.scene){var a=this.scene.tweens.add({targets:t,y:{from:e,to:i},ease:"Bounce.easeOut",duration:n,delay:r,onComplete:function(){a.stop(),a.remove(),o.removeTween(a),s&&s.run()}});this.tweens.push(a)}},ExploreTipsTextsCon.prototype.playAlphaTween=function(t,e,i,n,s,r){var o=this;if(void 0===n&&(n=500),this.scene){var a=this.scene.tweens.add({targets:t,alpha:{from:e,to:i},ease:"Linear",duration:n,delay:r,onComplete:function(){a.stop(),a.remove(),o.removeTween(a),s&&s.runWith(i)}});this.tweens.push(a)}},ExploreTipsTextsCon.prototype.removeTween=function(t){var e=this.tweens.indexOf(t);-1!==e&&this.tweens.splice(e,1)},ExploreTipsTextsCon}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaFriendPanel",(function(){return p}));var n,s=i(5),r=i(470),o=i(1),a=i(11),h=i(0),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=Phaser.GameObjects.Container,p=function(t){function PicaFriendPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i.key=o.ModuleName.PICAFRIEND_NAME,i.mSubContanerMap=new Map,i.mSubContanerMap.set(o.FriendChannel.Blacklist,_),i.mSubContanerMap.set(o.FriendChannel.Search,b),i.mSubContanerMap.set(o.FriendChannel.Notice,w),i}return l(PicaFriendPanel,t),PicaFriendPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,e,i),this.setSize(n,s),this.mBackGround.clear(),this.mBackGround.fillStyle(0,.66),this.mBackGround.fillRect(0,0,n,s),this.content.setPosition(n/2,s/2),this.friendContainer.parentContainer&&this.friendContainer.resize()},PicaFriendPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen(),this.friendContainer.setChannel(o.FriendChannel.Friends)):this.preload())},PicaFriendPanel.prototype.hide=function(){t.prototype.hide.call(this)},PicaFriendPanel.prototype.addListen=function(){this.mInitialized&&(this.closeBtn.on(s.ClickEvent.Tap,this.OnClosePanel,this),this.friendContainer.register(),this.friendContainer.on("shwoAddFriend",this.onShowAddFriendHandler,this),this.friendContainer.on(o.EventType.FETCH_FRIEND,this.onFetchFriendHandler,this),this.friendContainer.on(o.EventType.REQ_FRIEND_ATTRIBUTES,this.onReqFriendAttributesHandler,this),this.friendContainer.on(o.EventType.RENDERER_EVENT,this.onRendererEventHandler,this),this.friendContainer.on(o.EventType.REQ_PLAYER_LIST,this.onReqFriendListHandler,this))},PicaFriendPanel.prototype.removeListen=function(){this.mInitialized&&(this.closeBtn.off(s.ClickEvent.Tap,this.OnClosePanel,this),this.friendContainer.off("shwoAddFriend",this.onShowAddFriendHandler,this),this.friendContainer.off(o.EventType.FETCH_FRIEND,this.onFetchFriendHandler,this),this.friendContainer.off(o.EventType.REQ_FRIEND_ATTRIBUTES,this.onReqFriendAttributesHandler,this),this.friendContainer.off(o.EventType.RENDERER_EVENT,this.onRendererEventHandler,this),this.friendContainer.off(o.EventType.REQ_PLAYER_LIST,this.onReqFriendListHandler,this),this.friendContainer.unregister())},PicaFriendPanel.prototype.setFriend=function(t,e){this.mSubContanerMap.get(t)?this.mShowingSubContainer&&this.mShowingSubContainer.setItems(e):this.friendContainer&&this.friendContainer.setFriends(t,e)},PicaFriendPanel.prototype.updateFriend=function(t){this.mShowingSubContainer?this.mShowingSubContainer.updateFriends(t):this.friendContainer.updateFriends(t)},PicaFriendPanel.prototype.updateRelation=function(t){this.mShowingSubContainer&&this.mShowingSubContainer instanceof b&&this.mShowingSubContainer.updateRelation(t)},PicaFriendPanel.prototype.filterById=function(t){this.mShowingSubContainer?this.mShowingSubContainer.filterById(t):this.friendContainer&&this.friendContainer.filterById(t)},PicaFriendPanel.prototype.fetchCurrentFriend=function(){this.friendContainer&&this.friendContainer.fetchCurrentFriend()},PicaFriendPanel.prototype.preload=function(){this.addAtlas(this.key,"friend_list/friend_list.png","friend_list/friend_list.json"),this.addAtlas(a.c.commonKey,a.d.commonUrl+".png",a.d.commonUrl+".json"),t.prototype.preload.call(this)},PicaFriendPanel.prototype.init=function(){var e=this.scale,i=this.scaleWidth,n=this.scaleHeight;this.mBackGround=this.scene.make.graphics(void 0,!1),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,.5),this.mBackGround.fillRect(0,0,i*e,n*e),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.bg=this.scene.make.image({x:0,y:0,key:this.key,frame:"phone"}),this.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.content=this.scene.make.container(void 0,!1),this.content.setSize(this.bg.width,this.bg.height),this.content.add(this.bg),this.closeBtn=new s.Button(this.scene,a.c.commonKey,"close"),this.closeBtn.setPosition(.5*this.content.width-30*this.dpr,.5*(-this.bg.height+this.closeBtn.height)+25*this.dpr),this.friendContainer=new m(this.render.uiManager,this.bg.width,this.bg.height,this.key,this.dpr,this.scale),this.content.add([this.friendContainer,this.closeBtn]),this.add([this.mBackGround,this.content]),this.resize(i,n),t.prototype.init.call(this)},PicaFriendPanel.prototype.destroy=function(){this.friendContainer&&this.friendContainer.destroy(),this.mShowingSubContainer&&this.mShowingSubContainer.destroy(),t.prototype.destroy.call(this)},PicaFriendPanel.prototype.OnClosePanel=function(){this.render.renderEmitter(o.RENDER_PEER+this.key+"_hide")},PicaFriendPanel.prototype.onFetchFriendHandler=function(t){this.render.renderEmitter(o.EventType.FETCH_FRIEND,t)},PicaFriendPanel.prototype.onReqFriendAttributesHandler=function(t){this.render.renderEmitter(o.EventType.REQ_FRIEND_ATTRIBUTES,t)},PicaFriendPanel.prototype.onShowAddFriendHandler=function(t){this.mShowingSubContainer&&this.mShowingSubContainer.destroy();var e=this.mSubContanerMap.get(t);if(e){this.mShowingSubContainer=new e(this.uiManager,this.bg.width,this.bg.height,this.key,this.dpr,this.scale),this.mShowingSubContainer.register(),this.mShowingSubContainer.on("hide",this.onHideSearchHandler,this),this.mShowingSubContainer.on(o.EventType.REQ_FRIEND_ATTRIBUTES,this.onReqFriendAttributesHandler,this),this.mShowingSubContainer.on(o.EventType.RENDERER_EVENT,this.onRendererEventHandler,this),this.mShowingSubContainer.on(o.EventType.REQ_PLAYER_LIST,this.onReqFriendListHandler,this),this.mShowingSubContainer.on(o.EventType.REQ_FRIEND_RELATION,this.onReqFriendRelationHandler,this),this.content.remove(this.friendContainer),this.content.add(this.mShowingSubContainer),this.mShowingSubContainer.resize();var i=this.mShowingSubContainer.fetchEventName();i&&this.render.renderEmitter(i)}},PicaFriendPanel.prototype.onHideSearchHandler=function(){this.content.add(this.friendContainer),this.mShowingSubContainer&&(this.mShowingSubContainer.unregister(),this.mShowingSubContainer.destroy(),this.mShowingSubContainer=null),this.friendContainer.fetchCurrentFriend()},PicaFriendPanel.prototype.onReqFriendListHandler=function(t){this.render.renderEmitter(o.EventType.REQ_PLAYER_LIST,t)},PicaFriendPanel.prototype.onRendererEventHandler=function(t,e){t&&this.render.renderEmitter(t,e)},PicaFriendPanel.prototype.onReqFriendRelationHandler=function(t){if(t){var e=t.map((function(t){return t.id}));e.length>0&&this.render.renderEmitter(o.EventType.REQ_RELATION,e)}},PicaFriendPanel}(r.BasePanel),d=function(t){function FriendContainer(e,i,n,s,r,o){var a=t.call(this,e.scene,0,0)||this;return a.uiManager=e,a.key=s,a.dpr=r,a.uiScale=o,a.render=e.render,a.setSize(i,n),a}return l(FriendContainer,t),FriendContainer.prototype.draw=function(){var t=49*this.dpr-.5*this.height;this.titleText=this.scene.make.text({x:0,y:t,style:{fontSize:16*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#0"}}).setOrigin(.5,0),this.titleText.setFontStyle("bold"),this.add(this.titleText)},FriendContainer.prototype.createGrideTable=function(t,e,i,n,r,a,h,l,c){var p=this,d={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:r,cellHeight:a,reuseCellContainer:!0,zoom:this.uiScale},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,e){var i=t.item;return null===e&&(e=h(p.scene,t)),i.type===o.FriendChannel.Null?t.setHeight(11*p.dpr):t.height!==a&&t.setHeight(a),e.setSize(t.width,t.height),e.setData({item:i}),e.setItemData(i),c&&c(t,e),e}},m=new s.GameGridTable(this.scene,d);return m.layout(),m.on("cellTap",(function(t){t&&l.runWith(t)})),this.add(m),m},FriendContainer.prototype.sortByName=function(t){return t.sort((function(t,e){return t.nickname.localeCompare(e.nickname,h.i18n.language)}))},FriendContainer.prototype.sortByCreate=function(t){return t.sort((function(t,e){return e.createAt-t.createAt}))},FriendContainer.prototype.sortByOnlien=function(t){return t.sort((function(t,e){var i=t.lv?1:0,n=e.lv?1:0;return t.type===o.FriendChannel.Menu||e.type===o.FriendChannel.Menu||t.type===o.FriendChannel.Null||e.type===o.FriendChannel.Null?1:n-i}))},FriendContainer}(c),m=function(t){function MainContainer(e,i,n,s,r,o){var a=t.call(this,e,i,n,s,r,o)||this;return a.friendDatas=new Map,a.draw(),a}return l(MainContainer,t),MainContainer.prototype.register=function(){this.searchInput.on("textchange",this.onTextChangeHandler,this),this.searchBtn.on(s.ClickEvent.Tap,this.onSeachHandler,this),this.onlineCheckBox.on(s.ClickEvent.Tap,this.onCheckoutOnlineHandler,this),this.addFriendBtn.on(s.ClickEvent.Tap,this.onShowAddFriendHandler,this)},MainContainer.prototype.unregister=function(){this.searchInput.off("textchange",this.onTextChangeHandler,this),this.searchBtn.off(s.ClickEvent.Tap,this.onSeachHandler,this),this.onlineCheckBox.off(s.ClickEvent.Tap,this.onCheckoutOnlineHandler,this),this.addFriendBtn.off(s.ClickEvent.Tap,this.onShowAddFriendHandler,this)},MainContainer.prototype.resize=function(){this.friendTabel&&this.friendTabel.resetMask()},MainContainer.prototype.setChannel=function(t){this.channelGroup&&this.channelGroup.selectIndex(t)},MainContainer.prototype.updateFriends=function(t){var e=t.playerInfos,i=null,n=this.friendDatas.get(this.channelGroup.selectedIndex);if(n){for(var _loop_1=function(t){(i=n.find((function(e){return e.id===t.platformId})))&&(i.nickname=t.nickname,t.level&&(i.lv=t.level.level))},s=0,r=e;s<r.length;s++){_loop_1(r[s])}this.showFriend(this.channelGroup.selectedIndex,n)}},MainContainer.prototype.setFriends=function(t,e){for(var i,n=[],s=null,r=[],a=0,h=e;a<h.length;a++){var l=h[a];if(t===o.FriendChannel.Followes?(s=l.followed_user,i=o.FriendRelationEnum.Followed):t===o.FriendChannel.Fans?(s=l.user,i=o.FriendRelationEnum.Fans):(s=l,i=o.FriendRelationEnum.Friend),s){var c=0;s.createAt&&(c=Date.parse(s.createAt)),n.push({type:t,id:s._id,nickname:s.nickname,relation:i,createAt:c}),r.push(s._id)}}this.friendDatas.set(t,n),r.length>0&&this.emit(o.EventType.REQ_PLAYER_LIST,r),this.showFriend(t,n)},MainContainer.prototype.showFriend=function(t,e){var i="",n="";switch(t){case o.FriendChannel.Friends:this.sortByOnlien(e),i=h.i18n.t("friendlist.title"),n=h.i18n.t("friendlist.friends"),e=[{type:o.FriendChannel.Menu,menuData:{type:o.FriendChannel.Notice}},{type:o.FriendChannel.Menu,menuData:{type:o.FriendChannel.Blacklist}},{type:o.FriendChannel.Null}].concat(e);break;case o.FriendChannel.Fans:i=h.i18n.t("friendlist.fans"),n=h.i18n.t("friendlist.fans");break;case o.FriendChannel.Followes:i=h.i18n.t("friendlist.follow"),n=h.i18n.t("friendlist.fans");break;case o.FriendChannel.Blacklist:i=h.i18n.t("friendlist.blacklist")}t!==o.FriendChannel.Friends&&this.sortByCreate(e),this.sortByOnlien(e),this.showingFriends=e,this.friendTabel.setItems(this.showingFriends),i&&this.titleText.setText(i);var s=this.friendDatas.get(this.channelGroup.selectedIndex);s&&this.friendNum.setText(n+": "+s.length),this.friendTabel&&this.friendTabel.setT(0)},MainContainer.prototype.filterById=function(t){if(this.showingFriends){var e=this.friendDatas.get(this.channelGroup.selectedIndex);e&&(e=e.filter((function(e){return e.id!==t}))),this.showingFriends=this.showingFriends.filter((function(e){return e.id!==t})),this.friendTabel.setItems(this.showingFriends)}},MainContainer.prototype.fetchCurrentFriend=function(){!this.channelGroup||this.channelGroup.selectedIndex<0||this.emit(o.EventType.FETCH_FRIEND,this.channelGroup.selectedIndex)},MainContainer.prototype.draw=function(){var e=this;t.prototype.draw.call(this);var i=.5*-this.height+17.33*this.dpr;this.friendNum=this.scene.make.text({x:0,y:i,text:"",style:{color:"#ffffff",fontSize:12*this.dpr,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(.5,0),this.add(this.friendNum),this.topContent=this.scene.make.container(void 0,!1),this.add(this.topContent);var n=new s.NineSlicePatch(this.scene,0,0,276*this.dpr,33*this.dpr,this.key,"min_pic_bg",{left:5*this.dpr,top:5*this.dpr,right:5*this.dpr,bottom:5*this.dpr});this.topContent.setPosition(0,73.67*this.dpr+.5*(n.height-this.height)),this.onlineCheckBox=new s.CheckBox(this.scene,this.key,"online_unchecked","online_checked"),this.onlineCheckBox.setPosition(12*this.dpr-.5*n.width,0);var a=this.scene.make.text({x:6.67*this.dpr+.5*this.onlineCheckBox.width,y:0,text:h.i18n.t("friendlist.olinetitle"),style:{fontSize:9.33*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#0098D8"}}).setOrigin(0,.5);this.onlineCheckBox.add(a),this.searchBtn=new s.Button(this.scene,this.key,"search"),this.searchBtn.x=.5*n.width-39*this.dpr-.5*this.searchBtn.width,this.addFriendBtn=new s.Button(this.scene,this.key,"add"),this.addFriendBtn.x=.5*n.width-7.33*this.dpr-.5*this.addFriendBtn.width,this.searchInput=new k(this.render.uiManager,{x:0,y:0,width:80*this.dpr,height:22*this.dpr,placeholder:h.i18n.t("friendlist.search_friends_notes"),fontSize:12*this.dpr+"px",color:"#666666"},this.key,this.dpr).setOrigin(0,.5),this.topContent.add([n,this.onlineCheckBox,this.searchInput,this.searchBtn,this.addFriendBtn]);var l={fontSize:14*this.dpr,fontFamily:h.Font.DEFULT_FONT},c=new s.TabButton(this.scene,this.key,"friend_default","friend_select",h.i18n.t("friendlist.friends"));c.y=.5*this.height-14*this.dpr-.5*c.height,c.setTextStyle(l);var p=new s.TabButton(this.scene,this.key,"fans_default","fans_select",h.i18n.t("friendlist.fans"));p.y=c.y,p.setTextStyle(l);var d=new s.TabButton(this.scene,this.key,"follow_default","follow_select",h.i18n.t("friendlist.follow"));d.y=c.y,d.setTextStyle(l),c.x=.5*(-p.width-c.width)-.67*this.dpr,d.x=.5*(p.width+d.width)+.67*this.dpr,this.add([c,p,d]),this.channelGroup=new r.CheckboxGroup,this.channelGroup.on("selected",this.onSelectChannelHandler,this),this.channelGroup.appendItemAll([c,p,d]),this.friendTabel=this.createGrideTable(0,this.topContent.y+this.topContent.height+380*this.dpr*.5+18*this.dpr,275*this.dpr,380*this.dpr,275*this.dpr,36*this.dpr,(function(t,i){var n=new u(e.render.uiManager,0,0,e.key,e.dpr);return n.on(o.EventType.REQ_FRIEND_ATTRIBUTES,e.onFtechPlayerHandler,e),n.on(o.EventType.RENDERER_EVENT,e.onRendererEventHandler,e),n}),new h.Handler(this,this.onSelectItemHandler))},MainContainer.prototype.onRendererEventHandler=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.emit(o.EventType.RENDERER_EVENT,t,e)},MainContainer.prototype.onFtechPlayerHandler=function(t){void 0!==t.lv&&this.emit(o.EventType.REQ_FRIEND_ATTRIBUTES,t.id),this.searchInput.setBlur()},MainContainer.prototype.onSelectChannelHandler=function(t){this.fetchCurrentFriend()},MainContainer.prototype.onSelectItemHandler=function(t){var e=t.getData("item");e&&e.menuData&&e.type===o.FriendChannel.Menu&&this.emit("shwoAddFriend",e.menuData.type)},MainContainer.prototype.onCheckoutOnlineHandler=function(){var t=this.showingFriends;this.onlineCheckBox.selected&&(t=this.showingFriends.slice(0).filter((function(t){return!0===t.online})));this.friendTabel.setItems(t)},MainContainer.prototype.onShowAddFriendHandler=function(){this.emit("shwoAddFriend",o.FriendChannel.Search),this.searchInput.setBlur()},MainContainer.prototype.onSeachHandler=function(){var t=this.searchInput.text;if(t){var e=this.showingFriends.slice(0);e=e.filter((function(e){return!!(e.nickname&&e.nickname.indexOf(t)>-1)})),this.friendTabel.setItems(e)}else this.friendTabel.setItems(this.showingFriends)},MainContainer.prototype.onTextChangeHandler=function(){this.onSeachHandler()},MainContainer}(d),u=function(t){function PicFriendItem(e,i,n,s,r){var o=t.call(this,e.scene,i,n)||this;return o.mDpr=0,o.render=e.render,o.setSize(275*r,36*r),o.mDpr=r,o.mKey=s,o}return l(PicFriendItem,t),PicFriendItem.prototype.setItemData=function(t){this.itemData=t,this.currnetType!==t.type&&(this.currnetType=t.type,this.currentRender&&(this.currentRender.destroy(),this.currentRender=null),this.currentRender=this.createRenderer(t.type)),this.currentRender&&this.currentRender.setItemData(t)},PicFriendItem.prototype.createAddBtn=function(t){var e=48*this.mDpr,i=24*this.mDpr;return new s.NineSliceButton(this.scene,.5*(this.width-e)-18*this.mDpr,0,e,i,a.c.commonKey,"yellow_btn_normal_s",h.i18n.t("common.add"),this.mDpr,this.scale,{left:10*this.mDpr,top:10*this.mDpr,right:10*this.mDpr,bottom:10*this.mDpr})},PicFriendItem.prototype.onHeadhandler=function(){this.emit(o.EventType.REQ_FRIEND_ATTRIBUTES,this.itemData)},PicFriendItem.prototype.createRenderer=function(t){switch(t){case o.FriendChannel.Fans:case o.FriendChannel.Search:case o.FriendChannel.Friends:case o.FriendChannel.Followes:case o.FriendChannel.Blacklist:return new P(this.scene,this);case o.FriendChannel.Null:return new g(this.scene,this);case o.FriendChannel.Menu:return new y(this.scene,this);case o.FriendChannel.Notice:return new f(this.scene,this)}},Object.defineProperty(PicFriendItem.prototype,"key",{get:function(){return this.mKey},enumerable:!1,configurable:!0}),Object.defineProperty(PicFriendItem.prototype,"dpr",{get:function(){return this.mDpr},enumerable:!1,configurable:!0}),PicFriendItem}(c),y=function(){function MenuRenderer(t,e){this.scene=t,this.owner=e,this.icon=this.scene.make.image({x:7.44*this.owner.dpr-.5*this.owner.width,key:e.key,frame:"black_list"},!1).setOrigin(0,.5),this.text=this.scene.make.text({x:this.icon.x+this.icon.width+9.67*e.dpr,style:{fontSize:9.33*e.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#000000"}}).setOrigin(0,.5),this.arrow=this.scene.make.image({x:.5*e.width-20*e.dpr,key:e.key,frame:"arrow"}).setOrigin(1,.5),this.owner.add([this.icon,this.text,this.arrow])}return MenuRenderer.prototype.setItemData=function(t){var e=t.menuData;if(e)switch(e.type){case o.FriendChannel.Notice:this.icon.setFrame("notice"),this.text.text=h.i18n.t("friendlist.notice");break;case o.FriendChannel.Blacklist:this.icon.setFrame("black_list"),this.text.text=h.i18n.t("friendlist.blacklist")}},MenuRenderer.prototype.destroy=function(){this.icon&&this.icon.destroy(),this.text&&this.text.destroy(),this.arrow&&this.arrow.destroy()},MenuRenderer}(),f=function(){function NoticeRenderer(t,e){this.scene=t,this.owner=e,this.icon=this.scene.make.image({x:7.44*this.owner.dpr-.5*this.owner.width,key:e.key,frame:"notice_icon"},!1).setOrigin(0,.5),this.text=new s.BBCodeText(this.scene,this.icon.x+this.icon.width+9.67*e.dpr,0,"",{fontSize:9.33*e.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#000000"}),this.text.setOrigin(0,.5),this.owner.add([this.icon,this.text])}return NoticeRenderer.prototype.setItemData=function(t){this.text.setText("[color=#00dffc]"+t.nickname+"[/color] "+h.i18n.t("friendlist.followed_you"))},NoticeRenderer.prototype.destroy=function(){this.icon&&this.icon.destroy(),this.text&&this.text.destroy()},NoticeRenderer}(),g=function(){function NullRenderer(t,e){this.owner=e,this.graphics=t.make.graphics(void 0,!1),this.graphics.fillStyle(16119285),this.graphics.fillRect(.5*-this.owner.width,-18*e.dpr,this.owner.width,this.owner.height),e.add(this.graphics)}return NullRenderer.prototype.setItemData=function(t){},NullRenderer.prototype.destroy=function(){this.graphics&&this.graphics.destroy()},NullRenderer}(),P=function(){function FriendRenderer(t,e){this.scene=t,this.owner=e,this.icon=t.make.image({x:7.44*e.dpr-.5*e.width,key:e.key,frame:"offline_head"}).setOrigin(0,.5).setInteractive().on("pointerup",this.onHeadhandler,this),this.icon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.nameText=t.make.text({x:this.icon.x+this.icon.width+9.67*e.dpr,y:.5*-this.icon.height+1*e.dpr,style:{fontSize:10*e.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#6F75FF"}},!1),this.level=t.make.text({x:this.nameText.x,y:this.nameText.y+18*e.dpr,text:"",style:{fontSize:8*e.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#6F75FF"}}),this.addBtn=this.createAddBtn(h.i18n.t("friendlist.follow")),this.addBtn.on(s.ClickEvent.Tap,this.onAddHandler,this),this.owner.add(this.addBtn),e.add([this.icon,this.nameText,this.level,this.addBtn])}return FriendRenderer.prototype.setItemData=function(t){this.itemData=t,this.nameText.text=t.nickname;var e=t.lv?h.i18n.t("friendlist.lv")+"："+t.lv:h.i18n.t("friendlist.unregistered_game");this.level.setText(e),this.curRelation!==t.relation&&(this.curRelation=t.relation,this.updateRelation())},FriendRenderer.prototype.destroy=function(){if(this.owner)for(var t=this.owner.list;t.length;)t[t.length-1].destroy()},FriendRenderer.prototype.updateRelation=function(){this.curRelation&&this[this.curRelation]?this[this.curRelation]():(this.addBtn.visible=!1,this.friendEvnet=null)},FriendRenderer.prototype.fans=function(){this.addBtn.visible=!0,this.addBtn.setText(h.i18n.t("friendlist.follow")),this.friendEvnet=o.EventType.FOLLOW},FriendRenderer.prototype.followed=function(){this.addBtn.visible=!0,this.addBtn.setText(h.i18n.t("friendlist.unfollow")),this.friendEvnet=o.EventType.UNFOLLOW},FriendRenderer.prototype.blacklist=function(){this.addBtn.visible=!0,this.addBtn.setText(h.i18n.t("friendlist.remove")),this.friendEvnet=o.EventType.REMOVE_FROM_BLACKLIST},FriendRenderer.prototype.null=function(){this.fans()},FriendRenderer.prototype.createAddBtn=function(t){var e=this.owner,i=e.width,n=(e.height,e.key,e.dpr),r=48*n,o=24*n,l=new s.NineSliceButton(this.scene,.5*(i-r)-18*n,0,r,o,a.c.commonKey,"yellow_btn_normal_s",t,n,1,{left:10*n,top:6*n,right:10*n,bottom:6*n});return l.setTextStyle({fontSize:9*n,fontFamily:h.Font.DEFULT_FONT}),l},FriendRenderer.prototype.onHeadhandler=function(){this.owner.emit(o.EventType.REQ_FRIEND_ATTRIBUTES,this.itemData)},FriendRenderer.prototype.onAddHandler=function(){this.friendEvnet&&this.itemData&&this.owner.emit(o.EventType.RENDERER_EVENT,this.friendEvnet,this.itemData.id)},FriendRenderer}(),v=function(t){function SubFriendContainer(e,i,n,s,r,o){var a=t.call(this,e,i,n,s,r,o)||this;return a.draw(),a}return l(SubFriendContainer,t),SubFriendContainer.prototype.register=function(){this.backBtn.on(s.ClickEvent.Tap,this.onBackHandler,this)},SubFriendContainer.prototype.unregister=function(){this.backBtn.off(s.ClickEvent.Tap,this.onBackHandler,this)},SubFriendContainer.prototype.resize=function(){this.gridTable&&this.gridTable.resetMask()},SubFriendContainer.prototype.setItems=function(t){this.items=t,this.gridTable&&this.gridTable.setItems(t)},SubFriendContainer.prototype.filterById=function(t){!this.items||this.items.length<1||(this.items&&(this.items=this.items.filter((function(e){return e.id!==t}))),this.gridTable&&this.gridTable.setItems(this.items))},SubFriendContainer.prototype.updateFriends=function(t){},SubFriendContainer.prototype.fetchEventName=function(){return""},SubFriendContainer.prototype.destroy=function(){this.unregister(),this.gridTable&&this.gridTable.destroy(),t.prototype.destroy.call(this)},SubFriendContainer.prototype.draw=function(){var e=this;t.prototype.draw.call(this),this.backBtn=new s.Button(this.scene,this.key,"back"),this.backBtn.setPosition(.5*(-this.width+this.backBtn.width)+21.67*this.dpr,.5*(-this.height+this.backBtn.height)+47*this.dpr),this.gridTable=this.createGrideTable(0,18*this.dpr,275*this.dpr,400*this.dpr,275*this.dpr,36*this.dpr,(function(){var t=new u(e.uiManager,0,0,e.key,e.dpr);return t.on(o.EventType.REQ_FRIEND_ATTRIBUTES,e.onFtechPlayerHandler,e),t.on(o.EventType.RENDERER_EVENT,e.onRendererEventHandler,e),t}),new h.Handler(this.onItemClickHandler)),this.add([this.backBtn])},SubFriendContainer.prototype.onBackHandler=function(){this.emit("hide")},SubFriendContainer.prototype.onItemClickHandler=function(){},SubFriendContainer.prototype.onFtechPlayerHandler=function(t){this.emit(o.EventType.REQ_FRIEND_ATTRIBUTES,t.id)},SubFriendContainer.prototype.onRendererEventHandler=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.emit(o.EventType.RENDERER_EVENT,t,e)},SubFriendContainer}(d),b=function(t){function SearchContainer(e,i,n,s,r,a){var h=t.call(this,e,i,n,s,r,a)||this;return h.friendType=o.FriendChannel.Search,h}return l(SearchContainer,t),SearchContainer.prototype.setItems=function(t){if(t){for(var e=[],i=0,n=t;i<n.length;i++){var s=n[i],r=s.platformId,a=s.nickname,h=s.level;e.push({type:this.friendType,nickname:a,id:r,lv:h.level})}this.emit(o.EventType.REQ_FRIEND_RELATION,e),this.items=e}},SearchContainer.prototype.updateRelation=function(t){if(this.items){for(var _loop_2=function(t){e.items.find((function(e){return e.id===t.id})).relation=t.relation},e=this,i=0,n=t;i<n.length;i++){_loop_2(n[i])}this.updateFriends(this.items)}},SearchContainer.prototype.updateFriends=function(t){this.items=t,this.gridTable&&this.gridTable.setItems(t)},SearchContainer.prototype.draw=function(){t.prototype.draw.call(this),this.titleText.setText(h.i18n.t("friendlist.search"));var e=new s.NineSlicePatch(this.scene,0,0,276*this.dpr,33*this.dpr,this.key,"min_pic_bg",{left:5*this.dpr,top:5*this.dpr,right:5*this.dpr,bottom:5*this.dpr});e.setPosition(0,73.67*this.dpr+.5*(e.height-this.height)),this.searchInput=new k(this.uiManager,{x:0,y:0,width:80*this.dpr,height:22*this.dpr,placeholder:h.i18n.t("friendlist.search_friends_notes"),fontSize:12*this.dpr+"px",color:"#666666"},this.key,this.dpr).setOrigin(0,.5),this.searchInput.setPosition(0,e.y),this.searchInput.on("search",this.onSearchHandler,this),this.gridTable.y=e.height,this.gridTable.layout(),this.add([e,this.searchInput])},SearchContainer.prototype.onSearchHandler=function(t){this.emit(o.EventType.RENDERER_EVENT,o.EventType.SEARCH_FRIEND,t),this.resize()},SearchContainer}(v),_=function(t){function BlackContainer(e,i,n,s,r,a){var h=t.call(this,e,i,n,s,r,a)||this;return h.friendType=o.FriendChannel.Blacklist,h}return l(BlackContainer,t),BlackContainer.prototype.draw=function(){t.prototype.draw.call(this),this.titleText.setText(h.i18n.t("friendlist.blacklist"))},BlackContainer.prototype.setItems=function(e){if(e){for(var i=[],n=[],s=null,r=0,a=e;r<a.length;r++){(s=a[r].ban_user)&&(n.push(s._id),i.push({type:o.FriendChannel.Blacklist,id:s._id,nickname:s.nickname,relation:o.FriendRelationEnum.Blacklist}))}t.prototype.setItems.call(this,i),n.length>0&&this.emit(o.EventType.REQ_PLAYER_LIST,n)}},BlackContainer.prototype.updateFriends=function(t){for(var e=t.playerInfos,i=null,_loop_3=function(t){(i=n.items.find((function(e){return e.id===t.platformId})))&&(i.nickname=t.nickname,t.level&&(i.lv=t.level.level))},n=this,s=0,r=e;s<r.length;s++){_loop_3(r[s])}this.gridTable&&this.gridTable.setItems(this.items)},BlackContainer.prototype.fetchEventName=function(){return o.EventType.REQ_BLACKLIST},BlackContainer}(v),k=function(t){function SearchInput(e,i,n,r){var o=t.call(this,e.scene,i)||this;o.render=e.render,o.searchBtn=new s.Button(o.scene,n,"search_blue"),o.searchBtn.x=i.width+4*r+.5*o.searchBtn.width,o.searchBtn.on(s.ClickEvent.Tap,o.onSearchHandler,o),o.add(o.searchBtn);var a=e.scene.make.graphics(void 0,!1);return a.fillStyle(16777215),a.fillRoundedRect(-5*r,.5*-i.height,i.width+14*r+o.searchBtn.width,i.height,.5*i.height),o.addAt(a,0),o.setOrigin(0,.5),o}return l(SearchInput,t),SearchInput.prototype.onSearchHandler=function(){this.setBlur(),this.emit("search",this.text)},SearchInput}(r.LabelInput),w=function(t){function NoticeContainer(e,i,n,s,r,a){var h=t.call(this,e,i,n,s,r,a)||this;return h.friendType=o.FriendChannel.Search,h}return l(NoticeContainer,t),NoticeContainer.prototype.draw=function(){t.prototype.draw.call(this),this.titleText.setText(h.i18n.t("friendlist.notice"))},NoticeContainer.prototype.setItems=function(e){if(e){for(var i=[],n=[],s=Date.now(),r=0,a=e;r<a.length;r++){var h=a[r];if(h.created_at)if(s-Date.parse(h.created_at)<2592e5){var l=h.user;l&&(i.push({type:o.FriendChannel.Notice,id:l._id,nickname:l.nickname}),n.push(l._id))}}t.prototype.setItems.call(this,i),n.length>0&&this.emit(o.EventType.REQ_PLAYER_LIST,n)}},NoticeContainer.prototype.updateFriends=function(t){for(var e=t.playerInfos,i=null,_loop_4=function(t){(i=n.items.find((function(e){return e.id===t.platformId})))&&(i.nickname=t.nickname,t.level&&(i.lv=t.level.level))},n=this,s=0,r=e;s<r.length;s++){_loop_4(r[s])}this.gridTable&&this.gridTable.setItems(this.items)},NoticeContainer.prototype.fetchEventName=function(){return o.EventType.REQ_NEW_FANS},NoticeContainer}(v);!function(t){function NavigateContaienr(e,i,n,s,r,o){var a=t.call(this,e,i,n)||this;a.setSize(s,r),a.chars=[];for(var l=0;l<26;l++)a.chars.push(String.fromCharCode(l+65));a.chars.push("#"),a.texts=[];var c=r/a.chars.length,p={color:"#0",fontSize:8*o,fontFamily:h.Font.DEFULT_FONT},d=0,m=0;for(l=0;l<a.chars.length;l++){var u=a.scene.make.text({y:l*c-.5*a.height,text:a.chars[l],style:p}).setOrigin(.5);a.texts[l]=u,d||(d=u.width+8*o,m=u.height+2*o)}return a.selected=a.scene.make.graphics(void 0,!1),a.selected.fillStyle(3115002),a.selected.fillRect(.5*-d,.5*-m,d,m),a.add(a.selected),a.selected.x=a.texts[0].x,a.selected.y=a.texts[0].y,a.add(a.texts),a}l(NavigateContaienr,t),NavigateContaienr.prototype.checkSlider=function(t){if(t){this.selected.visible=!0;for(var e=0;e<this.chars.length;e++)if(t.localeCompare(this.chars[e])>-1)return this.selected.x=this.texts[e].x,void(this.selected.y=this.texts[e].y)}else this.selected.visible=!1}}(c)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaFurniFunPanel",(function(){return d}));var n,s=i(2),r=i(5),o=i(470),a=i(475),h=i(1),l=i(11),c=i(0),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaFurniFunPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=h.ModuleName.PICAFURNIFUN_NAME,i}return p(PicaFurniFunPanel,t),PicaFurniFunPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,n,s),this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.66),this.blackGraphic.fillRect(0,0,n,s),this.content.x=Math.floor(n/2),this.content.y=Math.floor(s/2),this.setSize(n*this.scale,s*this.scale),this.materialGameScroll.refreshMask()},PicaFurniFunPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen(),this.setFuritDisplay(),this.setMaterialsData(this._getMaterialData())):this.preload())},PicaFurniFunPanel.prototype.addListen=function(){this.mInitialized&&(this.confirmBtn.on(r.ClickEvent.Tap,this.onConfirmBtnClick,this),this.closeBtn.on(r.ClickEvent.Tap,this.OnClosePanel,this))},PicaFurniFunPanel.prototype.removeListen=function(){this.mInitialized&&(this.confirmBtn.off(r.ClickEvent.Tap,this.onConfirmBtnClick,this),this.closeBtn.off(r.ClickEvent.Tap,this.OnClosePanel,this))},PicaFurniFunPanel.prototype.preload=function(){this.addAtlas(this.key,"furni_unlock/furni_unlock.png","furni_unlock/furni_unlock.json"),this.addAtlas(l.c.commonKey,l.d.commonUrl+".png",l.d.commonUrl+".json"),this.addAtlas(l.c.common2Key,l.d.common2Url+".png",l.d.common2Url+".json"),t.prototype.preload.call(this)},PicaFurniFunPanel.prototype.init=function(){var e=this,i=this.cameraWidth,n=this.cameraHeight;this.blackGraphic=this.scene.make.graphics(void 0,!1),this.blackGraphic.setInteractive(new Phaser.Geom.Rectangle(0,0,i/this.scale,n/this.scale),Phaser.Geom.Rectangle.Contains),this.add(this.blackGraphic),this.content=this.scene.make.container(void 0,!1);var s=295*this.dpr,h=400*this.dpr;this.content.setSize(s,h),this.add(this.content),this.bg=new r.NineSlicePatch(this.scene,0,0,s,h,l.c.common2Key,"bg",{left:20*this.dpr,top:20*this.dpr,right:20*this.dpr,bottom:40*this.dpr}),this.content.add(this.bg);var p=.5*-this.bg.height;this.titleimage=this.scene.make.image({x:0,y:p+5*this.dpr,key:l.c.common2Key,frame:"title"},!1),this.titleimage.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titleName=this.scene.make.text({x:0,y:this.titleimage.y+2*this.dpr,text:c.i18n.t("furni_unlock.title"),style:{color:"#905B06",fontFamily:c.Font.DEFULT_FONT,fontSize:16*this.dpr}}).setOrigin(.5,.5).setFontStyle("bold"),this.closeBtn=new r.Button(this.scene,l.c.commonKey,"close"),this.closeBtn.x=.5*this.bg.width-8*this.dpr,this.closeBtn.y=p+7*this.dpr,this.content.add([this.titleimage,this.titleName,this.closeBtn]),this.itemName=this.scene.make.text({x:0,y:this.titleimage.y+.5*this.titleimage.height+13*this.dpr,text:"",style:{color:"#FFC51A",fontFamily:c.Font.DEFULT_FONT,fontSize:14*this.dpr}}).setFontStyle("bold").setStroke("#996600",4).setOrigin(.5),this.content.add(this.itemName),this.bgicon=this.scene.make.image({key:this.key,frame:"bg_f"}),this.bgicon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.bgicon.y=this.itemName.y+.5*this.bgicon.height+13*this.dpr,this.content.add([this.bg,this.bgicon]),this.mDetailDisplay=new a.a(this.scene,this.render),this.mDetailDisplay.setTexture(this.key,"bg_f"),this.mDetailDisplay.y=this.bgicon.y,this.mDetailDisplay.setFixedScale(this.dpr/this.scale),this.mDetailDisplay.setSize(72*this.dpr,72*this.dpr),this.content.add(this.mDetailDisplay);var d=360*this.dpr,m=92*this.dpr;this.materialCon=this.scene.make.container(void 0,!1).setSize(d,m),this.content.add(this.materialCon),this.materialCon.setPosition(0,-p-.5*m-66*this.dpr);var u=this.scene.make.text({x:0,y:.5*-m+12*this.dpr,text:c.i18n.t("furni_unlock.needMaterials"),style:{color:"#253FCA",fontSize:12*this.dpr,fontFamily:c.Font.DEFULT_FONT}},!1).setOrigin(.5),y=this.scene.make.image({key:this.key,frame:"sourcelist_title"});y.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var f=this.scene.make.image({key:this.key,frame:"sourcelist_title"});f.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var g=.5*-u.width-.5*y.width-10*this.dpr;y.setPosition(g,u.y),f.setPosition(-g,u.y).rotation=-Math.PI,this.materialCon.add([u,y,f]),this.materialGameScroll=new r.GameScroller(this.scene,{x:0,y:2*this.dpr,width:240*this.dpr,height:90*this.dpr,zoom:this.scale,dpr:this.dpr,align:2,orientation:1,space:20*this.dpr,valuechangeCallback:void 0,cellupCallBack:function(t){e.onMaterialItemHandler(t)}}),this.materialCon.add(this.materialGameScroll);var P=145*this.dpr,v=55*this.dpr;this.itemtips=new o.ItemInfoTips(this.scene,P,v,l.c.common2Key,"tips_bg",this.dpr,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr}),this.itemtips.x=.5*-this.width+.5*P+10*this.dpr,this.itemtips.y=.5*-this.height+70*this.dpr,this.itemtips.setVisible(!1),this.itemtips.setHandler(new c.Handler(this,this.onItemTipsHideHandler)),this.content.add(this.itemtips),this.confirmBtn=new r.NineSliceButton(this.scene,0,-p-35*this.dpr,100*this.dpr,40*this.dpr,l.c.commonKey,"yellow_btn_over",c.i18n.t("furni_unlock.unlock"),this.dpr,this.scale,{left:15*this.dpr,top:15*this.dpr,right:15*this.dpr,bottom:15*this.dpr}),this.confirmBtn.setTextStyle({color:"#976400",fontSize:12*this.dpr,fontFamily:c.Font.DEFULT_FONT,stroke:"#976400"}),this.confirmBtn.setTextOffset(10*this.dpr,0);var b=this.scene.make.image({key:this.key,frame:"repair_icon"});b.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),b.x=-28*this.dpr,this.confirmBtn.add(b),this.content.add(this.confirmBtn),this.resize(0,0),t.prototype.init.call(this)},PicaFurniFunPanel.prototype.destroy=function(){this.removeListen(),this.confirmBtn&&this.confirmBtn.destroy(),this.confirmBtn=null,t.prototype.destroy.call(this)},PicaFurniFunPanel.prototype.setFuritDisplay=function(){var t=this._getDisplayData(),e=t.displayInfo,i=new s.op_client.OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_COMMODITY_RESOURCE;i.display=e.display;var n=this.createProtocolObject(e.animations);if(n.length>1){for(var r=[],o=0,a=n;o<a.length;o++){var h=a[o];"lock"!==h.node.name&&(h.frameName=h.layer[0].frameName,r.push(h))}0===r.length&&r.push(n[0]),i.animations=r}else i.animations=n;this.mDetailDisplay.loadDisplay(i),this.itemName.text=t.nickname},PicaFurniFunPanel.prototype.isTeamBuild=function(){return this.mShowData.tag&&"teambuild"===this.mShowData.tag},PicaFurniFunPanel.prototype._getDisplayData=function(){return this.isTeamBuild()?this.mShowData.element:this.mShowData},PicaFurniFunPanel.prototype._getMaterialData=function(){return this.isTeamBuild()?this.mShowData.materials:this.materials},PicaFurniFunPanel.prototype.setMaterialsData=function(t){this.materials=t,this.mInitialized&&t&&this.setMaterialItems(this.materials)},PicaFurniFunPanel.prototype.createProtocolObject=function(t){var e=[];return t.forEach((function(t){var i={node:t.mNode,baseLoc:"0,0",originPoint:[0,0],layer:[]},n=new o.AnimationModel(i);Object.assign(n,t);var s=n.createProtocolObject();e.push(s)}),this),e},PicaFurniFunPanel.prototype.setMaterialItems=function(t){var e=t.length;this.materialGameScroll.clearItems();for(var i=0;i<e;i++){var n=new m(this.scene,this.key,this.dpr,this.scale);n.y=0,n.setItemData(t[i]),n.setData("itemData",t[i]),this.materialGameScroll.addItem(n)}this.materialGameScroll.Sort()},PicaFurniFunPanel.prototype.onConfirmBtnClick=function(){var t=this.showData;t&&(this.isTeamBuild()?this.render.renderEmitter(this.key+"_queryTeamBuild",[t.element.id]):this.render.renderEmitter(this.key+"_queryunlock",[t.id]),this.OnClosePanel())},PicaFurniFunPanel.prototype.OnClosePanel=function(){this.render.renderEmitter(this.key+"_close")},PicaFurniFunPanel.prototype.onMaterialItemHandler=function(t){this.itemtips.setVisible(!1),this.selectMaterial&&this.selectMaterial!==t&&(this.selectMaterial.select=!1),t.select=!t.select,t.select&&(this.itemtips.setItemData(t.itemData),this.itemtips.setVisible(!0)),this.selectMaterial=t,this.setTipsPosition(t)},PicaFurniFunPanel.prototype.onItemTipsHideHandler=function(){this.selectMaterial&&(this.selectMaterial.select=!1)},PicaFurniFunPanel.prototype.setTipsPosition=function(t){for(var e=t.x,i=t.y,n=t;n.parentContainer!==this.content;)e+=n.parentContainer.x,i+=n.parentContainer.y,n=n.parentContainer;e-.5*this.itemtips.width<.5*-this.content.width?this.itemtips.x=.5*this.itemtips.width-.5*this.content.width+20*this.dpr:e+.5*this.itemtips.width>.5*this.content.width?this.itemtips.x=.5*this.content.width-.5*this.itemtips.width-20*this.dpr:this.itemtips.x=e,this.itemtips.y=i-.5*this.itemtips.height+5*this.dpr},PicaFurniFunPanel}(o.BasePanel),m=function(t){function MaterialItem(e,i,n,s){var a=t.call(this,e)||this;return a.mselect=!1,a.dpr=n,a.key=i,a.zoom=s,a.bg=a.scene.make.image({key:a.key,frame:"bg_m"}),a.itemIcon=new o.DynamicImage(e,0,0),a.itemIcon.scale=a.dpr/a.zoom,a.itemCount=new r.BBCodeText(a.scene,0,15*n,"10/20",{color:"#000000"}).setOrigin(.5).setFontSize(11*n).setFontFamily(c.Font.DEFULT_FONT),a.add([a.bg,a.itemIcon,a.itemCount]),a.setSize(a.bg.width,a.bg.height),a.itemCount.y=.5*a.height+8*n,a}return p(MaterialItem,t),MaterialItem.prototype.setItemData=function(t){this.itemData=t,this.itemCount.text=this.getCountText(t);var e=c.Url.getOsdRes(t.display.texturePath);this.itemIcon.load(e,this,(function(){}))},Object.defineProperty(MaterialItem.prototype,"select",{get:function(){return this.mselect},set:function(t){this.bg.setFrame(t?"bg_select":"bg_m"),this.mselect=t},enumerable:!1,configurable:!0}),MaterialItem.prototype.getCountText=function(t){var e="[color="+(t.count>=t.neededCount?"#000000":"#ff0000")+"]"+t.count+"[/color]/"+t.neededCount;return t.hasOwnProperty("recommended")&&(e=t.recommended+"/"+e),e},MaterialItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaFurnitureComposePanel",(function(){return d}));var n,s=i(5),r=i(470),o=i(475),a=i(11),h=i(1),l=i(0),c=i(471),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaFurnitureComposePanel(e){var i=t.call(this,e)||this;return i.mSelectedItemData=[],i.subCategoryType=1,i.atlasNames=[a.d.uicommon,a.d.effectcommon],i.key=h.ModuleName.PICAFURNITURECOMPOSE_NAME,i}return p(PicaFurnitureComposePanel,t),PicaFurnitureComposePanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,n,s),this.mBackground.x=.5*n,this.mBackground.y=.5*s,this.topBackground.x=.5*n,this.topBackground.y=.5*this.topBackground.height;var r=79*this.dpr,o=s-this.mPropGrid.height-.5*r-47*this.dpr;this.furiAnimation.x=.5*n,this.furiAnimation.y=.5*o+7*this.dpr,this.mCategoryCon.setSize(n,79*this.dpr),this.mCategoryCon.y=o,this.mCategoryCon.x=.5*n,this.mCategoriesBar.y=40*this.dpr,this.mCategoriesBar.x=.5*-n,this.mCategoriesBar.clear(),this.mCategoriesBar.fillStyle(10841086),this.mCategoriesBar.fillRect(0,0,n,40*this.dpr),this.mCategoriesBar.fillStyle(8539348),this.mCategoriesBar.fillRect(0,40*this.dpr,n,3*this.dpr),this.composeBtn.x=n-this.composeBtn.width/2-20*this.dpr,this.composeBtn.y=this.mCategoryCon.y-this.composeBtn.height/2+35*this.dpr,this.mPropGridBg.clear(),this.mPropGridBg.fillStyle(13531891),this.mPropGridBg.fillRect(0,0,this.mPropGrid.width,this.mPropGrid.height+10*this.dpr),this.mPropGridBg.y=s-this.mPropGrid.height-4*this.dpr,this.mPropGrid.x=n/2+3*this.dpr,this.mPropGrid.y=s-.5*this.mPropGrid.height,this.mPropGrid.layout(),this.mPropGrid.resetMask(),this.mCategoryScroll.refreshMask(),this.setSize(n,s),this.setInteractive()},PicaFurnitureComposePanel.prototype.setCategories=function(){var t=[{name:l.i18n.t("furnicompose.onestar"),value:1},{name:l.i18n.t("furnicompose.twostar"),value:2},{name:l.i18n.t("furnicompose.threestar"),value:3},{name:l.i18n.t("furnicompose.fourstar"),value:4}];this.mPreCategoryBtn=null,this.mSelectedCategeories=null;var e=60*this.dpr,i=41*this.dpr,n=[];this.mCategoryScroll.clearItems();for(var s=0;s<t.length;s++){var o=new r.TextButton(this.scene,this.dpr,1,t[s].name,0,0);o.setData("item",t[s]),o.setSize(e,i),this.mCategoryScroll.addItem(o),o.setChangeColor("#FFE63C"),n[s]=o,o.setFontSize(16*this.dpr),o.setFontStyle("bold")}this.mCategoryScroll.setAlign(1),this.mCategoryScroll.Sort(),this.mCategoryScroll.refreshMask(),n.length>1&&this.onSelectSubCategoryHandler(n[0])},PicaFurnitureComposePanel.prototype.setGridProp=function(t){this.setProps(t),this.mPropGrid.setT(0),this.updateSelectItemDatas(t)},PicaFurnitureComposePanel.prototype.updateGridProp=function(t){this.setProps(t),this.updateSelectItemDatas(t)},PicaFurnitureComposePanel.prototype.setProps=function(t){var e=(t=t||[]).length;e<24&&(t=t.concat(new Array(24-e))),this.mPropGrid.setItems(t)},PicaFurnitureComposePanel.prototype.setStarData=function(t){this.starCount=t,this.mInitialized&&this.starvalue.setText(t+"")},PicaFurnitureComposePanel.prototype.updateSelectItemDatas=function(t){for(var e=[],i=0,n=this.mSelectedItemData;i<n.length;i++)for(var s=n[i],r=0,o=t;r<o.length;r++){var a=o[r];s&&a.indexId===s.indexId&&e.push(a)}this.mSelectedItemData.length=0,this.mSelectedItemData=e},PicaFurnitureComposePanel.prototype.setComposeResult=function(t){},PicaFurnitureComposePanel.prototype.addListen=function(){this.mInitialized&&(this.mCloseBtn.on(s.ClickEvent.Tap,this.onCloseHandler,this),this.composeBtn.on(s.ClickEvent.Tap,this.onComposeBtnHandler,this))},PicaFurnitureComposePanel.prototype.removeListen=function(){this.mInitialized&&(this.mCloseBtn.off(s.ClickEvent.Tap,this.onCloseHandler,this),this.composeBtn.off(s.ClickEvent.Tap,this.onComposeBtnHandler,this))},PicaFurnitureComposePanel.prototype.destroy=function(){this.mCategoryScroll&&this.mCategoryScroll.destroy(),this.mPropGrid&&this.mPropGrid.destroy(),t.prototype.destroy.call(this)},PicaFurnitureComposePanel.prototype.queryRefreshPackage=function(t){this.queryPackege(t)},PicaFurnitureComposePanel.prototype.onInitialized=function(){this.starCount&&this.starvalue.setText(this.starCount+"")},PicaFurnitureComposePanel.prototype.init=function(){var e=this,i=this.scaleWidth,n=this.scaleHeight;this.mBackground=new r.CommonBackground(this.scene,0,0,i,n,a.d.effectcommon,"synthetic_bg",13204211),this.topBackground=this.scene.make.image({key:a.d.effectcommon,frame:"synthetic_bg_stripe"}),this.mCategoryCon=this.scene.make.container(void 0,!1),this.mCategoryCon.setSize(i,295*this.dpr),this.mCategoryCon.y=n-this.mCategoryCon.height,this.mCategoriesBar=this.scene.make.graphics(void 0,!1),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.mCloseBtn=new r.ButtonEventDispatcher(this.scene,0,0),this.mCloseBtn.setSize(100*this.dpr,40*this.dpr),this.mCloseBtn.enable=!0,this.mCloseBtn.x=.5*this.mCloseBtn.width+10*this.dpr,this.mCloseBtn.y=35*this.dpr;var h=this.scene.make.image({key:a.d.uicommon,frame:"back_arrow"});h.x=.5*-this.mCloseBtn.width+.5*h.width+10*this.dpr;var c=this.scene.make.text({text:"",style:l.UIHelper.whiteStyle(this.dpr,18)}).setOrigin(0,.5);c.text=l.i18n.t("compose.title"),c.x=h.x+.5*h.width+10*this.dpr,this.mCloseBtn.add([h,c]),this.furiAnimation=new m(this.scene,this.dpr,this.scale),this.furiAnimation.setHandler(new l.Handler(this,this.onFuriComposeAnimationHandler));var p=new s.NineSlicePatch(this.scene,0,-this.dpr,80*this.dpr,28*this.dpr,a.d.uicommon,"home_assets_bg",{left:17*this.dpr,top:0*this.dpr,right:17*this.dpr,bottom:0*this.dpr});p.x=.5*-p.width,this.starvalue=new r.ImageValue(this.scene,60*this.dpr,26*this.dpr,a.d.uicommon,"Recast_pica star_big",this.dpr,{color:"#ffffff",fontSize:15*this.dpr,fontFamily:l.Font.NUMBER}),this.starvalue.setLayout(1),this.starvalue.x=p.x-.5*p.width+22*this.dpr,this.starCountCon=this.scene.make.container(void 0,!1),this.starCountCon.setSize(p.width,p.height),this.starCountCon.add([p,this.starvalue]),this.starCountCon.x=i-20*this.dpr,this.starCountCon.y=this.mCloseBtn.y;var d=100*this.dpr,u=40*this.dpr,y=i-d/2-20*this.dpr,f=this.mCategoryCon.y-25*this.dpr;this.composeBtn=this.createNineButton(y+100*this.dpr,f,d,u,a.d.uicommon,"yellow_btn",l.i18n.t("compose.title"),"#996600"),this.mCategoryScroll=new s.GameScroller(this.scene,{x:0,y:60*this.dpr,width:i,height:41*this.dpr,zoom:this.scale,orientation:1,dpr:this.dpr,space:28*this.dpr,selfevent:!0,cellupCallBack:function(t){e.onSelectSubCategoryHandler(t)}}),this.mPropGridBg=this.scene.make.graphics(void 0,!1),this.mCategoryCon.add([this.mCategoriesBar,this.mCategoryScroll]),this.add([this.mBackground,this.topBackground,this.mPropGridBg,this.mCloseBtn,this.furiAnimation,this.starCountCon,this.mCategoryCon,this.composeBtn]);var g=this.scene.textures.getFrame(a.d.uicommon,"bag_icon_common_bg"),P=g.width+9*this.dpr,v=g.height+9*this.dpr,b={x:0,y:0,table:{width:i,height:231*this.dpr,columns:3,cellWidth:P,cellHeight:v,reuseCellContainer:!0,zoom:this.scale,mask:!1},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.scene,s=t.item;return null===i&&(i=new o.c(n,a.d.effectcommon,"synthetic_icon_bg",e.dpr,e.scale,!1)),i.setData({item:s}),i.setItemData(s,!0),i}};this.mPropGrid=new s.GameGridTable(this.scene,b),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){t&&e.onSelectItemHandler(t)})),this.add(this.mPropGrid),this.resize(0,0),t.prototype.init.call(this)},PicaFurnitureComposePanel.prototype.createNineButton=function(t,e,i,n,r,o,a,h){var c=new s.NineSliceButton(this.scene,t,e,i,n,r,o,a,this.dpr,1,{left:14*this.dpr,top:14*this.dpr,right:15*this.dpr,bottom:14*this.dpr});return a&&(c.setTextStyle({color:h,fontSize:16*this.dpr,fontFamily:l.Font.DEFULT_FONT}),c.setFontStyle("bold")),c},PicaFurnitureComposePanel.prototype.onSelectSubCategoryHandler=function(t){var e=t.getData("item");e&&(this.mPreCategoryBtn&&this.mPreCategoryBtn.changeNormal(),t.changeDown(),this.mSelectedCategeories=e,this.subCategoryType=e.value,this.queryPackege(!1),this.mPreCategoryBtn=t),this.mPropGrid.setT(0),this.furiAnimation.clearItemDatas(!0),this.furiAnimation.setStarType(this.subCategoryType)},PicaFurnitureComposePanel.prototype.onCloseHandler=function(){this.render.renderEmitter(this.key+"_close")},PicaFurnitureComposePanel.prototype.queryPackege=function(t){this.mSelectedCategeories&&this.render.renderEmitter(this.key+"_queryfuripackage",{type:this.subCategoryType,update:t})},PicaFurnitureComposePanel.prototype.onSelectItemHandler=function(t){var e=t.getData("item");e&&this.checkSelectItemDatas(e,!0)},PicaFurnitureComposePanel.prototype.onComposeBtnHandler=function(){if(this.mSelectedItemData&&5===this.mSelectedItemData.length){if(this.starCount<this.subCategoryType){var t={text:[{text:l.i18n.t("furnicompose.starpicatips"),node:void 0}]};return void this.render.mainPeer.showMediator(h.ModuleName.PICANOTICE_NAME,!0,t)}for(var e=[],i=0,n=this.mSelectedItemData;i<n.length;i++){t=n[i];e.push(t.id)}this.render.renderEmitter(this.key+"_queryfuricompose",e),this.furiAnimation.playComposeAnimation(),this.mSelectedItemData.length=0}else{t={text:[{text:l.i18n.t("furnicompose.selecttips"),node:void 0}]};this.render.mainPeer.showMediator(h.ModuleName.PICANOTICE_NAME,!0,t)}},PicaFurnitureComposePanel.prototype.checkSelectItemDatas=function(t,e){if(!e||5!==this.mSelectedItemData.length){for(var i=-1,n=0;n<this.mSelectedItemData.length;n++){this.mSelectedItemData[n].indexId===t.indexId&&(i=n)}if(e)t.count>0&&(this.mSelectedItemData.push(t),this.furiAnimation.setItemData(t,this.subCategoryType),t.count--);else if(-1!==i)this.mSelectedItemData.splice(i,1)[0].count++;this.mPropGrid.refresh()}},PicaFurnitureComposePanel.prototype.onFuriComposeAnimationHandler=function(t,e){"remove"===t&&this.checkSelectItemDatas(e,!1)},PicaFurnitureComposePanel}(c.PicaBasePanel),m=function(t){function FuriComposeAnimation(e,i,n){var s=t.call(this,e)||this;return s.starImgList=[],s.itemList=[],s.indexeds=[0,0,0,0,0],s.tweens=[],s.canPlay=!1,s.dpr=i,s.zoom=n,s.init(),s.setSize(s.bgring1.width,s.bgring1.height),s}return p(FuriComposeAnimation,t),FuriComposeAnimation.prototype.setHandler=function(t){this.send=t},FuriComposeAnimation.prototype.setStarType=function(t){this.starType=t,this.bgstarLev.setFrame("synthetic_center_star"+(t+1)),this.spendStarTex.text=l.i18n.t("furnicompose.spendstar",{name:t}),this.bgstarLev.visible=!0},FuriComposeAnimation.prototype.setItemData=function(t,e){this.starType=e;for(var i=-1,n=0;n<this.indexeds.length;n++){if(0===this.indexeds[n])-1===i&&(i=n);else this.itemList[n].itemData.indexId===t.indexId&&0}-1!==i&&t.count>0&&(this.indexeds[i]=1,this.itemList[i].setItemData(t),this.starImgList[i].visible=!0,this.playAnimation());this.displayStarImg()},FuriComposeAnimation.prototype.removeItemData=function(t){this.indexeds[t]=0;var e=this.itemList[t];e.itemData&&(this.send&&this.send.runWith(["remove",e.itemData]),e.setItemData(void 0)),this.displayStarImg();for(var i=!1,n=0,s=this.indexeds;n<s.length;n++){1===s[n]&&(i=!0)}i?this.playAnimation():this.stopAnimation()},FuriComposeAnimation.prototype.clearItemDatas=function(t){for(var e=0;e<this.indexeds.length;e++){this.indexeds[e]=0;var i=this.itemList[e];i.itemData&&(t&&this.send&&this.send.runWith(["remove",i.itemData]),i.setItemData(void 0))}this.stopTweens(),this.displayStarImg(),this.stopAnimation(),this.layoutItemsPosition()},FuriComposeAnimation.prototype.playComposeAnimation=function(){for(var t=0,e=this.itemList;t<e.length;t++){var i=e[t];this.playMove(i,0,0,200)}},FuriComposeAnimation.prototype.update=function(){this.canPlay&&(this.bgring1.rotation+=.04,this.bgring2.rotation-=.015,this.bgring3.rotation+=.02)},FuriComposeAnimation.prototype.destroy=function(){t.prototype.destroy.call(this),this.stopAnimation(),this.stopTweens()},FuriComposeAnimation.prototype.init=function(){this.bgring1=this.scene.make.image({key:a.d.effectcommon,frame:"synthetic_ring_1"}),this.bgring2=this.scene.make.image({key:a.d.effectcommon,frame:"synthetic_ring_2"}),this.bgring3=this.scene.make.image({key:a.d.effectcommon,frame:"synthetic_ring_3"}),this.bgring4=this.scene.make.image({key:a.d.effectcommon,frame:"synthetic_ring_4"}),this.bgring5=this.scene.make.image({key:a.d.effectcommon,frame:"synthetic_ring_5"}),this.bgring6=this.scene.make.image({key:a.d.effectcommon,frame:"synthetic_ring_6"}),this.bgringstar=this.scene.make.image({key:a.d.effectcommon,frame:"synthetic_star_default"}),this.bgstarLev=this.scene.make.image({key:a.d.effectcommon,frame:"synthetic_center_star2"}),this.bglightstar=this.scene.make.image({key:a.d.effectcommon,frame:"synthetic_star_illume_5"}),this.bglightstar.y=3*this.dpr,this.spendStarTex=new s.BBCodeText(this.scene,0,.5*this.bgring1.height+15*this.dpr,"",l.UIHelper.whiteStyle(this.dpr,11)).setOrigin(.5),this.add([this.bgring1,this.bgring2,this.bgring3,this.bgring4,this.bgring5,this.bgring6,this.bgringstar,this.bgstarLev,this.bglightstar,this.spendStarTex]),this.createStarImg(),this.createItem(),this.bglightstar.visible=!1,this.bgstarLev.visible=!1},FuriComposeAnimation.prototype.createStarImg=function(){for(var t=2*Math.PI/5-.0096,e=0;e<5;e++){var i=this.scene.make.image({key:a.d.effectcommon,frame:"synthetic_star_illume_1"});i.rotation=-t*e+5e-4,this.starImgList.push(i),i.visible=!1,i.y=3*this.dpr,i.x=-2*this.dpr}this.add(this.starImgList)},FuriComposeAnimation.prototype.createItem=function(){for(var t=0;t<5;t++){var e=new u(this.scene,this.dpr,this.zoom);this.itemList.push(e),e.on(s.ClickEvent.Tap,this.onItemHandler,this)}this.add(this.itemList),this.layoutItemsPosition()},FuriComposeAnimation.prototype.layoutItemsPosition=function(){for(var t=3*Math.PI/2-2*Math.PI/5,e=108*this.dpr,i=0;i<this.itemList.length;i++){var n=this.itemList[i],s=t-2*Math.PI/5*i;n.y=Math.sin(s)*e,n.x=Math.cos(s)*e}},FuriComposeAnimation.prototype.displayStarImg=function(){for(var t=0,e=0;e<this.indexeds.length;e++){var i=this.indexeds[e];this.starImgList[e].visible=0!==i,0===i?this.starImgList[e].visible=!1:(this.starImgList[e].visible=!0,t++)}if(5===t){this.bglightstar.visible=!0;for(var n=0,s=this.starImgList;n<s.length;n++){s[n].visible=!1}}else this.bglightstar.visible=!1},FuriComposeAnimation.prototype.playAnimation=function(){this.canPlay=!0,this.timerID||(this.timerID=setInterval(this.update.bind(this),20))},FuriComposeAnimation.prototype.stopAnimation=function(){this.canPlay=!1,this.bgring1.rotation=0,this.bgring2.rotation=0,this.bgring3.rotation=0,this.timerID&&(this.timerID=clearInterval(this.timerID),this.timerID=void 0)},FuriComposeAnimation.prototype.onItemHandler=function(t,e){var i=this.itemList.indexOf(e);this.removeItemData(i)},FuriComposeAnimation.prototype.playMove=function(t,e,i,n){var s=this;if(this.scene){var r=this.scene.tweens.add({targets:t,x:{value:0},y:{value:3*this.dpr},ease:"Linear",duration:n,onComplete:function(){r.stop(),r.remove(),s.clearItemDatas(!1)}});this.tweens.push(r)}},FuriComposeAnimation.prototype.stopTweens=function(){for(var t=0,e=this.tweens;t<e.length;t++){var i=e[t];i.stop(),i.remove()}this.tweens.length=0},FuriComposeAnimation}(Phaser.GameObjects.Container),u=function(t){function FuriComposeItem(e,i,n){var s=t.call(this,e,0,0)||this;return s.dpr=i,s.zoom=n,s.init(),s.setSize(s.bg.width,s.bg.height),s.enable=!0,s}return p(FuriComposeItem,t),FuriComposeItem.prototype.setItemData=function(t){if(this.itemData=t,this.lightbg.alpha=0,this.icon.alpha=0,t){var e=l.Url.getOsdRes(t.display.texturePath);this.icon.load(e),this.icon.visible=!0,this.playAlphaAni([this.icon,this.lightbg])}else this.icon.visible=!1},FuriComposeItem.prototype.init=function(){this.bg=this.scene.make.image({key:a.d.effectcommon,frame:"synthetic_default"}),this.lightbg=this.scene.make.image({key:a.d.effectcommon,frame:"synthetic_Light"}),this.icon=new r.DynamicImage(this.scene,0,0),this.icon.scale=this.dpr/this.zoom,this.add([this.bg,this.lightbg,this.icon]),this.lightbg.alpha=0,this.icon.alpha=0},FuriComposeItem.prototype.playAlphaAni=function(t){if(this.scene)var e=this.scene.tweens.add({targets:t,alpha:{from:0,to:1},ease:"Linear",duration:300,onComplete:function(){e.stop(),e.remove()}})},FuriComposeItem}(r.ButtonEventDispatcher)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaGiftEffectPanel",(function(){return l}));var n,s=i(470),r=i(1),o=i(508),a=i(510),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaGiftEffectPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=r.ModuleName.PICAGIFTEFFECT_NAME,i}return h(PicaGiftEffectPanel,t),PicaGiftEffectPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;this.content.x=n/2,this.content.y=s/2,t.prototype.resize.call(this,n,s),this.setSize(n*this.scale,s*this.scale)},PicaGiftEffectPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||this.mInitialized||this.preload()},PicaGiftEffectPanel.prototype.preload=function(){this.addAtlas(this.key,"gifteffect/gifteffect.png","gifteffect/gifteffect.json"),t.prototype.preload.call(this)},PicaGiftEffectPanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight;this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.add(this.content),this.laterctPanel=new o.PicaGiftLaterctPanel(this.scene,this.mWorld,e,i,this.key,this.dpr),this.playerPanel=new a.PicaGiftPlayerPanel(this.scene,this.mWorld,e,i,this.key,this.dpr),this.content.add(this.laterctPanel),this.content.add(this.playerPanel),this.resize(0,0),t.prototype.init.call(this),this.play(void 0)},PicaGiftEffectPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaGiftEffectPanel.prototype.play=function(t){this.mInitialized&&(this.laterctPanel.play(t),this.playerPanel.play(t))},PicaGiftEffectPanel}(s.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaHousePanel",(function(){return p}));var n,s=i(5),r=i(470),o=i(511),a=i(1),h=i(0),l=i(11),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaHousePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=a.ModuleName.PICAHOUSE_NAME,i}return c(PicaHousePanel,t),PicaHousePanel.prototype.resize=function(t,e){this.scale;var i=this.scaleWidth,n=this.scaleHeight;this.content.x=.5*i,this.content.y=.5*n,this.setSize(i,n),this.itemsPanel.y=.5*this.height-60*this.dpr,this.itemsPanel.x=.5*this.width},PicaHousePanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen(),this.updateData()):this.preload())},PicaHousePanel.prototype.hide=function(){this.mShow=!1,this.removeListen()},PicaHousePanel.prototype.addListen=function(){this.mInitialized&&(this.closeBtn.on("pointerup",this.onCloseHandler,this),this.editorRoomBtn.on("pointerup",this.onEnterEditorHandler,this))},PicaHousePanel.prototype.removeListen=function(){this.mInitialized&&(this.closeBtn.off("pointerup",this.onCloseHandler,this),this.editorRoomBtn.off("pointerup",this.onEnterEditorHandler,this))},PicaHousePanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaHousePanel.prototype.setRoomInfoData=function(t,e){if(void 0===e&&(e=!0),this.mRoomInfoData=t,this.mInitialized){var i=295*this.dpr,n=370*this.dpr;"store"===t.roomType?(n=460*this.dpr,this.content.setSize(i,n),this.bg.resize(i,n),this.roomInfoBtn.y=.5*-this.content.height-.5*this.roomInfoBtn.height+5*this.dpr,this.roomSettingBtn.y=this.roomInfoBtn.y,this.closeBtn.y=.5*-this.bg.height+5*this.dpr,this.editorRoomBtn.y=.5*this.content.height-30*this.dpr,this.houseInfoPanel.y=.5*-this.content.height+.5*this.houseInfoPanel.height+30*this.dpr):this.closeShopBtn.visible=!1,this.houseInfoPanel.setAttributeData(t,e),this.roomSettingBtn.visible=e,this.editorRoomBtn.visible=e}},PicaHousePanel.prototype.on_REFURBISH_REQUIREMENTS=function(t){var e=this;this.itemsPanel.setHandler(new h.Handler(this,(function(){e.render.renderEmitter(a.ModuleName.PICAHOUSE_NAME+"_queryrefurbish",e.mRoomInfoData.roomId)}))),this.itemsPanel.setItemDatas(t.requirements)},PicaHousePanel.prototype.preload=function(){this.addAtlas(this.key,"room_information/room_information.png","room_information/room_information.json"),this.addAtlas(l.c.commonKey,l.d.commonUrl+".png",l.d.commonUrl+".json"),this.addAtlas(l.c.common2Key,l.d.common2Url+".png",l.d.common2Url+".json"),t.prototype.preload.call(this)},PicaHousePanel.prototype.init=function(){var e=this;if(!this.mInitialized){var i=this.scaleWidth,n=this.scaleHeight;this.mBackground=this.scene.make.graphics(void 0,!1),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.mBackground.fillStyle(0,.66),this.mBackground.fillRect(0,0,i,n),this.add(this.mBackground),this.content=this.scene.make.container(void 0,!1);var c=295*this.dpr,p=370*this.dpr;this.content.setSize(c,p),this.bg=new s.NineSlicePatch(this.scene,0,0,c,p,l.c.common2Key,"bg",{left:20*this.dpr,top:20*this.dpr,right:20*this.dpr,bottom:60*this.dpr}),this.content.add(this.bg),this.closeBtn=this.scene.make.image({x:.5*this.bg.width-5*this.dpr,y:.5*-this.bg.height+5*this.dpr,key:l.c.commonKey,frame:"close"}).setScale(1.3),this.closeBtn.setInteractive(),this.closeBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.content.add([this.closeBtn]),this.roomInfoBtn=this.createTabButton(h.i18n.t("room_info.infobtn"),"small_information"),this.roomSettingBtn=this.createTabButton(h.i18n.t("room_info.setting"),"small_setting"),this.roomInfoBtn.setPosition(.5*-this.roomInfoBtn.width-2*this.dpr,.5*-this.content.height-.5*this.roomInfoBtn.height+3*this.dpr),this.roomSettingBtn.setPosition(.5*this.roomSettingBtn.width+2*this.dpr,this.roomInfoBtn.y),this.topCheckBox=new r.CheckboxGroup,this.topCheckBox.appendItemAll([this.roomInfoBtn,this.roomSettingBtn]),this.topCheckBox.on("selected",this.onTabBtnHandler,this),this.content.add([this.roomInfoBtn,this.roomSettingBtn]),this.houseInfoPanel=new o.PicaHouseInfoPanel(this.scene,0,0,this.content.width-40*this.dpr,this.content.height-70*this.dpr,this.key,this.dpr),this.houseInfoPanel.y=.5*-this.content.height+.5*this.houseInfoPanel.height+30*this.dpr,this.houseInfoPanel.setHandler(new h.Handler(this,(function(){e.itemsPanel.visible=!0,e.add(e.itemsPanel),e.itemsPanel.resetMask(),e.mRoomInfoData.undepreciated<1?e.render.renderEmitter(a.ModuleName.PICAHOUSE_NAME+"_queryrequirements",e.mRoomInfoData.roomId):(e.itemsPanel.setContent(h.i18n.t("room_info.renovatetips")),e.itemsPanel.setHandler(null))}))),this.content.add(this.houseInfoPanel),this.closeShopBtn=new s.NineSliceButton(this.scene,0,this.houseInfoPanel.height-30*this.dpr,94*this.dpr,29*this.dpr,this.key,"close_shop",h.i18n.t("room_info.closeshop"),this.dpr,this.scale,{left:14*this.dpr,top:0*this.dpr,right:14*this.dpr,bottom:0*this.dpr}),this.closeShopBtn.setTextStyle({color:"#C12914",fontSize:12*this.dpr,fontFamily:h.Font.DEFULT_FONT});var d=this.houseInfoPanel.y+.5*this.houseInfoPanel.height+.5*this.closeShopBtn.height+20*this.dpr;this.closeShopBtn.y=d,this.houseInfoPanel.add(this.closeShopBtn),this.closeShopBtn.visible=!1;var m=.5*this.content.height;this.editorRoomBtn=new s.NineSliceButton(this.scene,0,m-30*this.dpr,100*this.dpr,35*this.dpr,l.c.commonKey,"button_g",h.i18n.t("room_info.editorroom"),this.dpr,this.scale,{left:16*this.dpr,top:16*this.dpr,right:16*this.dpr,bottom:16*this.dpr}),this.editorRoomBtn.setTextStyle({color:"#022B55",fontSize:12*this.dpr,fontFamily:h.Font.DEFULT_FONT}),this.editorRoomBtn.setTextOffset(10*this.dpr,0);var u=.5*-this.editorRoomBtn.width+8*this.dpr,y=this.scene.make.image({x:u,y:-3*this.dpr,key:this.key,frame:"renovation"});y.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.editorRoomBtn.add(y),this.content.add(this.editorRoomBtn),this.editorRoomBtn.visible=!1,this.topCheckBox.selectIndex(0),this.itemsPanel=new r.ItemsConsumeFunPanel(this.scene,278*this.dpr,198*this.dpr,this.dpr,this.scale),this.itemsPanel.createBackGrphaic(i,n),this.itemsPanel.setTextInfo(h.i18n.t("room_info.renovate").toUpperCase(),h.i18n.t("room_info.needmaterials")),this.itemsPanel.visible=!1,this.add(this.content),this.resize(0,0),t.prototype.init.call(this)}},PicaHousePanel.prototype.updateData=function(){this.mRoomInfoData&&this.setRoomInfoData(this.mRoomInfoData)},PicaHousePanel.prototype.onTabBtnHandler=function(t){this.roomInfoBtn===t?this.houseInfoPanel.visible=!0:this.houseInfoPanel.visible=!1,this.roomSettingBtn===t&&(this.houseInfoPanel.visible=!1)},PicaHousePanel.prototype.createTabButton=function(t,e){var i=new s.TabButton(this.scene,this.key,"default tab","check tab",t);i.setTextStyle({fontFamily:h.Font.DEFULT_FONT,fontSize:12*this.dpr,color:"#ffffff"}),i.setTextOffset(13*this.dpr,0);var n=this.scene.make.image({key:this.key,frame:e});return i.add(n),n.x=.5*-i.width+.5*n.width+7*this.dpr,i},PicaHousePanel.prototype.onCloseShopHandler=function(){this.render.renderEmitter(a.ModuleName.PICAHOUSE_NAME+"_closeshop",this.mRoomInfoData)},PicaHousePanel.prototype.onCloseHandler=function(){this.render.renderEmitter(a.ModuleName.PICAHOUSE_NAME+"_hide")},PicaHousePanel.prototype.onEnterEditorHandler=function(){this.render.renderEmitter(a.ModuleName.PICAHOUSE_NAME+"_scenedecorate")},PicaHousePanel}(r.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaItemPopCardPanel",(function(){return c}));var n,s=i(643),r=i(470),o=i(1),a=i(0),h=i(473),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaItemPopCardPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.mPressDelay=1e3,i.key=o.ModuleName.PICAITEMPOPCARD_NAME,i.setTween(!1),i}return l(PicaItemPopCardPanel,t),PicaItemPopCardPanel.prototype.addListen=function(){this.mInitialized&&(this.mDetailDisplay.on("show",this.onShowHandler,this),this.on("pointerup",this.onCloseHandler,this),this.mCloseBtn.on("pointerup",this.onCloseHandler,this),this.mNickName.on("pointerup",this.onPointerNickNameHandler,this),this.mNickName.on("pointerdown",this.onPointerNickNameDownHandler,this),this.mDesText.on("pointerdown",this.onPointerDesDownHandler,this),this.mDesText.on("pointerup",this.onPointerNickNameHandler,this))},PicaItemPopCardPanel.prototype.removeListen=function(){this.mInitialized&&(this.mDetailDisplay.off("show",this.onShowHandler,this),this.off("pointerup",this.onCloseHandler,this),this.mCloseBtn.off("pointerup",this.onCloseHandler,this),this.mNickName.off("pointerup",this.onPointerNickNameHandler,this),this.mNickName.off("pointerdown",this.onPointerNickNameDownHandler,this),this.mDesText.off("pointerdown",this.onPointerDesDownHandler,this),this.mDesText.off("pointerup",this.onPointerNickNameHandler,this))},PicaItemPopCardPanel.prototype.resize=function(e,i){var n=this.render.uiScale,s=this.scene.cameras.main.width/n,r=this.scene.cameras.main.height/n,o=this.scene.cameras.main.centerX/n,a=this.scene.cameras.main.centerY/n;this.setSize(s,r),this.mCardContainer.x=o,this.mCardContainer.y=a,this.mCloseBtn.x=o,this.mCloseBtn.y=a+this.mCardContainer.height/2+48*this.dpr,t.prototype.resize.call(this,e,i)},PicaItemPopCardPanel.prototype.setProp=function(){if(this.mShowData){var t=this.mShowData[0].prop;if(t){this.mDesText.setText(t.des),this.mNickName.setText(t.name),t.source?this.mSource.setText(t.source):this.mSource.setText("");var e=this.mShowData[0].display;e&&(e.display?this.mDetailDisplay.loadDisplay(e):e.avatar?this.mDetailDisplay.loadAvatar(e.avatar):this.mDetailDisplay.loadUrl(t.icon))}}},PicaItemPopCardPanel.prototype.preload=function(){this.addAtlas(this.key,"item_pop_card/item_pop_card.png","item_pop_card/item_pop_card.json"),t.prototype.preload.call(this)},PicaItemPopCardPanel.prototype.init=function(){this.mCardContainer=this.scene.make.container({width:325*this.dpr,height:468*this.dpr},!1),this.mCardContainer.setSize(325*this.dpr,468*this.dpr),this.mCardContainer.setInteractive(),this.mBorder=this.scene.make.graphics(void 0,!1),this.mBorder.fillGradientStyle(7304703,7304703,118271,118271),this.mBorder.fillRect(-this.mCardContainer.width/2,-this.mCardContainer.height/2,this.mCardContainer.width,this.mCardContainer.height);var e=this.scene.make.image({key:this.key,frame:"bg.png"},!1);e.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),e.y=23*this.dpr-e.height/2;var i=this.scene.make.image({y:42*this.dpr,key:this.key,frame:"name_bg.png"});i.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mNickName=this.scene.make.text({y:42*this.dpr,style:{fontSize:18*this.dpr,fontFamily:a.Font.DEFULT_FONT}},!1).setOrigin(.5).setInteractive();var n=this.scene.make.image({y:138*this.dpr,key:this.key,frame:"des_bg.png"},!1);n.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mDesText=this.scene.make.text({x:n.x-n.width/2+12*this.dpr,y:n.y-n.height/2+10*this.dpr,style:{fontSize:10*this.dpr,fontFamily:a.Font.DEFULT_FONT,wordWrap:{width:240*this.dpr,useAdvancedWrap:!0}}},!1).setInteractive(),this.mDetailDisplay=new h.DetailDisplay(this.scene,this.render),this.mDetailDisplay.setFixedScale(2*this.dpr/this.scale),this.mCloseBtn=this.scene.make.image({key:this.key,frame:"close.png"},!1).setInteractive(),this.mCloseBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mSource=this.scene.make.text({x:n.x-n.width/2+12*this.dpr,y:n.y+n.height/2-23*this.dpr,style:{fontSize:10*this.dpr,fontFamily:a.Font.DEFULT_FONT}},!1),this.add(this.mCardContainer),this.mCardContainer.add([this.mBorder,e,n,this.mDetailDisplay,i,this.mNickName,this.mDesText,this.mSource]),this.add(this.mCloseBtn),this.resize(0,0),t.prototype.init.call(this),this.setInteractive(),this.setProp()},PicaItemPopCardPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_close"),clearTimeout(this.mPressTime),this.mNickNameDown=!1},PicaItemPopCardPanel.prototype.onPointerNickNameHandler=function(){clearTimeout(this.mPressTime),this.mNickNameDown=!1},PicaItemPopCardPanel.prototype.onPointerNickNameDownHandler=function(){var t=this;this.mPressTime=setTimeout((function(){t.copyName()}),this.mPressDelay)},PicaItemPopCardPanel.prototype.onPointerDesDownHandler=function(){var t=this;this.mPressTime=setTimeout((function(){t.copyDes()}),this.mPressDelay)},PicaItemPopCardPanel.prototype.copyName=function(){if(this.mNickName){s(this.mNickName.text);var t={noticeContext:a.i18n.t("item.copy_suc",{name:a.i18n.t("item.name")})};this.render.renderEmitter(o.MessageType.SHOW_NOTICE,{content:t})}},PicaItemPopCardPanel.prototype.copyDes=function(){if(this.mDesText){s(this.mDesText.text);var t={noticeContext:a.i18n.t("item.copy_suc",{name:a.i18n.t("item.des")})};this.render.renderEmitter(o.MessageType.SHOW_NOTICE,{content:t})}},PicaItemPopCardPanel.prototype.onShowHandler=function(t){this.mDetailDisplay.y=-this.mCardContainer.height/4},PicaItemPopCardPanel}(r.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaManorListPanel",(function(){return p}));var n,s=i(470),r=i(11),o=i(1),a=i(0),h=i(512),l=i(513),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaManorListPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=o.ModuleName.PICAMANORLIST_NAME,i}return c(PicaManorListPanel,t),PicaManorListPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,e,i),this.setSize(n,s),this.mBackGround.clear(),this.mBackGround.fillStyle(0,.66),this.mBackGround.fillRect(0,0,n,s)},PicaManorListPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicaManorListPanel.prototype.addListen=function(){this.mInitialized},PicaManorListPanel.prototype.removeListen=function(){this.mInitialized},PicaManorListPanel.prototype.preload=function(){this.addAtlas(this.key,"manor/manor.png","manor/manor.json"),this.addAtlas(r.c.commonKey,r.d.commonUrl+".png",r.d.commonUrl+".json"),this.addAtlas(r.c.common2Key,r.d.common2Url+".png",r.d.common2Url+".json"),t.prototype.preload.call(this)},PicaManorListPanel.prototype.init=function(){var e=this.scale,i=this.scaleWidth,n=this.scaleHeight;this.mBackGround=this.scene.make.graphics(void 0,!1),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,i*e,n*e),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.add(this.mBackGround);var s=90*this.dpr,r=74*this.dpr,o=295*this.dpr,l=n-s-r,c=s+.5*l,p=.5*i;this.content=new h.PicaManorContentPanel(this.scene,p,c,o,l,this.dpr,this.key),this.content.setCloseHandler(new a.Handler(this,this.OnCloseHandler)),this.add(this.content),this.resize(i,n),t.prototype.init.call(this),this.openManorList()},PicaManorListPanel.prototype.setManorList=function(t){this.picScrollPanel.setManorListData(t)},PicaManorListPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaManorListPanel.prototype.openManorList=function(){this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_querylist"),this.showScrollPanel(),this.content.setTitleText(a.i18n.t("manor.title"))},PicaManorListPanel.prototype.showScrollPanel=function(){var t=this,e=90*this.dpr,i=74*this.dpr;if(this.setContentSize(e,i),!this.picScrollPanel){var n=this.content.width,s=this.content.height-50*this.dpr;this.picScrollPanel=new l.PicaManorScrollPanel(this.scene,0,0,n,s,this.dpr,this.scale,this.key),this.picScrollPanel.setHandler(new a.Handler(this,(function(e){t.render.renderEmitter(o.RENDER_PEER+"_"+t.key+"_queryenter",e)})))}this.content.add(this.picScrollPanel),this.picScrollPanel.resetMask()},PicaManorListPanel.prototype.hideScrollPanel=function(){this.content.remove(this.picScrollPanel)},PicaManorListPanel.prototype.setContentSize=function(t,e){var i=this.scaleWidth,n=this.scaleHeight,s=334*this.dpr,r=452*this.dpr,o=.5*n,a=.5*i;this.content.setPosition(a,o),this.content.setContentSize(s,r)},PicaManorListPanel.prototype.OnCloseHandler=function(){this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_hide")},PicaManorListPanel.prototype.onSelectItemHandler=function(t){},PicaManorListPanel}(s.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaMarketPanel",(function(){return d}));var n,s=i(514),r=i(516),o=i(5),a=i(470),h=i(1),l=i(0),c=i(11),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaMarketPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=h.ModuleName.PICAMARKET_NAME,i.mSubTabs=[],i.mTabs=[],i}return p(PicaMarketPanel,t),PicaMarketPanel.prototype.addListen=function(){this.mInitialized&&(this.mSelectItem.on("buyItem",this.onBuyItemHandler,this),this.mSelectItem.on("popItemCard",this.onPopItemCardHandler,this))},PicaMarketPanel.prototype.removeListen=function(){this.mInitialized&&(this.mSelectItem.off("buyItem",this.onBuyItemHandler,this),this.mSelectItem.off("popItemCard",this.onPopItemCardHandler,this))},PicaMarketPanel.prototype.resize=function(t,e){var i=this.scaleWidth,n=this.scaleHeight;this.setSize(i,n),this.mTIle.x=i/2;var s=290*this.dpr;this.mBackgroundColor.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.mShelfContainer.setSize(i,s),this.mShelfContainer.setPosition(0,n-this.mShelfContainer.height),this.mShelfBackground.clear(),this.mShelfBackground.fillStyle(183551),this.mShelfBackground.fillRect(0,0,this.mShelfContainer.width,this.mShelfContainer.height),this.mShelfBackground.y=this.mSubCategeoriesContainer.y+43*this.dpr,this.mSelectItem.resize(i,n),this.mCategoriesBar.clear(),this.mCategoriesBar.fillStyle(4121087),this.mCategoriesBar.fillRect(0,0,i,40*this.dpr),this.mCategoriesBar.fillStyle(308179),this.mCategoriesBar.fillRect(0,40*this.dpr,i,3*this.dpr),this.mSubCategeoriesContainer.setSize(i,43*this.dpr)},PicaMarketPanel.prototype.setCategories=function(t){if(this.mCategoriesContainer){this.mCategoriesContainer.removeAll(!0);var e=t.marketCategory;this.mTabs=[];var i=this.scene.textures.getFrame(this.key,"categories_normal"),n=60;i&&(n=i.width,i.height);for(var s={left:n/2,top:12*this.dpr,right:4*this.dpr,bottom:2*this.dpr},r=new a.CheckboxGroup,h=77*this.dpr,c=38*this.dpr,p=0;p<e.length;p++){var d=new o.NinePatchTabButton(this.scene,h,c,this.key,"categories_normal","categories_down",e[p].category.value,[s],1,1);d.setTextStyle({fontSize:18*this.dpr,fontFamily:l.Font.DEFULT_FONT}),this.mTabs[p]=d,d.setData("category",e[p]),d.x=80*p*this.dpr+h/2,d.y=c/2}this.mCategoriesContainer.setSize(this.mTabs.length*h,c),this.mShelfContainer.add(this.mTabs),this.layoutCategories(),r.on("selected",this.onSelectCategoryHandler,this),r.appendItemAll(this.mTabs),r.selectIndex(0)}},PicaMarketPanel.prototype.setProp=function(t){this.clearCategories(this.mItems),this.mItems=[];var e=t.commodities;this.mPropGrid.setItems(e),this.mPropGrid.layout(),this.mPropGrid.setT(0),e.length>0&&this.onSelectItemHandler(e[0])},PicaMarketPanel.prototype.setCommodityResource=function(t){this.mSelectItem&&(this.mSelectItem.setResource(t),this.mSelectItem.setData("display",t))},PicaMarketPanel.prototype.destroy=function(){this.mSubCategorisScroll&&this.mSubCategorisScroll.destroy(),this.mPropGrid&&this.mPropGrid.destroy(),t.prototype.destroy.call(this)},PicaMarketPanel.prototype.onPropConfirmHandler=function(t,e){this.render.renderEmitter(this.key+"_buyItem",t)},PicaMarketPanel.prototype.layoutCategories=function(){this.mCategoriesBar.y=this.mCategoriesContainer.height+this.mShelfContainer.y,this.mSubCategeoriesContainer.addAt(this.mCategoriesBar,0),this.mPropContainer.y=this.mSubCategeoriesContainer.y+43*this.dpr+this.mSubCategeoriesContainer.height+9*this.dpr,this.mShelfBackground.y=this.mSubCategeoriesContainer.y+43*this.dpr,this.mSubCategorisScroll.y=this.mCategoriesBar.y+25*this.dpr,this.randomCon.y=this.mSubCategorisScroll.y,this.mPropGrid.y=this.mCategoriesBar.y+this.mSubCategeoriesContainer.height+.5*this.mPropGrid.height+5*this.dpr,this.mPropGrid.layout(),this.mSubCategorisScroll.layout(),this.mSubCategorisScroll.resetMask(),this.mPropGrid.resetMask()},PicaMarketPanel.prototype.preload=function(){this.addAtlas(this.key,"market/market.png","market/market.json"),this.addAtlas(c.c.commonKey,c.d.commonUrl+".png",c.d.commonUrl+".json"),t.prototype.preload.call(this)},PicaMarketPanel.prototype.init=function(){var e=this;if(!this.mInitialized){var i=this.scaleWidth,n=this.scaleHeight;this.mBackgroundColor=this.scene.make.graphics(void 0,!1),this.mBackgroundColor.fillGradientStyle(7304703,7304703,314367,314367),this.mBackgroundColor.fillRect(0,0,i,n),this.add(this.mBackgroundColor),this.mShelfContainer=this.scene.make.container({x:i/2,y:n},!1).setSize(i,290*this.dpr);for(var h=this.scene.textures.getFrame(this.key,"bg"),p=Math.ceil(i/h.width),d=Math.ceil((n-this.mShelfContainer.height+h.height)/h.height),m=0;m<p;m++)for(var u=0;u<d;u++){var y=this.scene.make.image({x:m*h.width,y:u*h.height,key:this.key,frame:"bg"},!1);y.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.add(y)}this.mShelfBackground=this.scene.make.graphics(void 0,!1),this.mCloseBtn=new o.Button(this.scene,c.d.uicommon,"back_arrow","back_arrow"),this.mCloseBtn.setPosition(21*this.dpr,35*this.dpr),this.mCloseBtn.setInteractive(new Phaser.Geom.Rectangle(-28*this.dpr,-20*this.dpr,56*this.dpr,40*this.dpr),Phaser.Geom.Rectangle.Contains),this.mCloseBtn.on(o.ClickEvent.Tap,this.onCloseHandler,this),this.mPropContainer=this.scene.make.container(void 0,!1),this.mCategoriesContainer=this.scene.make.container(void 0,!1),this.mSubCategeoriesContainer=this.scene.make.container(void 0,!1),this.mShelfContainer.add([this.mShelfBackground,this.mCategoriesContainer,this.mPropContainer]),this.add([this.mShelfContainer,this.mSubCategeoriesContainer]),this.mSelectItem=new s.ElementDetail(this.scene,this.render,this.key,this.dpr,this.scale),this.mSelectItem.setSize(i,n-this.mShelfContainer.height),this.mTIle=this.scene.make.text({text:l.i18n.t("market.title"),y:30*this.dpr,style:{fontSize:36*this.dpr,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(.5),this.add([this.mTIle,this.mSelectItem,this.mCloseBtn]),t.prototype.init.call(this),this.mCategoriesBar=this.scene.make.graphics(void 0,!1);var f=56*this.dpr,g=41*this.dpr,P={x:i/2,y:0,table:{width:i,height:50*this.dpr,cellWidth:f,cellHeight:g,reuseCellContainer:!0,zoom:this.scale,mask:!1},scrollMode:1,createCellContainerCallback:function(t,i){var n=t.scene,s=t.item;return null===i&&(i=new a.TextButton(n,e.dpr)),i.getData("item")!==s&&(i.setText(s.value),i.setData({item:s}),s&&e.mPreSubCategoris&&e.mPreSubCategoris.key===s.key?i.changeDown():i.changeNormal()),i}};this.mSubCategorisScroll=new o.GameGridTable(this.scene,P),this.mSubCategorisScroll.on("cellTap",(function(t,i){e.onSelectSubCategoryHandler(t)})),this.add(this.mSubCategorisScroll),this.randomCon=this.scene.make.container(void 0,!1),this.randomCon.x=.5*i,this.randomCon.visible=!1,this.add(this.randomCon),this.randomRefeshTime=this.scene.make.text({x:.5*-i+10*this.dpr,y:-12*this.dpr,text:l.i18n.t("market.refreshtime"),style:{color:"#007AAE",fontSize:13*this.dpr,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(0,.5);var v=80*this.dpr,b=30*this.dpr;this.randomRefreshBtn=new o.NineSliceButton(this.scene,.5*i,this.randomRefeshTime.y,v,b,c.c.commonKey,"button_g",l.i18n.t("market.refresh"),this.dpr,this.scale,{left:15*this.dpr,top:15*this.dpr,right:15*this.dpr,bottom:15*this.dpr}),this.randomRefreshBtn.x=.5*i-.5*this.randomRefreshBtn.width-10*this.dpr,this.randomRefreshBtn.setTextOffset(0,5*this.dpr),this.randomRefreshBtn.setTextStyle({color:"#0",fontSize:13*this.dpr,fontFamily:l.Font.DEFULT_FONT}),this.randomRefreshBtn.setFontStyle("bold"),this.refreshIcon=this.scene.make.image({key:c.c.commonKey,frame:"iv_coin"}).setScale(.8),this.refreshIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.refreshIcon.setPosition(-10*this.dpr,-8*this.dpr),this.refreshNeedCount=this.scene.make.text({x:0*this.dpr,y:this.refreshIcon.y,text:"100",style:{fontSize:10*this.dpr,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(0,.5),this.randomRefreshBtn.add([this.refreshIcon,this.refreshNeedCount]),this.randomCon.add([this.randomRefeshTime,this.randomRefreshBtn]);var _=this.scene.textures.getFrame(this.key,"border"),k=_.width+6*this.dpr,w=_.height+10*this.dpr,x={x:i/2+4*this.dpr,y:0,table:{width:i,height:224*this.dpr,columns:3,cellWidth:k,cellHeight:w,reuseCellContainer:!0,cellOriginX:0,cellOriginY:0,zoom:this.scale,mask:!1},scroller:{backDeceleration:!1,slidingDeceleration:!1},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.scene,s=t.item;return null===i&&(i=new r.MarketItem(n,0,0,e.dpr,e.scale)),i.setData({item:s}),i.setProp(s),i}};this.mPropGrid=new o.GameGridTable(this.scene,x),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){var i=t.getData("item");i&&e.onSelectItemHandler(i)})),this.add(this.mPropGrid),this.resize(0,0),this.render.renderEmitter(this.key+"_getCategories")}},PicaMarketPanel.prototype.setSelect=function(){},PicaMarketPanel.prototype.clearCategories=function(t){t&&(t.map((function(t){return t.destroy()})),t=void 0)},PicaMarketPanel.prototype.onSelectCategoryHandler=function(t){if(this.mSubCategeoriesContainer){this.mSubCategorisScroll.setT(0),this.mPreSubCategoris=null,this.clearCategories(this.mSubTabs);var e=t.getData("category");if(this.mSelectedCategories=t,e){var i=e.subcategory;if(this.mSubCategorisScroll){this.mSubCategorisScroll.setItems(i),this.mSubCategorisScroll.layout();var n=this.mSubCategorisScroll.getCell(0);this.onSelectSubCategoryHandler(n.container)}}}},PicaMarketPanel.prototype.onSelectSubCategoryHandler=function(t){if(this.mSelectedCategories&&t instanceof a.TextButton){var e=this.mSelectedCategories.getData("category");if(e){var i=t.getData("item");i&&(this.queryProp(e.category.key,i.key),this.mPreSubCategoris=i,this.mPreSubCategorisItem&&this.mPreSubCategorisItem.changeNormal(),t.changeDown(),this.mPreSubCategorisItem=t)}}},PicaMarketPanel.prototype.queryProp=function(t,e){this.render.renderEmitter(this.key+"_queryProp",{page:1,category:t,subCategory:e})},PicaMarketPanel.prototype.onSelectItemHandler=function(t){if(this.mSelectItem.setProp(t),this.mSelectItem.setData("propdata",t),t.suitType&&""!==t.suitType){var e=this.getCommodityResource(t);this.setCommodityResource(e)}else this.render.renderEmitter(this.key+"_queryPropResource",t)},PicaMarketPanel.prototype.onBuyItemHandler=function(t){var e=this.getBuyPackageData();e.count=t.quantity;var i=e,n=l.i18n.t("market.payment"),s=this.mSelectItem.getData("display"),r={key:this.key,confirmFunc:"onPropConfirmHandler",confirmAddData:t};this.showPropFun({resultHandler:r,data:i,resource:s,slider:!1,title:n})},PicaMarketPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(this.key+"_close")},PicaMarketPanel.prototype.onPopItemCardHandler=function(t,e){t&&this.render.renderEmitter(this.key+"_popItemCard",{prop:t,display:e})},PicaMarketPanel.prototype.getBuyPackageData=function(){var t=this.mSelectItem.getData("propdata"),e={id:null,sellingPrice:null,name:null,shortName:null,count:1};return e.id=t.id,e.sellingPrice=t.price[0],e.name=t.name,e.shortName=t.shortName,e},PicaMarketPanel.prototype.showPropFun=function(t){this.render.mainPeer.showMediator(h.ModuleName.PICAPROPFUN_NAME,!0,t)},PicaMarketPanel.prototype.getCommodityResource=function(t){var e={};return e.avatar=h.AvatarSuitType.createAvatarBySn(t.suitType,t.sn,t.slot,t.tag,t.version),e.suits=[{suit_type:t.suitType,sn:t.sn,tag:t.tag,version:t.version}],e},PicaMarketPanel}(a.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaMessageBoxPanel",(function(){return l}));var n,s=i(5),r=i(470),o=i(1),a=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaMessageBoxPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=o.ModuleName.PICAMESSAGEBOX_NAME,i}return h(PicaMessageBoxPanel,t),PicaMessageBoxPanel.prototype.show=function(t){if(this.mShowData=t,!this.mPreLoad)if(this.mInitialized){var e=t;this.mButtons=[],e&&(e.text&&e.text[0]&&(this.mText.setText(e.text[0].text),this.mText.x=-this.mText.width/2,this.mText.y=-this.mText.height),e.title&&this.mTitleLabel.setText(e.title.text));var i=e.button.sort((function(t,e){return t.param>e.param?1:-1}));if(i){var n=114*this.dpr,r=40*this.dpr,o=(this.width-30*this.dpr)/i.length;this.mButtonContaier.y=this.height/2-r;var h=this.scene.textures.getFrame(this.key,"yellow_btn_normal");if(!h)return;for(var l={left:13*this.dpr,top:13*this.dpr,bottom:h.width-2-13*this.dpr,right:h.height-2-13*this.dpr},c=.5*-(o*i.length),p=0;p<i.length;p++){var d=i[p]?i[p].text:"",m=i[p].param,u=1===m?"yellow_btn":"red_btn",y=1===m?a.Color.brownish:a.Color.white,f=new s.NineSliceButton(this.mScene,0,0,n,r,this.key,u,d,this.dpr,this.scale,l,void 0,i[p]);f.setTextStyle({fontFamily:a.Font.DEFULT_FONT,fontSize:16*this.dpr,color:y}),f.setFontStyle("bold"),f.x=c+.5*o,c+=o,this.mButtons.push(f),f.on(s.ClickEvent.Tap,this.onClickHandler,this)}this.mButtonContaier.add(this.mButtons),this.mButtonContaier.x=0}this.resize(0,0)}else this.preload()},PicaMessageBoxPanel.prototype.resize=function(e,i){var n=this.scene.cameras.main.width,s=this.scene.cameras.main.height;this.x=n/2,this.y=s/2,t.prototype.resize.call(this,e,i),this.border.setInteractive(new Phaser.Geom.Rectangle(.5*-n,.5*-s,n,s),Phaser.Geom.Rectangle.Contains)},PicaMessageBoxPanel.prototype.preload=function(){this.addAtlas(this.key,"pica_message_box/pica_message_box.png","pica_message_box/pica_message_box.json"),t.prototype.preload.call(this)},PicaMessageBoxPanel.prototype.init=function(){var e=this.scene.cameras.main,i=e.width,n=e.height,r=this.scene.make.graphics(void 0,!1);r.fillStyle(0,.6),r.fillRect(.5*-i,.5*-n,i,n),this.add(r),this.border=r;var o=this.scene.make.image({key:this.key,frame:"bg_universal_box"});this.add(o),this.setSize(o.width,o.height),this.closeBtn=new s.Button(this.scene,this.key,"close"),this.closeBtn.setDisplaySize(28*this.dpr,28*this.dpr),this.closeBtn.setPosition(.5*this.width-5*this.dpr,.5*-this.height+4*this.dpr),this.closeBtn.on(String(s.ClickEvent.Tap),this.onCloseHandler,this),this.add(this.closeBtn),this.mButtonContaier=this.scene.make.container(void 0,!1);var h=this.scene.make.image({y:-o.height/2,key:this.key,frame:"title"});h.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mTitleLabel=this.scene.make.text({y:h.y-6*this.dpr,style:{fontFamily:a.Font.DEFULT_FONT,fontSize:16*this.dpr,color:"#3366cc"}},!1).setOrigin(.5),this.mText=new s.BBCodeText(this.mScene,0,0,"",{fontSize:14*this.dpr+"px",fontFamily:a.Font.DEFULT_FONT,color:"#000000",origin:{x:.5,y:.5},wrap:{mode:"char",width:this.width},align:"center"}),this.add([o,h,this.mTitleLabel,this.mText,this.mButtonContaier]),t.prototype.init.call(this),this.resize(i,n),this.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains)},PicaMessageBoxPanel.prototype.onClickHandler=function(t,e){if(e){var i=e.getBtnData();if(i)if(i.local){if(i.clickhandler){var n=this.render.uiManager.getPanel(""+i.clickhandler.key);if(n&&i.clickhandler.clickfun)n[i.clickhandler.clickfun].apply(n,i.data)}this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_hide")}else this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_click",i)}},PicaMessageBoxPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_hide")},PicaMessageBoxPanel}(r.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaMineCarPanel",(function(){return c}));var n,s,r=i(5),o=i(470),a=i(1),h=i(0),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaMineCarPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i.mFilterItem=[],i.key=a.ModuleName.PICAMINECAR_NAME,i.disInteractive(),i}return l(PicaMineCarPanel,t),PicaMineCarPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,e,i),this.setSize(n,s),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,n,s),this.mBg.x=n/2,this.mBg.y=this.mBg.displayHeight/2+107*this.dpr,this.carIcon.x=this.mBg.x/2-4*this.dpr,this.carIcon.y=this.mBg.y-(this.mBg.displayHeight-this.carIcon.displayHeight)/2+4*this.dpr,this.mCloseBtn.x=this.mBg.x+this.mBg.displayWidth/2,this.mCloseBtn.y=this.mBg.y-(this.mBg.displayHeight-this.mCloseBtn.displayHeight)/2+10*this.dpr,this.mCounter.x=this.mBg.x/2,this.mCounter.y=this.mBg.y+(this.mBg.displayHeight-this.mDiscardBtn.displayHeight)/2-16*this.dpr,this.mCounter.setResolution(this.dpr),this.mTips.x=this.mBg.x+20*this.dpr,this.mTips.y=this.mBg.y-this.mBg.displayHeight/2-15*this.dpr,this.mDiscardBtn.x=this.mBg.x+this.mBg.displayWidth/2-this.mDiscardBtn.displayWidth/2-9*this.dpr,this.mDiscardBtn.y=this.mBg.y+this.mBg.displayHeight/2-this.mDiscardBtn.displayHeight/2-9*this.dpr,this.categoriesBg.x=this.mBg.x,this.categoriesBg.y=this.mBg.y-this.mBg.displayHeight/2+this.categoriesBg.displayHeight/2+38*this.dpr,this.mPropGrid.refreshPos(this.mBg.x+2*this.dpr,this.mBg.y+6*this.dpr),this.mCategoryTable.refreshPos(this.mBg.x,this.mBg.y-this.mBg.displayHeight/2+this.categoriesBg.displayHeight/2+44*this.dpr),this.mPropGrid.resetMask(),this.mCategoryTable.resetMask()},PicaMineCarPanel.prototype.show=function(e){t.prototype.show.call(this,e)},PicaMineCarPanel.prototype.setCategories=function(t){this.mPreSelectedCategorie=void 0,this.mPreSelectedCategorieData=void 0,this.mCategoryTable.setItems(t)},PicaMineCarPanel.prototype.setCategoriesData=function(t){this.mDiscardBtn.changeState(s.Discard),this.setCategories(t)},PicaMineCarPanel.prototype.addListen=function(){this.mInitialized&&(this.removeListen(),this.mCloseBtn.on("pointerup",this.onCloseHandler,this),this.mDiscardBtn.on(r.ClickEvent.Tap,this.enterDiscardMode,this))},PicaMineCarPanel.prototype.removeListen=function(){this.mInitialized&&(this.mCloseBtn.off("pointerup",this.onCloseHandler,this),this.mDiscardBtn.off(r.ClickEvent.Tap,this.enterDiscardMode,this))},PicaMineCarPanel.prototype.setProp=function(t,e){var i=t||[];this.mLimit=e||0,this.mFilterItem.length=0;for(var n=0,s=i;n<s.length;n++){var r=s[n];this.mFilterItem.push({item:r})}for(var o=this.mLimit-this.mFilterItem.length,a=0;a<o;a++)this.mFilterItem.push({item:null});this.mPropGrid.setItems(this.mFilterItem),this.mCounter.setText(i.length+"/"+this.mLimit)},PicaMineCarPanel.prototype.destroy=function(){this.mPropGrid&&this.mPropGrid.destroy(),this.mCategoryTable&&this.mCategoryTable.destroy(),t.prototype.destroy.call(this)},PicaMineCarPanel.prototype.queryRefreshPackage=function(){this.mPreSelectedCategorieData&&this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_querypackage",{type:4,key:this.mPreSelectedCategorieData.key})},PicaMineCarPanel.prototype.preload=function(){this.addAtlas(this.key,"mine_car/mine_car.png","mine_car/mine_car.json"),t.prototype.preload.call(this)},PicaMineCarPanel.prototype.init=function(){var e=this,i=this.scaleWidth,n=this.scaleHeight;this.setSize(i,n),this.mBackGround=this.scene.make.graphics(void 0,!1),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,i,n),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.mBg=this.scene.make.image({key:this.key,frame:"bg.png"}),this.mBg.x=i/2,this.mBg.y=n/2,this.carIcon=this.scene.make.image({key:this.key,frame:"car_icon.png"},!1),this.carIcon.x=-(this.mBg.width-this.carIcon.width)/2+28*this.dpr,this.carIcon.y=-(this.mBg.height-this.carIcon.height/2)/2+10*this.dpr,this.mCloseBtn=this.scene.make.image({key:this.key,frame:"close_btn.png"},!1),this.mCloseBtn.setInteractive(),this.mCloseBtn.x=this.mBg.width/2,this.mCloseBtn.y=-(this.mBg.height-this.mCloseBtn.height)/2+10*this.dpr,this.mCloseBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mCounter=this.scene.make.text({text:"25/50",style:{fontFamily:h.Font.DEFULT_FONT,color:"#FFFFFF",fontSize:12*this.dpr}},!1),this.mCounter.x=-this.displayWidth/2+17*this.dpr,this.mCounter.y=this.displayHeight/2-18*this.dpr-this.mCounter.height,this.mCounter.setFontStyle("bold"),this.mTips=new d(this.scene,this.key,this.dpr),this.mTips.x=40*this.dpr,this.mTips.y=-(this.mBg.height+this.mTips.height)/2+15*this.dpr,this.mDiscardBtn=new m(this.scene,this.key,"yellow_btn.png",void 0,"丢弃"),this.mDiscardBtn.x=(this.mBg.width-this.mDiscardBtn.displayWidth)/2-17*this.dpr,this.mDiscardBtn.y=(this.mBg.height-this.mDiscardBtn.displayHeight)/2-10*this.dpr,this.mDiscardBtn.setTextStyle({color:"##996600",fontFamily:h.Font.DEFULT_FONT,fontSize:10*this.dpr}),this.mDiscardBtn.changeState(s.Discard),this.categoriesBg=this.scene.make.image({key:this.key,frame:"nav_bg.png"}),this.categoriesBg.y=-(this.displayHeight-this.categoriesBg.displayHeight)/2+36*this.dpr;var o=this.scene.textures.getFrame(this.key,"item_border.png"),l=o.width+4*this.dpr,c=o.height+4*this.dpr,y=236*this.dpr,f={x:-7*this.dpr,y:-16*this.dpr,table:{width:y,height:295*this.dpr,columns:4,cellsCount:25,cellWidth:l,cellHeight:c,reuseCellContainer:!0,cellOriginX:0,cellOriginY:0,zoom:this.scale},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.scene,s=t.item;return null===i&&(i=new p(n,e.key,e.dpr)),i.setData({item:s}),i.setProp(s),i}};this.mPropGrid=new r.GameGridTable(this.scene,f),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){e.onSelectItemHandler(t)}));var g=this.scene.textures.getFrame(this.key,"nav_btn_normal.png"),P={x:-9*this.dpr,y:-155*this.dpr,table:{width:y,height:this.categoriesBg.displayHeight,cellWidth:g.width+4*this.dpr,cellHeight:g.height,reuseCellContainer:!0,cellOriginX:0,cellOriginY:0,zoom:this.scale},scrollMode:1,createCellContainerCallback:function(t,i){var n=t.scene,s=t.item;return null===i&&((i=new u(n,e.key,"nav_btn_normal.png","nav_btn_down.png","1")).setTextStyle({color:"#566ddb",fontFamily:h.Font.DEFULT_FONT,fontSize:10*e.dpr}),i.setFontStyle("bold")),i.setText(s.value),i.setData("data",s),e.mPreSelectedCategorieData===s?(i.changeDown(),e.mPreSelectedCategorie=i):i.changeNormal(),e.mPreSelectedCategorie||e.onClickCategoryHandler(i),i}};this.mCategoryTable=new r.GameGridTable(this.scene,P),this.mCategoryTable.layout(),this.mCategoryTable.on("cellTap",(function(t){e.onClickCategoryHandler(t)})),this.add([this.mBackGround,this.mBg,this.carIcon,this.mCounter,this.categoriesBg,this.mPropGrid,this.mCategoryTable,this.mCloseBtn,this.mDiscardBtn]),this.resize(this.scene.cameras.main.width,this.scene.cameras.main.height),t.prototype.init.call(this),this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_querycategory")},PicaMineCarPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_close")},PicaMineCarPanel.prototype.onSelectItemHandler=function(t){if(this.mDiscardBtn&&this.mDiscardBtn.buttonState!==s.Discard)return t.switchSelect(),void this.checkMode();t&&t.item.item?(this.mTips.parentContainer||this.add(this.mTips),this.mTips.setItem(t.item.item)):this.remove(this.mTips)},PicaMineCarPanel.prototype.onClickCategoryHandler=function(t){var e=t.getData("data");e&&(this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_querypackage",{type:4,key:e.key}),this.mPreSelectedCategorie&&this.mPreSelectedCategorie.changeNormal(),t.changeDown(),this.mPreSelectedCategorie=t,this.mPreSelectedCategorieData=e)},PicaMineCarPanel.prototype.checkMode=function(){if(this.mFilterItem&&!(this.mFilterItem.length<1)){for(var t=0,e=this.mFilterItem;t<e.length;t++){if(e[t].selected)return void this.mDiscardBtn.changeState(s.Sutmit)}this.mDiscardBtn.changeState(s.Cancel)}},PicaMineCarPanel.prototype.onDiscardSelectedItem=function(){var t=this;if(this.mFilterItem&&!(this.mFilterItem.length<1)){for(var e=[],i=[],n=0,s=this.mFilterItem;n<s.length;n++){var r=s[n];r.item&&r.selected&&(e.push(r.item),i.push(r.item.name+"*"+r.item.count))}new o.AlertView(this.uiManager).show({text:h.i18n.t("minecar.confirmation",{name:""+i.join("、")}),title:h.i18n.t("minecar.discard"),oy:302*this.dpr*this.render.uiScale,callback:function(){t.render.renderEmitter(a.RENDER_PEER+"_"+t.key+"_discard",e)}})}},PicaMineCarPanel.prototype.enterDiscardMode=function(){if(this.mFilterItem){var t=this.mDiscardBtn.buttonState,e=!1;t===s.Discard?(this.mDiscardBtn.changeState(s.Cancel),e=!0):(t===s.Sutmit&&this.onDiscardSelectedItem(),this.mDiscardBtn.changeState(s.Discard)),this.mFilterItem.length>0&&this.mFilterItem[0].selectVisible!==e&&(this.mFilterItem.map((function(t){t.selectVisible=e,t.selected=!1})),this.mPropGrid.setItems(this.mFilterItem))}},PicaMineCarPanel}(o.BasePanel),p=function(t){function PackageItem(e,i,n){var s=t.call(this,e)||this,r=s.scene.make.image({key:i,frame:"item_border.png"},!1).setOrigin(0);return s.setSize(r.width,r.height),s.mItemImage=new o.DynamicImage(s.scene,0,0),s.mItemImage.setOrigin(0),s.mItemImage.setScale(n),s.mCounter=s.scene.make.text({x:r.displayWidth-2*n,y:r.displayHeight-1*n,style:{fontFamily:h.Font.DEFULT_FONT,fontSize:9*n,color:"#566DDB"}}).setOrigin(1),s.mCounter.setFontStyle("bold"),s.mSelectedIcon=s.scene.make.image({key:i,frame:"icon_normal.png"},!1),s.mSelectedIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),s.mSelectedIcon.x=r.width-2*n-s.mSelectedIcon.width/2,s.mSelectedIcon.y=2*n+s.mSelectedIcon.height/2,s.add(r),s.add([s.mItemImage,s.mCounter,s.mSelectedIcon]),s}return l(PackageItem,t),PackageItem.prototype.setProp=function(t){this.itemData=t;var e=t.item;if(!t||!e)return this.mItemImage.visible=!1,this.mCounter.visible=!1,void(this.mSelectedIcon.visible=!1);this.itemData&&(this.mItemImage.load(h.Url.getOsdRes(e.display.texturePath),this,this.onLoadCompleteHandler),this.mItemImage.visible=!0,e.count>1?(this.mCounter.setText(e.count.toString()),this.mCounter.visible=!0):this.mCounter.visible=!1,this.mSelectedIcon.visible=!!this.itemData.selectVisible,this.setSelected())},PackageItem.prototype.switchSelect=function(){this.itemData.item&&(this.itemData.selected=!this.itemData.selected,this.setSelected())},Object.defineProperty(PackageItem.prototype,"item",{get:function(){return this.itemData},enumerable:!1,configurable:!0}),PackageItem.prototype.onLoadCompleteHandler=function(){this.mItemImage&&(this.mItemImage.x=this.width-this.mItemImage.displayWidth>>1,this.mItemImage.y=this.height-this.mItemImage.displayHeight>>1)},PackageItem.prototype.setSelected=function(){this.itemData.selected?this.mSelectedIcon.setFrame("icon_selected.png"):this.mSelectedIcon.setFrame("icon_normal.png")},PackageItem}(Phaser.GameObjects.Container),d=function(t){function Tips(e,i,n){var s=t.call(this,e)||this;s.mDpr=n;var r=s.scene.make.image({key:i,frame:"tips_bg.png"},!1);return r.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),s.mName=s.scene.make.text({x:-r.width/2+12*n,y:-r.height/2+5*n,style:{fontFamily:h.Font.DEFULT_FONT,fontSize:10*n,color:"#000000"}},!1),s.mDes=s.scene.make.text({x:s.mName.x,style:{fontFamily:h.Font.DEFULT_FONT,fontSize:10*n,color:"#000000"}},!1).setOrigin(0,1),s.add([r,s.mName,s.mDes]),s.setSize(r.width,r.height),s}return l(Tips,t),Tips.prototype.setItem=function(t){if(t){var e=this.y,i=this.alpha;this.y=e+50*this.mDpr,this.alpha=0,this.scene.tweens.add({targets:this,props:{alpha:i,y:e},duration:200,ease:Phaser.Math.Easing.Elastic.Out}),this.mName.setText(t.shortName||t.name),this.mDes.setText(t.des)}},Tips}(Phaser.GameObjects.Container),m=function(t){function DiscardButton(e,i,n,s,r){return t.call(this,e,i,n,s,r)||this}return l(DiscardButton,t),DiscardButton.prototype.changeState=function(t){if(this.mState!==t)switch(this.mState=t,t){case s.Cancel:this.setText("取消"),this.setFrame("gray_btn.png");break;case s.Sutmit:this.setText("提交"),this.setFrame("yellow_btn.png");break;default:this.setText("丢弃"),this.setFrame("yellow_btn.png")}},Object.defineProperty(DiscardButton.prototype,"buttonState",{get:function(){return this.mState},enumerable:!1,configurable:!0}),DiscardButton}(r.Button);!function(t){t[t.Discard=0]="Discard",t[t.Cancel=1]="Cancel",t[t.Sutmit=2]="Sutmit"}(s||(s={}));var u=function(t){function CategorieButton(e,i,n,s,r){var o=t.call(this,e,i,n,s,r)||this;return o.disInteractive(),o.removeListen(),o.mBackground.setOrigin(0,0),o.mText&&o.mText.setPosition(o.mBackground.width/2,o.mBackground.height/2),o}return l(CategorieButton,t),CategorieButton}(r.TabButton)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaMineSettlePanel",(function(){return c}));var n,s=i(5),r=i(470),o=i(11),a=i(1),h=i(0),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaMineSettlePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=a.ModuleName.PICAMINESETTLE_NAME,i}return l(PicaMineSettlePanel,t),PicaMineSettlePanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,n,s),this.bg.x=n/2,this.bg.y=s/2,this.titleimage.x=n/2,this.titleimage.y=this.bg.y-this.bg.displayHeight/2-8*this.dpr,this.confirmBtn.x=n/2,this.confirmBtn.y=this.bg.y+100*this.dpr,this.titleName.x=n/2,this.titleName.y=this.titleimage.y+32*this.dpr,this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.66),this.blackGraphic.fillRect(0,0,n,s),this.mPropGrid.refreshPos(n/2,this.bg.y-2*this.dpr),this.mPropGrid.resetMask(),this.setSize(n,s)},PicaMineSettlePanel.prototype.show=function(t){this.mShowData=t,this.refreshData(),this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicaMineSettlePanel.prototype.addListen=function(){this.mInitialized&&this.confirmBtn.on(String(s.ClickEvent.Tap),this.onConfirmBtnClick,this)},PicaMineSettlePanel.prototype.removeListen=function(){this.mInitialized&&this.confirmBtn.off(String(s.ClickEvent.Tap),this.onConfirmBtnClick,this)},PicaMineSettlePanel.prototype.preload=function(){this.addAtlas(this.key,"minesettle/settlement.png","minesettle/settlement.json"),this.addAtlas(o.c.commonKey,o.d.commonUrl+".png",o.d.commonUrl+".json"),t.prototype.preload.call(this)},PicaMineSettlePanel.prototype.init=function(){var e=this,i=this.cameraWidth,n=this.cameraHeight;this.bg=new r.NinePatch(this.scene,0,0,293*this.dpr,260*this.dpr,this.key,"bg",{left:10,top:10,right:10,bottom:10}),this.blackGraphic=this.scene.make.graphics(void 0,!1),this.blackGraphic.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains);var a=this.scene.textures.getFrame(this.key,"icon_test"),l=a.width+20*this.dpr,c=a.height+25*this.dpr,d={x:0,y:0,table:{width:280*this.dpr,height:160*this.dpr,columns:5,cellWidth:l,cellHeight:c,reuseCellContainer:!0,cellOriginX:0,cellOriginY:0,cellPadX:18*this.dpr,zoom:this.scale},clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.scene,s=t.item;return null===i&&(i=new p(n,e.dpr)),i.setData({item:s}),i.setItemData(s),i}};this.mPropGrid=new s.GameGridTable(this.scene,d),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){var i=t.itemData;i&&e.onSelectItemHandler(i)})),this.titleimage=this.scene.make.image({x:0,y:.5*-this.bg.displayWidth-10*this.dpr,key:this.key,frame:"title"},!1),this.titleimage.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titleName=this.scene.make.text({x:0,y:this.titleimage.y+32*this.dpr,text:h.i18n.t("minesettle.settle"),style:{fontSize:15*this.dpr,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(.5,.5),this.confirmBtn=new s.NineSliceButton(this.scene,0,100*this.dpr,90*this.dpr,40*this.dpr,o.c.commonKey,"yellow_btn",h.i18n.t("minesettle.savebag"),this.dpr,this.scale,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr}),this.confirmBtn.setTextStyle({color:"#976400",fontSize:16*this.dpr,fontFamily:h.Font.DEFULT_FONT}),this.add([this.blackGraphic,this.bg,this.titleimage,this.titleName,this.confirmBtn]),this.add(this.mPropGrid),this.resize(0,0),t.prototype.init.call(this)},PicaMineSettlePanel.prototype.setMineSettlePacket=function(t){this.mInitialized&&this.mPropGrid.setItems(t.items)},PicaMineSettlePanel.prototype.destroy=function(){this.mPropGrid&&this.mPropGrid.destroy(),this.confirmBtn&&this.confirmBtn.destroy(),this.mPropGrid=null,this.confirmBtn=null,t.prototype.destroy.call(this)},PicaMineSettlePanel.prototype.refreshData=function(){var t=this.getData("settleData");t&&this.setMineSettlePacket(t)},PicaMineSettlePanel.prototype.onSelectItemHandler=function(t){},PicaMineSettlePanel.prototype.onConfirmBtnClick=function(t){this.checkPointerDis(t)&&this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_hide")},PicaMineSettlePanel.prototype.checkPointerDis=function(t){return!this.render||Math.abs(t.downX-t.upX)<10*this.render.uiRatio*this.render.uiScale&&Math.abs(t.downY-t.upY)<10*this.render.uiRatio*this.render.uiScale},PicaMineSettlePanel}(r.BasePanel),p=function(t){function MineSettleItem(e,i){var n=t.call(this,e)||this;return n.dpr=i,n.icon=new r.DynamicImage(e,0,0),n.itemCount=n.scene.make.text({text:"600",style:{fontSize:18,fontFamily:h.Font.DEFULT_FONT}},!1),n.itemCount.setOrigin(.5,0),n.icon.setOrigin(0,0),n.icon.setScale(n.dpr),n.itemCount.setPosition(0,n.icon.height),n.add(n.icon),n.add(n.itemCount),n}return l(MineSettleItem,t),MineSettleItem.prototype.setItemData=function(t){var e=this;this.itemData=t,this.itemCount.setFontSize(14*this.dpr),this.itemCount.text=t.count+"";var i=h.Url.getOsdRes(t.display.texturePath);this.icon.load(i,this,(function(){e.icon.setScale(33*e.dpr/e.icon.width),e.icon.setPosition(0,3*e.dpr),e.itemCount.setPosition(.5*e.icon.displayWidth,e.icon.x+e.icon.displayHeight+3*e.dpr)}))},MineSettleItem.prototype.destroy=function(){t.prototype.destroy.call(this),this.icon&&this.icon.destroy(),this.itemCount&&this.itemCount.destroy(),this.itemData=null,this.icon=null,this.itemCount=null,this.scene=null},MineSettleItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNavigatePanel",(function(){return c}));var n,s=i(5),r=i(470),o=i(11),a=i(1),h=i(0),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaNavigatePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key_lang="key_lang",i.key=a.ModuleName.PICANAVIGATE_NAME,i.UIType=s.UIType.Scene,i.setTween(!1),i.setInteractive(),i}return l(PicaNavigatePanel,t),PicaNavigatePanel.prototype.resize=function(e,i){var n=this.scale;e=e||this.mBackground.width*n,i=i||this.mBackground.height*n,this.setSize(e,i);var s=this.scene.cameras.main.width/n,r=this.scene.cameras.main.height,a=s/this.scene.textures.getFrame(o.c.commonKey,"menu_bg").width*this.dpr;this.mBackground.scaleX=a,this.mBackground.x=s/2,this.mBackground.setInteractive(),this.mCloseBtn.x=s-this.mCloseBtn.width/2-3*this.dpr,this.mGoHomeBtn.x=this.mCloseBtn.x-.5*this.mCloseBtn.width-.5*this.mGoHomeBtn.width-24*this.dpr,this.y=r-this.height/2,t.prototype.resize.call(this,e,i)},PicaNavigatePanel.prototype.addListen=function(){this.mInitialized&&this.interactiveBoo&&(this.mMapBtn.on("pointerup",this.onShowMapHandler,this),this.mShopBtn.on("pointerup",this.onShowShopHandler,this),this.mBagBtn.on("pointerup",this.onShowBagHandler,this),this.mFamilyBtn.on("pointerup",this.onShowFamilyHandler,this),this.mGoHomeBtn.on("pointerup",this.onShowGoHomeHandler,this),this.mCloseBtn.on("pointerup",this.onCloseHandler,this))},PicaNavigatePanel.prototype.removeListen=function(){this.mInitialized&&(this.mMapBtn.off("pointerup",this.onShowMapHandler,this),this.mShopBtn.off("pointerup",this.onShowShopHandler,this),this.mBagBtn.off("pointerup",this.onShowBagHandler,this),this.mFamilyBtn.off("pointerup",this.onShowFamilyHandler,this),this.mGoHomeBtn.on("pointerup",this.onShowGoHomeHandler,this),this.mCloseBtn.off("pointerup",this.onCloseHandler,this))},PicaNavigatePanel.prototype.hide=function(){this.mShow=!1,t.prototype.hide.call(this),this.removeListen()},PicaNavigatePanel.prototype.show=function(e){t.prototype.show.call(this,e),this.checkUpdateActive(),this.addListen()},PicaNavigatePanel.prototype.updateUIState=function(t){this.mInitialized&&("picanavigate.mapbtn"===t.name&&(this.mMapBtn.visible=t.visible,t.disabled?this.mMapBtn.removeInteractive():this.mMapBtn.setInteractive()),"picanavigate.marketbtn"===t.name&&(this.mShopBtn.visible=t.visible,t.disabled?this.mShopBtn.removeInteractive():this.mShopBtn.setInteractive()),"picanavigate.bagbtn"===t.name&&(this.mBagBtn.visible=t.visible,t.disabled?this.mBagBtn.removeInteractive():this.mBagBtn.setInteractive()),"picanavigate.gohomebtn"===t.name&&(this.mGoHomeBtn.visible=t.visible,t.disabled?this.mGoHomeBtn.removeInteractive():this.mGoHomeBtn.setInteractive()))},Object.defineProperty(PicaNavigatePanel.prototype,"isZh_CN",{get:function(){return"zh-CN"===h.i18n.language},enumerable:!1,configurable:!0}),PicaNavigatePanel.prototype.preload=function(){this.addAtlas(o.c.commonKey,o.d.commonUrl+".png",o.d.commonUrl+".json");var e="cn";this.isZh_CN||(e="en"),this.addAtlas(this.key_lang,"pica_navigate/pica_navigate_"+e+".png","pica_navigate/pica_navigate_"+e+".json"),t.prototype.preload.call(this)},PicaNavigatePanel.prototype.init=function(){this.mBackground=this.createImage(o.c.commonKey,"menu_bg"),this.mBackground.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mMapBtn=this.createButton(this.key_lang,"map_btn"),this.mShopBtn=this.createButton(this.key_lang,"shop_btn"),this.mBagBtn=this.createButton(this.key_lang,"bag_btn"),this.mFamilyBtn=this.createButton(this.key_lang,"family_btn"),this.mGoHomeBtn=this.createImage(this.key_lang,"home_btn").setInteractive(),this.mCloseBtn=this.createImage(o.c.commonKey,"close_1").setInteractive();var e,i=[this.mMapBtn,this.mShopBtn,this.mBagBtn,this.mFamilyBtn,this.mGoHomeBtn];this.add([this.mBackground]),this.add(i),this.add(this.mCloseBtn);for(var n=0;n<i.length;n++)0===n?i[n].x=10.33*this.dpr+.5*i[n].width:(e=i[n-1],i[n].x=e.x+12*this.dpr+.5*(i[n].width+e.width));var s=this.scale;this.resize(this.mBackground.width*s,this.mBackground.height*s),t.prototype.init.call(this)},PicaNavigatePanel.prototype.createButton=function(t,e){var i;return(i=this.isZh_CN?this.createImage(t,e):this.createSprite(t,e)).setInteractive(),i},PicaNavigatePanel.prototype.createImage=function(t,e){return this.scene.make.image({key:t,frame:e},!1)},PicaNavigatePanel.prototype.createSprite=function(t,e){var i=this.scene.make.sprite({key:this.key_lang,frame:e+"_1"});return this.scene.anims.create({key:e,frames:this.scene.anims.generateFrameNames(this.key_lang,{prefix:e+"_",frames:[1,3]}),duration:500,repeat:-1}),i.play(e),i},PicaNavigatePanel.prototype.onShowMapHandler=function(){this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_showPanel",a.ModuleName.PICAPARTYLIST_NAME)},PicaNavigatePanel.prototype.onShowShopHandler=function(){this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_showPanel",a.ModuleName.PICAMARKET_NAME)},PicaNavigatePanel.prototype.onShowBagHandler=function(){this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_showPanel",a.ModuleName.PICABAG_NAME)},PicaNavigatePanel.prototype.onShowFamilyHandler=function(){this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_showPanel",a.ModuleName.PICAGIFTEFFECT_NAME)},PicaNavigatePanel.prototype.onShowGoHomeHandler=function(){this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_goHome")},PicaNavigatePanel.prototype.onCloseHandler=function(){this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_close")},PicaNavigatePanel.prototype.checkUpdateActive=function(){var t=this;this.render.mainPeer.getActiveUIData(a.ModuleName.PICAHANDHELD_NAME).then((function(e){if(e)for(var i=0,n=e;i<n.length;i++){var s=n[i];t.updateUIState(s)}}))},PicaNavigatePanel}(r.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNewMainPanel",(function(){return u}));var n,s=i(5),r=i(11),o=i(1),a=i(0),h=i(471),l=i(517),c=i(518),p=i(519),d=i(520),m=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),u=function(t){function PicaNewMainPanel(e){var i=t.call(this,e)||this;return i.isFold=!1,i.atlasNames=[r.d.uicommon,r.d.iconcommon],i.key=o.ModuleName.PICANEWMAIN_NAME,i}return m(PicaNewMainPanel,t),PicaNewMainPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;this.foldButton.x=.5*this.foldButton.width+5*this.dpr,this.foldButton.y=.5*this.foldButton.height+5*this.dpr,this.headPanel.x=.5*n,this.headPanel.y=.5*this.headPanel.height,this.leftPanel.x=.5*this.leftPanel.width+10*this.dpr,this.leftPanel.y=this.headPanel.height+.5*this.leftPanel.height+20*this.dpr,this.activityPanel.x=n-.5*this.activityPanel.width-10*this.dpr,this.activityPanel.y=this.headPanel.height+.5*this.activityPanel.height+0*this.dpr,t.prototype.resize.call(this,n,s)},PicaNewMainPanel.prototype.addListen=function(){t.prototype.addListen.call(this)},PicaNewMainPanel.prototype.removeListen=function(){t.prototype.removeListen.call(this)},PicaNewMainPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaNewMainPanel.prototype.hide=function(){t.prototype.hide.call(this)},PicaNewMainPanel.prototype.update=function(e){t.prototype.update.call(this)},PicaNewMainPanel.prototype.setPlayerInfo=function(t,e,i,n){this.headData={level:t,energy:e,money:i,diamond:n},this.mInitialized&&this.headPanel.setHeadData(t,e,i,n)},PicaNewMainPanel.prototype.setRoomInfo=function(t,e,i,n,s){void 0===s&&(s=!1),this.sceneData={sceneName:t,isPraise:e,people:i,roomType:n,isself:s},this.mInitialized&&this.headPanel.setSceneData(t,e,i,n,s)},PicaNewMainPanel.prototype.updateUIState=function(t){},PicaNewMainPanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight;this.foldButton=new s.Button(this.scene,r.d.uicommon,"home_retract"),this.foldButton.on(s.ClickEvent.Tap,this.onFoldButtonHandler,this),this.add(this.foldButton),this.headPanel=new p.PicaNewHeadPanel(this.scene,e,70*this.dpr,this.key,this.dpr),this.headPanel.setHandler(new a.Handler(this,this.onHeadHandler)),this.add(this.headPanel),this.leftPanel=new d.PicaNewLeftPanel(this.scene,40*this.dpr,170*this.dpr,this.key,this.dpr),this.leftPanel.setHandler(new a.Handler(this,this.onLeftHandler)),this.add(this.leftPanel),this.activityPanel=new l.PicaNewActivityPanel(this.scene,40*this.dpr,170*this.dpr,this.key,this.dpr),this.activityPanel.setHandler(new a.Handler(this,this.onActivityHandler)),this.add(this.activityPanel),this.chatPanel=new c.PicaNewChatPanel(this.scene,e,201*this.dpr,this.key,this.dpr),this.add(this.chatPanel),this.resize(e,i),t.prototype.init.call(this)},PicaNewMainPanel.prototype.onInitialized=function(){this.headData&&this.headPanel.setHeadData(this.headData.level,this.headData.energy,this.headData.money,this.headData.diamond),this.sceneData&&this.headPanel.setSceneData(this.sceneData.sceneName,this.sceneData.isPraise,this.sceneData.people,this.sceneData.roomType,this.sceneData.isself)},PicaNewMainPanel.prototype.onFoldButtonHandler=function(){this.isFold=!this.isFold,this.isFold?(this.foldButton.setFrameNormal("home_spread","home_spread"),this.headPanel.visible=!1,this.leftPanel.visible=!1,this.activityPanel.visible=!1):(this.foldButton.setFrameNormal("home_retract","home_retract"),this.headPanel.visible=!0,this.leftPanel.visible=!0,this.activityPanel.visible=!0)},PicaNewMainPanel.prototype.onHeadHandler=function(t,e){"head"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.CHARACTERINFO_NAME):"energy"===t||("praise"===t?this.render.renderEmitter(o.EventType.QUERY_PRAISE,e):"recharge"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICARECHARGE_NAME):"room"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_openhousepanel"):"party"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAOPENPARTY_NAME):"online"===t&&this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAONLINE_NAME))},PicaNewMainPanel.prototype.onLeftHandler=function(t,e){"maphome"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAPARTYLIST_NAME):"task"===t&&this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICATASK_NAME)},PicaNewMainPanel.prototype.onActivityHandler=function(t,e){"activity"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAORDER_NAME):"indent"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAPARTYLIST_NAME):"recharge"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAFURNITURECOMPOSE_NAME):("email"===t||"roam"===t)&&this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAROAM_NAME)},PicaNewMainPanel.prototype.onNavigateHandler=function(t,e){"bag"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICABAG_NAME):"friend"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAFRIEND_NAME):"avatar"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAAVATAR_NAME):"shop"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAMARKET_NAME):"explore"===t&&this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAEXPLORELIST_NAME)},PicaNewMainPanel}(h.PicaBasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNewRolePanel",(function(){return c}));var n,s=i(5),r=i(470),o=i(1),a=i(11),h=i(0),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaNewRolePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.followed=!1,i.key=o.ModuleName.PICANEWROLE_NAME,i.UIType=s.UIType.Scene,i}return l(PicaNewRolePanel,t),PicaNewRolePanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,n,s),this.setSize(n,s),this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.66),this.blackGraphic.fillRect(0,0,n,s),this.content.x=.5*n,this.content.y=s+.5*this.content.height+10*this.dpr,this.content.setInteractive(),this.setInteractive(new Phaser.Geom.Rectangle(0,0,2*n,2*s),Phaser.Geom.Rectangle.Contains);var r=this.scaleHeight+.5*this.content.height+10*this.dpr,o=this.scaleHeight-.5*this.content.height;this.playMove(r,o)},PicaNewRolePanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen(),this.render.renderEmitter(this.key+"_initialized"),this.setRoleData(this.roleData),this.setFollowButton(this.followed)):this.preload())},PicaNewRolePanel.prototype.addListen=function(){this.mInitialized&&(this.openBigBtn.on(s.ClickEvent.Tap,this.onOpeningCharacterHandler,this),this.followBtn.on(s.ClickEvent.Tap,this.onFollowHandler,this),this.tradingBtn.on(s.ClickEvent.Tap,this.onTradingHandler,this),this.on("pointerdown",this.OnClosePanel,this))},PicaNewRolePanel.prototype.removeListen=function(){this.mInitialized&&(this.openBigBtn.off(s.ClickEvent.Tap,this.onOpeningCharacterHandler,this),this.followBtn.off(s.ClickEvent.Tap,this.onFollowHandler,this),this.tradingBtn.off(s.ClickEvent.Tap,this.onTradingHandler,this),this.off("pointerdown",this.OnClosePanel,this))},PicaNewRolePanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaNewRolePanel.prototype.preload=function(){this.addAtlas(this.key,a.d.textureUrl(a.d.uicommonurl),a.d.jsonUrl(a.d.uicommonurl)),t.prototype.preload.call(this)},PicaNewRolePanel.prototype.init=function(){var e=this.scaleWidth,i=87*this.dpr;this.blackGraphic=this.scene.make.graphics(void 0,!1),this.add(this.blackGraphic),this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.add(this.content),this.bg=new r.ThreeSlicePath(this.scene,0,0,e,87*this.dpr,this.key,["people_panel_bg_left","people_panel_bg_middle","people_panel_bg_right"],this.dpr),this.bg.y=.5*i-.5*this.bg.height,this.content.add(this.bg),this.headAvatar=new r.UIDragonbonesDisplay(this.scene,this.render),this.headAvatar.x=.5*-e+60*this.dpr,this.headAvatar.y=35*this.dpr,this.headAvatar.scale=2*this.dpr,this.headAvatar.visible=!1,this.content.add(this.headAvatar),this.nameImage=new r.ImageValue(this.scene,60*this.dpr,20*this.dpr,this.key,"people_woman",this.dpr),this.nameImage.setOffset(-this.dpr,0),this.nameImage.setTextStyle(h.UIHelper.whiteStyle(this.dpr,14)),this.nameImage.setLayout(1),this.nameImage.setText(""),this.nameImage.x=this.headAvatar.x+70*this.dpr,this.nameImage.y=.5*-i+15*this.dpr,this.content.add(this.nameImage),this.levelLabel=this.scene.make.text({x:this.nameImage.x-8*this.dpr,y:this.nameImage.y+20*this.dpr,text:"",style:h.UIHelper.whiteStyle(this.dpr)}),this.levelLabel.setOrigin(0,.5),this.content.add(this.levelLabel),this.openBigBtn=new s.Button(this.scene,this.key,"people_minute","people_minute"),this.openBigBtn.setSize(20*this.dpr,20*this.dpr),this.openBigBtn.removeInteractive(),this.openBigBtn.setInteractive(),this.openBigBtn.y=.5*-i+15*this.dpr,this.openBigBtn.x=.5*e-20*this.dpr,this.content.add(this.openBigBtn);var n=["butt_yellow_left_s","butt_yellow_middle_s","butt_yellow_right_s"];this.followBtn=new r.ThreeSliceButton(this.scene,84*this.dpr,31*this.dpr,this.key,n,n,h.i18n.t("player_info.follow")),this.followBtn.setTextStyle(h.UIHelper.brownishStyle(this.dpr)),this.followBtn.y=.5*i-.5*this.followBtn.height-5*this.dpr,this.followBtn.x=.5*-this.followBtn.width+20*this.dpr,this.content.add(this.followBtn);var o=["butt_red_left_s","butt_red_middle_s","butt_red_right_s"];this.tradingBtn=new r.ThreeSliceButton(this.scene,84*this.dpr,31*this.dpr,this.key,o,o,h.i18n.t("player_info.trading")),this.tradingBtn.setTextStyle(h.UIHelper.brownishStyle(this.dpr)),this.tradingBtn.y=this.followBtn.y,this.tradingBtn.x=.5*this.tradingBtn.width+40*this.dpr,this.content.add(this.tradingBtn),this.resize(),t.prototype.init.call(this)},PicaNewRolePanel.prototype.setRoleData=function(t){var e=this;if(this.roleData=t,this.mInitialized&&this.roleData){var i=o.AvatarSuitType.getSuitsFromItem(t.avatarSuit),n={id:t.id,avatar:i.avatar};this.headAvatar.visible=!1,this.headAvatar.setSuits(i.suits),this.headAvatar.once("replacefinished",(function(){e.headAvatar.play({name:"idle",flip:!1}),e.headAvatar.visible=!0})),this.headAvatar.load(n),this.nameImage.setFrameValue(t.nickname,this.key,"people_man"),this.levelLabel.text=h.i18n.t("common.lv")+" "+t.level.level;var s=["butt_gray_left_s","butt_gray_middle_s","butt_gray_right_s"];this.tradingBtn.setFrameNormal(s,s),this.tradingBtn.setTextColor("#000000"),this.tradingBtn.setEnable(!1,!1)}},PicaNewRolePanel.prototype.setFollowButton=function(t){this.followed=t,this.mInitialized&&this.followBtn.setText(t?h.i18n.t("friendlist.unfollow"):h.i18n.t("friendlist.follow"))},PicaNewRolePanel.prototype.playMove=function(t,e){var i=this.scene.tweens.add({targets:this.content,y:{from:t,to:e},ease:"Linear",duration:150,onComplete:function(){i.stop(),i.remove()}})},PicaNewRolePanel.prototype.onOpeningCharacterHandler=function(){this.render.renderEmitter(o.ModuleName.PICANEWROLE_NAME+"_openingcharacter",this.roleData),this.OnClosePanel()},PicaNewRolePanel.prototype.onFollowHandler=function(){void 0!==this.roleData&&this.render.renderEmitter(o.ModuleName.PICANEWROLE_NAME+"_followcharacter",{uid:this.roleData.cid,follow:this.followed})},PicaNewRolePanel.prototype.onTradingHandler=function(){this.render.renderEmitter(o.ModuleName.PICANEWROLE_NAME+"_tradingcharacter",this.roleData)},PicaNewRolePanel.prototype.OnClosePanel=function(){this.render.renderEmitter(this.key+"_hide")},PicaNewRolePanel}(r.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNoticePanel",(function(){return l}));var n,s=i(5),r=i(470),o=i(1),a=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaNoticePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.isbigbg=!1,i.key=o.ModuleName.PICANOTICE_NAME,i}return h(PicaNoticePanel,t),PicaNoticePanel.prototype.show=function(t){var e=this;if(t&&Array.isArray(t)&&t.length>0&&(t=t[0]),this.mShowData=t,t&&t.display&&t.display.length>0&&(this.isbigbg=!0),this.mInitialized){if(t){var i=t.text;this.mContent&&i&&i.length>0&&(this.mContent.setText(i[0].text),this.isbigbg&&(this.mContent.y=.5*-this.bg.height+.5*this.mContent.height+2*this.dpr));var n=t.display;if(this.imageIcon&&n&&n.length>0){var s=a.Url.getOsdRes(n[0].texturePath);this.imageIcon.load(s,this,(function(){e.imageIcon.scale=e.dpr,e.mContent&&""!==e.mContent.text&&(e.imageIcon.y=.5*e.bg.height-.5*e.imageIcon.displayHeight-2*e.dpr)}))}this.scene.cameras.main.width;this.scene.tweens.timeline({targets:this,duration:500,tweens:[{y:"-="+20*this.dpr,ease:"Bounce.easeOut"},{delay:2e3,y:"-="+20*this.dpr,ease:"Linear",alpha:0}],onComplete:function(){e.render.renderEmitter(o.RENDER_PEER+"_"+e.key+"_close")}})}}else this.preload()},PicaNoticePanel.prototype.resize=function(){this.x=this.scene.cameras.main.width/2,this.y=170*this.dpr},PicaNoticePanel.prototype.preload=function(){var e=this.isbigbg?"pica_notice/bg_big.png":"pica_notice/bg.png",i=this.isbigbg?"pica_notice_bg_big":"pica_notice_bg";this.addImage(i,e),t.prototype.preload.call(this)},PicaNoticePanel.prototype.init=function(){var e=this.isbigbg?"pica_notice_bg_big":"pica_notice_bg";this.bg=this.scene.make.image({key:e},!1),this.mContent=new s.BBCodeText(this.mScene,0,0,"",{fontSize:16*this.dpr+"px",fontFamily:a.Font.DEFULT_FONT,stroke:"#000000",strokeThickness:1*this.dpr,align:"center",textMask:!1,shadow:{offsetX:0,offsetY:0,color:"#000",blur:4,stroke:!0,fill:!0},wrap:{mode:"char",width:this.bg.width*this.scale-12*this.dpr}}).setOrigin(.5,.5),this.mContent.setFontStyle("bold"),this.add([this.bg,this.mContent]),this.isbigbg&&(this.imageIcon=new r.DynamicImage(this.scene,0,0),this.add(this.imageIcon)),this.mScene.layerManager.addToLayer(r.MainUIScene.LAYER_TOOLTIPS,this),t.prototype.init.call(this),this.resize()},PicaNoticePanel}(r.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaOnlinePanel",(function(){return d}));var n,s=i(470),r=i(11),o=i(1),a=i(0),h=i(471),l=i(5),c=i(618),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaOnlinePanel(e){var i=t.call(this,e)||this;return i.key=o.ModuleName.PICAONLINE_NAME,i.atlasNames=[r.d.uicommon],i}return p(PicaOnlinePanel,t),PicaOnlinePanel.prototype.resize=function(t,e){this.scale;var i=this.scaleWidth,n=this.scaleHeight;this.mBackground.clear(),this.mBackground.fillStyle(118271,1),this.mBackground.fillRect(0,0,this.content.width,n),this.mBackground.x=.5*-this.content.width,this.mBackground.y=.5*-n,this.content.x=i+.5*this.content.width+10*this.dpr,this.content.y=.5*n,this.bottomPanel.x=.5*i,this.bottomPanel.y=.5*n,this.setSize(i,n)},PicaOnlinePanel.prototype.addListen=function(){this.mInitialized&&this.mBlack.on("pointerup",this.onCloseHandler,this)},PicaOnlinePanel.prototype.removeListen=function(){this.mInitialized&&this.mBlack.off("pointerup",this.onCloseHandler,this)},PicaOnlinePanel.prototype.destroy=function(){this.removeListen(),t.prototype.destroy.call(this)},PicaOnlinePanel.prototype.setOnlineDatas=function(t,e,i){this.onlineData=t,this.userid=i,this.people=e,this.mInitialized&&(this.peopleImg.setText(e+""),this.mGameGrid.setItems(t))},PicaOnlinePanel.prototype.setBlackList=function(t){this.blackList=t,this.mInitialized&&this.refreshBottomPanel()},PicaOnlinePanel.prototype.setAvatarList=function(t){for(var e=0,i=this.onlineData;e<i.length;e++)for(var n=i[e],s=0,r=t;s<r.length;s++){var o=r[s],a=o._id,h=o.avatar;n.platformId===a&&(n.avatar=h)}this.mInitialized&&this.mGameGrid.refresh()},PicaOnlinePanel.prototype.onInitialized=function(){this.onlineData&&this.mGameGrid.setItems(this.onlineData),this.people&&this.peopleImg.setText(this.people+"")},PicaOnlinePanel.prototype.init=function(){var e=this;if(!this.mInitialized){var i=this.scaleWidth,n=this.scaleHeight;this.mBlack=this.scene.make.graphics(void 0,!1),this.mBlack.fillStyle(0,.66),this.mBlack.fillRect(0,0,i,n),this.mBlack.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.add(this.mBlack),this.mBackground=this.scene.make.graphics(void 0,!1),this.content=this.scene.make.container(void 0,!1);var o=237*this.dpr;this.content.setSize(o,n),this.content.setInteractive(),this.bg=this.scene.make.image({key:r.d.uicommon,frame:"online_bg"}),this.bg.displayWidth=o,this.bg.y=.5*-n+.5*this.bg.height,this.titleTex=this.scene.make.text({x:0,y:0,text:a.i18n.t("online.title"),style:a.UIHelper.whiteStyle(this.dpr,18)}).setOrigin(0,.5),this.titleTex.setFontStyle("bold"),this.titleTex.x=.5*-this.content.width+10*this.dpr,this.titleTex.y=.5*-this.content.height+20*this.dpr,this.peopleImg=new s.ImageValue(this.scene,50*this.dpr,20*this.dpr,r.d.uicommon,"online_people",this.dpr),this.peopleImg.setOffset(-this.dpr,0),this.peopleImg.setTextStyle(a.UIHelper.whiteStyle(this.dpr,14)),this.peopleImg.setLayout(3),this.peopleImg.setText("1000"),this.peopleImg.x=.5*this.content.width-30*this.dpr,this.peopleImg.y=this.titleTex.y;var h=new a.Handler(this,this.onSimpleHandler),p={x:0,y:25*this.dpr,table:{width:o,height:n-40*this.dpr,columns:1,cellWidth:o,cellHeight:50*this.dpr,reuseCellContainer:!0,zoom:this.scale},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,i){t.scene;var n=t.index,s=t.item;return null===i&&(i=new m(e.scene,r.d.uicommon,e.dpr)).setHandler(h),i.setPlayerInfo(s,n),i}};this.mGameGrid=new l.GameGridTable(this.scene,p),this.mGameGrid.layout(),this.mGameGrid.on("cellTap",this.onGridTableHandler,this),this.content.add([this.mBackground,this.bg,this.titleTex,this.peopleImg,this.mGameGrid]),this.add(this.content),this.bottomPanel=new c.PicaOnlineBottomPanel(this.scene,i,n,r.d.uicommon,this.dpr),this.bottomPanel.setHandler(new a.Handler(this,this.onBottomPanelHandler)),this.add(this.bottomPanel),this.bottomPanel.visible=!1,this.resize(0,0),t.prototype.init.call(this),this.playMove()}},PicaOnlinePanel.prototype.onGridTableHandler=function(t){var e=t.playerData;this.render.renderEmitter(this.key+"_openingcharacter",e.platformId)},PicaOnlinePanel.prototype.playMove=function(){var t=this,e=this.scaleWidth,i=e+.5*this.content.width+10*this.dpr,n=e-.5*this.content.width,s=this.scene.tweens.add({targets:this.content,x:{from:i,to:n},ease:"Linear",duration:300,onComplete:function(){s.stop(),s.remove(),t.mGameGrid.resetMask()}})},PicaOnlinePanel.prototype.onCloseHandler=function(){this.render.renderEmitter(this.key+"_close")},PicaOnlinePanel.prototype.onSimpleHandler=function(t){if(t.platformId===this.userid)this.render.renderEmitter(this.key+"_openingcharacter",t.platformId);else{this.add(this.bottomPanel),this.bottomPanel.show();var e=-1!==this.blackList.indexOf(t.platformId);this.bottomPanel.setRoleData(t,e)}},PicaOnlinePanel.prototype.refreshBottomPanel=function(){if(this.bottomPanel.visible){var t=this.bottomPanel.roleData.platformId,e=-1!==this.blackList.indexOf(t);this.bottomPanel.refreshBlack(e)}},PicaOnlinePanel.prototype.onBottomPanelHandler=function(t,e){"report"===t||("block"===t?this.render.renderEmitter(this.key+"_block",e):"close"===t&&this.closeBottomPanel())},PicaOnlinePanel.prototype.closeBottomPanel=function(){this.bottomPanel.hide(),this.remove(this.bottomPanel)},PicaOnlinePanel}(h.PicaBasePanel),m=function(t){function OnlineItem(e,i,n){var o=t.call(this,e,0,0)||this;return o.key=i,o.dpr=n,o.setSize(237*n,48*n),o.headicon=new s.DynamicImage(o.scene,0,0),o.headicon.x=.5*-o.width+10*o.dpr,o.headicon.y=0,o.headicon.scale=.8*o.dpr,o.headicon.visible=!1,o.add(o.headicon),o.nameImage=new s.ImageValue(o.scene,60*o.dpr,20*o.dpr,o.key,"people_woman",o.dpr),o.nameImage.setOffset(-o.dpr,0),o.nameImage.setTextStyle(a.UIHelper.whiteStyle(o.dpr,14)),o.nameImage.setLayout(1),o.nameImage.setText(""),o.nameImage.x=o.headicon.x+70*o.dpr,o.nameImage.y=.5*-o.height+15*o.dpr,o.add(o.nameImage),o.levelLabel=o.scene.make.text({x:o.nameImage.x-8*o.dpr,y:o.nameImage.y+20*o.dpr,text:"",style:a.UIHelper.whiteStyle(o.dpr)}),o.levelLabel.setOrigin(0,.5),o.add(o.levelLabel),o.vipImage=new s.ImageValue(o.scene,60*o.dpr,20*o.dpr,o.key,"people_woman",o.dpr),o.vipImage.setOffset(-o.dpr,0),o.vipImage.setTextStyle(a.UIHelper.whiteStyle(o.dpr,14)),o.vipImage.setLayout(1),o.vipImage.setText(""),o.vipImage.x=o.levelLabel.x+70*o.dpr,o.vipImage.y=.5*-o.width+15*o.dpr,o.line=o.scene.make.image({key:r.d.uicommon,frame:"online_divider"}),o.line.y=.5*o.height,o.add(o.line),o.simpleButton=new l.Button(o.scene,o.key,"online_more"),o.simpleButton.on(l.ClickEvent.Tap,o.onSimpleClickHandler,o),o.simpleButton.x=.5*o.width-.5*o.simpleButton.width-10*n,o.add(o.simpleButton),o}return p(OnlineItem,t),OnlineItem.prototype.setPlayerInfo=function(t){var e=this;if(this.playerData=t,this.nameImage.setText(t.nickname),this.levelLabel.text=a.i18n.t("common.lv")+" "+t.level.level,this.headicon.visible=!1,t.avatar){var i=a.Url.getOsdRes(t.avatar);this.headicon.load(i,this,(function(){e.headicon.x=.5*-e.width+.5*e.headicon.displayWidth+10*e.dpr,e.headicon.visible=!0}))}},OnlineItem.prototype.setHandler=function(t){this.sendHandler=t},OnlineItem.prototype.onSimpleClickHandler=function(){this.sendHandler&&this.sendHandler.runWith(this.playerData)},OnlineItem}(s.ButtonEventDispatcher)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaOpenPartyPanel",(function(){return d}));var n,s=i(2),r=i(5),o=i(470),a=i(1),h=i(0),l=i(11),c=i(521),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function fulfilled(t){try{step(n.next(t))}catch(t){r(t)}}function rejected(t){try{step(n.throw(t))}catch(t){r(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function verb(r){return function(a){return function step(r){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(s=2&r[0]?n.return:r[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,r[1])).done)return s;switch(n=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],n=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},d=function(t){function PicaOpenPartyPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i.key=a.ModuleName.PICAOPENPARTY_NAME,i}return p(PicaOpenPartyPanel,t),PicaOpenPartyPanel.prototype.resize=function(t,e){this.scale;var i=this.scaleWidth,n=this.scaleHeight;this.content.x=.5*i,this.content.y=.5*n,this.setSize(i,n),this.partyCreatePanel.resize()},PicaOpenPartyPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen()):this.preload())},PicaOpenPartyPanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.onCloseHandler,this)},PicaOpenPartyPanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.onCloseHandler,this)},PicaOpenPartyPanel.prototype.destroy=function(){this.removeListen(),t.prototype.destroy.call(this)},PicaOpenPartyPanel.prototype.setPartyData=function(t,e){return void 0===e&&(e=!0),__awaiter(this,void 0,void 0,(function(){var i;return __generator(this,(function(n){switch(n.label){case 0:return this.settingBtn.visible=e,[4,this.render.mainPeer.getRoomUserName()];case 1:return i=n.sent(),this.partyCreatePanel.setPartyData(t,i,Math.ceil(this.render.mainPeer.getClockNow()/1e3)),t.created?this.partyBtn.setText(h.i18n.t("party.partymgr")):this.partyBtn.setText(h.i18n.t("main_ui.party")),[2]}}))}))},PicaOpenPartyPanel.prototype.preload=function(){this.addAtlas(this.key,"party/party.png","party/party.json"),this.addAtlas(l.c.commonKey,l.d.commonUrl+".png",l.d.commonUrl+".json"),this.addAtlas(l.c.common2Key,l.d.common2Url+".png",l.d.common2Url+".json"),t.prototype.preload.call(this)},PicaOpenPartyPanel.prototype.init=function(){if(!this.mInitialized){var e=this.scaleWidth,i=this.scaleHeight;this.mBackground=this.scene.make.graphics(void 0,!1),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,e,i),Phaser.Geom.Rectangle.Contains),this.mBackground.fillStyle(0,.66),this.mBackground.fillRect(0,0,e,i),this.add(this.mBackground),this.content=this.scene.make.container(void 0,!1);var n=295*this.dpr,s=450*this.dpr;this.content.setSize(n,s),this.bg=new r.NineSlicePatch(this.scene,0,0,n,s,l.c.common2Key,"bg",{left:20*this.dpr,top:20*this.dpr,right:20*this.dpr,bottom:60*this.dpr}),this.content.add(this.bg),this.closeBtn=this.scene.make.image({x:.5*this.bg.width-5*this.dpr,y:.5*-this.bg.height+5*this.dpr,key:l.c.commonKey,frame:"close"}).setScale(1.3),this.closeBtn.setInteractive(),this.closeBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.content.add([this.closeBtn]),this.partyBtn=this.createTabButton(h.i18n.t("main_ui.party")),this.settingBtn=this.createTabButton(h.i18n.t("common.setting")),this.partyBtn.setPosition(.5*-this.partyBtn.width-2*this.dpr,.5*-this.content.height-.5*this.partyBtn.height+3*this.dpr),this.settingBtn.setPosition(.5*this.settingBtn.width+2*this.dpr,this.partyBtn.y),this.topCheckBox=new o.CheckboxGroup,this.topCheckBox.appendItemAll([this.partyBtn,this.settingBtn]),this.topCheckBox.on("selected",this.onTabBtnHandler,this),this.content.add([this.partyBtn,this.settingBtn]),this.partyCreatePanel=new c.PicaOpenPartyCreatePanel(this.uiManager,0,0,this.content.width-20*this.dpr,this.content.height-70*this.dpr,this.key,this.dpr,this.scale),this.partyCreatePanel.on("openparty",this.onOpenPartyHandler,this),this.partyCreatePanel.on("showtips",this.showPanelHandler,this),this.partyCreatePanel.on("querytheme",this.onQueryThemeHandler,this),this.partyCreatePanel.y=0,this.content.add(this.partyCreatePanel),this.add(this.content),this.resize(0,0),t.prototype.init.call(this),this.topCheckBox.selectIndex(0)}},PicaOpenPartyPanel.prototype.onTabBtnHandler=function(t){this.partyBtn===t?(this.partyCreatePanel.show(),this.onQueryThemeHandler()):this.partyCreatePanel.hide(),this.settingBtn},PicaOpenPartyPanel.prototype.createTabButton=function(t){var e=new r.TabButton(this.scene,l.c.common2Key,"default_tab","check_tab",t);return e.tweenEnable=!1,e.setTextStyle({fontFamily:h.Font.DEFULT_FONT,fontSize:16*this.dpr,color:"#ffffff"}),e.setTextOffset(0,0),e},PicaOpenPartyPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(a.ModuleName.PICAOPENPARTY_NAME+"_close")},PicaOpenPartyPanel.prototype.onOpenPartyHandler=function(t,e,i,n,s){this.render.renderEmitter(a.ModuleName.PICAOPENPARTY_NAME+"_queryopen",{topic:t,name:e,des:i,ticket:n}),this.render.renderEmitter(a.ModuleName.PICAOPENPARTY_NAME+"_close"),this.showPanelHandler("PicaNotice",s?h.i18n.t("party.modifytips"):h.i18n.t("party.opentips"))},PicaOpenPartyPanel.prototype.showPanelHandler=function(t,e){if(this.mWorld){var i=new s.op_client.OP_VIRTUAL_WORLD_RES_CLIENT_SHOW_UI;i.text=[{text:e,node:void 0}],this.render.mainPeer.showMediator(t,!0,i)}},PicaOpenPartyPanel.prototype.onQueryThemeHandler=function(){this.render.renderEmitter(a.ModuleName.PICAOPENPARTY_NAME+"_querytheme")},PicaOpenPartyPanel}(o.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaPartyListPanel",(function(){return d}));var n,s=i(5),r=i(470),o=i(11),a=i(1),h=i(0),l=i(620),c=i(619),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaPartyListPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=a.ModuleName.PICAPARTYLIST_NAME,i}return p(PicaPartyListPanel,t),PicaPartyListPanel.prototype.resize=function(t,e){this.scale;var i=this.scaleWidth,n=this.scaleHeight;this.content.x=.5*i,this.content.y=.5*n+20*this.dpr,this.setSize(i,n)},PicaPartyListPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen()):this.preload())},PicaPartyListPanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.onCloseHandler,this)},PicaPartyListPanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.onCloseHandler,this)},PicaPartyListPanel.prototype.destroy=function(){this.removeListen(),t.prototype.destroy.call(this)},PicaPartyListPanel.prototype.setPartyListData=function(t,e){void 0===e&&(e=!0),this.mPartyData=t,this.partyNavigationPanel.setPartyDataList(t)},PicaPartyListPanel.prototype.setOnlineProgress=function(t){this.partyNavigationPanel.setSignProgress(t)},PicaPartyListPanel.prototype.setRoomListData=function(t){this.myRoomNavigationPanel.setRoomDataList(t)},PicaPartyListPanel.prototype.preload=function(){this.addAtlas(this.key,"party/party.png","party/party.json"),this.addAtlas(o.c.commonKey,o.d.commonUrl+".png",o.d.commonUrl+".json"),this.addAtlas(o.c.common2Key,o.d.common2Url+".png",o.d.common2Url+".json"),t.prototype.preload.call(this)},PicaPartyListPanel.prototype.init=function(){if(!this.mInitialized){var e=this.scaleWidth,i=this.scaleHeight;this.mBackground=this.scene.make.graphics(void 0,!1),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,e,i),Phaser.Geom.Rectangle.Contains),this.mBackground.fillStyle(0,.66),this.mBackground.fillRect(0,0,e,i),this.add(this.mBackground),this.content=this.scene.make.container(void 0,!1);var n=295*this.dpr,a=490*this.dpr;this.content.setSize(n,a),this.bg=new s.NineSlicePatch(this.scene,0,0,n,a,o.c.commonKey,"bg",{left:20*this.dpr,top:20*this.dpr,right:20*this.dpr,bottom:60*this.dpr}),this.content.add(this.bg),this.closeBtn=this.scene.make.image({x:.5*this.bg.width-5*this.dpr,y:.5*-this.bg.height+5*this.dpr,key:o.c.commonKey,frame:"close"}).setScale(1.3),this.closeBtn.setInteractive(),this.closeBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.content.add([this.closeBtn]),this.navigationBtn=this.createTabButton(h.i18n.t("party.navigation")),this.mineBtn=this.createTabButton(h.i18n.t("party.mine")),this.navigationBtn.setPosition(-this.navigationBtn.width-2*this.dpr,.5*-this.content.height-.5*this.navigationBtn.height+5*this.dpr),this.mineBtn.setPosition(this.navigationBtn.x+this.navigationBtn.width+2*this.dpr,this.navigationBtn.y),this.topCheckBox=new r.CheckboxGroup,this.topCheckBox.appendItemAll([this.navigationBtn,this.mineBtn]),this.topCheckBox.on("selected",this.onTabBtnHandler,this),this.content.add([this.navigationBtn,this.mineBtn]),this.add(this.content),this.resize(0,0),t.prototype.init.call(this),this.topCheckBox.selectIndex(0)}},PicaPartyListPanel.prototype.onTabBtnHandler=function(t){this.navigationBtn===t?(this.openPartyNavigationPanel(),this.hideRoomNavigationPanel(),this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_querylist"),this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_questprogress")):this.mineBtn===t?(this.openRoomNavigationPanel(),this.hidePartyNavigationPanel(),this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_getMyRoomList")):this.searchBtn},PicaPartyListPanel.prototype.openPartyNavigationPanel=function(){this.partyNavigationPanel||(this.partyNavigationPanel=new l.PicaPartyNavigationPanel(this.scene,this.content.width-40*this.dpr,this.content.height-40*this.dpr,this.key,this.dpr,this.scale),this.partyNavigationPanel.setHandler(new h.Handler(this,this.onPartyListHandler)),this.partyNavigationPanel.y=0*this.dpr,this.partyNavigationPanel.on("questreward",this.onProgressRewardHandler,this)),this.content.add(this.partyNavigationPanel),this.partyNavigationPanel.refreshMask()},PicaPartyListPanel.prototype.hidePartyNavigationPanel=function(){this.partyNavigationPanel&&this.content.remove(this.partyNavigationPanel)},PicaPartyListPanel.prototype.openRoomNavigationPanel=function(){this.myRoomNavigationPanel||(this.myRoomNavigationPanel=new c.PicaMyRoomNavigationPanel(this.scene,this.content.width-40*this.dpr,this.content.height-34*this.dpr,this.key,this.dpr,this.scale),this.myRoomNavigationPanel.setHandler(new h.Handler(this,this.onEnterRoomHandler)),this.myRoomNavigationPanel.y=-10*this.dpr),this.content.add(this.myRoomNavigationPanel),this.myRoomNavigationPanel.refreshMask()},PicaPartyListPanel.prototype.hideRoomNavigationPanel=function(){this.myRoomNavigationPanel&&(this.myRoomNavigationPanel.clear(),this.content.remove(this.myRoomNavigationPanel))},PicaPartyListPanel.prototype.createTabButton=function(t){var e=new s.TabButton(this.scene,o.c.common2Key,"default_tab_s","check_tab_s",t);return e.tweenEnable=!1,e.setTextStyle({fontFamily:h.Font.DEFULT_FONT,fontSize:16*this.dpr,color:"#ffffff"}),e},PicaPartyListPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_close")},PicaPartyListPanel.prototype.onPartyListHandler=function(t,e){"hotel"!==t&&"pictown"!==t&&"partylist"!==t||this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_queryenter",e.roomId)},PicaPartyListPanel.prototype.onProgressRewardHandler=function(t){this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_questreward",t)},PicaPartyListPanel.prototype.onEnterRoomHandler=function(t){this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_queryenter",t)},PicaPartyListPanel}(r.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaPropFunPanel",(function(){return p}));var n,s=i(473),r=i(5),o=i(470),a=i(1),h=i(0),l=i(11),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaPropFunPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i.itemCount=1,i.line=!1,i.key=a.ModuleName.PICAPROPFUN_NAME,i}return c(PicaPropFunPanel,t),PicaPropFunPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,n,s),this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.66),this.blackGraphic.fillRect(0,0,n,s),this.content.x=n/2,this.content.y=s/2,this.setSize(n*this.scale,s*this.scale)},PicaPropFunPanel.prototype.show=function(t){if(this.mShowData=t,!this.mPreLoad)if(this.mInitialized){if(!this.mShow){this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen();var e=this.mShowData;this.setProp(e),this.updateData()}}else this.preload()},PicaPropFunPanel.prototype.addListen=function(){this.mInitialized&&(this.cancelBtn.on(r.ClickEvent.Tap,this.onCancelBtnHandler,this),this.confirmBtn.on(r.ClickEvent.Tap,this.onConfirmBtnHandler,this))},PicaPropFunPanel.prototype.removeListen=function(){this.mInitialized&&(this.cancelBtn.off(r.ClickEvent.Tap,this.onCancelBtnHandler,this),this.confirmBtn.off(r.ClickEvent.Tap,this.onConfirmBtnHandler,this))},PicaPropFunPanel.prototype.preload=function(){this.addAtlas(l.c.commonKey,l.d.commonUrl+".png",l.d.commonUrl+".json"),this.addAtlas(l.c.common2Key,l.d.common2Url+".png",l.d.common2Url+".json"),t.prototype.preload.call(this)},PicaPropFunPanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight,n=this.dpr;this.blackGraphic=this.scene.make.graphics(void 0,!1),this.blackGraphic.setInteractive(new Phaser.Geom.Rectangle(0,0,e,i),Phaser.Geom.Rectangle.Contains),this.add(this.blackGraphic),this.content=this.scene.make.container(void 0,!1);var o=299*this.dpr,a=305*this.dpr;this.content.setSize(o,a),this.add(this.content);var c=new r.NineSlicePatch(this.scene,0,0,o,a,l.c.common2Key,"bg",{left:20*this.dpr,top:20*this.dpr,right:30*this.dpr,bottom:40*this.dpr});c.setInteractive(new Phaser.Geom.Rectangle(0,0,e,i),Phaser.Geom.Rectangle.Contains);var p=.5*-c.height+3*n,d=this.scene.make.image({x:0,y:p,key:l.c.common2Key,frame:"title"});d.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titleName=this.scene.make.text({x:0,y:p+3*n,text:"售出",style:{color:"#905B06",fontSize:16*n,fontFamily:h.Font.DEFULT_FONT}},!1).setOrigin(.5),this.titleName.setFontStyle("bold"),this.itemName=this.scene.make.text({x:0,y:p+40*n,style:{color:"#000000",fontSize:15*n,fontFamily:h.Font.DEFULT_FONT}},!1).setOrigin(.5);var m=-40*n;this.mDetailDisplay=new s.DetailDisplay(this.scene,this.render),this.mDetailDisplay.setFixedScale(this.dpr/this.scale),this.mDetailDisplay.y=m;var u=30*n;this.priceBg=this.scene.make.image({x:0,y:u,key:l.c.common2Key,frame:"price_bg"}),this.priceBg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.pricText=this.scene.make.text({x:0,y:u,style:{color:"#000000",fontSize:15*n,fontFamily:h.Font.DEFULT_FONT}},!1).setOrigin(.5),this.mCoinIcon=this.scene.make.image({x:-45*this.dpr,y:u,key:l.c.commonKey,frame:"iv_coin"},!1).setOrigin(.5),this.mCoinIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var y=new r.NineSlicePatch(this.scene,0,0,8,7*n,l.c.common2Key,"slider_bg",{left:3,top:1,right:3,bottom:1}),f=new r.NineSlicePatch(this.scene,0,0,8,7*n,l.c.common2Key,"slider_rate",{left:3,top:1,right:3,bottom:1}),g=this.scene.make.image({key:l.c.common2Key,frame:"block"});this.thumb=g,this.itemCountText=this.scene.make.text({x:0,y:0,style:{color:"#744803",fontSize:15*n,fontFamily:h.Font.DEFULT_FONT}},!1).setOrigin(.5),this.slider=new r.GameSlider(this.scene,{x:0,y:70*n,width:136*n,height:7*n,orientation:1,background:y,indicator:f,thumb:g,offsetX:.5*g.width,valuechangeCallback:this.onSliderValueHandler,valuechangeCallbackScope:this,value:.5}),this.slider.add(this.itemCountText),this.slider.setValue(0);var P=.5*c.height-30*n,v=-66*n;this.cancelBtn=new r.NineSliceButton(this.scene,v,P,112*n,36*n,l.c.commonKey,"red_btn",h.i18n.t("common.cancel"),n,this.scale,{left:12*n,top:12*n,right:12*n,bottom:12*n}),this.confirmBtn=new r.NineSliceButton(this.scene,-v,P,112*n,36*n,l.c.commonKey,"yellow_btn",h.i18n.t("common.confirm"),n,this.scale,{left:12*n,top:12*n,right:12*n,bottom:12*n}),this.cancelBtn.setTextStyle({color:"#FFFFFF",fontSize:16*n,fontFamily:h.Font.DEFULT_FONT}),this.confirmBtn.setTextStyle({color:"#976400",fontSize:16*n,fontFamily:h.Font.DEFULT_FONT}),this.content.add([c,d,this.titleName,this.itemName,this.mDetailDisplay,this.priceBg,this.mCoinIcon,this.pricText,this.slider,this.cancelBtn,this.confirmBtn]),this.resize(0,0),t.prototype.init.call(this)},PicaPropFunPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaPropFunPanel.prototype.setProp=function(t){this.prop=t;var e=void 0===t.price||t.price;e=!!this.prop.data.sellingPrice&&e;var i=void 0===t.slider||t.slider;if(this.line=t.line||!1,this.itemData=this.prop.data,this.itemCount=i?1:this.itemData.count,t.resource&&this.setResource(t.resource),t.url&&this.mDetailDisplay.loadUrl(t.url),this.itemName.text=this.itemData.name||this.itemData.shortName,this.itemCountText.text=this.itemCount+"",t.title&&(this.titleName.text=t.title),e){this.pricText.visible=!0,this.priceBg.visible=!0,this.mCoinIcon.visible=!0,this.slider.y=70*this.dpr,this.pricText.text=h.Coin.getName(this.itemData.sellingPrice.coinType)+" x "+this.itemData.sellingPrice.price*this.itemCount;var n=h.Coin.getIcon(this.itemData.sellingPrice.coinType);this.mCoinIcon.setFrame(n)}else this.pricText.visible=!1,this.priceBg.visible=!1,this.mCoinIcon.visible=!1,this.slider.y=50*this.dpr;if(t.resultHandler.key&&t.resultHandler.key.length>0){var s=this.uiManager.getPanel(""+t.resultHandler.key);s&&(t.resultHandler.confirmFunc&&t.resultHandler.confirmFunc in s&&"function"==typeof s[t.resultHandler.confirmFunc]&&(this.confirmHandler=s[t.resultHandler.confirmFunc]),t.resultHandler.confirmAddData&&(this.confirmHandlerAddData=t.resultHandler.confirmAddData),t.resultHandler.cancelFunc&&t.resultHandler.cancelFunc in s&&"function"==typeof s[t.resultHandler.cancelFunc]&&(this.cancelHandler=s[t.resultHandler.cancelFunc]))}this.slider.visible=i,this.slider.setValue(0)},PicaPropFunPanel.prototype.setResource=function(t){t?t.display?this.mDetailDisplay.loadDisplay(t):t.avatar&&this.mDetailDisplay.loadAvatar(t,2,new Phaser.Geom.Point(0,70)):this.mDetailDisplay.loadUrl(this.itemData.display.texturePath)},PicaPropFunPanel.prototype.updateData=function(){this.itemCountText&&(this.itemCountText.text=this.itemCount+""),this.pricText&&this.itemData&&this.itemData.sellingPrice&&(this.pricText.text=h.Coin.getName(this.itemData.sellingPrice.coinType)+" x "+this.itemData.sellingPrice.price*this.itemCount)},PicaPropFunPanel.prototype.onCancelBtnHandler=function(){var t=this.uiManager.getPanel(""+this.prop.resultHandler.key);t&&this.cancelHandler&&this.cancelHandler.apply(t,this.itemData),this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_close")},PicaPropFunPanel.prototype.onConfirmBtnHandler=function(){if(this.confirmHandler){var t=this.uiManager.getPanel(""+this.prop.resultHandler.key);t&&(this.confirmHandlerAddData?this.confirmHandler.apply(t,[this.confirmHandlerAddData,this.itemData,this.itemCount]):this.confirmHandler.apply(t,[this.itemData,this.itemCount]))}this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_close")},PicaPropFunPanel.prototype.onSliderValueHandler=function(t){this.itemCountText.x=this.thumb.x,this.itemCount=this.line?this.calcuSliderValue(t):this.lineSliderValue(t),this.updateData()},PicaPropFunPanel.prototype.calcuSliderValue=function(t){var e=this.itemData?this.itemData.count:1,i=0;if(e<=40)i=Math.round(e*t);else if(t<=1/4)i=40*t;else{var n=e-10;if(n<=40)i=10+n*(t-1/4)/.75;else{var s=n/4;i=10;for(var r=1;r<4;r++){var o=s+n/12*(r-1);if(t>r/4&&t<=(r+1)/4){i+=o*(t-r/4)/(1/4);break}i+=o}}}return(i=Math.round(i))<1&&(i=1),i},PicaPropFunPanel.prototype.lineSliderValue=function(t){var e=this.itemData?this.itemData.count:1;return Math.round(e*t)},PicaPropFunPanel}(o.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRecastePanel",(function(){return m}));var n,s=i(5),r=i(470),o=i(475),a=i(11),h=i(1),l=i(0),c=i(2),p=i(471),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),m=function(t){function PicaRecastePanel(e){var i=t.call(this,e)||this;return i.tempData={},i.atlasNames=[a.d.uicommon],i.textures=[{atlasName:"Recast_aims_icon_bg",folder:"texture"},{atlasName:"Recast_bg_texture",folder:"texture"}],i.key=h.ModuleName.PICARECASTE_NAME,i}return d(PicaRecastePanel,t),PicaRecastePanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,n,s),this.mBackground.x=.5*n,this.mBackground.y=.5*s,this.mTopBg.x=.5*n,this.mTopBg.y=.5*this.mTopBg.height;var r=79*this.dpr,o=s-this.mPropGrid.height-.5*r-47*this.dpr;this.mCategoryCon.setSize(n,79*this.dpr),this.mCategoryCon.y=o,this.mCategoryCon.x=.5*n,this.mCategoriesBar.y=40*this.dpr,this.mCategoriesBar.x=.5*-n,this.mCategoriesBar.clear(),this.mCategoriesBar.fillStyle(4121087),this.mCategoriesBar.fillRect(0,0,n,40*this.dpr),this.confirmBtn.x=n-this.confirmBtn.width/2-10*this.dpr,this.confirmBtn.y=this.mCategoryCon.y-this.confirmBtn.height/2+25*this.dpr,this.labelTipTex.x=15*this.dpr,this.labelTipTex.y=this.confirmBtn.y,this.displayPanel.x=.5*n,this.displayPanel.y=.5*o+17*this.dpr,this.mPropGridBg.clear(),this.mPropGridBg.fillStyle(8250878),this.mPropGridBg.fillRect(0,0,this.mPropGrid.width,this.mPropGrid.height+10*this.dpr),this.mPropGridBg.y=s-this.mPropGrid.height-4*this.dpr,this.mPropGrid.x=n/2+3*this.dpr,this.mPropGrid.y=s-.5*this.mPropGrid.height,this.mPropGrid.layout(),this.mPropGrid.resetMask(),this.mCategoryScroll.refreshMask(),this.setSize(n,s),this.setInteractive()},PicaRecastePanel.prototype.setRecasteResult=function(t){t&&(this.mRecasteItemData.count--,this.displayPanel.setRecasteItemData(this.mRecasteItemData))},PicaRecastePanel.prototype.setCategories=function(t){if(this.tempData.subcategory=t,this.mInitialized&&t){this.mPreCategoryBtn=null,this.mSelectedCategeories=null;var e=60*this.dpr,i=41*this.dpr,n=[];this.mCategoryScroll.clearItems();var s={value:l.i18n.t("common.all"),key:"alltype"};t.unshift(s);for(var o=0;o<t.length;o++){var h=new r.TextButton(this.scene,this.dpr,1,t[o].value,0,0);h.setData("item",t[o]),h.setSize(e,i),this.mCategoryScroll.addItem(h),n[o]=h,h.setFontSize(18*this.dpr),h.setFontStyle("bold");var c=this.scene.make.image({key:a.d.uicommon,frame:"Recast_nav_Select"});c.y=21*this.dpr,h.add(c),c.visible=!1,h.setData("lineImg",c)}this.mCategoryScroll.Sort(),this.mCategoryScroll.refreshMask(),n.length>1&&this.onSelectSubCategoryHandler(n[0])}},PicaRecastePanel.prototype.onShow=function(){this.setStarData(this.starCount),this.setRecasteItemData(this.mShowData),this.setCategories(this.tempData.subcategory)},PicaRecastePanel.prototype.setProp=function(t){var e=(t=t||[]).length;e<18&&(t=t.concat(new Array(18-e))),this.mPropGrid.setItems(t)},PicaRecastePanel.prototype.setStarData=function(t){this.starCount=t,this.mInitialized&&this.starvalue.setText(t+"")},PicaRecastePanel.prototype.setRecasteItemData=function(t){this.mRecasteItemData=t,this.displayPanel.setRecasteItemData(t)},PicaRecastePanel.prototype.addListen=function(){this.mInitialized&&(this.mCloseBtn.on(s.ClickEvent.Tap,this.onCloseHandler,this),this.confirmBtn.on(s.ClickEvent.Tap,this.onConfirmBtnHandler,this))},PicaRecastePanel.prototype.removeListen=function(){this.mInitialized&&(this.mCloseBtn.off(s.ClickEvent.Tap,this.onCloseHandler,this),this.confirmBtn.off(s.ClickEvent.Tap,this.onConfirmBtnHandler,this))},PicaRecastePanel.prototype.destroy=function(){this.mCategoryScroll&&this.mCategoryScroll.destroy(),this.mPropGrid&&this.mPropGrid.destroy(),t.prototype.destroy.call(this)},PicaRecastePanel.prototype.queryRecasteList=function(){if(this.mSelectedCategeories){var t=this.mSelectedCategeories;this.render.renderEmitter(this.key+"_queryrecastelist",{type:t.key,star:this.mRecasteItemData.grade})}},PicaRecastePanel.prototype.onInitialized=function(){this.starCount&&this.starvalue.setText(this.starCount+"")},PicaRecastePanel.prototype.init=function(){var e=this,i=this.scaleWidth,n=this.scaleHeight;this.mBackground=new r.CommonBackground(this.scene,0,0,i,n),this.mTopBg=this.scene.make.image({key:"Recast_bg_texture"},!1),this.displayPanel=new u(this.scene,i,248*this.dpr,this.render,this.dpr,this.scale),this.mTopBg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mCategoryCon=this.scene.make.container(void 0,!1),this.mCategoryCon.setSize(i,295*this.dpr),this.mCategoryCon.y=n-this.mCategoryCon.height,this.mCategoriesBar=this.scene.make.graphics(void 0,!1),this.mCategoryCon.add(this.mCategoriesBar),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.mCloseBtn=new r.ButtonEventDispatcher(this.scene,0,0),this.mCloseBtn.setSize(100*this.dpr,40*this.dpr),this.mCloseBtn.enable=!0,this.mCloseBtn.x=.5*this.mCloseBtn.width+10*this.dpr,this.mCloseBtn.y=35*this.dpr;var h=this.scene.make.image({key:a.d.uicommon,frame:"back_arrow"});h.x=.5*-this.mCloseBtn.width+.5*h.width+10*this.dpr;var c=this.scene.make.text({text:"",style:l.UIHelper.whiteStyle(this.dpr,18)}).setOrigin(0,.5);c.setFontStyle("bold"),c.text=l.i18n.t("furni_bag.recaste"),c.x=h.x+.5*h.width+10*this.dpr,this.mCloseBtn.add([h,c]);var p=new s.NineSlicePatch(this.scene,0,-this.dpr,80*this.dpr,28*this.dpr,a.d.uicommon,"home_assets_bg",{left:17*this.dpr,top:0*this.dpr,right:17*this.dpr,bottom:0*this.dpr});p.x=.5*-p.width,this.starvalue=new r.ImageValue(this.scene,60*this.dpr,26*this.dpr,a.d.uicommon,"Recast_pica star_big",this.dpr,{color:"#ffffff",fontSize:15*this.dpr,fontFamily:l.Font.NUMBER}),this.starvalue.setLayout(1),this.starvalue.x=p.x-.5*p.width+22*this.dpr,this.starCountCon=this.scene.make.container(void 0,!1),this.starCountCon.setSize(p.width,p.height),this.starCountCon.add([p,this.starvalue]),this.starCountCon.x=i-20*this.dpr,this.starCountCon.y=this.mCloseBtn.y;var d=100*this.dpr,m=40*this.dpr,y=i-d/2-20*this.dpr,f=this.mCategoryCon.y-25*this.dpr;this.confirmBtn=this.createNineButton(y+100*this.dpr,f,d,m,a.d.uicommon,"yellow_btn",l.i18n.t("common.confirm"),"#996600"),this.labelTipTex=this.scene.make.text({text:l.i18n.t("recaste.tip"),style:l.UIHelper.colorStyle("#FAF916",14*this.dpr)}).setOrigin(0,.5),this.mCategoryScroll=new s.GameScroller(this.scene,{x:0,y:60*this.dpr,width:i,height:44*this.dpr,zoom:this.scale,orientation:1,dpr:this.dpr,space:10*this.dpr,selfevent:!0,cellupCallBack:function(t){e.onSelectSubCategoryHandler(t)}}),this.mPropGridBg=this.scene.make.graphics(void 0,!1),this.mCategoryCon.add(this.mCategoryScroll),this.add([this.mBackground,this.mPropGridBg,this.mTopBg,this.displayPanel,this.mCloseBtn,this.starCountCon,this.mCategoryCon,this.confirmBtn,this.labelTipTex]);var g=this.scene.textures.getFrame(a.d.uicommon,"bag_icon_common_bg"),P=g.width+9*this.dpr,v=g.height+9*this.dpr,b={x:0,y:0,table:{width:i,height:231*this.dpr,columns:3,cellWidth:P,cellHeight:v,reuseCellContainer:!0,zoom:this.scale,mask:!1},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.scene,s=t.item;return null===i&&(i=new o.c(n,a.d.uicommon,"bag_icon_common_bg",e.dpr,e.scale,!1)),i.setData({item:s}),i.setItemData(s),e.mSelectedItemData&&s&&e.mSelectedItemData.id===s.id&&(i.isSelect=!0,e.mSelectedItem=i),i}};this.mPropGrid=new s.GameGridTable(this.scene,b),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){t&&e.onSelectItemHandler(t)})),this.add(this.mPropGrid),this.resize(0,0),t.prototype.init.call(this)},PicaRecastePanel.prototype.createNineButton=function(t,e,i,n,r,o,a,h){var c=new s.NineSliceButton(this.scene,t,e,i,n,r,o,a,this.dpr,1,{left:14*this.dpr,top:14*this.dpr,right:15*this.dpr,bottom:14*this.dpr});return a&&(c.setTextStyle({color:h,fontSize:16*this.dpr,fontFamily:l.Font.DEFULT_FONT}),c.setFontStyle("bold")),c},PicaRecastePanel.prototype.onSelectSubCategoryHandler=function(t){var e=t.getData("item");if(e){if(this.mPreCategoryBtn)this.mPreCategoryBtn.changeNormal(),this.mPreCategoryBtn.getData("lineImg").visible=!1;t.changeDown(),this.mSelectedCategeories=e,this.mPropGrid.setT(0),this.queryRecasteList(),this.mPreCategoryBtn=t,t.getData("lineImg").visible=!0}this.mPropGrid.setT(0)},PicaRecastePanel.prototype.onCloseHandler=function(){this.render.renderEmitter(this.key+"_close")},PicaRecastePanel.prototype.onSelectItemHandler=function(t){var e=t.getData("item");e&&this.mSelectedItemData===e||!e||(this.mSelectedItemData=e,this.displayPanel.setRecasteTargetData(e),this.mSelectedItem&&(this.mSelectedItem.select=!1),t.select=!0,this.mSelectedItem=t)},PicaRecastePanel.prototype.onConfirmBtnHandler=function(){var t;if(this.mSelectedItemData?this.starCount<this.mSelectedItemData.grade?t=l.i18n.t("furnicompose.starpicatips"):0===this.mRecasteItemData.count?t=l.i18n.t("recaste.counttips"):this.mRecasteItemData.id===this.mSelectedItemData.id&&(t=l.i18n.t("recaste.sametips")):t=l.i18n.t("recaste.selecttips"),t){var e={text:[{text:t,node:void 0}]};this.render.mainPeer.showMediator(h.ModuleName.PICANOTICE_NAME,!0,e)}else this.render.renderEmitter(this.key+"_queryrecaste",{consumedId:this.mRecasteItemData.id,targetId:this.mSelectedItemData.id})},PicaRecastePanel}(p.PicaBasePanel),u=function(t){function RecasteDisplayPanel(e,i,n,s,r,o){var a=t.call(this,e)||this;return a.setSize(i,n),a.dpr=r,a.zoom=o,a.render=s,a.init(),a}return d(RecasteDisplayPanel,t),RecasteDisplayPanel.prototype.setRecasteItemData=function(t){this.recasteItem.setItemData(t,!0),this.starvalue.setText(t.grade+"")},RecasteDisplayPanel.prototype.setRecasteTargetData=function(t){this.recasteTarget.displayLoading("loading_ui",l.Url.getUIRes(this.dpr,"loading_ui"),l.Url.getUIRes(this.dpr,"loading_ui"),this.dpr/this.zoom);var e=new c.op_client.OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE_ITEM_RESOURCE;e.display=t.animationDisplay,e.animations=t.animations,this.recasteTarget.loadDisplay(e),this.starLevelImg.setFrame("Recast_star_big_"+t.grade),this.nameTex.text=t.name||t.shortName,this.starLevelImg.visible=!0},RecasteDisplayPanel.prototype.init=function(){var t=this,e=this.scene.make.image({key:"Recast_aims_icon_bg"});e.x=.5*this.width-.5*e.width-15*this.dpr,this.recasteItem=new o.c(this.scene,a.d.uicommon,"Recast_default_icon_bg",this.dpr,this.zoom,!1),this.recasteItem.x=.5*-this.width+.5*this.recasteItem.width+20*this.dpr,this.recasteItem.y=0;var i=this.scene.make.image({key:a.d.uicommon,frame:"Recast_arrow"});i.x=this.recasteItem.x+.5*this.recasteItem.width+.5*i.width+6*this.dpr,i.y=this.recasteItem.y,this.starvalue=new r.ImageValue(this.scene,60*this.dpr,20*this.dpr,a.d.uicommon,"Recast_pica star_small",this.dpr,l.UIHelper.colorNumberStyle("#ffffff",20*this.dpr)),this.starvalue.x=i.x-11*this.dpr,this.starvalue.y=i.y-10*this.dpr,this.nameTex=this.scene.make.text({text:"",style:l.UIHelper.colorStyle("#FFFF00",14*this.dpr)}).setOrigin(0,.5),this.nameTex.setFontStyle("bold"),this.nameTex.x=e.x-.5*e.width,this.nameTex.y=e.y-.5*e.height-18*this.dpr,this.starLevelImg=this.scene.make.image({key:a.d.uicommon,frame:"Recast_star_big_1"}).setOrigin(1,.5),this.starLevelImg.x=e.x+.5*e.width-.5*this.starLevelImg.width-12*this.dpr,this.starLevelImg.y=e.y-.5*e.height+.5*this.starLevelImg.height+8*this.dpr,this.starLevelImg.visible=!1,this.recasteTarget=new o.a(this.scene,this.render),this.recasteTarget.setFixedScale(2*this.dpr/this.zoom),this.recasteTarget.setComplHandler(new l.Handler(this,(function(){t.recasteTarget.visible=!0}))),this.recasteTarget.setTexture(a.d.uicommon,"bag_nothing",1),this.recasteTarget.setNearest(),this.recasteTarget.x=e.x,this.recasteTarget.y=e.y,this.add([e,this.recasteItem,this.recasteTarget,i,this.starvalue,this.nameTex,this.starLevelImg])},RecasteDisplayPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRechargePanel",(function(){return p}));var n,s,r=i(5),o=i(470),a=i(1),h=i(11),l=i(0),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaRechargePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=a.ModuleName.PICARECHARGE_NAME,i}return c(PicaRechargePanel,t),PicaRechargePanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,n,s),this.setSize(n,s),this.mBackground.clear(),this.mBackground.fillGradientStyle(7304703,7304703,314367,314367),this.mBackground.fillRect(0,0,n,s),this.content.setSize(n,s),this.content.x=.5*n,this.content.y=.5*s,this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,n,s),Phaser.Geom.Rectangle.Contains),this.top.y=.5*-s+.5*this.top.height,this.bottom.y=.5*s-.5*this.bottom.height;var r=640*this.dpr;this.middle.y=i<r?this.top.y+this.top.height+.5*this.middle.height:28*this.dpr;var o=this.top.height+this.bottom.height;this.bg.scaleY=1,this.bg.displayHeight=s-o+60*this.dpr,this.gamescroll&&this.gamescroll.refreshMask()},PicaRechargePanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicaRechargePanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.OnClosePanel,this)},PicaRechargePanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.OnClosePanel,this)},PicaRechargePanel.prototype.preload=function(){this.addAtlas(this.key,"recharge/recharge.png","recharge/recharge.json"),this.addAtlas(h.c.commonKey,h.d.textureUrl(h.d.commonUrl),h.d.jsonUrl(h.d.commonUrl)),this.addAtlas(h.c.common2Key,h.d.textureUrl(h.d.common2Url),h.d.jsonUrl(h.d.common2Url)),this.addAtlas(h.c.common3Key,h.d.textureUrl(h.d.common3Url),h.d.jsonUrl(h.d.common3Url)),t.prototype.preload.call(this)},PicaRechargePanel.prototype.init=function(){this.mBackground=this.scene.make.graphics(void 0,!1),this.add(this.mBackground);var e=this.scaleWidth,i=this.scaleHeight;this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.add(this.content),this.bg=this.scene.make.image({key:this.key,frame:"recharge_bg"}),this.bg.scale=1,this.bg.displayHeight=i-(96*this.dpr+50*this.dpr),this.bg.y=23*this.dpr,this.content.add(this.bg),this.top=this.scene.make.container(void 0,!1),this.top.setSize(e,100*this.dpr),this.top.y=.5*-i+.5*this.top.height,this.content.add(this.top);var n=.5*-this.top.height;this.topbg=this.scene.make.image({key:this.key,frame:"recharge_head"}),this.topbg.y=n+.5*this.topbg.height+43*this.dpr,this.titlebg=this.scene.make.image({x:0,y:0,key:this.key,frame:"recharge_text"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titlebg.y=n+45*this.dpr,this.tilteName=this.scene.make.text({x:0,y:this.titlebg.y+2*this.dpr,text:l.i18n.t("recharge.title"),style:l.UIHelper.titleYellowStyle_m(this.dpr)}).setOrigin(.5),this.tilteName.setFontStyle("bold"),this.tilteName.setResolution(this.dpr),this.closeBtn=new r.Button(this.scene,h.c.commonKey,"back_arrow","back_arrow"),this.closeBtn.x=.5*-e+.5*this.closeBtn.width+15*this.dpr,this.closeBtn.y=n+.5*this.closeBtn.height+10*this.dpr,this.diamondvalue=new o.ValueContainer(this.scene,h.c.common3Key,"diamond",this.dpr),this.diamondvalue.x=.5*e-46*this.dpr,this.diamondvalue.y=this.closeBtn.y,this.top.add([this.topbg,this.titlebg,this.tilteName,this.closeBtn,this.diamondvalue]),this.createMiddle(e,i),this.createBottom(e,50*this.dpr),this.itemtips=new o.ItemInfoTips(this.scene,150*this.dpr,46*this.dpr,h.c.common2Key,"tips_bg",this.dpr),this.itemtips.setVisible(!1),this.content.add(this.itemtips),this.resize(),t.prototype.init.call(this),this.setDataList()},PicaRechargePanel.prototype.setDataList=function(){var t=this;if(this.gamescroll){for(var e=0;e<3;e++){(i=new m(this.scene,this.width,110*this.dpr,this.key,this.dpr,this.scale)).setHandler(new l.Handler(this,(function(e){t.buy("com.tooqing.app.60diamond","测试付费项目")}))),i.setTwoData(),this.gamescroll.addItem(i)}this.gamescroll.Sort()}else{for(e=0;e<6;e++){var i;(i=new d(this.scene,this.key,this.dpr,this.scale)).setHandler(new l.Handler(this,(function(e){t.buy("com.tooqing.app.60diamond","测试付费项目")}))),this.gridlayout.add(i)}this.gridlayout.Layout()}},PicaRechargePanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaRechargePanel.prototype.createMiddle=function(t,e){this.middle=this.scene.make.container(void 0,!1),this.content.add(this.middle),this.banner=new u(this.scene,0,0,308*this.dpr,96*this.dpr,this.key,"recharge_banner",this.scale),this.middle.add(this.banner);var i=150*this.dpr,n=e-i;if(n<640*this.dpr-i){this.middle.setSize(t,n),this.middle.y=this.top.y+this.top.height+.5*this.middle.height,this.banner.y=.5*-this.middle.height+.5*this.banner.height,(l=this.scene.make.image({key:this.key,frame:"recharge_division"})).y=this.banner.y+.5*this.banner.height+.5*l.height,this.middle.add(l);var s=n-110*this.dpr,r=.5*s+l.y+.5*l.height;this.gamescroll=this.createGameScroll(0,r,t,s),this.middle.add(this.gamescroll)}else{this.middle.setSize(t,500*this.dpr),this.middle.y=28*this.dpr,this.banner.y=.5*-this.middle.height+.5*this.banner.height+3*this.dpr;for(var a=this.banner.y+.5*this.banner.height-this.dpr,h=0;h<4;h++){var l;(l=this.scene.make.image({key:this.key,frame:"recharge_division"})).y=a+.5*l.height,a+=131*this.dpr,this.middle.add(l)}this.gridlayout=new o.GridLayoutGroup(this.scene,0,0,{cellSize:new Phaser.Math.Vector2(149*this.dpr,110*this.dpr),space:new Phaser.Math.Vector2(10*this.dpr,21*this.dpr),startAxis:o.AxisType.Horizontal,constraint:o.ConstraintType.FixedColumnCount,constraintCount:2,alignmentType:o.AlignmentType.UpperCenter}),this.gridlayout.y=this.banner.y+.5*this.banner.height+21*this.dpr,this.middle.add(this.gridlayout)}},PicaRechargePanel.prototype.createBottom=function(t,e){this.bottom=this.scene.make.container(void 0,!1),this.bottom.setSize(t,e),this.content.add(this.bottom),this.bottom.y=.5*this.scaleHeight-.5*e;var i=this.scene.make.image({key:this.key,frame:"recharge_nav_bg"});this.bottom.add(i);var n=102*this.dpr,a=41*this.dpr,h=15*this.dpr,c=l.UIHelper.blueStyle(this.dpr,15);this.checkBox=new o.CheckboxGroup;for(var p=[s.GIFT,s.PRIVILEGE,s.DIAMONO],d=[l.i18n.t("recharge.gift"),l.i18n.t("recharge.privilege"),l.i18n.t("recharge.diamond")],m=.5*-(n*p.length+h*(p.length-1)),u=0;u<p.length;u++){var y=p[u],f=new r.TabButton(this.scene,this.key,"recharge_tab_uncheck","recharge_tab_check",d[u]);f.setTextStyle(c),f.setData("data",y),f.setSize(n,a),f.setFontStyle("bold"),f.y=1*this.dpr,f.x=m+.5*n,m+=n+h,this.checkBox.appendItem(f),this.bottom.add(f)}this.checkBox.on("selected",this.onTabButtonHandler,this),this.checkBox.selectIndex(0)},PicaRechargePanel.prototype.createGameScroll=function(t,e,i,n){return new r.GameScroller(this.scene,{x:t,y:e,width:i,height:n,zoom:this.scale,align:2,orientation:0,dpr:this.dpr,space:20*this.dpr,selfEvent:!0,padding:{top:10*this.dpr,bottom:10*this.dpr}})},PicaRechargePanel.prototype.buy=function(t,e){window.IAP&&window.IAP.buy(t,(function(){alert("购买"+e+"成功，等待发货！")}))},PicaRechargePanel.prototype.onTabButtonHandler=function(t){},PicaRechargePanel.prototype.OnClosePanel=function(){this.render.renderEmitter(a.ModuleName.PICARECHARGE_NAME+"_hide")},PicaRechargePanel.prototype.onPointerUpHandler=function(t){},PicaRechargePanel.prototype.onSendHandler=function(t){this.render.renderEmitter(a.ModuleName.PICARECHARGE_NAME+"_questwork",t)},PicaRechargePanel.prototype.onItemInfoTips=function(t,e,i){this.itemtips.visible=e,this.itemtips.x=i.x*this.scale-this.content.x,this.itemtips.y=i.y*this.scale-this.content.y-30*this.dpr,this.itemtips.setText(this.getDesText(t))},PicaRechargePanel.prototype.getDesText=function(t){return t||(t={sellingPrice:!0,tradable:!1}),l.i18n.t("work.attri",{name:""+t.name,value:t.neededCount})},PicaRechargePanel}(o.BasePanel),d=function(t){function RechargeItem(e,i,n,s){var a=t.call(this,e)||this;a.giftbags=[],a.key=i,a.dpr=n,a.zoom=s;var c=149*n,p=108*n;return a.setSize(c,p),a.bg=a.scene.make.image({key:i,frame:"recharge_diamond_bg"}),a.add(a.bg),a.title=new r.BBCodeText(a.scene,0,0,"",{color:"#ffffff",fontSize:14*n,fontFamily:l.Font.DEFULT_FONT}).setOrigin(.5),a.title.x=0,a.title.y=.5*-p+10*n,a.add(a.title),a.imgicon=a.scene.make.image({key:i,frame:"recharge_diamond_1.99"}),a.add(a.imgicon),a.imgicon.x=.5*-a.width+48*n,a.imgicon.y=2*n,a.tipsbg=a.scene.make.image({key:i,frame:"recharge_first_purchase"}),a.add(a.tipsbg),a.tipsbg.x=.5*a.width-.5*a.tipsbg.width+3*n,a.tipsbg.y=.5*-a.height+.5*a.tipsbg.height+23*n,a.tipsvalue=a.scene.make.text({text:"",style:l.UIHelper.whiteStyle(n)}),a.tipsvalue.setOrigin(0,.5),a.add(a.tipsvalue),a.tipsvalue.x=.5*-a.width+3*n,a.tipsvalue.y=a.tipsbg.y-7*n,a.tipstext=a.scene.make.text({text:"First Purchase",style:l.UIHelper.whiteStyle(n,11)}),a.tipstext.setOrigin(1,.5),a.add(a.tipstext),a.tipstext.x=.5*a.width-3*n,a.tipstext.y=a.tipsbg.y-3*n,a.purchaseBtn=new o.ThreeSliceButton(e,63*n,22*n,h.c.common3Key,l.UIHelper.threeYellowNormal,l.UIHelper.threeYellowNormal,"$ 1.99"),a.purchaseBtn.setTextStyle(l.UIHelper.brownishStyle(n)),a.purchaseBtn.setFontStyle("bold"),a.add(a.purchaseBtn),a.purchaseBtn.x=.5*a.width-.5*a.purchaseBtn.width-10*n,a.purchaseBtn.y=.5*a.height-.5*a.purchaseBtn.height-9*n,a.purchaseBtn.on(String(r.ClickEvent.Tap),a.onSendHandler,a),a.setRechargeData(void 0),a}return c(RechargeItem,t),RechargeItem.prototype.setHandler=function(t){this.sendHandler=t},RechargeItem.prototype.setRechargeData=function(t){this.rechargeData=t,this.title.text="[color=#FFE400]100[/color]Diamond",this.setPropItems()},RechargeItem.prototype.setPropItems=function(){for(var t=0,e=this.giftbags;t<e.length;t++){(r=e[t]).visible=!1,r.enable=!1}var i=[],n=0;1===i.length?(this.addimg&&(this.addimg.visible=!1),n=.5*this.width-55*this.dpr):(n+=20*this.dpr,this.addimg?this.addimg.visible=!0:(this.addimg=this.scene.make.image({key:this.key,frame:"recharge_diamond_gift"}),this.add(this.addimg)));for(var s=0;s<i.length;s++){var r=void 0,a=i[s];s<this.giftbags.length?r=this.giftbags[s]:((r=new o.PropItem(this.scene,this.key,"recharge_diamond_gift",this.dpr,this.zoom)).enable=!0,this.giftbags.push(r),this.add(r)),r.setItemData(a),r.visible=!0,r.x=n+.5*r.width,r.y=0,n+=r.width+20*this.dpr}},RechargeItem.prototype.onSendHandler=function(){this.sendHandler&&this.sendHandler.runWith([100])},RechargeItem}(Phaser.GameObjects.Container),m=function(t){function TwoRechargeItem(e,i,n,s,r,o){var a=t.call(this,e)||this;return a.key=s,a.dpr=r,a.zoom=o,a.bottombg=a.scene.make.image({key:s,frame:"recharge_division"}),a.setSize(i,n),a.add(a.bottombg),a.bottombg.y=.5*a.height+.5*a.bottombg.height-1*r,a}return c(TwoRechargeItem,t),TwoRechargeItem.prototype.setHandler=function(t){this.sendHandler=t},TwoRechargeItem.prototype.setTwoData=function(){for(var t=0;t<2;t++){var e=new d(this.scene,this.key,this.dpr,this.scale);e.setHandler(this.sendHandler),this.add(e),e.x=.5*-e.width-5*this.dpr+t*(e.width+10*this.dpr)}},TwoRechargeItem}(Phaser.GameObjects.Container),u=function(t){function RechargeBanner(e,i,n,s,r,o,a,h){var l=t.call(this,e,i,n)||this;return l.key=o,l.frame=a,l.banners=[],l.setSize(s,r),l.setBannerData(),l.enable=!0,l}return c(RechargeBanner,t),RechargeBanner.prototype.setBannerData=function(){for(var t=0,e=0;e<6;e++){var i=new o.DynamicImage(this.scene,0,0,this.key,this.frame);this.banners.push(i),i.x=t,t+=i.width+10*this.dpr}this.add(this.banners)},RechargeBanner.prototype.onPointerMoveHandler=function(e){t.prototype.onPointerMoveHandler.call(this,e),this.banners.length>1&&this.moveBanner(e.deltaX)},RechargeBanner.prototype.onPointerUpHandler=function(t){this.interactiveBoo?this.mTweenBoo?this.tween(!1,this.pointerUp.bind(this,t)):this.pointerUp(t):this.soundGroup&&this.soundGroup.disabled&&this.playSound(this.soundGroup.disabled)},RechargeBanner.prototype.moveBanner=function(t){for(var e=0,i=this.banners;e<i.length;e++){i[e].x+=t}},RechargeBanner.prototype.tween=function(t,e){var i=this;this.mTweening=!0,this.mTween&&(this.mTween.stop(),this.mTween.remove(),this.mTween=void 0),this.mTween=this.scene.tweens.add({targets:this.list,duration:45,ease:"Linear",x:0,onComplete:function(){i.tweenComplete(),e&&e()},onCompleteParams:[this]})},RechargeBanner.prototype.tweenComplete=function(){this.mTweening=!1,this.mTween&&(this.mTween.stop(),this.mTween.remove(),this.mTween=void 0)},RechargeBanner}(o.SoundButton);!function(t){t[t.GIFT=0]="GIFT",t[t.PRIVILEGE=1]="PRIVILEGE",t[t.DIAMONO=2]="DIAMONO"}(s||(s={}))},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRewardTipPanel",(function(){return h}));var n,s=i(470),r=i(1),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicaRewardTipPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i.mTips=[],i.showingList=[],i.key=r.ModuleName.PICAREWARDTIP_NAME,i}return a(PicaRewardTipPanel,t),PicaRewardTipPanel.prototype.show=function(){t.prototype.show.call(this),this.mInitialized&&0===this.showingList.length&&this.showAward(),this.mScene.layerManager.addToLayer(s.MainUIScene.LAYER_TOOLTIPS,this)},PicaRewardTipPanel.prototype.appendAward=function(t){this.mTips.push(t),this.show()},PicaRewardTipPanel.prototype.addAward=function(){},PicaRewardTipPanel.prototype.destroy=function(){t.prototype.destroy.call(this),this.mTips&&(this.mTips=[])},PicaRewardTipPanel.prototype.preload=function(){this.addImage(this.key,"reaward_tips/bg.png"),t.prototype.preload.call(this)},PicaRewardTipPanel.prototype.init=function(){this.setSize(20,20),t.prototype.init.call(this),this.y=250*this.dpr},PicaRewardTipPanel.prototype.showAward=function(){if(!(this.mTips.length<1)&&this.scene&&!(this.showingList.length>=3)){for(var t=0,e=this.showingList;t<e.length;t++){e[t].beUp()}var i=new l(this.scene,this.key,this.dpr,this.scale);i.once("destroy",this.onDestroyHanlder,this),i.once("show",this.onAwardItemShowHandler,this),i.setProp(this.mTips.pop()),this.add(i),this.showingList.push(i)}},PicaRewardTipPanel.prototype.onAwardItemShowHandler=function(){this.showAward()},PicaRewardTipPanel.prototype.onDestroyHanlder=function(t){var e=this.showingList.indexOf(t);e>-1&&this.showingList.splice(e,1),this.showAward()},PicaRewardTipPanel}(s.BasePanel),l=function(t){function AwardItem(e,i,n,r){var a=t.call(this,e)||this;return a.mBg=a.scene.make.image({key:i},!1),a.mScaleRatio=n*r,a.mImage=new s.DynamicImage(a.scene,0,0),a.mImage.setScale(n),a.mImage.setOrigin(.5,1),a.mImage.y=a.mBg.height*r/2,a.mLabel=a.scene.make.text({x:a.mBg.width*a.originX-6*a.mScaleRatio,style:{fontFamily:o.Font.DEFULT_FONT,fontSize:11*a.mScaleRatio,color:"#00FF00"}},!1).setOrigin(1,.5),a.addAt(a.mBg,0),a.add([a.mImage,a.mLabel]),a.setSize(a.mBg.width*r,a.mBg.height*r),a}return a(AwardItem,t),AwardItem.prototype.setProp=function(t){t&&(t.display&&t.display.texturePath&&this.mImage.load(o.Url.getOsdRes(t.display.texturePath)),this.mLabel.setText(t.text),this.showTween())},AwardItem.prototype.showTween=function(){var t=this;this.scene.tweens.add({targets:this,props:{x:"+="+.3*this.width},ease:"Bounce.easeOut",onComplete:function(){t.emit("show"),t.closeDelay=setTimeout((function(){t.closeTween()}),1e3)},duration:300})},AwardItem.prototype.closeTween=function(){var t=this;this.scene&&this.scene.tweens.add({targets:this,props:{y:"-="+50*this.mScaleRatio,alpha:"0"},ease:"Linear",duration:300,onComplete:function(){t.destroy()}})},AwardItem.prototype.beUp=function(){var t=this;clearTimeout(this.closeDelay),this.scene.tweens.add({targets:this,props:{y:"-="+50*this.mScaleRatio},ease:"Linear",duration:300,onComplete:function(){t.closeDelay=setTimeout((function(){t.closeTween()}),1e3)}})},AwardItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRoamPanel",(function(){return d}));var n,s=i(11),r=i(1),o=i(0),a=i(471),h=i(523),l=i(522),c=i(524),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaRoamPanel(e){var i=t.call(this,e)||this;return i.key=r.ModuleName.PICAROAM_NAME,i.atlasNames=[s.d.uicommon,s.d.uicommon1,s.d.roam],i.textures=[{atlasName:"roam_stripe",folder:"roam"},{atlasName:"roam_topic",folder:"roam"}],i}return p(PicaRoamPanel,t),PicaRoamPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,n,s),this.setSize(n,s),this.mBackground.clear(),this.mBackground.fillStyle(0,.5),this.mBackground.fillRoundedRect(-this.x,-this.y,n,s),this.content.x=.5*n,this.content.y=.5*s,this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,n,s),Phaser.Geom.Rectangle.Contains)},PicaRoamPanel.prototype.addListen=function(){this.mInitialized},PicaRoamPanel.prototype.removeListen=function(){this.mInitialized},PicaRoamPanel.prototype.destroy=function(){t.prototype.destroy.call(this),this.roamListPanel&&this.roamListPanel.destroy(),this.roamDrawPanel&&this.roamDrawPanel.destroy(),this.roamPreviewPanel&&this.roamPreviewPanel.destroy()},PicaRoamPanel.prototype.init=function(){this.mBackground=this.scene.make.graphics(void 0,!1),this.add(this.mBackground);var e=295*this.dpr,i=405*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.add(this.content),this.resize(),t.prototype.init.call(this)},PicaRoamPanel.prototype.onShow=function(){this.openRoamList(),this.tempDatas&&this.roamListPanel.setRoamDataList(this.tempDatas)},PicaRoamPanel.prototype.setRoamDataList=function(t){if(this.tempDatas=t,this.mInitialized&&(this.roamListPanel.setRoamDataList(t),this.roamDrawPanel)){var e=this.roamListPanel.getRoamTokenDatas();this.roamDrawPanel.setRoamDatas(e)}},PicaRoamPanel.prototype.payDrawHandler=function(t){this.render.renderEmitter(this.key+"_queryroamdraw",t)},PicaRoamPanel.prototype.setRoamTokenData=function(t,e,i){this.roamDrawPanel&&this.roamDrawPanel.setMoneyData(t,e,i)},PicaRoamPanel.prototype.openRoamList=function(){this.showRoamListPanel()},PicaRoamPanel.prototype.showRoamListPanel=function(){this.roamListPanel||(this.roamListPanel=new h.PicaRoamListPanel(this.scene,this.scaleWidth,this.scaleHeight,this.dpr,this.scale),this.roamListPanel.setHandler(new o.Handler(this,this.onRoamListHandler))),this.content.add(this.roamListPanel),this.roamListPanel.visible=!0,this.roamListPanel.resize(this.scaleWidth,this.scaleHeight),this.render.renderEmitter(this.key+"_updatepools")},PicaRoamPanel.prototype.hideRoamListPanel=function(){this.content.remove(this.roamListPanel),this.roamListPanel.visible=!1},PicaRoamPanel.prototype.openRoamDrawPanel=function(t){this.showRoamDrawPanel(),this.roamDrawPanel.setRoamDatas(t);var e=t[0],i={tokenId:e.tokenId,alterId:e.alterTokenId};this.render.renderEmitter(this.key+"_updatetoken",i),this.tokenId=e.tokenId},PicaRoamPanel.prototype.showRoamDrawPanel=function(){this.roamDrawPanel||(this.roamDrawPanel=new l.PicaRoamDrawPanel(this.scene,this.scaleWidth,this.scaleHeight,this.dpr,this.scale),this.roamDrawPanel.setHandler(new o.Handler(this,this.onRoamDrawHandler))),this.content.add(this.roamDrawPanel),this.roamDrawPanel.visible=!0,this.roamDrawPanel.resize(this.scaleWidth,this.scaleHeight)},PicaRoamPanel.prototype.hideRoamDrawPanel=function(){this.content.remove(this.roamDrawPanel),this.roamDrawPanel.visible=!1},PicaRoamPanel.prototype.showRoamPreviewPanel=function(){this.roamPreviewPanel||(this.roamPreviewPanel=new c.PicaRoamPreviewPanel(this.scene,this.scaleWidth,this.scaleHeight,this.dpr,this.scale),this.roamPreviewPanel.setHandler(new o.Handler(this,this.onRoamPreviewHandler))),this.content.add(this.roamPreviewPanel),this.roamPreviewPanel.visible=!0,this.roamPreviewPanel.resize(this.scaleWidth,this.scaleHeight)},PicaRoamPanel.prototype.hideRoamPreviewPanel=function(){this.content.remove(this.roamPreviewPanel),this.roamPreviewPanel.visible=!1},PicaRoamPanel.prototype.onRoamListHandler=function(t,e){"close"===t?this.onCloseHandler():"roam"===t&&this.openRoamDrawPanel(e)},PicaRoamPanel.prototype.onRoamDrawHandler=function(t,e){if("close"===t)this.hideRoamDrawPanel(),this.showRoamListPanel();else if("draw"===t)this.render.renderEmitter(this.key+"_queryroamdraw",e.id);else{if("notice"===t){var i={text:[{text:e,node:void 0}]};return void this.render.mainPeer.showMediator(r.ModuleName.PICANOTICE_NAME,!0,i)}if("pay"===t){var n=o.UIHelper.createMessageBoxConfig(e.text,o.i18n.t("roam.title"),this.key,"payDrawHandler",[e.id]);this.render.mainPeer.showMediator(r.ModuleName.PICAMESSAGEBOX_NAME,!0,n)}else"preview"===t?this.showRoamPreviewPanel():"progressrewards"===t&&this.render.renderEmitter(this.key+"_queryprogressrewards",e)}},PicaRoamPanel.prototype.onRoamPreviewHandler=function(t,e){"close"===t&&this.hideRoamPreviewPanel()},PicaRoamPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(this.key+"_hide")},PicaRoamPanel}(a.PicaBasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRoomListPanel",(function(){return p})),i.d(e,"RoomDelegate",(function(){return d})),i.d(e,"RoomZoon",(function(){return u}));var n,s=i(2),r=i(5),o=i(470),a=i(1),h=i(0),l=i(11),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaRoomListPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.mSelectIndex=0,i.key=a.ModuleName.PICAROOMLIST_NAME,i}return c(PicaRoomListPanel,t),PicaRoomListPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;this.content.x=n>>1,this.content.y=s>>1,this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,n,s),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,n,s),Phaser.Geom.Rectangle.Contains),t.prototype.resize.call(this,n,s),this.setSize(n,s)},PicaRoomListPanel.prototype.updateRoomList=function(t){t&&this.mRoomDele.updateList(t)},PicaRoomListPanel.prototype.updateMyRoomList=function(t){t&&this.mMyRoomDele.updateList(t)},PicaRoomListPanel.prototype.addListen=function(){this.mInitialized&&(this.mCloseBtn.on("pointerup",this.onCloseHandler,this),this.mSeachBtn.on("pointerup",this.onSeachHandler,this))},PicaRoomListPanel.prototype.removeListen=function(){this.mInitialized&&(this.mCloseBtn.off("pointerup",this.onCloseHandler,this),this.mSeachBtn.off("pointerup",this.onSeachHandler,this))},PicaRoomListPanel.prototype.destroy=function(){this.mScroller&&this.mScroller.destroy(),t.prototype.destroy.call(this)},PicaRoomListPanel.prototype.preload=function(){this.addAtlas(l.c.commonKey,l.d.commonUrl+".png",l.d.commonUrl+".json"),this.addAtlas(this.key,"pica_roomlist/pica_roomlist.png","pica_roomlist/pica_roomlist.json"),t.prototype.preload.call(this)},PicaRoomListPanel.prototype.init=function(){var e=this;this.setSize(this.scaleWidth,this.scaleWidth);var i=this.mWorld.uiScale,n=this.scene.make.image({key:this.key,frame:"bg.png"},!1).setInteractive();this.mBackGround=this.scene.make.graphics(void 0,!1),this.mCloseBtn=this.scene.make.image({key:this.key,frame:"close_btn.png"},!1).setInteractive(),this.mCloseBtn.x=n.width/2-this.mCloseBtn.width/2-2*this.dpr,this.mCloseBtn.y=-n.height/2+this.mCloseBtn.height/2,this.mRoomDeleBtn=new r.TabButton(this.scene,this.key,"checkbox_normal","checkbox_down",h.i18n.t("room_list.visit")),this.mRoomDeleBtn.x=-54*this.dpr,this.mRoomDeleBtn.y=-n.height/2+this.mRoomDeleBtn.displayHeight/2-4*this.dpr,this.mRoomDeleBtn.setTextStyle({color:"#3333cc",fontFamily:h.Font.DEFULT_FONT,fontSize:14*this.dpr}),this.mRoomDeleBtn.setFontStyle("bold"),this.mMyRoomDeleBtn=new r.TabButton(this.scene,this.key,"checkbox_normal","checkbox_down",h.i18n.t("room_list.my")),this.mMyRoomDeleBtn.x=54*this.dpr,this.mMyRoomDeleBtn.y=this.mRoomDeleBtn.y,this.mMyRoomDeleBtn.setTextStyle({color:"#3333cc",fontFamily:h.Font.DEFULT_FONT,fontSize:16*this.dpr}),this.mMyRoomDeleBtn.setFontStyle("bold");var s=new o.CheckboxGroup;s.appendItemAll([this.mRoomDeleBtn,this.mMyRoomDeleBtn]),s.on("selected",this.onSelectedHandler,this),this.mSelectIndex=0,this.mRoomContainer=this.scene.make.container(void 0,!1),this.mRoomContainer.setSize(282*this.dpr,362*this.dpr),this.mRoomContainer.y=-n.height/2+11*this.dpr*i,this.mSeachBtn=this.scene.make.image({key:this.key,frame:"seach_btn.png"},!1).setInteractive(),this.mSeachBtn.y=n.height/2-this.mSeachBtn.height/2+12*this.dpr;var a=this.scene.make.text({x:-35*this.dpr,y:this.mSeachBtn.y,text:h.i18n.t("room_list.seach"),style:{color:"#996600",fontFamily:h.Font.DEFULT_FONT,fontSize:14*this.dpr}},!1).setOrigin(.5),l=this.scene.make.text({x:35*this.dpr,y:this.mSeachBtn.y,text:h.i18n.t("room_list.room"),style:{color:"#996600",fontFamily:h.Font.DEFULT_FONT,fontSize:14*this.dpr}},!1).setOrigin(.5);this.content=this.scene.make.container(void 0,!1),this.content.setSize(n.width,n.height),this.content.add([n,this.mRoomContainer,this.mCloseBtn,this.mSeachBtn,a,l]),this.add([this.mBackGround,this.content]),t.prototype.init.call(this),this.resize(0,0);var c=this.mRoomContainer.width*this.scale,p=this.mRoomContainer.height*this.scale,d={x:this.scaleWidth-c/this.scale>>1,y:this.content.y-this.content.height/2+20*this.dpr*this.scale,clickX:0,clickY:0,width:this.scaleWidth,height:p,boundPad0:-40*this.dpr*i,zoom:i,dpr:this.dpr,value:this.content.y,valuechangeCallback:function(t){e.mRoomContainer.y=t-e.content.y-p/2},cellupCallBack:function(t){t.onEnterRoomHandler()},overminCallbackScope:this,overminCallback:function(){e.mRoomDele&&0===e.mSelectIndex&&e.mRoomDele.overminHandler(),e.mMyRoomDele||1!==e.mSelectIndex||e.mMyRoomDele.overminHandler()}};this.mScroller=new r.BaseScroller(this.scene,this.mRoomContainer,d),this.content.add([this.mRoomDeleBtn,this.mMyRoomDeleBtn,this.mCloseBtn]),s.selectIndex(0)},PicaRoomListPanel.prototype.showRoomList=function(){this.mMyRoomDele&&(this.mMyRoomDele.removeFromContainer(),this.mMyRoomDele.off("enterRoom",this.onEnterRoomHandler,this)),this.mRoomDele||(this.mRoomDele=new d(this.mRoomContainer,this.mScroller,this.scene,this.mWorld,this.key,this.dpr)),this.mRoomDele.on("enterRoom",this.onEnterRoomHandler,this),this.mRoomDele.addToContainer(),this.render.renderEmitter(a.ModuleName.PICAROOMLIST_NAME+"_getRoomList")},PicaRoomListPanel.prototype.showMyRoomList=function(){this.mRoomDele&&(this.mRoomDele.removeFromContainer(),this.mRoomDele.off("enterRoom",this.onEnterRoomHandler,this)),this.mMyRoomDele||(this.mMyRoomDele=new m(this.mRoomContainer,this.mScroller,this.mWorld,this.scene,this.key,this.dpr)),this.mMyRoomDele.on("enterRoom",this.onEnterRoomHandler,this),this.mMyRoomDele.addToContainer(),this.render.renderEmitter(a.ModuleName.PICAROOMLIST_NAME+"_getMyRoomList")},PicaRoomListPanel.prototype.onEnterRoomHandler=function(t){this.render.renderEmitter(a.ModuleName.PICAROOMLIST_NAME+"_enterRoom",t)},PicaRoomListPanel.prototype.onSelectedHandler=function(t){if(t instanceof r.Button){switch(this.mRoomContainer.removeAll(!1),t){case this.mRoomDeleBtn:this.showRoomList(),this.mSelectIndex=0;break;case this.mMyRoomDeleBtn:this.showMyRoomList(),this.mSelectIndex=1}t.setTextColor("#996600"),this.preTabButton&&this.preTabButton.setTextColor("#3333cc"),this.preTabButton=t}},PicaRoomListPanel.prototype.onSeachHandler=function(){},PicaRoomListPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(a.ModuleName.PICAROOMLIST_NAME+"_close")},PicaRoomListPanel}(o.BasePanel),d=function(t){function RoomDelegate(e,i,n,s,r,o){void 0===o&&(o=1);var a=t.call(this)||this;return a.mChildPad=0,a.mDpr=1,a.mHeight=0,a.mDpr=o,a.mRender=s,a.mChildPad=0,a.mScene=n,a.mContainer=e,a.mScroller=i,a.mKey=r,a.init(),a}return c(RoomDelegate,t),RoomDelegate.prototype.addListen=function(){this.mPopularityRoom.on("enterRoom",this.onEnterRoomHandler,this),this.mPlayerRoom.on("enterRoom",this.onEnterRoomHandler,this)},RoomDelegate.prototype.removeListen=function(){this.mPopularityRoom.off("enterRoom",this.onEnterRoomHandler,this),this.mPlayerRoom.off("enterRoom",this.onEnterRoomHandler,this)},RoomDelegate.prototype.updateList=function(t){this.mContent=t,this.mScroller.clearInteractiveObject(),this.mHeight=this.activity.height,this.mChildPad=this.activity.height+14*this.mDpr,this.mContent&&this.mPopularityRoom.addItem(t.popularRooms,this.mChildPad)},RoomDelegate.prototype.addToContainer=function(){this.addListen(),this.refreshPos()},RoomDelegate.prototype.removeFromContainer=function(){this.removeListen(),this.mPopularityRoom&&this.mPopularityRoom.clear(),this.mPlayerRoom&&this.mPlayerRoom.clear()},RoomDelegate.prototype.destroy=function(){this.removeListen(),this.mPlayerRoom&&this.mPopularityRoom.destroy(),this.mPopularityRoom&&this.mPopularityRoom.destroy(),this.mScroller&&this.mScroller.destroy(),this.activity&&this.activity.destroy(),t.prototype.destroy.call(this)},RoomDelegate.prototype.overminHandler=function(){var t=this.mPlayerRoom.updateItem();t&&this.mPlayerRoom.mRefreshRooms&&(this.mHeight+=t,this.mContainer.add(this.mPlayerRoom.mRefreshRooms),this.setUpdateScrollInteractive(this.mPlayerRoom.mRefreshRooms))},RoomDelegate.prototype.setUpdateScrollInteractive=function(t){for(var e=0,i=t.length;e<i;e++){var n=t[e];this.mScroller.setInteractiveObject(n)}this.mScroller.refreshBound(this.mHeight)},RoomDelegate.prototype.init=function(){var t=this;this.activity=this.mScene.make.image({key:this.mKey,frame:"activity_title.png"},!1),this.activity.y=this.activity.height/2+2*this.mDpr,this.mChildPad+=this.activity.height/2+18*this.mDpr,this.mPopularityRoom=new f(this.mScene,this.mKey,"popularity_icon.png",h.i18n.t("room_list.popularity_room"),this.mDpr,this.mRender.uiScale,0,this.mChildPad,(function(e){t.mPopularityRoom.roomList&&t.setScrollInteractive(t.mPopularityRoom.roomList),t.mHeight+=e,t.refreshPos(),t.mChildPad+=t.mPopularityRoom.height,t.mPlayerRoom.addItem(t.mContent.playerRooms,t.mChildPad)})),this.mPlayerRoom=new u(this.mScene,this.mKey,"player_icon.png",h.i18n.t("room_list.player_room"),this.mDpr,this.mRender.uiScale,0,this.mChildPad,(function(e){t.mPlayerRoom.roomList&&t.setScrollInteractive(t.mPlayerRoom.roomList),t.mHeight+=e,t.refreshPos(),t.mScroller.refreshBound(t.mHeight),t.mScroller.setValue(t.mContainer.parentContainer.y)})),this.mScroller.refreshBound(this.activity.height),this.mScroller.setValue(this.mContainer.parentContainer.y)},RoomDelegate.prototype.refreshPos=function(){var t=this;this.activity&&(this.activity.setTexture(this.mKey,"activity_title.png"),this.mContainer.add(this.activity)),this.mPopularityRoom&&this.mPopularityRoom.showList&&(this.mContainer.add(this.mPopularityRoom.showList),this.mPopularityRoom.roomList&&this.mPopularityRoom.roomList.forEach((function(e){t.mContainer.add(e)}))),this.mPlayerRoom&&this.mPlayerRoom.showList&&(this.mContainer.add(this.mPlayerRoom.showList),this.mPlayerRoom.roomList&&this.mPlayerRoom.roomList.forEach((function(e){t.mContainer.add(e)})))},RoomDelegate.prototype.onEnterRoomHandler=function(t){this.emit("enterRoom",t)},RoomDelegate.prototype.setScrollInteractive=function(t){for(var e=0,i=t.length;e<i;e++){var n=t[e];this.mScroller.setInteractiveObject(n)}this.refreshPos()},RoomDelegate}(Phaser.Events.EventEmitter),m=function(t){function MyRoomDelegate(e,i,n,s,r,o){return void 0===o&&(o=1),t.call(this,e,i,s,n,r,o)||this}return c(MyRoomDelegate,t),MyRoomDelegate.prototype.addListen=function(){this.mMyRoom.on("enterRoom",this.onEnterRoomHandler,this),this.mMyHistory.on("enterRoom",this.onEnterRoomHandler,this)},MyRoomDelegate.prototype.removeListen=function(){this.mMyRoom.off("enterRoom",this.onEnterRoomHandler,this),this.mMyHistory.off("enterRoom",this.onEnterRoomHandler,this)},MyRoomDelegate.prototype.addToContainer=function(){this.addListen(),this.refreshPos()},MyRoomDelegate.prototype.removeFromContainer=function(){this.removeListen(),this.mMyRoom&&this.mMyRoom.clear(),this.mMyHistory&&this.mMyHistory.clear()},MyRoomDelegate.prototype.updateList=function(t){this.mMyRoom&&(this.mContent=t,this.mScroller.clearInteractiveObject(),this.mHeight=this.activity.height,this.mChildPad=this.activity.height+14*this.mDpr,this.mMyRoom.addItem(t.selfRooms,this.mChildPad))},MyRoomDelegate.prototype.overminHandler=function(){var t=this.mMyHistory.updateItem();t&&this.mMyHistory.mRefreshRooms&&(this.mHeight+=t,this.mContainer.add(this.mMyHistory.mRefreshRooms),this.setUpdateScrollInteractive(this.mMyHistory.mRefreshRooms))},MyRoomDelegate.prototype.destroy=function(){this.mMyRoom&&this.mMyRoom.destroy(),this.mMyHistory&&this.mMyHistory.destroy(),t.prototype.destroy.call(this)},MyRoomDelegate.prototype.refreshPos=function(){var t=this;this.activity&&(this.activity.setTexture(this.mKey,"activity_title.png"),this.mContainer.add(this.activity)),this.mMyRoom&&this.mMyRoom.showList&&(this.mContainer.add(this.mMyRoom.showList),this.mMyRoom.roomList&&this.mMyRoom.roomList.forEach((function(e){t.mContainer.add(e)}))),this.mMyHistory&&this.mMyHistory.showList&&(this.mContainer.add(this.mMyHistory.showList),this.mMyHistory.roomList&&this.mMyHistory.roomList.forEach((function(e){t.mContainer.add(e)})))},MyRoomDelegate.prototype.init=function(){var t=this;this.activity=this.mScene.make.image({key:this.mKey,frame:"activity_title.png"},!1),this.activity.y=this.activity.height/2+2*this.mDpr,this.mChildPad=this.activity.height+14*this.mDpr,this.mMyRoom=new y(this.mScene,this.mKey,"my_room_icon.png",h.i18n.t("room_list.my_room"),this.mDpr,this.mRender.uiScale,0,this.mChildPad,(function(e){t.mMyRoom.roomList&&t.setScrollInteractive(t.mMyRoom.roomList),t.mHeight+=e,t.refreshPos(),t.mChildPad+=t.mMyRoom.height,t.mMyHistory.addItem(t.mContent.historyRooms,t.mChildPad)})),this.mMyHistory=new u(this.mScene,this.mKey,"history_icon.png",h.i18n.t("room_list.my_history"),this.mDpr,this.mRender.uiScale,0,this.mChildPad,(function(e){t.mMyHistory.roomList&&t.setScrollInteractive(t.mMyHistory.roomList),t.mHeight+=e,t.refreshPos(),t.mScroller.refreshBound(t.mHeight),t.mScroller.setValue(t.mContainer.parentContainer.y)})),this.mScroller.refreshBound(this.activity.height),this.mScroller.setValue(this.mContainer.parentContainer.y)},MyRoomDelegate.prototype.onEnterRoomHandler=function(t){this.emit("enterRoom",t)},MyRoomDelegate}(d),u=function(t){function RoomZoon(e,i,n,s,r,o,a,l,c){void 0===a&&(a=0),void 0===l&&(l=0);var p=t.call(this)||this;return p.mWidth=0,p.mHeight=0,p.mPad1=0,p.mShowList=[],p.mScene=e,p.mKey=i,p.mDpr=r,p.uiScale=o,p.mPad=l,p.mOrientaction=a,p.mIconFrame=n,p.mLabel=s,p.icon=e.make.image({key:i,frame:n},!1),p.icon.x=a?-254*r/2+l:-254*r/2,p.icon.y=a?0:l,p.text=e.make.text({text:s,style:{color:"#ffcc33",fontSize:16*r,fontFamily:h.Font.DEFULT_FONT}},!1).setOrigin(0,.5),p.text.setStroke("#663300",2*r),p.text.x=a?p.icon.x+p.icon.width/2+4*r+l:p.icon.x+p.icon.width/2+4*r,p.text.y=a?0:l,p.mWidth=p.icon.width,p.mHeight=p.icon.height,p.mAddCallBack=c,p.mRooms=[],p}return c(RoomZoon,t),Object.defineProperty(RoomZoon.prototype,"showList",{get:function(){return this.mShowList},enumerable:!1,configurable:!0}),Object.defineProperty(RoomZoon.prototype,"roomList",{get:function(){return this.mRooms},enumerable:!1,configurable:!0}),RoomZoon.prototype.addItem=function(t,e){void 0===e&&(e=0),this.icon=this.mScene.make.image({key:this.mKey,frame:this.mIconFrame},!1),this.text=this.mScene.make.text({text:this.mLabel,style:{color:"#ffcc33",fontSize:16*this.mDpr,fontFamily:h.Font.DEFULT_FONT}},!1).setOrigin(0,.5),this.text.setStroke("#663300",2*this.mDpr),this.icon.x=this.mOrientaction?-254*this.mDpr/2+e:-254*this.mDpr/2,this.icon.y=this.mOrientaction?0:e,this.text.x=this.mOrientaction?this.icon.x+this.icon.width/2+4*this.mDpr+e:this.icon.x+this.icon.width/2+4*this.mDpr,this.text.y=this.mOrientaction?0:e,this.mShowList.push(this.icon),this.mShowList.push(this.text),this.mHeight=this.icon.height,this.mPad=e||this.mPad,this.mPad1=e;var i=this.uiScale,n=this.mOrientaction?this.mPad+e:0,s=6*this.mDpr*i;if(t.length>0){var r=t.length;this.mPad+=this.icon.height+12*this.mDpr*i;for(var o=0;o<r;o++)if(o*(g.Hei+s)+this.mPad<=362*this.mDpr+g.Hei+s){var a=new g(this.mScene,this.mKey,this.mDpr);a.setInfo(t[0]),t.splice(0,1),a.on("enterRoom",this.onEnterRoomHandler,this),a.x=n;var l=o*(g.Hei+s)+this.mPad;this.mRooms.push(a),a.y=l,this.mHeight+=g.Hei+s}this.mRoomDatas=t}this.mHeight+=s,this.mAddCallBack&&this.mAddCallBack(this.mHeight)},RoomZoon.prototype.updateItem=function(){var t=this.mRoomDatas.slice(0,10),e=t.length;if(e<1)return 0;var i=this.uiScale,n=this.mOrientaction?this.mPad+this.mPad1:0,s=6*this.mDpr*i,r=this.mRooms.length;this.mRefreshRooms=[];for(var o=0,a=0;a<e;a++){var h=new g(this.mScene,this.mKey,this.mDpr);h.setInfo(t[a]),h.on("enterRoom",this.onEnterRoomHandler,this),h.x=n;var l=(a+r)*(g.Hei+s)+this.mPad;h.y=l,this.mRefreshRooms.push(h),this.mRooms.push(h),this.mHeight+=g.Hei+s,o+=g.Hei+s}return this.mRoomDatas.splice(0,10),o},Object.defineProperty(RoomZoon.prototype,"width",{get:function(){return this.mWidth},enumerable:!1,configurable:!0}),Object.defineProperty(RoomZoon.prototype,"height",{get:function(){return this.mHeight},enumerable:!1,configurable:!0}),RoomZoon.prototype.destroy=function(){this.clear(),t.prototype.destroy.call(this)},RoomZoon.prototype.clear=function(){for(var t=0,e=this.mRooms;t<e.length;t++){e[t].destroy()}for(var i=0,n=this.mShowList;i<n.length;i++){n[i].destroy()}this.icon.destroy(),this.text.destroy(),this.mShowList.length=0,this.mRooms.length=0},RoomZoon.prototype.onEnterRoomHandler=function(t){this.emit("enterRoom",t)},RoomZoon}(Phaser.Events.EventEmitter),y=function(t){function MyRoomZoon(){return null!==t&&t.apply(this,arguments)||this}return c(MyRoomZoon,t),MyRoomZoon.prototype.addItem=function(t,e){void 0===e&&(e=0),this.icon=this.mScene.make.image({key:this.mKey,frame:this.mIconFrame},!1),this.text=this.mScene.make.text({text:this.mLabel,style:{color:"#ffcc33",fontSize:16*this.mDpr,fontFamily:h.Font.DEFULT_FONT}},!1).setOrigin(0,.5),this.text.setStroke("#663300",2*this.mDpr),this.icon.x=this.mOrientaction?-254*this.mDpr/2+e:-254*this.mDpr/2,this.icon.y=this.mOrientaction?0:e,this.text.x=this.mOrientaction?this.icon.x+this.icon.width/2+4*this.mDpr+e:this.icon.x+this.icon.width/2+4*this.mDpr,this.text.y=this.mOrientaction?0:e,this.mShowList.push(this.icon),this.mShowList.push(this.text),this.mHeight=this.icon.height,this.mPad=e||this.mPad;var i=this.uiScale,n=this.mOrientaction?this.mPad+e:0,s=6*this.mDpr*i;if(t.length>0){this.mPad+=this.icon.height+14*this.mDpr*i;for(var r=0;r<t.length;r++){var o=new P(this.mScene,this.mKey,this.mDpr);o.setInfo(t[r]),o.on("enterRoom",this.onEnterRoomHandler,this),o.x=n;var a=r*(g.Hei+s)+this.mPad;o.y=a,this.mRooms[r]=o,this.mHeight+=g.Hei+s}}this.mHeight+=s,this.mAddCallBack&&this.mAddCallBack(this.mHeight)},MyRoomZoon}(u),f=function(t){function PopularRoomZoon(){return null!==t&&t.apply(this,arguments)||this}return c(PopularRoomZoon,t),PopularRoomZoon.prototype.addItem=function(t,e){void 0===e&&(e=0),this.icon=this.mScene.make.image({key:this.mKey,frame:this.mIconFrame},!1),this.text=this.mScene.make.text({text:this.mLabel,style:{color:"#ffcc33",fontSize:16*this.mDpr,fontFamily:h.Font.DEFULT_FONT}},!1).setOrigin(0,.5),this.text.setStroke("#663300",2*this.mDpr),this.icon.x=this.mOrientaction?-254*this.mDpr/2+e:-254*this.mDpr/2,this.icon.y=this.mOrientaction?0:e,this.text.x=this.mOrientaction?this.icon.x+this.icon.width/2+4*this.mDpr+e:this.icon.x+this.icon.width/2+4*this.mDpr,this.text.y=this.mOrientaction?0:e,this.mShowList.push(this.icon),this.mShowList.push(this.text),this.mHeight=this.icon.height,this.mPad=e||this.mPad;var i=this.uiScale,n=this.mOrientaction?this.mPad:0,s=6*this.mDpr*i;if(t.length>0){this.mPad+=this.icon.height+12*this.mDpr*i;for(var r=0;r<t.length;r++){var o=new v(this.mScene,this.mKey,this.mDpr);o.setInfo(t[r]),o.setRank(r+1),o.on("enterRoom",this.onEnterRoomHandler,this),o.x=n;var a=r*(o.height+s)+this.mPad;o.y=a,this.mHeight+=o.height+s,this.mRooms[r]=o}}return this.mHeight+=s,this.mAddCallBack&&this.mAddCallBack(this.mHeight),this.mHeight},PopularRoomZoon}(u),g=function(t){function RoomItem(e,i,n){void 0===n&&(n=1);var s=t.call(this,e)||this;return s.mKey=i,s.mDpr=n,s.init(i,n),s}return c(RoomItem,t),RoomItem.prototype.setInfo=function(t){t&&(t.name&&this.mNickName.setText(t.name),t.playerCount&&this.mCounter.setText(t.playerCount.toString())),this.mCounterIcon.x=this.mCounter.x-this.mCounter.width/2-this.mCounterIcon.width/2-4*this.mDpr,this.mRoom=t},RoomItem.prototype.roomData=function(){return this.mRoom},RoomItem.prototype.onEnterRoomHandler=function(t){this.mRoom&&this.emit("enterRoom",this.mRoom.roomId)},RoomItem.prototype.init=function(t,e){this.mBackground=this.scene.make.image({key:t,frame:"room_gray.png"},!1).setInteractive(),this.setSize(this.mBackground.width,this.mBackground.height),RoomItem.Hei=this.mBackground.height,this.mNickName=this.scene.make.text({style:{color:"#000000",fontFamily:h.Font.DEFULT_FONT,fontSize:14*e}},!1),this.mNickName.x=-this.width/2+12*e,this.mNickName.y=-this.mNickName.height/2,this.mCounterIcon=this.scene.make.image({key:l.c.commonKey,frame:"home_persons"},!1),this.mCounter=this.scene.make.text({style:{color:"#000000",fontFamily:h.Font.DEFULT_FONT,fontSize:14*e}},!1).setOrigin(.5),this.mCounter.x=this.width/2-23*e,this.add([this.mBackground,this.mNickName,this.mCounterIcon,this.mCounter])},RoomItem.prototype.crateLabel=function(t){var e="",i="";t===s.op_def.EditModeRoomPrivacy.EDIT_MODE_ROOM_LOCKED?(e="passworld_label.png",i=h.i18n.t("room_list.password")):t===s.op_def.EditModeRoomPrivacy.EDIT_MODE_ROOM_PRIVATE&&(e="close_label.png",i=h.i18n.t("room_list.close")),""!==e&&""!==i&&(this.mLabelImg=this.scene.make.image({key:this.mKey,frame:e},!1),this.mLabelText=this.scene.make.text({text:i,style:{color:"#666666",fontFamily:h.Font.DEFULT_FONT,fontSize:12*this.mDpr}},!1).setOrigin(0,.5),this.add([this.mLabelImg,this.mLabelText]),this.mLabelImg.x=this.width/2-85*this.mDpr,this.mLabelText.x=this.mLabelImg.x-7*this.mDpr)},RoomItem}(Phaser.GameObjects.Container),P=function(t){function MyRoomItem(e,i,n){return void 0===n&&(n=1),t.call(this,e,i,n)||this}return c(MyRoomItem,t),MyRoomItem.prototype.init=function(e,i){t.prototype.init.call(this,e,i),this.mBackground&&this.mBackground.setFrame("room_yellow.png"),this.mNickName&&(this.mNickName.setColor("#663300"),this.mCounter.setColor("#663300"))},MyRoomItem}(g),v=function(t){function PopularRoomItem(e,i,n){return void 0===n&&(n=1),t.call(this,e,i,n)||this}return c(PopularRoomItem,t),PopularRoomItem.prototype.setRank=function(t){this.mRankImage&&(this.mRankImage.setTexture(this.mKey,"rank_"+t+".png"),this.mRankImage.x=-this.width/2+this.mRankImage.width/2-2*this.mDpr,this.add(this.mRankImage))},PopularRoomItem.prototype.init=function(e,i){t.prototype.init.call(this,e,i),this.mRankImage=this.scene.make.image(void 0,!1),this.mNickName.x=-this.width/2+37*i},PopularRoomItem}(P)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaTaskPanel",(function(){return m}));var n,s=i(2),r=i(470),o=i(1),a=i(11),h=i(0),l=i(471),c=i(526),p=i(5),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),m=function(t){function PicaTaskPanel(e){var i=t.call(this,e)||this;return i.key=o.ModuleName.PICATASK_NAME,i.atlasNames=[a.d.uicommon],i}return d(PicaTaskPanel,t),PicaTaskPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,n,s),this.setSize(n,s),this.blackBg.clear(),this.blackBg.fillStyle(0,.5),this.blackBg.fillRect(-this.x,-this.y,n,s),this.bg.clear(),this.bg.fillStyle(0,.6),this.bg.fillRect(0,0,this.content.width,s),this.bg.x=.5*-this.content.width,this.bg.y=.5*-this.content.height,this.rewardLine.clear(),this.rewardLine.fillStyle(16777215,.6),this.rewardLine.fillRect(-136*this.dpr,0,272*this.dpr,1*this.dpr),this.selectLine.clear(),this.selectLine.fillStyle(16774217,.5),this.selectLine.fillRect(-29*this.dpr,0,58*this.dpr,2*this.dpr),this.content.x=.5*-this.content.width-10*this.dpr,this.content.y=.5*s,this.blackBg.setInteractive(new Phaser.Geom.Rectangle(0,0,n,s),Phaser.Geom.Rectangle.Contains),this.mainPanel.refreshMask()},PicaTaskPanel.prototype.addListen=function(){this.mInitialized&&this.blackBg.on("pointerup",this.OnClosePanel,this)},PicaTaskPanel.prototype.removeListen=function(){this.mInitialized&&this.blackBg.off("pointerup",this.OnClosePanel,this)},PicaTaskPanel.prototype.init=function(){this.setSize(this.scaleWidth,this.scaleHeight),this.blackBg=this.scene.make.graphics(void 0,!1);var e=300*this.dpr,i=this.height;this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.content.setInteractive(),this.add([this.blackBg,this.content]),this.bg=this.scene.make.graphics(void 0,!1),this.tilteName=this.scene.make.text({text:h.i18n.t("task.title"),style:h.UIHelper.whiteStyle(this.dpr,18)}),this.tilteName.setOrigin(0,.5),this.tilteName.setFontStyle("bold"),this.tilteName.x=.5*-e+20*this.dpr,this.tilteName.y=.5*-i+40*this.dpr,this.selectLine=this.scene.make.graphics(void 0,!1),this.rewardLine=this.scene.make.graphics(void 0,!1),this.rewardLine.x=0,this.rewardLine.y=this.tilteName.y+55*this.dpr,this.content.add([this.bg,this.tilteName,this.rewardLine,this.selectLine]);var n=.5*this.height-this.rewardLine.y-10*this.dpr;this.mainPanel=new c.PicaTaskMainPanel(this.scene,this.content.width,n,this.dpr,this.scale),this.mainPanel.setHandler(new h.Handler(this,this.onMainPanelHandler)),this.mainPanel.y=.5*this.height-.5*n,this.content.add(this.mainPanel),this.createOptionButtons(),this.resize(),t.prototype.init.call(this),this.playMove()},PicaTaskPanel.prototype.createOptionButtons=function(){for(var t,e=[{text:h.i18n.t("task.main_quest"),type:s.op_pkt_def.PKT_Quest_Type.QUEST_MAIN_MISSION},{text:h.i18n.t("task.daily_quest"),type:s.op_pkt_def.PKT_Quest_Type.QUEST_DAILY_GOAL}],i=272*this.dpr,n=i/e.length,o=20*this.dpr,a=-i/2,l=.5*-this.height+75*this.dpr,c=0;c<e.length;c++){var d=e[c],m=new r.ToggleColorButton(this.scene,n,20*this.dpr,this.dpr,d.text);m.on(p.ClickEvent.Tap,this.onToggleButtonHandler,this),m.x=a+.5*n,m.y=l,m.setData("item",d.type),m.setSize(n,o),this.content.add(m),m.setChangeColor("#FFF449"),m.setFontSize(14*this.dpr),a+=n,t||(t=m)}t.isOn=!0,this.onToggleButtonHandler(void 0,t)},PicaTaskPanel.prototype.setTaskDatas=function(t){this.mainPanel.setTaskDatas(t,this.questType)},PicaTaskPanel.prototype.setTaskDetail=function(t){},PicaTaskPanel.prototype.onToggleButtonHandler=function(t,e){this.curToggleItem!==e&&(this.curToggleItem&&(this.curToggleItem.isOn=!1),this.curToggleItem=e,this.questType=e.getData("item"),this.selectLine.x=e.x,this.selectLine.y=e.y+20*this.dpr,this.render.renderEmitter(o.ModuleName.PICATASK_NAME+"_questlist",this.questType))},PicaTaskPanel.prototype.onMainPanelHandler=function(t,e){"finish"===t?this.render.renderEmitter(o.ModuleName.PICATASK_NAME+"_submitquest",e):"go"===t||"detail"===t||"reward"===t&&this.render.renderEmitter(o.ModuleName.PICATASK_NAME+"_queryreward",this.questType)},PicaTaskPanel.prototype.OnClosePanel=function(){this.render.renderEmitter(o.ModuleName.PICATASK_NAME+"_hide")},PicaTaskPanel.prototype.playMove=function(){var t=this,e=.5*-this.content.width-10*this.dpr,i=.5*this.content.width,n=this.scene.tweens.add({targets:this.content,x:{from:e,to:i},ease:"Linear",duration:300,onComplete:function(){n.stop(),n.remove(),t.mainPanel.refreshMask(),t.mainPanel.moveFinish()}})},PicaTaskPanel}(l.PicaBasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaTaskSidePanel",(function(){return n}));var n=function n(){}},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaTreasurePanel",(function(){return d}));var n,s=i(11),r=i(1),o=i(0),a=i(471),h=i(528),l=i(529),c=i(530),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaTreasurePanel(e){var i=t.call(this,e)||this;return i.atlasNames=[s.d.treasure,s.d.uicommon1,s.d.uicommon,s.d.circleeffect,s.d.stareffect],i.key=r.ModuleName.PICATREASURE_NAME,i}return p(PicaTreasurePanel,t),PicaTreasurePanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,n,s),this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.88),this.blackGraphic.fillRect(0,0,n,s),this.content.x=n/2,this.content.y=s/2,this.setSize(n*this.scale,s*this.scale)},PicaTreasurePanel.prototype.onShow=function(){this.setInteractive(),this.setTreasureData(this.showData)},PicaTreasurePanel.prototype.destroy=function(){t.prototype.destroy.call(this),this.previewPanel&&this.previewPanel.destroy(),this.treasureOpenPanel&&this.treasureOpenPanel.destroy(),this.treasureAllOpenPanel&&this.treasureAllOpenPanel.destroy()},PicaTreasurePanel.prototype.init=function(){var e=this.cameraWidth,i=this.cameraHeight;this.blackGraphic=this.scene.make.graphics(void 0,!1),this.blackGraphic.setInteractive(new Phaser.Geom.Rectangle(0,0,e/this.scale,i/this.scale),Phaser.Geom.Rectangle.Contains),this.add(this.blackGraphic),this.content=this.scene.make.container(void 0,!1),this.add(this.content),this.resize(0,0),t.prototype.init.call(this)},PicaTreasurePanel.prototype.setTreasureData=function(t){this.trasureData=t,this.mInitialized&&t&&("preview"===t.type?this.setPreviewData(t.data):"open"===t.type?this.setTreasureOpenData(t.data):"roamdraw"===t.type?this.setTreasureAllOpenData(t.data):this.setPreviewData(t.data))},PicaTreasurePanel.prototype.setPreviewData=function(t){this.openPreviewPanel(),this.previewPanel.setTreasureData(t)},PicaTreasurePanel.prototype.setTreasureOpenData=function(t){this.openTreasureOpenPanel(),this.treasureOpenPanel.setTreasureData(t)},PicaTreasurePanel.prototype.setTreasureAllOpenData=function(t){this.openTreasureAllOpenPanel(),this.treasureAllOpenPanel.setTreasureData(t)},PicaTreasurePanel.prototype.openPreviewPanel=function(){var t=this,e=334*this.dpr,i=353*this.dpr;this.previewPanel||(this.previewPanel=new c.PicaTreasurePreviewPanel(this.scene,this.render,e,i,this.key,this.dpr,this.scale),this.previewPanel.setHandler(new o.Handler(this,(function(){t.hidePreviewPanel(),t.setTreasureOpenData(new Array(6))})),new o.Handler(this,this.OnCloseHandler))),this.content.add(this.previewPanel),this.previewPanel.resize(e,i),this.previewPanel.addListen()},PicaTreasurePanel.prototype.hidePreviewPanel=function(){this.content.remove(this.previewPanel),this.previewPanel.removeListen()},PicaTreasurePanel.prototype.openTreasureOpenPanel=function(){var t=this.width,e=310*this.dpr;this.treasureOpenPanel||(this.treasureOpenPanel=new l.PicaTreasureOpenPanel(this.scene,t,e,this.key,this.dpr,this.scale),this.treasureOpenPanel.setHandler(new o.Handler(this,this.OnCloseHandler)),this.treasureOpenPanel.y=-20*this.dpr),this.content.add(this.treasureOpenPanel),this.treasureOpenPanel.resize(t,e),this.treasureOpenPanel.addListen()},PicaTreasurePanel.prototype.hideOpenPanel=function(){this.content.remove(this.treasureOpenPanel),this.treasureOpenPanel.removeListen()},PicaTreasurePanel.prototype.openTreasureAllOpenPanel=function(){var t=this.width,e=320*this.dpr;this.treasureAllOpenPanel||(this.treasureAllOpenPanel=new h.PicaTreasureAllOpenPanel(this.scene,t,e,this.key,this.dpr,this.scale),this.treasureAllOpenPanel.setHandler(new o.Handler(this,this.OnCloseHandler)),this.treasureAllOpenPanel.y=-20*this.dpr),this.content.add(this.treasureAllOpenPanel),this.treasureAllOpenPanel.resize(t,e),this.treasureAllOpenPanel.addListen()},PicaTreasurePanel.prototype.hideAllOpenPanel=function(){this.content.remove(this.treasureAllOpenPanel),this.treasureAllOpenPanel.removeListen()},PicaTreasurePanel.prototype.OnCloseHandler=function(){this.render.renderEmitter(this.key+"_close")},PicaTreasurePanel}(a.PicaBasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaWorkPanel",(function(){return c}));var n,s=i(5),r=i(470),o=i(1),a=i(11),h=i(0),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaWorkPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=o.ModuleName.PICAWORK_NAME,i.workItems=[],i}return l(PicaWorkPanel,t),PicaWorkPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,n,s),this.setSize(n,s),this.mBackground.clear(),this.mBackground.fillStyle(0,.5),this.mBackground.fillRoundedRect(-this.x,-this.y,n,s),this.content.x=.5*n,this.content.y=.5*s,this.mGameScroll.refreshMask(),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,n,s),Phaser.Geom.Rectangle.Contains),this.itemtips.setInvalidArea(h.Tool.getRectangle(this.helpBtn,this.scene))},PicaWorkPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicaWorkPanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.OnClosePanel,this)},PicaWorkPanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.OnClosePanel,this)},PicaWorkPanel.prototype.preload=function(){this.addAtlas(this.key,"work/work.png","work/work.json"),this.addAtlas(a.c.commonKey,a.d.commonUrl+".png",a.d.commonUrl+".json"),this.addAtlas(a.c.common2Key,a.d.common2Url+".png",a.d.common2Url+".json"),t.prototype.preload.call(this)},PicaWorkPanel.prototype.init=function(){var e=this;this.mBackground=this.scene.make.graphics(void 0,!1),this.add(this.mBackground);var i=295*this.dpr,n=454*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(i,n),this.add(this.content),this.bg=new s.NineSlicePatch(this.scene,0,0,i,n,a.c.commonKey,"bg",{left:30*this.dpr,top:30*this.dpr,bottom:30*this.dpr,right:30*this.dpr});var o=.5*-n;this.titlebg=this.scene.make.image({x:0,y:0,key:a.c.common2Key,frame:"title"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titlebg.y=o+3*this.dpr,this.tilteName=this.scene.make.text({x:0,y:this.titlebg.y+2*this.dpr,text:h.i18n.t("work.title"),style:{color:"#905C06",fontSize:15*this.dpr,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(.5),this.closeBtn=this.scene.make.image({x:.5*i-5*this.dpr,y:o+5*this.dpr,key:a.c.commonKey,frame:"close"}),this.tilteName.setStroke("#905C06",2),this.tilteName.setResolution(this.dpr),this.closeBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.closeBtn.setInteractive(),this.timesPorgress=new m(this.scene,76*this.dpr,14*this.dpr,this.key,"slider_orange",h.i18n.t("work.worktimes"),this.dpr),this.timesPorgress.setImageValue(this.key,"icon_work"),this.timesPorgress.y=.5*-n+40*this.dpr,this.timesPorgress.x=-43*this.dpr,this.powerProgress=new m(this.scene,76*this.dpr,14*this.dpr,this.key,"slider_blue",h.i18n.t("work.vim"),this.dpr),this.powerProgress.setImageValue(this.key,"icon_strength"),this.powerProgress.y=this.timesPorgress.y,this.powerProgress.x=70*this.dpr,this.helpBtn=new s.Button(this.scene,this.key,"icon_tips","icon_tips"),this.helpBtn.y=this.powerProgress.y,this.helpBtn.x=this.powerProgress.x+.5*this.powerProgress.width+5*this.dpr+.5*this.helpBtn.width,this.helpBtn.on(s.ClickEvent.Tap,this.onHelpHandler,this),this.mGameScroll=new s.GameScroller(this.scene,{x:0,y:18*this.dpr,width:i,height:n-70*this.dpr,zoom:this.scale,dpr:this.dpr,align:2,orientation:0,space:10*this.dpr,selfevent:!0,cellupCallBack:function(t){e.onPointerUpHandler(t)}}),this.itemtips=new r.ItemInfoTips(this.scene,150*this.dpr,46*this.dpr,a.c.common2Key,"tips_bg",this.dpr),this.itemtips.setVisible(!1),this.content.add([this.bg,this.closeBtn,this.titlebg,this.tilteName,this.timesPorgress,this.powerProgress,this.helpBtn,this.mGameScroll,this.itemtips]),this.resize(),t.prototype.init.call(this),this.emit("questlist")},PicaWorkPanel.prototype.setWorkDataList=function(t){var e=t.jobs;this.mGameScroll.clearItems(!1);for(var i=0,n=this.workItems;i<n.length;i++){(r=n[i]).visible=!1}for(var s=0;s<e.length;s++){var r=void 0;s<this.workItems.length?r=this.workItems[s]:(r=new p(this.scene,this.key,this.dpr),this.workItems.push(r),r.setHandler(new h.Handler(this,this.onSendHandler),new h.Handler(this,this.onItemInfoTips))),r.visible=!0,r.setJobData(e[s]),this.mGameScroll.addItem(r)}this.mGameScroll.Sort()},PicaWorkPanel.prototype.setProgressData=function(t,e){e&&this.timesPorgress.setProgressDatas(e),t&&this.powerProgress.setProgressDatas(t)},PicaWorkPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaWorkPanel.prototype.onHelpHandler=function(){this.itemtips.setVisible(!this.itemtips.visible),this.itemtips.setText(h.i18n.t("work.worktips")),this.itemtips.setTipsPosition(this.helpBtn,this.content)},PicaWorkPanel.prototype.OnClosePanel=function(){this.emit("hide")},PicaWorkPanel.prototype.onPointerUpHandler=function(t){this.selectItem&&this.selectItem.setExtend(!1),t.setExtend(!0),this.selectItem=t,this.mGameScroll.Sort(!0)},PicaWorkPanel.prototype.onSendHandler=function(t){this.emit("questwork",t)},PicaWorkPanel.prototype.onItemInfoTips=function(t,e,i){this.itemtips.visible=e,this.itemtips.x=i.x*this.scale-this.content.x,this.itemtips.y=i.y*this.scale-this.content.y-30*this.dpr,this.itemtips.setText(this.getDesText(t))},PicaWorkPanel.prototype.getDesText=function(t){return t||(t={sellingPrice:!0,tradable:!1}),h.i18n.t("work.attri",{name:""+t.name,value:t.neededCount})},PicaWorkPanel}(r.BasePanel),p=function(t){function WorkItem(e,i,n){var o=t.call(this,e)||this;o.imageValues=[],o.isExtend=!1,o.pointTimestamp=0,o.key=i,o.dpr=n;var l=256*n,c=68*n;o.setSize(l,c),o.topCon=e.make.container(void 0,!1),o.add(o.topCon),o.topCon.setSize(l,c),o.bg=new s.NineSlicePatch(o.scene,0,0,l,c,o.key,"bg_default",{left:6*o.dpr,top:0*o.dpr,bottom:0*o.dpr,right:6*n}),o.headIcon=new r.DynamicImage(e,0,0),o.title=e.make.text({x:.5*-o.width+60*n,y:.5*-c+5*n,text:"",style:{color:"#ffffff",fontSize:13*n,fontFamily:h.Font.DEFULT_FONT}}),o.salaryvalue=new r.ImageValue(e,60*n,20*n,o.key,void 0,o.dpr),o.salaryvalue.setTextStyle({color:"#FFEA00"}),o.salaryvalue.setFrameValue("",a.c.commonKey,"iv_coin"),o.salaryvalue.x=.5*o.width-30*n,o.salaryvalue.y=.5*-o.height+10*n,o.salaryLabel=e.make.text({x:o.salaryvalue.x-.5*o.salaryvalue.width-5*n,y:o.salaryvalue.y,text:h.i18n.t("work.salary")+":",style:{color:"#ffffff",fontSize:11*n,fontFamily:h.Font.DEFULT_FONT}}),o.salaryLabel.setOrigin(1,.5),o.worklabel=e.make.text({x:.5*-o.width+60*n,y:.5*o.height-12*n,text:"",style:{color:"#ffffff",fontSize:11*n,fontFamily:h.Font.DEFULT_FONT}}),o.worklabel.setOrigin(0,.5),o.topCon.add([o.bg,o.headIcon,o.title,o.salaryvalue,o.salaryLabel,o.worklabel]);var p=46*n;return o.bottomCon=e.make.container(void 0,!1),o.bottomCon.setSize(l,p),o.workbg=new s.NineSlicePatch(o.scene,0,0,o.width,p,o.key,"bg_a_unfold",{left:6*o.dpr,top:0*o.dpr,bottom:0*o.dpr,right:6*n}),o.workBtn=new s.NineSliceButton(e,0,0,90*n,36*n,a.c.commonKey,"yellow_btn_normal",h.i18n.t("work.title"),n,void 0,{left:14*o.dpr,top:14*o.dpr,bottom:14*o.dpr,right:14*n}),o.workBtn.x=0,o.workBtn.setTextStyle({fontSize:12*n,color:"#996600",fontFamily:h.Font.DEFULT_FONT}),o.workBtn.setFontStyle("bold"),o.bottomCon.add([o.workbg,o.workBtn]),o.workBtn.on(String(s.ClickEvent.Tap),o.onWorkHandler,o),o}return l(WorkItem,t),WorkItem.prototype.setHandler=function(t,e){this.sendHandler=t,this.tipsHandler=e},WorkItem.prototype.setJobData=function(t){var e=this;this.jobData=t;var i=h.Url.getOsdRes(t.display.texturePath);this.headIcon.load(i,this,(function(){e.headIcon.scale=1,e.headIcon.scaleX=45*e.dpr/e.headIcon.displayHeight,e.headIcon.scaleY=e.headIcon.scaleX,e.headIcon.x=.5*-e.width+.5*e.headIcon.displayWidth+10*e.dpr})),this.title.text=t.name;var n="0";if(t.rewards){var s=t.rewards[0].countRange;n=s.start+"~"+s.stop}this.salaryvalue.setText(n),this.salaryvalue.x=.5*this.width-.5*this.salaryvalue.width-10*this.dpr,this.salaryLabel.x=this.salaryvalue.x-.5*this.salaryvalue.width-5*this.dpr,this.worklabel.text=t.detail;for(var r=t.targets,o=0,a=this.imageValues;o<a.length;o++){(p=a[o]).visible=!1}for(var l=.5*-this.width+55*this.dpr,c=0;c<r.length;c++){var p=void 0,m=r[c];c<this.imageValues.length?p=this.imageValues[c]:(p=new d(this.scene,35*this.dpr,15*this.dpr,this.key,this.dpr),this.topCon.add(p),this.imageValues.push(p),p.setHandler(new h.Handler(this,this.onTipsandler)));var u=h.Url.getOsdRes(m.display.texturePath);p.setUrlValue(u,m.neededCount),p.setTextStyle({color:m.count>=m.neededCount?"#000000":"#E71313"}),p.setImageData(m),p.visible=!0,p.x=l+.5*p.width,p.y=0,l+=p.width+20*this.dpr}},WorkItem.prototype.setExtend=function(t){if(this.isExtend!==t)if(this.isExtend=t,this.bottomCon.visible=t,t){this.add(this.bottomCon);var e=this.topCon.height+this.bottomCon.height;this.setSize(this.width,e),this.topCon.y=.5*-e+.5*this.topCon.height,this.bottomCon.y=this.topCon.y+.5*this.topCon.height+.5*this.bottomCon.height,this.bg.setFrame("bg_click")}else{this.remove(this.bottomCon);e=this.topCon.height;this.setSize(this.width,e),this.topCon.y=0,this.bg.setFrame("bg_default")}},WorkItem.prototype.destroy=function(e){t.prototype.destroy.call(this,e)},WorkItem.prototype.onWorkHandler=function(){var t=(new Date).getTime();this.pointTimestamp>t||(this.pointTimestamp=t+1e3,this.sendHandler&&this.sendHandler.runWith(this.jobData.id))},WorkItem.prototype.onTipsandler=function(t,e){var i=t.getWorldTransformMatrix();this.tipsHandler&&this.tipsHandler.runWith([t.imageData,e,new Phaser.Geom.Point(i.tx,i.ty)])},WorkItem}(Phaser.GameObjects.Container),d=function(t){function PointerImageValue(e,i,n,s,r){var o=t.call(this,e,i,n,s,void 0,r)||this;return o.addListen(),o}return l(PointerImageValue,t),PointerImageValue.prototype.setImageData=function(t){this.imageData=t},PointerImageValue.prototype.setUrlValue=function(t,e){var i=this;this.value.text=e,this.icon.load(t,this,(function(){i.icon.scale=1,i.icon.scaleY=14*i.dpr/i.icon.displayHeight,i.icon.scaleX=i.icon.scaleY,i.value.x=i.icon.x+.5*i.icon.displayWidth+10*i.dpr,i.resetSize()}))},PointerImageValue.prototype.addListen=function(){this.setInteractive(),this.on("pointerdown",this.onClickDownHandler,this),this.scene.input.on("pointerup",this.onClickUpHandler,this)},PointerImageValue.prototype.removeListen=function(){this.disableInteractive(),this.off("pointerdown",this.onClickDownHandler,this),this.scene.input.off("pointerup",this.onClickUpHandler,this)},PointerImageValue.prototype.destroy=function(e){this.removeListen(),t.prototype.destroy.call(this,e)},PointerImageValue.prototype.setHandler=function(t){this.tipsHandler=t},PointerImageValue.prototype.create=function(){this.icon=new r.DynamicImage(this.scene,0,0),this.value=this.scene.make.text({x:0,y:this.offset.y,text:"10",style:{color:"#ffffff",fontSize:11*this.dpr,fontFamily:h.Font.DEFULT_FONT}}),this.value.setOrigin(0,.5),this.add([this.icon,this.value])},PointerImageValue.prototype.onClickDownHandler=function(){new Phaser.Geom.Point;this.tipsHandler&&this.tipsHandler.runWith([this,!0])},PointerImageValue.prototype.onClickUpHandler=function(){this.tipsHandler&&this.tipsHandler.runWith([this,!1])},PointerImageValue}(r.ImageValue),m=function(t){function ProgressItem(e,i,n,o,a,l,c){var p=t.call(this,e)||this;p.setSize(i,n),p.dpr=c,p.key=o;var d={x:0,y:0,width:i,height:n,background:{x:0,y:0,width:i,height:n,config:{top:0*c,left:7*c,right:7*c,bottom:0*c},key:o,frame:"slider_bottom"},bar:{x:0,y:0,width:i-4*c,height:n-4*c,config:{top:0*c,left:7*c,right:7*c,bottom:0*c},key:o,frame:a},dpr:c,textConfig:void 0};return p.progress=new s.ProgressBar(e,d),p.add(p.progress),p.imgvalue=new r.ImageValue(e,p.width-20*c,p.height,o,void 0,c),p.imgvalue.y=c,p.add(p.imgvalue),p.imgvalue.setTextStyle({fontSize:10*c,fontFamily:h.Font.NUMBER}),p.imgvalue.setTextFilter(Phaser.Textures.FilterMode.LINEAR),p.title=e.make.text({x:.5*-p.progress.width-3*c,y:0,text:l,style:{color:"#6A7AFF",fontSize:9*c,fontFamily:h.Font.DEFULT_FONT}}),p.title.setOrigin(1,.5),p.add(p.title),p}return l(ProgressItem,t),ProgressItem.prototype.setImageValue=function(t,e){this.imgvalue.setFrameValue("",t,e)},ProgressItem.prototype.setProgressDatas=function(t){this.progress.setProgress(t.value,t.max),this.imgvalue.setText(t.value+"/"+t.max)},ProgressItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"TaskPanel",(function(){return p}));var n,s=i(2),r=i(5),o=i(470),a=i(1),h=i(11),l=i(0),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function TaskPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.taskItems=[],i.key=a.ModuleName.PICATASK_NAME,i}return c(TaskPanel,t),TaskPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,n,s),this.setSize(n,s),this.blackBg.clear(),this.blackBg.fillStyle(0,.5),this.blackBg.fillRoundedRect(-this.x,-this.y,n,s),this.content.x=.5*n,this.content.y=.5*s,this.mGameScroll.refreshMask(),this.blackBg.setInteractive(new Phaser.Geom.Rectangle(0,0,n,s),Phaser.Geom.Rectangle.Contains)},TaskPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},TaskPanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.OnClosePanel,this)},TaskPanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.OnClosePanel,this)},TaskPanel.prototype.preload=function(){this.addAtlas(this.key,"task/task.png","task/task.json"),this.addAtlas(h.c.commonKey,h.d.commonUrl+".png",h.d.commonUrl+".json"),t.prototype.preload.call(this)},TaskPanel.prototype.init=function(){this.setSize(this.scaleWidth,this.scaleWidth),this.blackBg=this.scene.make.graphics(void 0,!1),this.add(this.blackBg);var e=300*this.dpr,i=418*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.add(this.content),this.bg=new r.NineSlicePatch(this.scene,0,0,e,i,h.c.commonKey,"bg",{left:40,top:40,bottom:50,right:50});var n=this.bg.width,s=this.bg.height,o=.5*-this.bg.height;this.titlebg=this.scene.make.image({x:0,y:o,key:this.key,frame:"title"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titlebg.y=o-.5*this.titlebg.height+20*this.dpr;var c="bold "+15*this.dpr+"px Source Han Sans";this.tilteName=this.scene.make.text({x:0,y:o-12*this.dpr,text:l.i18n.t("task.title"),style:{font:c,color:"#8F4300",fontSize:15*this.dpr,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(.5,0),this.closeBtn=this.scene.make.image({x:.5*this.bg.width-5*this.dpr,y:o+5*this.dpr,key:h.c.commonKey,frame:"close"}),this.tilteName.setStroke("#8F4300",1),this.tilteName.setResolution(this.dpr),this.closeBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.closeBtn.setInteractive();var p=this.scene.make.container(void 0,!1);p.setSize(80*this.dpr,30*this.dpr),p.setPosition(.5*-n+70*this.dpr,.5*-s+30*this.dpr),p.setInteractive(),p.on("pointerup",this.onOpenOptionHandler,this),this.optionText=this.scene.make.text({x:-30*this.dpr,y:0,text:l.i18n.t("task.all_task"),style:{color:"#8F4300",fontSize:16*this.dpr,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(0,.5),this.optionArrow=this.scene.make.image({x:0,y:0,key:this.key,frame:"drop_down"}),this.optionArrow.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.optionArrow.x=this.optionText.x+this.optionText.width+10*this.dpr,p.add([this.optionText,this.optionArrow]);var d=253*this.dpr,m=this.scene.make.graphics(void 0,!1);m.clear(),m.fillStyle(12632256,1),m.fillRect(.5*-d,-1,d,2),m.y=.5*-s+50*this.dpr,this.optionCon=this.scene.make.container(void 0,!1),this.optionCon.visible=!1,this.optionCon.y=.5*-s+50*this.dpr,this.mGameScroll=new r.GameScroller(this.scene,{x:0,y:18*this.dpr,width:n,height:s-70*this.dpr,zoom:this.scale,dpr:this.dpr,align:2,orientation:0,space:20*this.dpr,padding:{top:2*this.dpr}}),this.content.add([this.bg,this.closeBtn,this.titlebg,this.tilteName,this.mGameScroll,p,m,this.optionCon]),this.resize(),t.prototype.init.call(this),this.render.renderEmitter(a.ModuleName.PICATASK_NAME+"_questlist")},TaskPanel.prototype.setTaskDatas=function(t){this.mInitialized&&(this.curTaskItem&&this.curTaskItem.setExtend(!1),this.taskDatas=t,this.setTaskOptions(),this.setTaskItems(t),this.onTaskOptionHandler(this.curOptionItem))},TaskPanel.prototype.setTaskOptions=function(){for(var t=[0,s.op_pkt_def.PKT_Quest_Type.QUEST_MAIN_MISSION,s.op_pkt_def.PKT_Quest_Type.QUEST_SIDE_MISSION,s.op_pkt_def.PKT_Quest_Type.QUEST_DAILY_GOAL],e=this.optionCon.list,i=0,n=e;i<n.length;i++){(o=n[i]).visible=!1}for(var r=0;r<t.length;r++){var o=void 0;r<e.length?o=e[r]:((o=new y(this.scene,this.key,this.dpr)).setHandler(new l.Handler(this,this.onTaskOptionHandler)),this.optionCon.add(o)),o.visible=!0,o.setOptionData(t[r])}for(var a=0,h=0,c=e;h<c.length;h++){var p=c[h];p.y=p.height*p.originY+a,a+=p.height+2}this.curOptionItem||(this.curOptionItem=e[0])},TaskPanel.prototype.setTaskDetail=function(t){this.curTaskItem&&t&&this.curTaskItem.questData.id===t.id&&this.curTaskItem.setTaskDetail(t)},TaskPanel.prototype.setTaskItems=function(t){for(var e=0,i=this.taskItems;e<i.length;e++){(s=i[e]).visible=!1}for(var n=0;n<t.length;n++){var s=void 0;n<this.taskItems.length?s=this.taskItems[n]:(s=new d(this.scene,this.key,this.dpr),this.mGameScroll.addItem(s),s.setHandler(new l.Handler(this,this.onExtendsHandler),new l.Handler(this,this.onFinishHandler)),this.taskItems.push(s)),s.setTaskData(t[n]),s.visible=!0}this.mGameScroll.Sort()},TaskPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},TaskPanel.prototype.OnClosePanel=function(){this.render.renderEmitter(a.ModuleName.PICATASK_NAME+"_hide")},TaskPanel.prototype.onFinishHandler=function(t){this.render.renderEmitter(a.ModuleName.PICATASK_NAME+"_submitquest",t)},TaskPanel.prototype.onExtendsHandler=function(t,e){this.curTaskItem&&this.curTaskItem.setExtend(!1,!1),this.curTaskItem=e,t?this.render.renderEmitter(a.ModuleName.PICATASK_NAME+"_questdetail",e.questData.id):this.curTaskItem=null,this.mGameScroll.Sort(!0)},TaskPanel.prototype.onOpenOptionHandler=function(){var t=this.optionCon.visible;this.optionCon.visible=!t,this.optionArrow.scaleY=t?-1:1},TaskPanel.prototype.onTaskOptionHandler=function(t){for(var e=0,i=this.optionCon.list;e<i.length;e++){i[e].changeNormal()}var n;n=0===t.optionData?this.taskDatas:this.taskDatas.filter((function(e){return e.questType===t.optionData})),this.setTaskItems(n),this.optionCon.visible=!1,this.curOptionItem=t,t.changeDown(),this.optionText.text=t.optionText,this.optionArrow.x=this.optionText.x+this.optionText.width+10*this.dpr},TaskPanel}(o.BasePanel),d=function(t){function TaskItem(e,i,n){var s=t.call(this,e)||this;s.key=i,s.dpr=n;var a=254*n,h=45*n;s.content=e.make.container(void 0,!1),s.content.setSize(a,h),s.bg=new r.NineSlicePatch(s.scene,0,0,a,h,i,"main_bg",{left:6*n,top:6*n,bottom:6*n,right:6*n});var c=.5*-a,p=.5*-h,d=e.make.image({key:i,frame:"head_border"});return d.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),d.x=c+25*n,s.headIcon=new o.DynamicImage(e,d.x,0),s.headIcon.setTexture(i,"head_test"),s.typeBg=e.make.image({key:i,frame:"tag_main"}),s.typeBg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),s.typeBg.setPosition(c+.5*s.typeBg.width,p+.5*s.typeBg.height-2*n),s.typeTex=e.make.text({x:0,y:0,text:l.i18n.t("task.m"),style:{color:"#ffffff",fontSize:10*s.dpr,fontFamily:l.Font.DEFULT_FONT}}),s.typeTex.setOrigin(.5).setPosition(s.typeBg.x-1*n,s.typeBg.y),s.taskName=e.make.text({x:s.headIcon.x+20*n,y:-9*n,text:"",style:{color:"#ffffff",fontSize:13*s.dpr,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(0,.5),s.taskDes=e.make.text({x:s.headIcon.x+25*n,y:10*n,text:"",style:{color:"#ffffff",fontSize:12*s.dpr,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(0,.5),s.finish=e.make.image({key:i,frame:"done"}),s.finish.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),s.finish.setPosition(.5*a-30*n,4*n),s.openBtn=new r.Button(e,i,"open","open"),s.setExtendBtn(s.openBtn),s.openBtn.setPosition(.5*a-25*n,4*n),s.closeBtn=new r.Button(e,i,"close"),s.setExtendBtn(s.closeBtn),s.closeBtn.setPosition(s.openBtn.x,s.openBtn.y).visible=!1,s.openBtn.on(r.ClickEvent.Tap,s.onOpenHandler,s),s.closeBtn.on(r.ClickEvent.Tap,s.onCloseHandler,s),s.content.add([s.bg,d,s.headIcon,s.typeBg,s.typeTex,s.taskName,s.taskDes,s.finish,s.openBtn,s.closeBtn]),s.add(s.content),s.setSize(a,h),s}return c(TaskItem,t),TaskItem.prototype.setTaskData=function(t){this.questData=t;var e=this.getQuestTypeTag(t.questType);this.typeBg.setFrame(e[0]),this.typeTex.text=e[1],this.setTextLimit(this.taskName,e[2]+t.name,12),this.bg.setFrame(e[3]),this.setTextLimit(this.taskDes,t.detail),this.taskDes.setColor(e[4]),this.finish.visible=t.stage===s.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_FINISHED},TaskItem.prototype.setTaskDetail=function(t){var e=this.getQuestTypeTag(t.questType);this.extend&&this.extend.setItemData(t,e[5])},TaskItem.prototype.setHandler=function(t,e){this.extendHandler=t,this.finishHandler=e},TaskItem.prototype.setExtend=function(t,e){void 0===e&&(e=!0),t?e?this.onOpenHandler():this.openExtend():e?this.onCloseHandler():this.closeExtend()},TaskItem.prototype.onOpenHandler=function(){this.openExtend(),this.extendHandler&&this.extendHandler.runWith([!0,this])},TaskItem.prototype.openExtend=function(){this.extend||(this.extend=new m(this.scene,this.key,this.dpr),this.extend.setFinishHandler(new l.Handler(this,this.onFinishHandler)),this.add(this.extend),this.extend.y=.5*this.height+.5*this.extend.height),this.extend.visible=!0,this.height=this.content.height+this.extend.height,this.content.y=.5*-this.height+.5*this.content.height,this.extend.y=.5*-this.height+this.content.height+.5*this.extend.height,this.openBtn.visible=!1,this.closeBtn.visible=!0},TaskItem.prototype.setExtendBtn=function(t){var e=60*this.dpr,i=60*this.dpr,n=this.scene.make.graphics(void 0,!1);n.clear(),n.fillStyle(16185078,0),n.fillRect(.5*-e,.5*-i,e,i),t.addAt(n,0),t.setInteractive(new Phaser.Geom.Rectangle(0,0,e,i),Phaser.Geom.Rectangle.Contains)},TaskItem.prototype.onFinishHandler=function(){this.finishHandler&&this.finishHandler.runWith(this.questData.id)},TaskItem.prototype.onCloseHandler=function(){this.closeExtend(),this.extendHandler&&this.extendHandler.runWith([!1,this])},TaskItem.prototype.closeExtend=function(){this.extend&&(this.extend.visible=!1),this.height=this.content.height,this.content.y=0,this.openBtn.visible=!0,this.closeBtn.visible=!1},TaskItem.prototype.getQuestTypeTag=function(t){var e=[];return t===s.op_pkt_def.PKT_Quest_Type.QUEST_MAIN_MISSION?(e[0]="tag_main",e[1]=l.i18n.t("task.m"),e[2]=""+l.i18n.t("task.main"),e[3]="main_bg",e[4]="#4C42C8",e[5]="#8780E0",e):t===s.op_pkt_def.PKT_Quest_Type.QUEST_SIDE_MISSION?(e[0]="tag_side",e[1]=l.i18n.t("task.s"),e[2]=l.i18n.t("task.side"),e[3]="side_bg",e[4]="#CB0A1D",e[5]="#F4919B",e):t===s.op_pkt_def.PKT_Quest_Type.QUEST_DAILY_GOAL?(e[0]="tag_daly",e[1]=l.i18n.t("task.d"),e[2]=l.i18n.t("task.daily"),e[3]="daly_bg",e[4]="#866107",e[5]="#F1D56C",e):void 0},TaskItem.prototype.setTextLimit=function(t,e,i){if(void 0===i&&(i=15),e.length>i)for(var n=155*this.dpr,s=4;s<e.length;s++){var r=e.slice(0,s);if(t.setText(r).width>n){r+="...",t.setText(r);break}}else t.setText(e)},TaskItem}(Phaser.GameObjects.Container),m=function(t){function TaskItemExtend(e,i,n){var s=t.call(this,e)||this;s.needArr=[],s.rewardArr=[],s.dpr=0;var o=253*n,a=202*n;s.dpr=n;var c=new r.NineSlicePatch(s.scene,0,0,o,a,i,"detail_bg",{left:4,top:4,right:4,bottom:4}),p=.5*-o+10*n,d=.5*-a+5*n;s.taskLabel=e.make.text({x:p,y:d,text:l.i18n.t("task.objective"),style:{color:"#8F4300",fontSize:12*s.dpr,fontFamily:l.Font.DEFULT_FONT}}),s.taskTex=e.make.text({x:p,y:d+18*n,text:l.i18n.t("task.collect_materials"),style:{color:"#8F4300",fontSize:12*s.dpr,fontFamily:l.Font.DEFULT_FONT}}),s.taskTex.setWordWrapWidth(o-10*n,!0),s.rewardLabel=e.make.text({x:p,y:d+90*n,text:l.i18n.t("task.rewards"),style:{color:"#8F4300",fontSize:12*s.dpr,fontFamily:l.Font.DEFULT_FONT}});var m=e.make.image({key:i,frame:"reward_cutline"});return m.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),m.setPosition(0,d+110*n),s.line=m,s.finishBtn=new r.NineSliceButton(s.scene,Math.ceil(.5*o-40*s.dpr),Math.ceil(.5*a-25*s.dpr),60*s.dpr,30*s.dpr,h.c.commonKey,"button_g",l.i18n.t("task.submit_task"),s.dpr,s.scale,{left:12*s.dpr,top:12*s.dpr,right:12*s.dpr,bottom:12*s.dpr}),s.finishBtn.setTextStyle({fontSize:12*n,color:"#000000"}),s.finishBtn.on(r.ClickEvent.Tap,s.onFinishHandler,s),s.add([c,s.taskLabel,s.taskTex,s.rewardLabel,m,s.finishBtn]),s.setSize(o,a),s.key=i,s.finishBtn.visible=!1,s}return c(TaskItemExtend,t),TaskItemExtend.prototype.setItemData=function(t,e){this.taskLabel.setColor(e),this.taskTex.setColor(e),this.rewardLabel.setColor(e);var i=0,n=33*this.dpr;this.taskTex.text=this.getTaskTargetText(t),this.createTaskCells(this.needArr,t.targets,!0),i=this.taskTex.y+this.taskTex.height+5*this.dpr,t.targets.length>0&&(i+=.5*n,this.sortItem(this.needArr,i),i+=.5*n+8*this.dpr),this.rewardLabel.y=i,i+=this.rewardLabel.height+5*this.dpr,this.line.y=i,i+=5*this.dpr,this.createTaskCells(this.rewardArr,t.rewards,!1),i+=.5*n,this.sortItem(this.rewardArr,i),this.finishBtn.visible=t.stage===s.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_FINISHED},TaskItemExtend.prototype.setFinishHandler=function(t){this.finishHandler=t},TaskItemExtend.prototype.sortItem=function(t,e){void 0===e&&(e=0);for(var i=.5*-this.width+10*this.dpr,n=t,s=0,r=10*this.dpr,o=0,a=n;o<a.length;o++){var h=a[o];h.x=i+h.width*h.originX+s,h.y=e,s+=h.width+r}},TaskItemExtend.prototype.createTaskCells=function(t,e,i){void 0===i&&(i=!0);for(var n=0,s=t;n<s.length;n++){(o=s[n]).visible=!1}for(var r=0;r<e.length;r++){var o=void 0;r<t.length?o=t[r]:(o=new u(this.scene,this.key,this.dpr),t.push(o),this.add(o)),o.visible=!0,o.setCellData(e[r],i)}return t},TaskItemExtend.prototype.onFinishHandler=function(){this.finishHandler&&this.finishHandler.run()},TaskItemExtend.prototype.getTaskTargetText=function(t){t.targets;return t.detail},TaskItemExtend}(Phaser.GameObjects.Container),u=function(t){function TaskCell(e,i,n){var s=t.call(this,e)||this;return s.key=i,s.dpr=n,s.bg=e.make.image({key:i,frame:"task_bg"}),s.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),s.setSize(s.bg.width,s.bg.height),s.itemIcon=new o.DynamicImage(e,0,0),s.countTex=new r.BBCodeText(s.scene,0,0).setOrigin(.5).setFontSize(12*n).setFontFamily(l.Font.DEFULT_FONT),s.countTex.setPosition(.5*s.width,.5*s.height-2*n),s.add([s.bg,s.itemIcon,s.countTex]),s}return c(TaskCell,t),TaskCell.prototype.setCellData=function(t,e){var i=this;void 0===e&&(e=!0);var n=e?"task_bg":"reward_bg";this.bg.setTexture(this.key,n);var s=l.Url.getOsdRes(t.display.texturePath);this.itemIcon.load(s,this,(function(){i.itemIcon.scale=.6*i.dpr})),this.countTex.text=e?this.getCountText(t.count,t.neededCount):"[stroke=#666666][color=#666666]"+t.count+"[/color][/stroke]"},TaskCell.prototype.getCountText=function(t,e){var i=t>=e?"#0054FF":"#FF2B2B";return"[stroke="+i+"][color="+i+"]"+t+"[/color][/stroke]"+"/"+("[stroke=#2D2D2D][color=#2D2D2D]"+e+"[/color][/stroke]")},TaskCell}(Phaser.GameObjects.Container),y=function(t){function TaskOption(e,i,n){var s=t.call(this,e)||this;s.dpr=0;var r=256*n,o=30*n;s.dpr=n,s.bg=e.make.graphics(void 0,!1),s.text=e.make.text({x:0,y:0,text:"全部",style:{color:"#666666",fontSize:15*n,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(0,.5),s.bg.clear(),s.bg.fillStyle(16185078,1),s.bg.fillRect(.5*-r,.5*-o,r,o);var a=s.scene.make.graphics(void 0,!1);return a.clear(),a.fillStyle(13421772,1),a.fillRect(.5*-r,.5*o,r,2),s.add([s.bg,s.text,a]),s.setSize(r,o),s.bg.setInteractive(new Phaser.Geom.Rectangle(.5*-r,.5*-o,r,o),Phaser.Geom.Rectangle.Contains),s.bg.on("pointerup",s.onClickHandler,s),s}return c(TaskOption,t),TaskOption.prototype.setSize=function(e,i){return t.prototype.setSize.call(this,e,i),this.text.setPosition(.5*-e+20*this.dpr,0),this.changeNormal(),this},TaskOption.prototype.setOptionData=function(t){this.optionData=t,t===s.op_pkt_def.PKT_Quest_Type.QUEST_MAIN_MISSION?this.text.text=l.i18n.t("task.main_quest"):t===s.op_pkt_def.PKT_Quest_Type.QUEST_SIDE_MISSION?this.text.text=l.i18n.t("task.side_quest"):t===s.op_pkt_def.PKT_Quest_Type.QUEST_DAILY_GOAL?this.text.text=l.i18n.t("task.daily_quest"):this.text.text=l.i18n.t("task.all_task"),this.optionText=this.text.text},TaskOption.prototype.changeDown=function(){this.bg.clear(),this.bg.fillStyle(14673663,1),this.bg.fillRect(.5*-this.width,.5*-this.height,this.width,this.height)},TaskOption.prototype.changeNormal=function(){this.bg.clear(),this.bg.fillStyle(16185078,1),this.bg.fillRect(.5*-this.width,.5*-this.height,this.width,this.height)},TaskOption.prototype.setHandler=function(t){this.clickHandler=t},TaskOption.prototype.onClickHandler=function(){this.clickHandler&&this.clickHandler.runWith(this)},TaskOption}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return y}));var n,s=i(0),r=i(532),o=i(474),a=i(534),h=i(1),l=i(324),c=function(){function MatterBodies(t){this.render=t;var e=this.render.sceneManager.getSceneByName(o.a.name);e?(this.mGraphics=e.make.graphics(void 0,!1),e.layerManager.addToLayer("middleLayer",this.mGraphics)):s.Logger.getInstance().error("no matter scene")}return MatterBodies.prototype.update=function(){this.mGraphics&&this.mGraphics.clear()},MatterBodies.prototype.renderWireframes=function(t){var e=this.mGraphics;if(e&&(e.clear(),t)){e.lineStyle(1,16711680),e.beginPath();for(var i=this.render.scaleRatio,n=0,s=t;n<s.length;n++){var r=s[n];e.moveTo(r[0].x/i,r[0].y/i);for(var o=1;o<r.length;o++)e.lineTo(r[o].x/i,r[o].y/i);e.lineTo(r[0].x/i,r[0].y/i)}e.strokePath()}},MatterBodies.prototype.destroy=function(){this.mGraphics&&this.mGraphics.destroy()},MatterBodies}(),p=function(){function ServerPosition(t){var e=t.sceneManager.getSceneByName(o.a.name);this.dpr=t.scaleRatio,this.mGridhics=e.make.graphics(void 0,!1),e.layerManager.addToLayer("middleLayer",this.mGridhics)}return ServerPosition.prototype.draw=function(t,e){this.mGridhics.clear(),this.mGridhics.fillStyle(65280,1),this.mGridhics.fillCircle(t,e,2*this.dpr)},ServerPosition.prototype.destroy=function(){this.mGridhics&&this.mGridhics.destroy()},ServerPosition}(),d=i(475),m=i(609),u=i(608);!function(t){t[t.UnknownNodeType=0]="UnknownNodeType",t[t.GameNodeType=1]="GameNodeType",t[t.SceneNodeType=2]="SceneNodeType",t[t.ElementNodeType=3]="ElementNodeType",t[t.TerrainNodeType=4]="TerrainNodeType",t[t.CharacterNodeType=5]="CharacterNodeType",t[t.LocationType=6]="LocationType",t[t.MovableType=7]="MovableType",t[t.DisplayType=8]="DisplayType",t[t.AttributeType=9]="AttributeType",t[t.FunctionType=10]="FunctionType",t[t.AnimationsType=11]="AnimationsType",t[t.EventType=12]="EventType",t[t.MapSizeType=13]="MapSizeType",t[t.UIType=14]="UIType",t[t.TimerType=15]="TimerType",t[t.PackageType=16]="PackageType",t[t.PackageItemType=17]="PackageItemType",t[t.AvatarType=18]="AvatarType",t[t.SettingsType=19]="SettingsType",t[t.CampType=20]="CampType",t[t.MutexType=21]="MutexType",t[t.AnimationDataType=22]="AnimationDataType",t[t.ForkType=23]="ForkType",t[t.ButtonType=24]="ButtonType",t[t.TextType=25]="TextType",t[t.AccessType=26]="AccessType",t[t.SpawnPointType=27]="SpawnPointType",t[t.CommodityType=28]="CommodityType",t[t.ShopType=29]="ShopType",t[t.PaletteType=30]="PaletteType",t[t.TerrainCollectionType=31]="TerrainCollectionType",t[t.AssetsType=32]="AssetsType",t[t.MossType=33]="MossType",t[t.MossCollectionType=34]="MossCollectionType",t[t.SceneryType=35]="SceneryType",t[t.ModsType=36]="ModsType",t[t.InputTextType=37]="InputTextType"}(n||(n={}));var y=function(){function DisplayManager(t){this.render=t,this.loading=!1,this.uuid=0,this.sceneManager=t.sceneManager,this.displays=new Map,this.scenerys=new Map,this.preLoadList=[]}return Object.defineProperty(DisplayManager.prototype,"user",{get:function(){return this.mUser},enumerable:!1,configurable:!0}),DisplayManager.prototype.update=function(t,e){this.preLoadList&&this.preLoadList.length>0&&!this.loading&&(this.loading=!0,this.loadProgress())},DisplayManager.prototype.resize=function(t,e){this.scenerys.forEach((function(i){i.resize(t,e)}))},DisplayManager.prototype.updateModel=function(t,e){if(this.sceneManager.getMainScene()){var i=this.displays.get(t);i&&(i.load(e),this.render.mainPeer.elementDisplaySyncReady(t))}else s.Logger.getInstance().fatal("scene does not exist")},DisplayManager.prototype.addDragonbonesDisplay=function(t,e,i){if(e){var r,o=this.sceneManager.getMainScene();if(o)this.displays.has(t)?r=this.displays.get(t):(r=new a.a(o,this.render,t,this.uuid++,n.CharacterNodeType),this.displays.set(t,r),this.preLoadList.push(r)),r.load(e),o.layerManager.addToLayer(i.toString(),r);else s.Logger.getInstance().fatal("scene does not exist")}},DisplayManager.prototype.addUserDragonbonesDisplay=function(t,e,i){if(void 0===e&&(e=!1),t){var r,o=this.sceneManager.getMainScene();if(o)return this.displays.has(t.id)?r=this.displays.get(t.id):(r=new a.a(o,this.render,t.id,this.uuid++,n.CharacterNodeType),this.displays.set(t.id,r)),r.load(t),r.startLoad(),o.layerManager.addToLayer(i.toString(),r),e&&(this.mUser=r),r;s.Logger.getInstance().fatal("scene does not exist")}},DisplayManager.prototype.addTerrainDisplay=function(t,e,i){if(e){var o,a=this.sceneManager.getMainScene();if(a)return this.displays.has(t)?o=this.displays.get(t):(o=new r.a(a,this.render,t,n.TerrainNodeType),this.displays.set(t,o)),o.load(e),a.layerManager.addToLayer(i.toString(),o),o;s.Logger.getInstance().fatal("scene does not exist")}},DisplayManager.prototype.addFramesDisplay=function(t,e,i,o){if(e){var a,h=this.sceneManager.getMainScene();if(h)return this.displays.has(t)?a=this.displays.get(t):(57255261===t&&s.Logger.getInstance().debug("no load obj render",e),a=new r.a(h,this.render,t,n.ElementNodeType),this.displays.set(t,a)),a.load(e,o),h.layerManager.addToLayer(i.toString(),a),a;s.Logger.getInstance().fatal("scene does not exist")}else s.Logger.getInstance().debug("addFramesDisplay ====>",t)},DisplayManager.prototype.addToSurfaceLayer=function(t){var e=this.sceneManager.getMainScene();e?e.layerManager.addToLayer(o.a.LAYER_SURFACE,t):s.Logger.getInstance().fatal("scene does not exist")},DisplayManager.prototype.removeDisplay=function(t){this.displays.has(t)&&(this.displays.get(t).destroy(),this.displays.delete(t))},DisplayManager.prototype.addFillEffect=function(t,e,i){var n=this.render.sceneManager.getMainScene(),s=new d.b(n,this.render.scaleRatio);s.show(i),s.setPosition(t,e),n.layerManager.addToLayer("sceneUILayer",s)},DisplayManager.prototype.load=function(t,e,i){this.displays.has(t)?this.displays.get(t).load(e,i):s.Logger.getInstance().error("BaseDisplay not found: ",t)},DisplayManager.prototype.changeAlpha=function(t,e){this.displays.has(t)?this.displays.get(t).changeAlpha(e):s.Logger.getInstance().error("BaseDisplay not found: ",t)},DisplayManager.prototype.fadeIn=function(t){this.displays.has(t)?this.displays.get(t).fadeIn():s.Logger.getInstance().error("BaseDisplay not found: ",t)},DisplayManager.prototype.fadeOut=function(t){this.displays.has(t)?this.displays.get(t).fadeOut():s.Logger.getInstance().error("BaseDisplay not found: ",t)},DisplayManager.prototype.play=function(t,e,i,n){this.displays.has(t)?this.displays.get(t).play(e):s.Logger.getInstance().error("BaseDisplay not found: ",t)},DisplayManager.prototype.mount=function(t,e,i){var n=this.displays.get(t);if(n){var r=this.displays.get(e);r?(r.setRootMount(n),n.mount(r,i)):s.Logger.getInstance().error("BaseDisplay not found: ",e)}else s.Logger.getInstance().error("BaseDisplay not found: ",t)},DisplayManager.prototype.unmount=function(t,e){var i=this.displays.get(t);if(i){var n=this.displays.get(e);n?(n.setRootMount(null),i.unmount(n)):s.Logger.getInstance().error("BaseDisplay not found: ",e)}else s.Logger.getInstance().error("BaseDisplay not found: ",t)},DisplayManager.prototype.addEffect=function(t,e,i){var n=this.getDisplay(t),s=this.addFramesDisplay(e,i,h.DisplayField.Effect);n&&s&&s.once("initialized",(function(){n.addEffect(s)}))},DisplayManager.prototype.removeEffect=function(t){var e=this.displays.get(t);e?(e.removeEffect(),e.destroy()):s.Logger.getInstance().error("BaseDisplay not found: ",t)},DisplayManager.prototype.showEffect=function(t){if(this.displays.has(t))this.displays.get(t);else s.Logger.getInstance().error("BaseDisplay not found: ",t)},DisplayManager.prototype.setModel=function(t){var e=this.displays.get(t.id);e&&(t.pos||(t.pos=new s.LogicPos(0,0,0)),e.titleMask=t.titleMask,e.setPosition(t.pos.x,t.pos.y,t.pos.z),e.changeAlpha(t.alpha))},DisplayManager.prototype.addSkybox=function(t){var e=new l.a(t,this.render);this.scenerys.set(t.id,e)},DisplayManager.prototype.updateSkyboxState=function(t){this.scenerys.forEach((function(e){e.setState(t)}))},DisplayManager.prototype.removeSkybox=function(t){var e=this.scenerys.get(t);e&&(e.destroy(),this.scenerys.delete(t))},DisplayManager.prototype.getDisplay=function(t){return this.displays.get(t)},DisplayManager.prototype.displayDoMove=function(t,e){var i=this.getDisplay(t);i&&i.doMove(e)},DisplayManager.prototype.showNickname=function(t,e){var i=this.getDisplay(t);if(!i)return s.Logger.getInstance().debug("can't show nickname "+e);i.showNickname(e)},DisplayManager.prototype.showTopDisplay=function(t,e){var i=this.getDisplay(t);i&&i.showTopDisplay(e)},DisplayManager.prototype.showMatterDebug=function(t){this.matterBodies||(this.matterBodies=new c(this.render)),this.matterBodies.renderWireframes(t)},DisplayManager.prototype.hideMatterDebug=function(){this.matterBodies&&(this.matterBodies.destroy(),this.matterBodies=void 0)},DisplayManager.prototype.showGridsDebug=function(t){this.mGridsDebug||(this.mGridsDebug=new u.a(this.render)),this.mGridsDebug.setData(t)},DisplayManager.prototype.hideGridsDebug=function(){this.mGridsDebug&&(this.mGridsDebug.destroy(),this.mGridsDebug=null)},DisplayManager.prototype.showAstarDebug_init=function(t,e){this.mAstarDebug||(this.mAstarDebug=new m.a(this.render)),this.mAstarDebug.initData(t,e)},DisplayManager.prototype.showAstarDebug_update=function(t,e,i){this.mAstarDebug&&this.mAstarDebug.updateData(t,e,i)},DisplayManager.prototype.showAstarDebug_findPath=function(t,e,i){this.mAstarDebug&&this.mAstarDebug.showPath(t,e,i)},DisplayManager.prototype.hideAstarDebug=function(){this.mAstarDebug&&(this.mAstarDebug.destroy(),this.mAstarDebug=null)},DisplayManager.prototype.drawServerPosition=function(t,e){this.serverPosition||(this.serverPosition=new p(this.render)),this.serverPosition.draw(t,e)},DisplayManager.prototype.destroy=function(){this.loading=!1,this.preLoadList&&(this.preLoadList.length=0,this.preLoadList=[]),this.displays&&(this.displays.forEach((function(t){t&&t.destroy()})),this.displays.clear()),this.scenerys&&(this.scenerys.forEach((function(t){t&&t.destroy()})),this.scenerys.clear()),this.matterBodies&&(this.matterBodies.destroy(),this.matterBodies=null),this.serverPosition&&(this.serverPosition.destroy(),this.serverPosition=null),this.mAstarDebug&&(this.mAstarDebug.destroy(),this.mAstarDebug=null),this.mGridsDebug&&(this.mGridsDebug.destroy(),this.mGridsDebug=null)},DisplayManager.prototype.loadProgress=function(){var t=this,e=this.preLoadList.shift();e?e.startLoad().then((function(){t.loadProgress()})).catch((function(){t.loadProgress()})):this.loading=!1},DisplayManager}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return l}));var n,s,r,o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)});!function(t){t[t.IMAGE=0]="IMAGE",t[t.JSON=1]="JSON",t[t.ALTAS=2]="ALTAS",t[t.DRAGONBONES=3]="DRAGONBONES"}(s||(s={})),function(t){t[t.NONE=0]="NONE",t[t.PRELOAD=1]="PRELOAD",t[t.PROGRESS=2]="PROGRESS",t[t.COMPLETE=3]="COMPLETE",t[t.ERROR=4]="ERROR",t[t.RETRY=5]="RETRY"}(r||(r={}));var a=function(t){function LoadQueue(e){var i=t.call(this)||this;return i.scene=e,i.mQueue=[],i}return o(LoadQueue,t),LoadQueue.prototype.add=function(t){var e=this;t.forEach((function(t){if(t){var i=t.type,n=t.key,r=t.altasUrl,o=t.textureUrl,a=t.jsonUrl,h=t.boneUrl;switch(i){case s.ALTAS:e.scene.load.atlas(n,r);break;case s.IMAGE:e.scene.load.image(n,o);break;case s.JSON:e.scene.load.json(n,a);break;case s.DRAGONBONES:e.scene.load.dragonbone(n,o,a,h,null,null,{responseType:"arraybuffer"})}e.mQueue.push(t)}}))},LoadQueue.prototype.startLoad=function(){this.mQueue.forEach((function(t){t.state=r.PROGRESS})),this.addListen(),this.scene.load.start()},LoadQueue.prototype.destroy=function(){this.removeListen(),this.mQueue&&(this.mQueue=null),t.prototype.destroy.call(this)},LoadQueue.prototype.addListen=function(){this.removeListen(),this.scene.load.on(Phaser.Loader.Events.FILE_COMPLETE,this.fileComplete,this),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.totalComplete,this),this.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,this.fileLoadError,this)},LoadQueue.prototype.removeListen=function(){this.scene.load.off(Phaser.Loader.Events.FILE_COMPLETE,this.fileComplete,this),this.scene.load.off(Phaser.Loader.Events.COMPLETE,this.totalComplete,this),this.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,this.fileLoadError,this)},LoadQueue.prototype.totalComplete=function(){this.emit("QueueComplete"),this.clearQueue()},LoadQueue.prototype.fileComplete=function(t,e){this.emit("QueueProgress",this.scene.load.progress,t,e)},LoadQueue.prototype.fileLoadError=function(t){this.emit("QueueError",t.key)},LoadQueue.prototype.clearQueue=function(){this.removeListen(),this.mQueue&&(this.mQueue.length=0,this.mQueue=[])},LoadQueue}(Phaser.Events.EventEmitter),h=i(0),l=function(){function LoadingTips(){}return LoadingTips.enterWorld=function(){return h.i18n.t("loading.enter_game")},LoadingTips.loginGame=function(){return h.i18n.t("loading.logging")},LoadingTips.downloadGameConfig=function(){return h.i18n.t("loading.downloading_config")},LoadingTips.downloadSceneConfig=function(){return h.i18n.t("loading.downloading_scene_config")},LoadingTips.parseConfig=function(){return h.i18n.t("loading.parse_config")},LoadingTips.loadingResources=function(){return h.i18n.t("loading.loading_resources")},LoadingTips.createScene=function(){return h.i18n.t("loading.create_scene")},LoadingTips.waitEnterRoom=function(){return h.i18n.t("loading.wait_enter_room")},LoadingTips}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function Account(){}return Account.prototype.getAccountData=function(){return this.accountData},Account.prototype.setAccount=function(t){this.accountData={id:t.id,fingerprint:t.fingerprint,refreshToken:t.refreshToken,expire:t.expire,accessToken:t.token||t.accessToken},this.saveLocalStorage()},Account.prototype.refreshToken=function(t){if(this.accountData){var e=t.newExpire,i=t.newFingerprint,n=t.newToken;this.accountData.expire=e,this.accountData.fingerprint=i,this.accountData.accessToken=n,this.saveLocalStorage()}},Account.prototype.saveLocalStorage=function(){if(this.accountData){var t=this.accountData,e=t.id,i=t.fingerprint,n=t.refreshToken,s=t.expire,r=t.accessToken;localStorage.setItem("token",JSON.stringify({id:e,fingerprint:i,refreshToken:n,expire:s,accessToken:r}))}},Account.prototype.clear=function(){this.accountData={accessToken:"",expire:0,fingerprint:"",id:"",refreshToken:""}},Account.prototype.destroy=function(){this.clear(),localStorage.removeItem("token"),this.enterGame(void 0,void 0,void 0,void 0)},Account.prototype.enterGame=function(t,e,i,n){this.gameId=t,this.virtualWorldId=e,this.sceneID=i,this.loc=n},Object.defineProperty(Account.prototype,"gameID",{get:function(){return this.gameId},enumerable:!1,configurable:!0}),Object.defineProperty(Account.prototype,"sceneId",{get:function(){return this.sceneID},enumerable:!1,configurable:!0}),Account}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n,s=i(143),r=i(1),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function CreateRoleScene(){return t.call(this,{key:r.SceneName.CREATE_ROLE_SCENE})||this}return a(CreateRoleScene,t),CreateRoleScene.prototype.init=function(e){t.prototype.init.call(this,e),this.params=e.params},CreateRoleScene.prototype.create=function(){this.render&&(this.render.uiManager.setScene(this),o.Logger.getInstance().debug("createrole===scene"));t.prototype.create.call(this)},CreateRoleScene.prototype.stop=function(){this.render&&this.render.showMediator("CreateRoleScene",!1),t.prototype.stop.call(this)},CreateRoleScene}(s.a)},function(t,e,i){"use strict";var n=i(599);i.d(e,"a",(function(){return n.b}));i(621)},function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n,s=i(605),r=i(31),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function BubbleContainer(e,i){var n=t.call(this,e)||this;return n.mBubbles=[],n.mScale=i,n.mArrow=new r.DynamicImage(n.scene,0,0),n.mArrow.scale=i,n.mArrow.load(o.Url.getRes("ui/chat/bubble_arrow.png")),n.add(n.mArrow),n}return a(BubbleContainer,t),BubbleContainer.prototype.addBubble=function(t,e){var i=this.createBubble(e),n=this.mBubbles.length,s=null,r=0;i.show(t,e);for(var o=n-1;o>=0;o--)r+=(s=this.mBubbles[o]).minHeight+5*this.mScale,s.tweenTo(-r);this.add(i),this.mArrow.y=4*this.mScale},BubbleContainer.prototype.follow=function(t){if(0!==this.mBubbles.length){var e=t.getPosition();e&&this.updatePos(e.x,e.y-110)}},BubbleContainer.prototype.updatePos=function(t,e){this.x=t*this.mScale,this.y=e*this.mScale},BubbleContainer.prototype.destroy=function(e){if(this.mBubbles){for(var i=null,n=this.mBubbles.length-1;n>=0;n--)(i=this.mBubbles[n])&&i.destroy();this.mBubbles=null,this.removeFormParent(),t.prototype.destroy.call(this,e)}},BubbleContainer.prototype.removeFormParent=function(){this.parentContainer&&this.parentContainer.remove(this)},BubbleContainer.prototype.createBubble=function(t){if(t){var e=new s.a(this.scene,this.mScale);this.mBubbles.push(e);var i=t.duration?t.duration:5e3;return e.durationRemove(i,this.onRemoveBubble,this),e}},BubbleContainer.prototype.onRemoveBubble=function(t){t&&(this.mBubbles=this.mBubbles.filter((function(e){return t!==e})),this.remove(t),t.destroy(),0===this.mBubbles.length&&this.removeFormParent())},BubbleContainer}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n,s=i(144),r=i(5),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function Bubble(e,i){var n=t.call(this,e)||this;return n.mMinWidth=0,n.mMinHeight=0,n.mScale=i,n.x=-40*i,n}return a(Bubble,t),Bubble.prototype.show=function(t,e){this.mChatContent=new r.BBCodeText(this.scene,0,4*this.mScale,t,{fontFamily:o.Font.DEFULT_FONT,fontSize:14*this.mScale,color:"#000000",origin:{x:0,y:0},wrap:{width:200*this.mScale,mode:"character"}}),this.add(this.mChatContent);var i=36*this.mScale,n=60*this.mScale;this.mMinHeight=this.mChatContent.height+18*this.mScale,this.mMinHeight=this.mMinHeight<i?i:this.mMinHeight,this.mMinWidth=this.mChatContent.width+20*this.mScale,this.mMinWidth=this.mMinWidth<n?n:this.mMinWidth,this.mBubbleBg=new s.DynamicNinepatch(this.scene,this);var a=o.Url.getOsdRes(e.bubbleResource||"platformitem/thumbnail/bubble_01.png");this.mBubbleBg.load(a,{width:this.mMinWidth,height:this.mMinHeight,key:a,columns:[34,2,32],rows:[42,2,9]},this.onComplete,this)},Bubble.prototype.tweenTo=function(t){this.mToY=t,this.scene.tweens.add({targets:this,y:t,alpha:1,duration:200})},Bubble.prototype.durationRemove=function(t,e,i){var n=this;this.mTweenCompleteCallback=e,this.mTweenCallContext=i,this.mRemoveDelay=setTimeout((function(){n.removeTween()}),t)},Bubble.prototype.removeTween=function(){var t=this,e=this.mToY-30;this.scene.tweens.add({targets:this,y:e,alpha:0,duration:200,onComplete:function(){t.mTweenCompleteCallback&&t.mTweenCompleteCallback.call(t.mTweenCallContext,t)}})},Bubble.prototype.destroy=function(){this.mChatContent&&this.mChatContent.destroy(!0),this.mChatContent=null,this.mMinWidth=0,this.mMinHeight=0,this.mToY=0,this.mTweenCompleteCallback=null,this.mTweenCallContext=null,this.mRemoveDelay&&clearTimeout(this.mRemoveDelay),t.prototype.destroy.call(this,!0)},Bubble.prototype.onComplete=function(t){if(t&&this.scene){t.setOrigin(0,0),this.addAt(t,0);this.getBounds();this.mChatContent.x=this.mMinWidth-this.mChatContent.width>>1,this.mChatContent.y=6+(this.mMinHeight-this.mChatContent.height>>1)}},Object.defineProperty(Bubble.prototype,"minWidth",{get:function(){return this.mMinWidth},enumerable:!1,configurable:!0}),Object.defineProperty(Bubble.prototype,"minHeight",{get:function(){return this.mMinHeight},enumerable:!1,configurable:!0}),Bubble}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i(533);var n=i(534);i.d(e,"DragonbonesDisplay",(function(){return n.a}));var s=i(532);i.d(e,"FramesDisplay",(function(){return s.a}));var r=i(626);i.d(e,"BubbleAnimation",(function(){return r.a}));i(627);var o=i(628);i.d(e,"FrameAnimation",(function(){return o.a}));i(482);var a=i(629);i.d(e,"AnimationModel",(function(){return a.a}));i(605),i(604);var h=i(630);i.d(e,"UIDragonbonesDisplay",(function(){return h.a}));var l=i(631);i.o(l,"AlertView")&&i.d(e,"AlertView",(function(){return l.AlertView})),i.o(l,"AlignmentType")&&i.d(e,"AlignmentType",(function(){return l.AlignmentType})),i.o(l,"AstarDebugger")&&i.d(e,"AstarDebugger",(function(){return l.AstarDebugger})),i.o(l,"AxisType")&&i.d(e,"AxisType",(function(){return l.AxisType})),i.o(l,"BackgroundScaleButton")&&i.d(e,"BackgroundScaleButton",(function(){return l.BackgroundScaleButton})),i.o(l,"BasePanel")&&i.d(e,"BasePanel",(function(){return l.BasePanel})),i.o(l,"ButtonEventDispatcher")&&i.d(e,"ButtonEventDispatcher",(function(){return l.ButtonEventDispatcher})),i.o(l,"CheckboxGroup")&&i.d(e,"CheckboxGroup",(function(){return l.CheckboxGroup})),i.o(l,"CommonBackground")&&i.d(e,"CommonBackground",(function(){return l.CommonBackground})),i.o(l,"ConstraintType")&&i.d(e,"ConstraintType",(function(){return l.ConstraintType})),i.o(l,"DynamicImage")&&i.d(e,"DynamicImage",(function(){return l.DynamicImage})),i.o(l,"DynamicImageValue")&&i.d(e,"DynamicImageValue",(function(){return l.DynamicImageValue})),i.o(l,"GridLayoutGroup")&&i.d(e,"GridLayoutGroup",(function(){return l.GridLayoutGroup})),i.o(l,"GridsDebugger")&&i.d(e,"GridsDebugger",(function(){return l.GridsDebugger})),i.o(l,"ImageBBCodeValue")&&i.d(e,"ImageBBCodeValue",(function(){return l.ImageBBCodeValue})),i.o(l,"ImageValue")&&i.d(e,"ImageValue",(function(){return l.ImageValue})),i.o(l,"InputPanel")&&i.d(e,"InputPanel",(function(){return l.InputPanel})),i.o(l,"InputView")&&i.d(e,"InputView",(function(){return l.InputView})),i.o(l,"ItemInfoTips")&&i.d(e,"ItemInfoTips",(function(){return l.ItemInfoTips})),i.o(l,"ItemsConsumeFunPanel")&&i.d(e,"ItemsConsumeFunPanel",(function(){return l.ItemsConsumeFunPanel})),i.o(l,"LabelInput")&&i.d(e,"LabelInput",(function(){return l.LabelInput})),i.o(l,"MainUIScene")&&i.d(e,"MainUIScene",(function(){return l.MainUIScene})),i.o(l,"NinePatch")&&i.d(e,"NinePatch",(function(){return l.NinePatch})),i.o(l,"NinePatchButton")&&i.d(e,"NinePatchButton",(function(){return l.NinePatchButton})),i.o(l,"PlayScene")&&i.d(e,"PlayScene",(function(){return l.PlayScene})),i.o(l,"ProgressMaskBar")&&i.d(e,"ProgressMaskBar",(function(){return l.ProgressMaskBar})),i.o(l,"ProgressThreeBar")&&i.d(e,"ProgressThreeBar",(function(){return l.ProgressThreeBar})),i.o(l,"PropItem")&&i.d(e,"PropItem",(function(){return l.PropItem})),i.o(l,"SoundButton")&&i.d(e,"SoundButton",(function(){return l.SoundButton})),i.o(l,"TextButton")&&i.d(e,"TextButton",(function(){return l.TextButton})),i.o(l,"TextToolTips")&&i.d(e,"TextToolTips",(function(){return l.TextToolTips})),i.o(l,"ThreeSliceButton")&&i.d(e,"ThreeSliceButton",(function(){return l.ThreeSliceButton})),i.o(l,"ThreeSlicePath")&&i.d(e,"ThreeSlicePath",(function(){return l.ThreeSlicePath})),i.o(l,"ToggleButton")&&i.d(e,"ToggleButton",(function(){return l.ToggleButton})),i.o(l,"ToggleColorButton")&&i.d(e,"ToggleColorButton",(function(){return l.ToggleColorButton})),i.o(l,"TweenCompent")&&i.d(e,"TweenCompent",(function(){return l.TweenCompent})),i.o(l,"UiManager")&&i.d(e,"UiManager",(function(){return l.UiManager})),i.o(l,"ValueContainer")&&i.d(e,"ValueContainer",(function(){return l.ValueContainer}));var c=i(608);i.d(e,"GridsDebugger",(function(){return c.b}));var p=i(609);i.d(e,"AstarDebugger",(function(){return p.b}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n,s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),r=function(t){function BaseAnimation(e){var i=t.call(this,e)||this;return i.loaded=!1,i.isPlaying=!1,i.loop=!1,i}return s(BaseAnimation,t),BaseAnimation.prototype.load=function(t,e,i){this.destroy(),this.resName=t||e,this.curAniName=t,this.resUrl=e},BaseAnimation.prototype.play=function(t){t&&(this.curAniName=t),this.isPlaying=!0},BaseAnimation.prototype.destroy=function(){this.animUrlData&&this.animUrlData.dispose(),this.animUrlData=void 0,this.curAniName=void 0,this.isPlaying=!1,this.loaded=!1,this.loop=!1},BaseAnimation.prototype.onLoadComplete=function(t,e,i){},BaseAnimation}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return o}));var n=i(0),s=i(474),r=function(){function Grids(t){this.render=t,o.getInstance().setDebugger(this)}return Grids.prototype.destroy=function(){this.mGraphic&&this.mGraphic.destroy(),this.mRoomSize=null,o.getInstance().setDebugger(null)},Grids.prototype.setData=function(t){this.mRoomSize=t,o.getInstance().isDebug?this.show():this.hide()},Grids.prototype.show=function(){if(this.mRoomSize){var t=this.render.sceneManager.getMainScene();if(t&&t instanceof s.a){this.mGraphic&&this.mGraphic.destroy(),this.mGraphic=t.make.graphics(void 0,!1),this.mGraphic.clear(),this.mGraphic.lineStyle(1,65280),this.mGraphic.beginPath();for(var e=0;e<=this.mRoomSize.rows;e++)this.drawLine(this.mRoomSize,this.mGraphic,0,e,this.mRoomSize.cols,e);for(e=0;e<=this.mRoomSize.cols;e++)this.drawLine(this.mRoomSize,this.mGraphic,e,0,e,this.mRoomSize.rows);this.mGraphic.closePath(),this.mGraphic.strokePath(),t.layerManager.addToLayer("middleLayer",this.mGraphic)}}},Grids.prototype.hide=function(){this.mGraphic&&this.mGraphic.destroy()},Grids.prototype.drawLine=function(t,e,i,s,r,o){var a=new n.LogicPos(i,s);a=n.Position45.transformTo90(a,t),e.moveTo(a.x,a.y),a=new n.LogicPos(r,o),a=n.Position45.transformTo90(a,t),e.lineTo(a.x,a.y)},Grids}(),o=function(){function GridsDebugger(){this.isDebug=!1,this.mGrids=null}return GridsDebugger.getInstance=function(){return GridsDebugger._instance||(GridsDebugger._instance=new GridsDebugger),GridsDebugger._instance},GridsDebugger.prototype.setDebugger=function(t){this.mGrids=t},GridsDebugger.prototype.q=function(){this.isDebug=!1,this.mGrids&&this.mGrids.hide()},GridsDebugger.prototype.v=function(){this.isDebug=!0,this.mGrids&&this.mGrids.show()},GridsDebugger}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return o}));var n=i(474),s=i(0),r=function(){function Astar(t){this.render=t,this.CIRCLE_RADIUS_POINTS=2,this.CIRCLE_RADIUS_START_POSITION=4,this.CIRCLE_RADIUS_TARGET_POSITION=4,this.CIRCLE_COLOR_POINTS_PASS=65280,this.CIRCLE_COLOR_POINTS_NOTPASS=16711680,this.CIRCLE_COLOR_START_POSITION=16776960,this.CIRCLE_COLOR_TARGET_POSITION=16776960,this.LINE_COLOR_PATH=16776960,this.mPoints=new Map,this.mStartPos=null,this.mTargetPos=null,this.mPath=null,o.getInstance().setDebugger(this)}return Astar.prototype.destroy=function(){this.clearAll(),this.mAstarSize&&(this.mAstarSize=null),o.getInstance().setDebugger(null)},Astar.prototype.initData=function(t,e){this.mAstarSize=e,o.getInstance().isDebug?this.drawPoints():this.clearAll()},Astar.prototype.updateData=function(t,e,i){this.mAstarSize&&(o.getInstance().isDebug?this.drawPoints():this.clearAll())},Astar.prototype.showPath=function(t,e,i){this.mAstarSize&&(o.getInstance().isDebug?this.drawPath(t,e,i):this.clearPath())},Astar.prototype.drawPoints=function(){var t=this;if(this.mAstarSize){var e=this.render.sceneManager.getMainScene();if(e&&e instanceof n.a){this.clearAll();for(var _loop_1=function(n){for(var _loop_2=function(r){i.render.physicalPeer.isWalkableAt(r,n).then((function(i){var o=t.getColorByValue(i),a=new s.LogicPos(r,n);(a=s.Position45.transformTo90(a,t.mAstarSize)).y+=t.mAstarSize.tileHeight/2;var h=t.drawCircle(e,a,o,t.CIRCLE_RADIUS_POINTS);t.mPoints.set(new s.LogicPos(r,n),h)}))},r=0;r<i.mAstarSize.cols;r++)_loop_2(r)},i=this,r=0;r<this.mAstarSize.rows;r++)_loop_1(r)}}},Astar.prototype.clearAll=function(){this.mPoints.forEach((function(t){t.destroy()})),this.mPoints.clear(),this.clearPath()},Astar.prototype.clearPath=function(){this.mStartPos&&(this.mStartPos.destroy(),this.mStartPos=null),this.mTargetPos&&(this.mTargetPos.destroy(),this.mTargetPos=null),this.mPath&&(this.mPath.destroy(),this.mPath=null)},Astar.prototype.drawPath=function(t,e,i){if(this.mAstarSize){var s=this.render.sceneManager.getMainScene();s&&s instanceof n.a&&(this.clearPath(),this.mStartPos=this.drawCircle(s,t,this.CIRCLE_COLOR_START_POSITION,this.CIRCLE_RADIUS_START_POSITION),this.mTargetPos=this.drawCircle(s,e,this.CIRCLE_COLOR_TARGET_POSITION,this.CIRCLE_RADIUS_TARGET_POSITION),i.length>1&&(this.mPath=this.drawLine(s,i,this.LINE_COLOR_PATH)))}},Astar.prototype.drawCircle=function(t,e,i,n){var s=t.make.graphics(void 0,!1);return s.clear(),s.fillStyle(i,1),s.fillCircle(e.x,e.y,n),t.layerManager.addToLayer("middleLayer",s),s},Astar.prototype.drawLine=function(t,e,i){var n=t.make.graphics(void 0,!1);n.lineStyle(1,i),n.beginPath();for(var r=0;r<e.length-1;r++){var o=e[r],a=new s.LogicPos(o.x,o.y);n.moveTo(a.x,a.y),o=e[r+1],a=new s.LogicPos(o.x,o.y),n.lineTo(a.x,a.y)}return n.closePath(),n.strokePath(),t.layerManager.addToLayer("middleLayer",n),n},Astar.prototype.getColorByValue=function(t){return t?this.CIRCLE_COLOR_POINTS_PASS:this.CIRCLE_COLOR_POINTS_NOTPASS},Astar}(),o=function(){function AstarDebugger(){this.isDebug=!1,this.mAstar=null}return AstarDebugger.getInstance=function(){return AstarDebugger._instance||(AstarDebugger._instance=new AstarDebugger),AstarDebugger._instance},AstarDebugger.prototype.setDebugger=function(t){this.mAstar=t},AstarDebugger.prototype.q=function(){this.isDebug=!1,this.mAstar&&this.mAstar.clearAll()},AstarDebugger.prototype.v=function(){this.isDebug=!0,this.mAstar&&this.mAstar.drawPoints()},AstarDebugger}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n=i(611),s=i(612),r=function(){function InputManager(t){this.render=t,this.mMouseManager=new s.a(t)}return InputManager.prototype.showJoystick=function(){this.mJoystickManager=new n.a(this.render),this.mJoystickManager.setScene(this.mScene)},InputManager.prototype.setScene=function(t){this.mScene=t,this.mMouseManager.changeScene(t),this.mJoystickManager&&this.mJoystickManager.setScene(t)},InputManager.prototype.resize=function(t,e){this.mMouseManager.resize(t,e)},InputManager.prototype.update=function(t,e){},InputManager.prototype.destroy=function(){this.mMouseManager&&this.mMouseManager.destroy(),this.mJoystickManager&&this.mJoystickManager.destroy()},InputManager}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n,s=i(3),r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function JoystickManager(e){var i=t.call(this)||this;return i.render=e,i.mScaleRatio=e.scaleRatio,i.mJoystick=i.render.mainPeer.JoystickManager,i}return r(JoystickManager,t),JoystickManager.prototype.setScene=function(t){this.scene=t,t&&this.onListener()},JoystickManager.prototype.onListener=function(){this.scene.input.on("pointerdown",this.onDownHandler,this),this.scene.input.on("pointerup",this.onUpHandler,this)},JoystickManager.prototype.offListener=function(){this.scene.input.off("pointermove",this.onPointerMoveHandler,this),this.scene.input.off("pointerdown",this.onDownHandler,this),this.scene.input.off("pointerup",this.onUpHandler,this)},JoystickManager.prototype.destroy=function(){this.offListener()},JoystickManager.prototype.onPointerMoveHandler=function(t){this.calcAngle(t)},JoystickManager.prototype.onDownHandler=function(t){this.scene.input.on("pointermove",this.onPointerMoveHandler,this),this.calcAngle(t),this.start()},JoystickManager.prototype.onUpHandler=function(t){this.scene.input.off("pointermove",this.onPointerMoveHandler,this),(t.downX-t.upX>10*this.mScaleRatio||Math.abs(t.downY-t.upY)>10*this.mScaleRatio)&&this.stop()},JoystickManager.prototype.calcAngle=function(t){this.mJoystick&&this.mJoystick.calcAngle(Math.ceil(t.worldX/this.mScaleRatio),Math.ceil(t.worldY/this.mScaleRatio))},JoystickManager.prototype.start=function(){this.mJoystick&&this.mJoystick.start()},JoystickManager.prototype.stop=function(){this.mJoystick&&this.mJoystick.stop()},JoystickManager}(s.PacketHandler)},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n,s=i(532),r=i(1),o=i(599);!function(t){t[t.RightMouseDown=1]="RightMouseDown",t[t.RightMouseUp=2]="RightMouseUp",t[t.LeftMouseDown=3]="LeftMouseDown",t[t.LeftMouseUp=4]="LeftMouseUp",t[t.WheelDown=5]="WheelDown",t[t.WheelUp=6]="WheelUp",t[t.RightMouseHolding=7]="RightMouseHolding",t[t.LeftMouseHolding=8]="LeftMouseHolding",t[t.Tap=9]="Tap"}(n||(n={}));var a=function(){function MouseManager(t){this.render=t,this.running=!1,this.mDownDelay=1e3,this.delay=500,this.zoom=this.render.scaleRatio||1}return Object.defineProperty(MouseManager.prototype,"clickID",{get:function(){return this.mClickID},enumerable:!1,configurable:!0}),MouseManager.prototype.changeScene=function(t){this.pause(),this.mGameObject=null,this.mScene=t,this.mScene&&(t.input.on("gameobjectdown",this.groundDown,this),t.input.on("pointerdown",this.pointerDownHandler,this),this.resume())},MouseManager.prototype.resize=function(t,e){this.zoom=this.render.scaleRatio||1},MouseManager.prototype.pause=function(){this.running=!1},MouseManager.prototype.resume=function(){this.running=!0},MouseManager.prototype.onUpdate=function(t,e){if(!1!==this.running&&void 0!==t){var i=[];t.leftButtonDown()?i.push(n.LeftMouseDown):t.leftButtonReleased()&&i.push(n.LeftMouseUp),t.middleButtonDown()?i.push(n.WheelDown):t.middleButtonReleased()&&i.push(n.WheelUp),t.rightButtonDown()?i.push(n.RightMouseDown):t.rightButtonReleased()&&i.push(n.RightMouseUp);var r=0,a=null;if(e&&e.parentContainer&&(r=e.parentContainer.getData("id"),a=e.parentContainer.parentContainer||e.parentContainer),!1===t.isDown){var h=Math.abs(t.downX-t.upX),l=Math.abs(t.downY-t.upY);h<10&&l<10&&e&&e.parentContainer&&a&&a instanceof s.a&&a.nodeType===o.b.ElementNodeType&&a.scaleTween()}0!==i.length&&this.sendMouseEvent(i,r,{x:t.worldX/this.zoom,y:t.worldY/this.zoom})}},Object.defineProperty(MouseManager.prototype,"enable",{get:function(){return!!this.mScene&&this.mScene.input.mouse.enabled},set:function(t){this.mScene&&(this.mScene.input.mouse.enabled=t)},enumerable:!1,configurable:!0}),MouseManager.prototype.destroy=function(){this.mScene=null,this.running=!1,this.debounce=null,this.mScene&&(this.mScene.input.off("gameobjectdown",this.groundDown,this),this.mScene.input.off("pointerdown",this.pointerDownHandler,this)),this.pause()},MouseManager.prototype.groundDown=function(t,e){this.mGameObject=e,this.mDownTime=setTimeout(this.holdHandler.bind(this),this.mDownDelay,t,e)},MouseManager.prototype.groundUp=function(t,e){this.onUpdate(t,e)},MouseManager.prototype.pointerDownHandler=function(t,e){var i=this;this.debounce?this.mGameObject=null:(this.debounce=setTimeout((function(){i.debounce=null}),this.delay),this.mScene.input.off("pointerup",this.onPointerUpHandler,this),this.mScene.input.once("pointerup",this.onPointerUpHandler,this),this.render&&this.render.emitter&&this.render.emitter.emit(r.MessageType.SCENE_BACKGROUND_CLICK,t),this.onUpdate(t,this.mGameObject))},MouseManager.prototype.onPointerUpHandler=function(t){clearTimeout(this.mDownTime),this.onUpdate(t,this.mGameObject),this.mGameObject=null},MouseManager.prototype.holdHandler=function(t,e){if(clearTimeout(this.mDownTime),!(Math.abs(t.downX-t.x)>5*this.zoom||Math.abs(t.downY-t.y)>5*this.zoom)){var i=0;e&&e.parentContainer&&(i=e.parentContainer.getData("id"),e.parentContainer.parentContainer||e.parentContainer,this.sendMouseEvent([n.LeftMouseHolding],i,{x:t.worldX/this.zoom,y:t.worldY/this.zoom}))}},MouseManager.prototype.sendMouseEvent=function(t,e,i){this.mClickID=e,this.render.mainPeer.sendMouseEvent(e,t,i)},MouseManager}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n,s=i(0),r=i(143),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),a=function(t){function GamePauseScene(){return t.call(this,{key:GamePauseScene.name})||this}return o(GamePauseScene,t),GamePauseScene.prototype.preload=function(){this.load.image("gamepause.png",s.Url.getRes("gamepause.png"))},GamePauseScene.prototype.init=function(e){t.prototype.init.call(this,e),this.mRender=e.render},GamePauseScene.prototype.create=function(){t.prototype.create.call(this);var e=this.scale.gameSize.width,i=this.scale.gameSize.height;this.bg=this.add.graphics(),this.bg.fillStyle(0,.8),this.bg.fillRect(0,0,e,i),this.pauseImg=this.add.image(e>>1,i>>1,"gamepause.png"),this.tipTF=this.add.text(e-240>>1,i-50,"点击任意位置开始游戏",{font:"30px Tahoma"}),this.scale.on("resize",this.checkSize,this),this.checkSize(new s.Size(e,i)),this.input.on("pointerdown",this.downHandler,this)},GamePauseScene.prototype.awake=function(){this.scale.on("resize",this.checkSize,this),this.input.on("pointerdown",this.downHandler,this),this.scene.wake()},GamePauseScene.prototype.sleep=function(){this.scale.off("resize",this.checkSize,this),this.input.off("pointerdown",this.downHandler,this),this.scene.sleep()},GamePauseScene.prototype.getKey=function(){return this.sys.config.key},GamePauseScene.prototype.downHandler=function(){this.mRender.onFocus()},GamePauseScene.prototype.checkSize=function(t){var e=t.width,i=t.height;this.bg.clear(),this.bg.fillStyle(0,.8),this.bg.fillRect(0,0,e,i),this.pauseImg.scaleX=this.pauseImg.scaleY=.7*this.mRender.uiScale,this.pauseImg.x=e>>1,this.pauseImg.y=i>>1,this.tipTF.scaleX=this.tipTF.scaleY=this.mRender.uiScale,this.tipTF.x=e-280*this.mRender.uiScale>>1,this.tipTF.y=i-50*this.mRender.uiScale},GamePauseScene}(r.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var n,s=i(0),r=i(483),o=i(73),a=i.n(o),h=i(1),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function fulfilled(t){try{step(n.next(t))}catch(t){r(t)}}function rejected(t){try{step(n.throw(t))}catch(t){r(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function verb(r){return function(a){return function step(r){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(s=2&r[0]?n.return:r[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,r[1])).done)return s;switch(n=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],n=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},c=function(t){function LoadingScene(){return t.call(this,{key:h.SceneName.LOADING_SCENE})||this}return l(LoadingScene,t),LoadingScene.prototype.preload=function(){this.load.image("avatar_placeholder",s.Url.getRes("dragonbones/avatar.png")),this.load.atlas("curtain",s.Url.getUIRes(this.dpr,"loading/curtain.png"),s.Url.getUIRes(this.dpr,"loading/curtain.json")),this.load.atlas("loading",s.Url.getRes("ui/loading/loading.png"),s.Url.getRes("ui/loading/loading.json")),this.load.script("webfont",s.Url.getRes("scripts/webfont/1.6.26/webfont.js"))},LoadingScene.prototype.init=function(e){t.prototype.init.call(this,e),this.createFont(),this.dpr=e.dpr||2,this.mRequestCom=!1,this.mCallback=e.callBack,this.tipsText=e.text||""},LoadingScene.prototype.create=function(){t.prototype.create.call(this);try{WebFont.load({custom:{families:["Source Han Sans","tt0173m_","tt0503m_","t04B25"]}})}catch(t){s.Logger.getInstance().warn("webfont failed to load")}var e=this.scale.gameSize.width,i=this.scale.gameSize.height;this.anims.create({key:"loading_anis",frames:this.anims.generateFrameNames("loading",{prefix:"loading_",start:1,end:3,zeroPad:1,suffix:".png"}),frameRate:5,repeat:-1}),this.curtain=new p(this,this.dpr),this.mask=this.add.graphics(void 0),this.mask.fillStyle(0),this.mask.fillRect(0,0,e,i);var n=this.render.uiRatio;this.bg=this.add.sprite(.5*e,.5*i,"loading").setScale(this.render.uiScale*n*2),this.bg.play("loading_anis"),this.progressText=this.add.text(this.bg.x,this.bg.y+.5*this.bg.displayHeight,this.tipsText,{fontSize:12*n,fontFamily:s.Font.DEFULT_FONT}).setOrigin(.5),this.debug=this.add.text(e-4*n,i-4*n,"v"+a.a+" "+this.getDebug(),{fontSize:12*n,fontFamily:s.Font.DEFULT_FONT}).setOrigin(1)},LoadingScene.prototype.show=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){return this.wake(),this.curtain?(this.displayVisible(!1),[2,this.curtain.open()]):[2,Promise.resolve()]}))}))},LoadingScene.prototype.close=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){return this.curtain?(this.displayVisible(!1),[2,this.curtain.close()]):[2]}))}))},LoadingScene.prototype.updateProgress=function(t){t&&(this.tipsText=t,t&&this.progressText&&this.progressText.active&&this.progressText.setText(t))},LoadingScene.prototype.wake=function(e){var i=this;this.scene&&this.scene.settings&&(this.curtain&&(this.displayVisible(!0),this.curtain.open().then((function(){i.scene.wake()})).catch((function(t){s.Logger.getInstance().debug(t)})),this.scene.bringToTop(h.SceneName.LOADING_SCENE),t.prototype.wake.call(this,e)),e&&(this.tipsText=e.text,s.Logger.getInstance().debug("loadState:----",e.text),e.text&&this.progressText&&this.progressText.active&&this.progressText.setText(e.text)))},LoadingScene.prototype.sleep=function(){var t=this;this.progressText&&this.progressText.active&&this.progressText.setText(""),this.scene&&this.scene.settings&&(this.curtain?(this.displayVisible(!1),this.curtain.close().then((function(){t.scene.sleep()}))):(this.displayVisible(!0),this.scene.sleep()))},LoadingScene.prototype.appendProgress=function(t){this.progressText&&this.progressText.setText(t)},LoadingScene.prototype.getKey=function(){return this.sys.config.key},LoadingScene.prototype.getDebug=function(){var t="WebGL",e=this.game.config;e.renderType===Phaser.CANVAS?t="Canvas":e.renderType===Phaser.HEADLESS&&(t="Headless");var i=e.audio,n=this.game.device.audio;return"("+t+" | "+(!n.webAudio||i&&i.disableWebAudio?i&&i.noAudio||!n.webAudio&&!n.audioData?"No Audio":"HTML5 Audio":"Web Audio")+")"},LoadingScene.prototype.displayVisible=function(t){this.bg&&(this.bg.visible=t,this.debug.visible=t,this.mask.visible=t)},LoadingScene.prototype.createFont=function(){var t=document.createElement("style");document.head.appendChild(t);var e=t.sheet,i="@font-face { font-family: 'tt0173m_'; src: url('"+s.Url.getRes("fonts/en/tt0173m_.ttf")+"') format('truetype');font-display:swap }\n",n="@font-face { font-family: 'tt0503m_'; src: url('"+s.Url.getRes("fonts/en/tt0503m_.ttf")+"') format('truetype'); font-display:swap}\n",r="@font-face { font-family: 't04B25'; src: url('"+s.Url.getRes("fonts/04B.ttf")+"') format('truetype'); font-display:swap}";e.insertRule(i,0),e.insertRule(n,0),e.insertRule(r,0)},LoadingScene}(r.a),p=function(){function Curtain(t,e){this.scene=t,this.dpr=e,this.key="curtain",this.upDisplay=this.scene.add.image(0,0,this.key,"up.png").setOrigin(0).setVisible(!1).setScale(this.dpr),this.downDisplay=this.scene.add.image(0,0,this.key,"down.png").setOrigin(0,1).setVisible(!1).setScale(this.dpr)}return Curtain.prototype.open=function(){var t=this;return this.upDisplay.visible=!0,this.downDisplay.visible=!0,new Promise((function(e,i){if(t.scene.cameras.main)if(t.upTween||t.downTween)i();else{var n=t.scene.cameras.main.height;t.upDisplay.y=-t.upDisplay.displayHeight,t.downDisplay.y=n+t.downDisplay.displayHeight,t.upTween=t.scene.add.tween({targets:t.upDisplay,props:{y:0},duration:1e3}),t.downTween=t.scene.add.tween({targets:t.downDisplay,props:{y:n},duration:1e3,onComplete:function(){t.clearTween(),e()}})}else e()}))},Curtain.prototype.close=function(){var t=this;return this.downDisplay.visible=!0,this.upDisplay.visible=!0,new Promise((function(e,i){if(t.scene.cameras.main){var n=t.scene.cameras.main.height;t.upDisplay.y=0,t.downDisplay.y=n,t.clearTween(),t.upTween=t.scene.add.tween({targets:t.upDisplay,props:{y:-t.upDisplay.displayHeight},duration:1e3}),t.downTween=t.scene.add.tween({targets:t.downDisplay,props:{y:n+t.downDisplay.displayHeight},duration:1e3,onComplete:function(){t.clearTween(),e()}})}else e(null)}))},Curtain.prototype.destroy=function(){},Curtain.prototype.clearTween=function(){this.upTween&&(this.upTween.stop(),this.upTween=null),this.downTween&&(this.downTween.stop(),this.downTween=null)},Curtain}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n,s=i(143),r=i(0),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),a=function(t){function LoginAccountScene(){return t.call(this,{key:LoginAccountScene.name})||this}return o(LoginAccountScene,t),LoginAccountScene.prototype.preload=function(){var t=2;this.mWorld&&(t=this.mWorld.uiRatio||2),this.load.image("avatar_placeholder",r.Url.getRes("dragonbones/avatar.png")),this.load.atlas("curtain",r.Url.getUIRes(t,"loading/curtain.png"),r.Url.getUIRes(t,"loading/curtain.json")),this.load.atlas("loading",r.Url.getRes("ui/loading/loading.png"),r.Url.getRes("ui/loading/loading.json")),this.load.script("webfont","./resources/scripts/webfont/1.6.26/webfont.js")},LoginAccountScene.prototype.init=function(e){t.prototype.init.call(this,e),this.createFont(),this.mWorld=e.world,this.mCallback=e.callBack},LoginAccountScene.prototype.create=function(){var e=this;t.prototype.create.call(this);try{WebFont.load({custom:{families:["Source Han Sans","tt0173m_","tt0503m_","t04B25"]}})}catch(t){r.Logger.getInstance().warn("webfont failed to load")}var i=this.scale.gameSize.width,n=this.scale.gameSize.height;this.anims.create({key:"loading_anis",frames:this.anims.generateFrameNames("loading",{prefix:"loading_",start:1,end:3,zeroPad:1,suffix:".png"}),frameRate:5,repeat:-1});var s=this.mWorld.uiRatio;this.bg=this.add.sprite(.5*i,.5*n,"loading").setScale(this.mWorld.uiScale*s*2),this.bg.play("loading_anis"),this.checkSize(new r.Size(i,n)),this.scale.on("resize",this.checkSize,this);var o=this.add.graphics();o.fillStyle(16763904,.8),o.fillRect(0,0,100,50),o.setInteractive(new Phaser.Geom.Rectangle(0,0,100,50),Phaser.Geom.Rectangle.Contains),o.x=200,o.y=300,o.on("pointerdown",(function(){e.mCallback&&(e.mCallback.call(e,e),e.mCallback=void 0)}),this)},LoginAccountScene.prototype.getKey=function(){return this.sys.config.key},LoginAccountScene.prototype.checkSize=function(t){},LoginAccountScene.prototype.createFont=function(){var t=document.createElement("style");document.head.appendChild(t);var e=t.sheet;e.insertRule("@font-face { font-family: 'tt0173m_'; src: url('./resources/fonts/en/tt0173m_.ttf') format('truetype');font-display:swap }\n",0),e.insertRule("@font-face { font-family: 'tt0503m_'; src: url('./resources/fonts/en/tt0503m_.ttf') format('truetype'); font-display:swap}\n",0),e.insertRule("@font-face { font-family: 't04B25'; src: url('./resources/fonts/04B.ttf') format('truetype'); font-display:swap}",0)},LoginAccountScene}(s.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n,s=i(143),r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function SelectRoleScene(){return t.call(this,{key:SelectRoleScene.name})||this}return r(SelectRoleScene,t),SelectRoleScene.prototype.preload=function(){},SelectRoleScene.prototype.init=function(t){this.mWorld=t},SelectRoleScene.prototype.create=function(){t.prototype.create.call(this)},Object.defineProperty(SelectRoleScene.prototype,"key",{get:function(){return this.sys.config.key},enumerable:!1,configurable:!0}),SelectRoleScene}(s.a)},function(t,e,i){"use strict";i.r(e),i.d(e,"Item",(function(){return a}));var n,s=i(470),r=i(0),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),a=function(t){function Item(e){var i=t.call(this,e)||this,n=e.make.image({key:"prop_background"}).setOrigin(0,0);return i.setSize(n.width,n.height),i.add(n),i.mImage=new s.DynamicImage(i.scene,0,0).setOrigin(0,0),i.add(i.mImage),i.mCount=e.make.text(void 0,!1),i.mCount.setAlign("right"),i.mCount.y=i.height-20,i.add(i.mCount),i}return o(Item,t),Item.prototype.setProp=function(t){var e=this;this.mProp=t,this.mCount&&t&&(this.mImage.load(r.Url.getOsdRes(t.display.texturePath),this,(function(){e.mImage.setInteractive(),e.scene.input.setDraggable(e.mImage);var t=1;e.mImage.width>e.width&&(t=e.width/e.mImage.width),e.mImage.height>e.height&&(t=e.height/e.mImage.height),e.mImage.scale=t})),this.mCount.setText(t.count>1?t.count.toString():""),this.mCount.x=this.width-this.mCount.width)},Item.prototype.clear=function(){this.count&&this.mProp&&(this.mCount.setText(""),this.mImage.setTexture(void 0),this.mImage.off("pointerup",this.onPointerUpHandler,this),this.mProp=void 0)},Item.prototype.destroy=function(){this.clear(),t.prototype.destroy.call(this)},Object.defineProperty(Item.prototype,"prop",{get:function(){return this.mProp},enumerable:!1,configurable:!0}),Item.prototype.onPointerUpHandler=function(){this.emit("click",this.mProp)},Item}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaOnlineBottomPanel",(function(){return h}));var n,s=i(5),r=i(470),o=i(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicaOnlineBottomPanel(e,i,n,s,r){var o=t.call(this,e)||this;return o.key=s,o.dpr=r,o.isblack=!1,o.setSize(i,n),o.setInteractive(),o.init(),o}return a(PicaOnlineBottomPanel,t),PicaOnlineBottomPanel.prototype.init=function(){var t=this.width,e=69*this.dpr;this.blackGraphic=this.scene.make.graphics(void 0,!1),this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.66),this.blackGraphic.fillRect(0,0,this.width,this.height),this.blackGraphic.x=.5*-this.width,this.blackGraphic.y=.5*-this.height,this.add(this.blackGraphic),this.content=this.scene.make.container(void 0,!1),this.content.setSize(t,e),this.add(this.content),this.bg=new r.ThreeSlicePath(this.scene,0,0,t,87*this.dpr,this.key,["people_panel_bg_left","people_panel_bg_middle","people_panel_bg_right"],this.dpr),this.bg.y=.5*e-.5*this.bg.height+18*this.dpr,this.content.add(this.bg),this.headIcon=new r.DynamicImage(this.scene,0,0),this.headIcon.x=.5*-t+40*this.dpr,this.headIcon.y=0*this.dpr,this.headIcon.scale=this.dpr,this.headIcon.visible=!1,this.content.add(this.headIcon),this.nameText=this.scene.make.text({x:.5*-t+96*this.dpr,y:.5*-e+15*this.dpr,text:"",style:o.UIHelper.whiteStyle(this.dpr,14)}),this.nameText.setFontStyle("bold"),this.nameText.setOrigin(0,.5),this.content.add(this.nameText);var i=["butt_yellow_left_s","butt_yellow_middle_s","butt_yellow_right_s"];this.reportBtn=new r.ThreeSliceButton(this.scene,84*this.dpr,31*this.dpr,this.key,i,i,o.i18n.t("player_info.report")),this.reportBtn.setTextStyle(o.UIHelper.brownishStyle(this.dpr)),this.reportBtn.y=.5*e-.5*this.reportBtn.height-5*this.dpr,this.reportBtn.x=.5*this.reportBtn.width+20*this.dpr,this.reportBtn.on(s.ClickEvent.Tap,this.onReportHandler,this),this.content.add(this.reportBtn);var n=["butt_red_left_s","butt_red_middle_s","butt_red_right_s"];this.blackBtn=new r.ThreeSliceButton(this.scene,84*this.dpr,31*this.dpr,this.key,n,n,o.i18n.t("player_info.blockuer")),this.blackBtn.setTextStyle(o.UIHelper.whiteStyle(this.dpr)),this.blackBtn.y=this.reportBtn.y,this.blackBtn.x=.5*-this.blackBtn.width-5*this.dpr,this.blackBtn.on(s.ClickEvent.Tap,this.onBlockHandler,this),this.content.add(this.blackBtn),this.content.x=0,this.content.y=.5*this.height+.5*this.content.height+10*this.dpr,this.content.setInteractive()},PicaOnlineBottomPanel.prototype.setRoleData=function(t,e){var i=this;if(this.roleData=t,this.isblack=e,this.roleData){if(this.headIcon.visible=!1,this.nameText.text=t.nickname,t.avatar){var n=o.Url.getOsdRes(t.avatar);this.headIcon.load(n,this,(function(){i.headIcon.visible=!0}))}this.blackBtn.setText(e?o.i18n.t("player_info.remove_black"):o.i18n.t("player_info.blockuer"))}},PicaOnlineBottomPanel.prototype.refreshBlack=function(t){this.setRoleData(this.roleData,t)},PicaOnlineBottomPanel.prototype.setHandler=function(t){this.sendHandler=t},PicaOnlineBottomPanel.prototype.addListen=function(){this.reportBtn.on(s.ClickEvent.Tap,this.onReportHandler,this),this.blackBtn.on(s.ClickEvent.Tap,this.onBlockHandler,this),this.on("pointerdown",this.onCloseHandler,this)},PicaOnlineBottomPanel.prototype.removeListen=function(){this.reportBtn.off(s.ClickEvent.Tap,this.onReportHandler,this),this.blackBtn.off(s.ClickEvent.Tap,this.onBlockHandler,this),this.off("pointerdown",this.onCloseHandler,this)},PicaOnlineBottomPanel.prototype.show=function(){this.addListen(),this.visible=!0;var t=.5*this.height+.5*this.content.height+10*this.dpr;this.content.y=t;var e=t,i=.5*this.height-.5*this.content.height;this.playMove(e,i)},PicaOnlineBottomPanel.prototype.hide=function(){this.removeListen(),this.visible=!1},PicaOnlineBottomPanel.prototype.playMove=function(t,e){var i=this.scene.tweens.add({targets:this.content,y:{from:t,to:e},ease:"Linear",duration:150,onComplete:function(){i.stop(),i.remove()}})},PicaOnlineBottomPanel.prototype.onReportHandler=function(){this.sendHandler&&this.sendHandler.runWith(["report"])},PicaOnlineBottomPanel.prototype.onBlockHandler=function(){this.sendHandler&&this.sendHandler.runWith(["block",{uid:this.roleData.platformId,black:!this.isblack}])},PicaOnlineBottomPanel.prototype.onCloseHandler=function(){this.hide(),this.sendHandler&&this.sendHandler.runWith(["close"])},PicaOnlineBottomPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaMyRoomNavigationPanel",(function(){return l}));var n,s=i(5),r=i(470),o=i(11),a=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaMyRoomNavigationPanel(e,i,n,s,r,o){var a=t.call(this,e)||this;return a.setSize(i,n),a.key=s,a.dpr=r,a.zoom=o,a.create(),a}return h(PicaMyRoomNavigationPanel,t),PicaMyRoomNavigationPanel.prototype.create=function(){var t=this;this.gameScroll=new s.GameScroller(this.scene,{x:0,y:10*this.dpr,width:this.width,height:this.height,zoom:this.zoom,align:2,orientation:0,dpr:this.dpr,space:10*this.dpr,padding:{top:10*this.dpr},cellupCallBack:function(e){t.onGameScrollHandler(e)}}),this.add(this.gameScroll)},PicaMyRoomNavigationPanel.prototype.clear=function(){this.gameScroll.clearItems(!0)},PicaMyRoomNavigationPanel.prototype.refreshMask=function(){this.gameScroll.refreshMask()},PicaMyRoomNavigationPanel.prototype.setHandler=function(t){this.sendHandler=t},PicaMyRoomNavigationPanel.prototype.setRoomDataList=function(t){var e=this;this.gameScroll.clearItems(!0),this.setMyRoomDatas(t.selfRooms,new a.Handler(this,(function(){e.setHistoryDatas(t.historyRooms)})))},PicaMyRoomNavigationPanel.prototype.setMyRoomDatas=function(t,e){var i=new r.ImageValue(this.scene,78*this.dpr,15*this.dpr,this.key,"my_house",this.dpr,{color:"#FFC51A",fontSize:13*this.dpr,fontFamily:a.Font.DEFULT_FONT});i.setStroke("#744803",2*this.dpr),i.x=.5*-this.width+20*this.dpr,i.setFrameValue(a.i18n.t("room_list.my_room"),this.key,"my_house"),this.gameScroll.addItem(i),this.createRoomItemByFrame(t,"my_home_bg","#744803",e)},PicaMyRoomNavigationPanel.prototype.createRoomItemByFrame=function(t,e,i,n){var s=this;void 0===e&&(e="list_bg"),void 0===i&&(i="#333333");var r=0,framefun=function(){for(var o=0,a=t.slice(r,r+5);o<a.length;o++){var h=a[o],l=new c(s.scene,s.key,s.dpr,e,i);l.setRoomData(h),s.gameScroll.addItem(l)}s.gameScroll.Sort(!0),(r+=5)<t.length?setTimeout((function(){framefun()}),20):n&&n.run()};framefun()},PicaMyRoomNavigationPanel.prototype.setHistoryDatas=function(t){var e=new r.ImageValue(this.scene,78*this.dpr,30*this.dpr,this.key,"footprint",this.dpr,{color:"#FFC51A",fontSize:13*this.dpr,fontFamily:a.Font.DEFULT_FONT});e.setStroke("#744803",2*this.dpr),e.x=.5*-this.width+20*this.dpr,e.setFrameValue(a.i18n.t("room_list.my_history"),this.key,"footprint"),this.gameScroll.addItem(e),this.createRoomItemByFrame(t)},PicaMyRoomNavigationPanel.prototype.onGameScrollHandler=function(t){t&&t.roomData&&this.onSendHandler(t.roomData)},PicaMyRoomNavigationPanel.prototype.onSendHandler=function(t){this.sendHandler&&this.sendHandler.runWith(t.roomId)},PicaMyRoomNavigationPanel}(Phaser.GameObjects.Container),c=function(t){function RoomListItem(e,i,n,h,l){void 0===h&&(h="list_bg"),void 0===l&&(l="#333333");var c=t.call(this,e)||this;return c.key=i,c.dpr=n,c.bg=new s.NineSlicePatch(c.scene,0,0,254*n,40*n,c.key,h,{left:12*c.dpr,top:0*c.dpr,right:12*c.dpr,bottom:0*c.dpr}),c.add(c.bg),c.setSize(c.bg.width,c.bg.height),c.roomName=new s.BBCodeText(c.scene,.5*-c.width+10*n,.5*-c.height+5*n,"",{fontFamily:a.Font.DEFULT_FONT,fontSize:12*n,color:l}),c.roomName.setOrigin(0),c.add(c.roomName),c.roomOwnerName=new r.ImageBBCodeValue(e,50*n,20*n,i,"user",n,{fontFamily:a.Font.DEFULT_FONT,fontSize:11*n,color:"#333333"}),c.roomOwnerName.x=c.roomName.x+.5*c.roomOwnerName.width,c.roomOwnerName.y=c.roomName.y+25*n,c.add(c.roomOwnerName),c.playerCount=new r.ImageBBCodeValue(e,30*n,20*n,o.c.commonKey,"home_persons",n,{fontFamily:a.Font.DEFULT_FONT,fontSize:12*n,color:"#333333"}),c.playerCount.x=.5*c.width-35*n,c.add(c.playerCount),c}return h(RoomListItem,t),RoomListItem.prototype.setRoomData=function(t){this.roomData=t,this.roomName.text="[b]"+t.name+"[/b]",this.playerCount.setText("[b]"+t.playerCount+"[/b]"),this.roomOwnerName.setText(t.ownerName)},RoomListItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaPartyNavigationPanel",(function(){return c}));var n,s=i(5),r=i(470),o=i(11),a=i(1),h=i(0),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaPartyNavigationPanel(e,i,n,s,r,o){var a=t.call(this,e)||this;return a.setSize(i,n),a.key=s,a.dpr=r,a.zoom=o,a.create(),a}return l(PicaPartyNavigationPanel,t),PicaPartyNavigationPanel.prototype.create=function(){var t=this;this.signProgressPanel=new d(this.scene,252*this.dpr,45*this.dpr,this.key,this.dpr),this.signProgressPanel.y=.5*-this.height+15*this.dpr,this.signProgressPanel.setHandler(new h.Handler(this,this.onProgressHandler)),this.add(this.signProgressPanel);var e={x:0,y:60*this.dpr,table:{width:254*this.dpr,height:330*this.dpr,columns:1,cellWidth:254*this.dpr,cellHeight:50*this.dpr,reuseCellContainer:!0,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(e,i){e.scene;var n=e.index,s=e.item;return null===i&&(i=new p(t.scene,t.key,t.dpr)),i.setPartyData(s,n),i}};this.mGameGrid=new s.GameGridTable(this.scene,e),this.mGameGrid.layout(),this.mGameGrid.on("cellTap",this.onGridTableHandler,this),this.add(this.mGameGrid),this.noPartyImg=this.scene.make.image({key:this.key,frame:"no_party"}),this.noPartyImg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.noPartyImg.y=20*this.dpr,this.add(this.noPartyImg),this.noPartyText=this.scene.make.text({x:0,y:this.noPartyImg.y+.5*this.noPartyImg.height+10*this.dpr,text:h.i18n.t("party.nopartytips"),style:{color:"#AAAAAA",fontSize:13*this.dpr,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(.5),this.add(this.noPartyText),this.itemtips=new r.ItemInfoTips(this.scene,121*this.dpr,46*this.dpr,o.c.common2Key,"tips_bg",this.dpr),this.itemtips.setVisible(!1),this.add(this.itemtips),this.hotelBtn=new s.Button(this.scene,this.key,"hotel","hotel",h.i18n.t("party.hotel")),this.hotelBtn.text.setOrigin(0,1),this.hotelBtn.tweenScale=.88,this.hotelBtn.setTextStyle({fontSize:13*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#FFDE00",stroke:"#222222",strokeThickness:2*this.dpr}),this.hotelBtn.setTextOffset(.5*-this.hotelBtn.width+5*this.dpr,.5*this.hotelBtn.height-2*this.dpr),this.hotelBtn.setPosition(.5*-this.hotelBtn.width-18*this.dpr,this.signProgressPanel.y+.5*this.signProgressPanel.height+.5*this.hotelBtn.height+20*this.dpr),this.hotelBtn.on(String(s.ClickEvent.Tap),this.onHotelHandler,this),this.add(this.hotelBtn),this.picatownBtn=new s.Button(this.scene,this.key,"town","town",h.i18n.t("party.picatown")),this.picatownBtn.text.setOrigin(0,1),this.picatownBtn.tweenScale=.88,this.picatownBtn.setTextStyle({fontSize:13*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#FFDE00",stroke:"#222222",strokeThickness:2*this.dpr}),this.picatownBtn.setTextOffset(.5*-this.picatownBtn.width+5*this.dpr,.5*this.picatownBtn.height-2*this.dpr),this.picatownBtn.setPosition(.5*this.picatownBtn.width-10*this.dpr,this.hotelBtn.y),this.picatownBtn.on(String(s.ClickEvent.Tap),this.onPicatownHandler,this),this.add(this.picatownBtn)},PicaPartyNavigationPanel.prototype.refreshMask=function(){this.mGameGrid.resetMask()},PicaPartyNavigationPanel.prototype.setHandler=function(t){this.sendHandler=t},PicaPartyNavigationPanel.prototype.setPartyDataList=function(t){this.partyData=t,t.party.length>0?(this.mGameGrid.setItems(t.party),this.mGameGrid.visible=!0,this.noPartyText.visible=!1,this.noPartyImg.visible=!1):(this.noPartyText.visible=!0,this.noPartyImg.visible=!0,this.mGameGrid.visible=!1)},PicaPartyNavigationPanel.prototype.setSignProgress=function(t){this.progressData=t,this.signProgressPanel.setProgressDatas(t)},PicaPartyNavigationPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaPartyNavigationPanel.prototype.onGridTableHandler=function(t){this.onSendHandler(t.partyData)},PicaPartyNavigationPanel.prototype.onHotelHandler=function(){this.partyData&&this.sendHandler&&this.sendHandler.runWith(["hotel",this.partyData.hotel])},PicaPartyNavigationPanel.prototype.onPicatownHandler=function(){this.partyData&&this.sendHandler&&this.sendHandler.runWith(["pictown",this.partyData.picatown])},PicaPartyNavigationPanel.prototype.onSendHandler=function(t){this.sendHandler&&this.sendHandler.runWith(["partylist",t])},PicaPartyNavigationPanel.prototype.onProgressHandler=function(t,e){if(this.progressData){var i=e.progressData;i.received||(i.targetValue<=this.progressData.currentProgressValue?this.emit("questreward",t):(this.itemtips.setItemData(i.rewards[0]),this.showItemTipsState(e)))}},PicaPartyNavigationPanel.prototype.showItemTipsState=function(t,e){void 0===e&&(e=0);var i=this.itemtips.x,n=this.itemtips.y;this.setTipsPosition(t,e),i!==this.itemtips.x||n!==this.itemtips.y?this.itemtips.setVisible(!0):this.itemtips.setVisible(!this.itemtips.visible)},PicaPartyNavigationPanel.prototype.setTipsPosition=function(t,e){void 0===e&&(e=0);for(var i=t.x,n=t.y,s=t;s.parentContainer!==this;)i+=s.parentContainer.x,n+=s.parentContainer.y,s=s.parentContainer;i-.5*this.itemtips.width<.5*-this.width?this.itemtips.x=.5*this.itemtips.width-.5*this.width+20*this.dpr:i+.5*this.itemtips.width>.5*this.width?this.itemtips.x=.5*this.width-.5*this.itemtips.width-20*this.dpr:this.itemtips.x=i,this.itemtips.y=n-.5*this.itemtips.height+10*this.dpr+e},PicaPartyNavigationPanel}(Phaser.GameObjects.Container),p=function(t){function PartyListItem(e,i,n){var a=t.call(this,e)||this;return a.key=i,a.dpr=n,a.bg=new s.NineSlicePatch(a.scene,0,0,254*n,40*n,a.key,"list_bg",{left:12*a.dpr,top:0*a.dpr,right:12*a.dpr,bottom:0*a.dpr}),a.add(a.bg),a.setSize(a.bg.width,a.bg.height),a.imagIcon=new r.DynamicImage(e,0,0),a.imagIcon.setTexture(a.key,"party_icon_1"),a.imagIcon.x=.5*-a.width+.5*a.imagIcon.width+8*n,a.imagIcon.y=.5*-a.height+.5*a.imagIcon.height+5*n,a.add(a.imagIcon),a.hotImageValue=new r.ImageBBCodeValue(e,30*n,10*n,i,"hot",n,{fontSize:9*n,color:"#FFDD00",fontFamily:h.Font.DEFULT_FONT,stroke:"#666666",strokeThickness:2*n}),a.hotImageValue.setOffset(-3*n,0),a.hotImageValue.x=.5*-a.width+.5*a.hotImageValue.width+8*n,a.hotImageValue.y=.5*a.height-.5*a.hotImageValue.height-5*n,a.add(a.hotImageValue),a.partyName=new s.BBCodeText(a.scene,.5*-a.width+45*n,.5*-a.height+5*n,"",{fontFamily:h.Font.DEFULT_FONT,fontSize:12*n,color:"#333333"}),a.partyName.setOrigin(0),a.add(a.partyName),a.partyOwnerName=new r.ImageBBCodeValue(e,50*n,20*n,i,"user",n,{fontFamily:h.Font.DEFULT_FONT,fontSize:11*n,color:"#333333"}),a.partyOwnerName.x=a.partyName.x+.5*a.partyOwnerName.width,a.partyOwnerName.y=a.partyName.y+25*n,a.add(a.partyOwnerName),a.playerCount=new r.ImageBBCodeValue(e,30*n,20*n,o.c.commonKey,"home_persons",n,{fontFamily:h.Font.DEFULT_FONT,fontSize:12*n,color:"#333333"}),a.playerCount.x=.5*a.width-35*n,a.add(a.playerCount),a}return l(PartyListItem,t),PartyListItem.prototype.setPartyData=function(t){this.partyData=t;var e=t.topic.display.texturePath,i=e.lastIndexOf("/"),n=e.slice(i+1,e.length),s=e.slice(0,i+1),r=h.Url.getOsdRes(s+n+"_s_"+this.dpr+"x.png");this.imagIcon.load(r),this.hotImageValue.setText(this.getHotText(t.focus)),this.partyName.text="[b]"+t.name+"[/b]",this.playerCount.setText("[b]"+t.playerCount+"[/b]"),this.partyOwnerName.setText(t.ownerName)},PartyListItem.prototype.getHotText=function(t){var e=t+"";return"en"===h.i18n.language?e.length>=4&&e.length<7?e=Math.floor(t/100)/10+h.i18n.t("quantityunit.k"):e.length>=7&&(e=Math.floor(t/1e5)/10+h.i18n.t("quantityunit.m")):e=a.ChineseUnit.getChineseUnit(t,1),"[stroke]"+e+" [/stroke]"},PartyListItem}(Phaser.GameObjects.Container),d=function(t){function SignProgressPanel(e,i,n,r,o){var a=t.call(this,e)||this;a.progressItems=[],a.setSize(i,n),a.dpr=o,a.key=r;var l={x:0*o/2,y:15*o,width:218*o,height:11*o,background:{x:0,y:0,width:251*o,height:11*o,config:{top:0*o,left:7*o,right:7*o,bottom:0*o},key:r,frame:"order_progress_bottom"},bar:{x:0,y:0,width:251*o,height:11*o,config:{top:0*o,left:7*o,right:7*o,bottom:0*o},key:r,frame:"order_progress_top"},dpr:o,textConfig:void 0};return a.progress=new s.ProgressBar(e,l),a.add(a.progress),a.text=e.make.text({x:a.width/2,y:.5*-a.height+11*o,text:"",style:{color:"#6666FF",fontSize:13*o,fontFamily:h.Font.DEFULT_FONT}}),a.text.setOrigin(1,.5),a.add(a.text),a}return l(SignProgressPanel,t),SignProgressPanel.prototype.setProgressDatas=function(t){for(var e=t.steps.length,i=100,n=this.progress.width,s=0,r=0;r<e;r++){var o=t.steps[r],a=void 0;r<this.progressItems.length?a=this.progressItems[r]:(a=new m(this.scene,0,0,this.key,this.dpr),this.add(a),this.progressItems.push(a),a.setHandler(this.receiveHandler)),a.x=.5*-n+(e>1?n*r/(e-1):.5*n),a.y=15*this.dpr,a.setItemData(o,r,t.currentProgressValue),i=o.targetValue,o.targetValue>t.currentProgressValue&&0===s&&(s=o.targetValue)}this.progress.setProgress(t.currentProgressValue,i),this.initCountDown(s-t.currentProgressValue,i===s)},SignProgressPanel.prototype.setHandler=function(t){this.receiveHandler=t},SignProgressPanel.prototype.destroy=function(){clearInterval(this.timerID),t.prototype.destroy.call(this)},SignProgressPanel.prototype.initCountDown=function(t,e){var i=this;this.timerID&&(clearTimeout(this.timerID),this.timerID=void 0);var timeextu=function(){var e=Math.floor(t/60),n=t%60,s=(e<10?"0"+e:e+"")+":"+(n<10?"0"+n:n+"");i.text.text=h.i18n.t("party.progresstips",{timer:s}),--t>0?i.timerID=setTimeout((function(){timeextu()}),1e3):(i.text.text="",i.timerID=void 0)};timeextu()},SignProgressPanel}(Phaser.GameObjects.Container),m=function(t){function SignProgressItem(e,i,n,o,a){var l=t.call(this,e,i,n)||this;return l.dpr=a,l.key=o,l.bg=new s.Button(e,o,"order_progress_unfinished","order_progress_unfinished"),l.icon=new r.DynamicImage(e,0,0),l.text=e.make.text({x:2*a,y:.5*-l.bg.height-8*a,text:"10",style:{color:"#FFDD00",fontSize:13*a,fontFamily:h.Font.DEFULT_FONT}}),l.text.setStroke("#905B06",2*a).setOrigin(.5),l.finishIcon=e.make.image({key:o,frame:"order_progress_ok"}),l.finishIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.balckgraphic=e.make.graphics(void 0,!1),l.balckgraphic.clear(),l.balckgraphic.fillStyle(0,.5),l.balckgraphic.fillCircle(0,0,16*a),l.add([l.bg,l.icon,l.text,l.balckgraphic,l.finishIcon]),l.finishIcon.visible=!1,l}return l(SignProgressItem,t),SignProgressItem.prototype.setItemData=function(t,e,i){var n=this;if(this.progressData=t,this.index=e,this.text.text=0===e?h.i18n.t("common.sign"):h.i18n.t("party.onlinetime",{name:Math.floor(t.targetValue/60)}),this.text.visible=0===e,t.rewards&&t.rewards.length>0){var r=h.Url.getOsdRes(t.rewards[0].display.texturePath);this.icon.load(r,this,(function(){n.icon.scale=1,n.icon.scaleY=29*n.dpr/n.icon.displayHeight,n.icon.scaleX=n.icon.scaleY}))}this.finishIcon.visible=!1,this.balckgraphic.visible=!1,t.targetValue<=i?(this.bg.setFrameNormal("order_progress_finished","order_progress_finished"),t.received&&(this.finishIcon.visible=!0,this.balckgraphic.visible=!0),this.icon.clearTint()):(this.bg.setFrameNormal("order_progress_unfinished","order_progress_unfinished"),this.icon.setTint(9145210)),t.received?this.bg.off(String(s.ClickEvent.Tap),this.onReceiveHandler,this):(this.bg.off(String(s.ClickEvent.Tap),this.onReceiveHandler,this),this.bg.on(String(s.ClickEvent.Tap),this.onReceiveHandler,this))},SignProgressItem.prototype.setHandler=function(t){this.receiveHandler=t},SignProgressItem.prototype.onReceiveHandler=function(){this.receiveHandler&&this.receiveHandler.runWith([this.index,this])},SignProgressItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function LocalStorageManager(){}return LocalStorageManager.prototype.setItem=function(t,e){localStorage.setItem(t,e)},LocalStorageManager.prototype.removeItem=function(t){localStorage.removeItem(t)},LocalStorageManager.prototype.getItem=function(t){return localStorage.getItem(t)},LocalStorageManager.prototype.clear=function(){localStorage.clear()},LocalStorageManager.prototype.destroy=function(){this.clear()},LocalStorageManager}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return w}));var n,s,r=i(1),o=i(0),a=i(600),h=i(143),l=i(602),c=i(474),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function DecorateManager(e,i){var n=t.call(this)||this;return n.render=i,n.mSelecting=!1,n.mDisplayManager=n.render.displayManager,n.mDpr=n.render.scaleRatio,n}return p(DecorateManager,t),DecorateManager.prototype.setElement=function(t){this.mSelectorElement=this.mDisplayManager.getDisplay(t),this.mediator.setElement(t,!0),this.mSelecting=!0},DecorateManager.prototype.moveElement=function(t){if(this.mSelectorElement&&t){var e=this.mediator,i=t.worldX/this.mDpr,n=t.worldY/this.mDpr;e.moveElement(i,n)}},DecorateManager.prototype.isDragging=function(){return this.mSelectorElement&&this.mSelecting},Object.defineProperty(DecorateManager.prototype,"mediator",{get:function(){return this.render.mainPeer[r.ModuleName.PICADECORATE_NAME]},enumerable:!1,configurable:!0}),Object.defineProperty(DecorateManager.prototype,"selecting",{get:function(){return this.mSelecting},set:function(t){this.mSelecting=t},enumerable:!1,configurable:!0}),DecorateManager}(Phaser.Events.EventEmitter),m=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),u=function(t){function DecorateScene(e){return t.call(this,e||{key:r.SceneName.DECORATE_SCENE})||this}return m(DecorateScene,t),DecorateScene.prototype.initListener=function(){this.input.on("pointerup",this.onPointerUpHandler,this),this.input.on("pointerdown",this.onPointerDownHandler,this),this.input.on("gameobjectdown",this.onGameobjectDownHandler,this)},DecorateScene.prototype.initInput=function(){this.mDecorateManager=new d(this,this.render)},DecorateScene.prototype.onGameobjectDownHandler=function(t,e){if(e){var i=e.getData("id");i&&this.mDecorateManager.setElement(i)}},DecorateScene.prototype.onPointerUpHandler=function(e){t.prototype.onPointerUpHandler.call(this,e),this.mDecorateManager.selecting=!1},DecorateScene.prototype.onGameobjectUpHandler=function(t){this.removePointerMoveHandler(),this.mDecorateManager.selecting=!1},DecorateScene.prototype.onPointerMoveHandler=function(t){this.mDecorateManager.isDragging()?t.downX===t.x&&t.downY===t.y||this.mDecorateManager.moveElement(t):this.render.camerasManager.offsetScroll(t.prevPosition.x-t.position.x,t.prevPosition.y-t.position.y)},DecorateScene}(c.a),y=i(613),f=i(614),g=i(615),P=i(537),v=i(77),b=i(531),_=i(616),k=i(325),w=function(){function SceneManager(t){this.render=t,this.sceneClass={BasicScene:h.a,CreateRoleScene:l.a,GamePauseScene:y.a,LoadingScene:f.a,LoginAccountScene:g.a,LoginScene:P.a,MainUIScene:v.a,PlayScene:c.a,RoomScene:b.a,SelectRoleScene:_.a,SkyBoxScene:k.a,DecorateScene:u},this.render.exportProperty(this,this.render,r.ModuleName.SCENEMANAGER_NAME).onceReady((function(){}))}return Object.defineProperty(SceneManager.prototype,"currentScene",{get:function(){var t=this.render.game.scene;return t?t.getScene(this.mCurSceneName):null},enumerable:!1,configurable:!0}),SceneManager.prototype.resize=function(t,e){var i=this.render.game.scene;if(!i)return null;var n=this.render.scaleRatio,s=i.getScene("PlayScene");s&&s.setScale(n);var r=i.getScene("MainUIScene");r&&r.setScale(n)},SceneManager.prototype.getSceneByName=function(t){if(this.render&&this.render.game)return this.render.game.scene.getScene(t)},SceneManager.prototype.showProgress=function(t){var e=this.render.game.scene;if(e){var i=e.getScene("LoadingScene");if(i&&i.scene.isActive){t*=100;var n=o.StringUtils.format("正在加载资源 {0}",[t.toFixed(0)+"%"]);i.updateProgress(n)}}},SceneManager.prototype.startScene=function(t,e){var i=this.render.game.scene;if(e||(e={render:this.render}),i&&this.sceneClass.hasOwnProperty(t)){if(e.render=this.render,void 0!==e.state)switch(e.state){case r.LoadState.ENTERWORLD:e.text=a.c.enterWorld();break;case r.LoadState.DOWNLOADGAMECONFIG:e.text=a.c.downloadGameConfig();break;case r.LoadState.DOWNLOADSCENECONFIG:e.text=a.c.downloadSceneConfig();break;case r.LoadState.LOADINGRESOURCES:e.text=a.c.loadingResources();break;case r.LoadState.LOGINGAME:e.text=a.c.loginGame();break;case r.LoadState.PARSECONFIG:e.text=a.c.parseConfig();break;case r.LoadState.WAITENTERROOM:e.text=a.c.waitEnterRoom();break;case r.LoadState.CREATESCENE:e.text=a.c.createScene()}var n=i.getScene(t);if(n)n.scene.isActive(t)?n.updateProgress(e.text):n.wake(e),e.callBack&&e.callBack();else this.render.emitter.once("sceneCreated",(function(){o.Logger.getInstance().debug("sceneCreated===scenemanager"),e.callBack&&e.callBack()}),this),i.add(t,this.sceneClass[t]),i.start(t,e);this.mCurSceneName=t}},SceneManager.prototype.launchScene=function(t,e,i){var n=this.render.game.scene;if(i||(i={render:this.render}),n&&this.sceneClass.hasOwnProperty(e)){i.render=this.render;var s=n.getScene(e);this.render.emitter.once("sceneCreated",(function(){i.callBack&&i.callBack()}),this),s||n.add(e,this.sceneClass[e]),t.scene.launch(e,i)}},SceneManager.prototype.stopScene=function(t){var e=this.render.game.scene;if(!e)return Promise.reject("start faild. SceneManager does not exist");if(!this.sceneClass.hasOwnProperty(t))return Promise.reject("className error: "+t);var i=e.getScene(t);i&&(i.stop(),this.render.game.scene.remove(t))},SceneManager.prototype.wakeScene=function(t,e){var i=this.render.game.scene;if(!i)return Promise.reject("start faild. SceneManager does not exist");if(!this.sceneClass.hasOwnProperty(t))return Promise.reject("className error: "+t);var n=i.getScene(t);n&&n.wake(e)},SceneManager.prototype.sleepScene=function(t){if(this.render.game.scene.getScene(t)){var e=this.render.game.scene.getScene(t);e.scene.isActive(t)&&e.sleep()}else o.Logger.getInstance().debug(t+"sleep faild")},SceneManager.prototype.pauseScene=function(t){var e=this.render.game.scene.getScene(t);e?e.scene.pause(t):o.Logger.getInstance().error("scene not found : ",t)},SceneManager.prototype.resumeScene=function(t){var e=this.render.game.scene.getScene(t);e?e.scene.resume(t):o.Logger.getInstance().error("scene not found : ",t)},SceneManager.prototype.remove=function(t){this.render.game.scene.remove(t)},SceneManager.prototype.isActive=function(t){return!!this.render.game.scene.getScene(t)&&this.render.game.scene.getScene(t).scene.isActive()},SceneManager.prototype.destroy=function(){this.mCurSceneName&&(this.mCurSceneName=void 0),this.render&&this.render.hasOwnProperty(r.ModuleName.SCENEMANAGER_NAME)&&delete this.render[r.ModuleName.SCENEMANAGER_NAME],this.mMainScene=void 0},SceneManager.prototype.setMainScene=function(t){this.mMainScene=t},SceneManager.prototype.getMainScene=function(){return this.mMainScene},SceneManager.prototype.updateInput=function(t){this.render.game.scene.getScenes().map((function(e){return e.input.enabled=t!==s.Disable}))},SceneManager.prototype.sceneCallback=function(t){return Promise.resolve()},SceneManager}();!function(t){t[t.Disable=0]="Disable",t[t.Mouse=1]="Mouse",t[t.Keyboard=2]="Keyboard",t[t.All=3]="All"}(s||(s={}))},function(t,e,i){"use strict";i.r(e),function(t){i.d(e,"Render",(function(){return I}));var n,s,r=i(344),o=(i(431),i(6)),a=i(0),h=i(3),l=i(601),c=i(622),p=i(537),d=i(621),m=i(474),u=i(536),y=i(86),f=i(1),g=i(599),P=i(610),v=i(2),b=i(475),_=i(483),k=i(644),w=i(73),x=i.n(w),T=i(606),C=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__decorate=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o},__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function fulfilled(t){try{step(n.next(t))}catch(t){r(t)}}function rejected(t){try{step(n.throw(t))}catch(t){r(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function verb(r){return function(a){return function step(r){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(s=2&r[0]?n.return:r[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,r[1])).done)return s;switch(n=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],n=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};for(var S in v)h.PBpacket.addProtocol(v[S]);!function(t){t[t.DIRECTION_MOVE_STYLE=1]="DIRECTION_MOVE_STYLE",t[t.FOLLOW_MOUSE_MOVE_STYLE=2]="FOLLOW_MOUSE_MOVE_STYLE",t[t.PATH_MOVE_STYLE=3]="PATH_MOVE_STYLE"}(s||(s={}));var I=function(e){function Render(t,i){var n=e.call(this,f.RENDER_PEER)||this;return n.isConnect=!1,n.DEFAULT_WIDTH=360,n.DEFAULT_HEIGHT=640,n._moveStyle=0,n.isPause=!1,n.emitter=new Phaser.Events.EventEmitter,n.mConfig=t,n.mCallBack=i,n.gridsDebugger=T.GridsDebugger.getInstance(),n.astarDebugger=T.AstarDebugger.getInstance(),n.mConnectFailFunc=n.mConfig.connectFail,n.mConfig.hasConnectFail=!!n.mConnectFailFunc,n.mConfig.hasCloseGame=!!n.mConfig.closeGame,n.mConfig.hasGameCreated=!!n.mConfig.game_created,n.mConfig.hasReload=!!n.mConfig.reload,delete n.mConfig.connectFail,delete n.mConfig.game_created,delete n.mConfig.closeGame,n.initConfig(),a.Logger.getInstance().log("Render version ====>:","v"+x.a),n.linkTo(f.MAIN_WORKER,f.MAIN_WORKER_URL).onceReady((function(){n.mMainPeer=n.remote[f.MAIN_WORKER].MainPeer,n.mMainPeer.updateFps(),n.createGame(),a.Logger.getInstance().debug("worker onReady")})),n.linkTo(f.PHYSICAL_WORKER,f.PHYSICAL_WORKER_URL).onceReady((function(){n.mPhysicalPeer=n.remote[f.PHYSICAL_WORKER].PhysicalPeer,n.mPhysicalPeer.setScaleRatio(Math.ceil(n.mConfig.devicePixelRatio||1)),n.mPhysicalPeer.start(),a.Logger.getInstance().debug("Physcialworker onReady")})),n}return C(Render,e),Object.defineProperty(Render.prototype,"physicalPeer",{get:function(){return this.mPhysicalPeer},enumerable:!1,configurable:!0}),Render.prototype.setKeyBoardHeight=function(t){throw new Error("Method not implemented.")},Object.defineProperty(Render.prototype,"config",{get:function(){return this.mConfig},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"uiRatio",{get:function(){return this.mUIRatio},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"uiScale",{get:function(){return this.mUIScale},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"scaleRatio",{get:function(){return this.mScaleRatio},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"account",{get:function(){return this.mAccount},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"uiManager",{get:function(){return this.mUiManager},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"sceneManager",{get:function(){return this.mSceneManager},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"camerasManager",{get:function(){return this.mCameraManager},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"displayManager",{get:function(){return this.mDisplayManager},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"localStorageManager",{get:function(){return this.mLocalStorageManager},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"editorCanvasManager",{get:function(){return this.mEditorCanvasManager},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"game",{get:function(){return this.mGame},enumerable:!1,configurable:!0}),Render.prototype.getSize=function(){if(this.mGame)return this.mGame.scale.gameSize},Render.prototype.createGame=function(){var t=this;this.newGame().then((function(){t.createManager(),t.remote[f.MAIN_WORKER].MainPeer.createGame(t.mConfig)}))},Render.prototype.createManager=function(){this.mUiManager||(this.mUiManager=new b.e(this)),this.mCameraManager||(this.mCameraManager=new u.a(this)),this.mLocalStorageManager||(this.mLocalStorageManager=new d.a),this.mSceneManager||(this.mSceneManager=new c.a(this)),this.mInputManager||(this.mInputManager=new P.a(this)),this.mDisplayManager||(this.mDisplayManager=new g.a(this)),this.mEditorCanvasManager||(this.mEditorCanvasManager=new k.a(this))},Render.prototype.destroyManager=function(){this.mUiManager&&(this.mUiManager.destroy(),this.mUiManager=void 0),this.mCameraManager&&(this.mCameraManager.destroy(),this.mCameraManager=void 0),this.mSceneManager&&(this.mSceneManager.destroy(),this.mSceneManager=void 0),this.mInputManager&&(this.mInputManager.destroy(),this.mInputManager=void 0),this.mDisplayManager&&(this.mDisplayManager.destroy(),this.mDisplayManager=void 0),this.mEditorCanvasManager&&(this.mEditorCanvasManager.destroy(),this.mEditorCanvasManager=void 0)},Render.prototype.clearManager=function(){this.mUiManager&&this.mUiManager.destroy(),this.mCameraManager&&this.mCameraManager.destroy(),this.mSceneManager&&this.mSceneManager.destroy(),this.mInputManager&&this.mInputManager.destroy(),this.mDisplayManager&&this.mDisplayManager.destroy()},Render.prototype.enterGame=function(){this.remote[f.MAIN_WORKER].MainPeer.loginEnterWorld(),this.mGame.scene.remove(p.a.name)},Render.prototype.resize=function(t,e){var i=this.uiManager.getPanel(f.ModuleName.BOTTOM);if(i){var n=this.game.domContainer.getElementsByTagName("input");if(n&&n.length>0){for(var s=0;s<n.length;s++)if(window.document.activeElement===n[s])return void i.showKeyboard(t*this.mConfig.devicePixelRatio,e*this.mConfig.devicePixelRatio);i.hideKeyboard()}}this.mConfig&&(this.mConfig.width=t,this.mConfig.height=e);var r=t*this.mConfig.devicePixelRatio,o=e*this.mConfig.devicePixelRatio;this.mScaleRatio=Math.ceil(this.mConfig.devicePixelRatio||1),this.mConfig.scale_ratio=this.mScaleRatio,this.mUIRatio=Math.round(this.mConfig.devicePixelRatio||1);var a=t/this.DEFAULT_WIDTH*(this.mConfig.devicePixelRatio/this.mUIRatio);if(this.mUIScale=this.game.device.os.desktop?1:a,this.mGame){this.mGame.scale.zoom=1/this.mConfig.devicePixelRatio,this.mGame.scale.resize(r,o);for(var h=0,l=this.mGame.scene.scenes;h<l.length;h++){var c=l[h].cameras.main;c&&c.setPixelRatio&&c.setPixelRatio(this.mScaleRatio)}}this.mUiManager&&this.mUiManager.resize(r,o),this.mInputManager&&this.mInputManager.resize(r,o),this.mDisplayManager&&this.mDisplayManager.resize(r,o),this.mCameraManager&&this.mCameraManager.resize(t,e)},Render.prototype.onOrientationChange=function(t,e,i){},Render.prototype.scaleChange=function(t){},Render.prototype.enableClick=function(){},Render.prototype.disableClick=function(){},Render.prototype.keyboardDidShow=function(t){var e=this.uiManager.getPanel(f.ModuleName.BOTTOM),i=this.mConfig.width,n=this.mConfig.height-t;e&&e.showKeyboard(i*this.mConfig.devicePixelRatio,n*this.mConfig.devicePixelRatio)},Render.prototype.keyboardDidHide=function(){var t=this.uiManager.getPanel(f.ModuleName.BOTTOM);t&&t.hideKeyboard()},Render.prototype.startFullscreen=function(){},Render.prototype.stopFullscreen=function(){},Render.prototype.setGameConfig=function(t){},Render.prototype.updatePalette=function(t){this.mainPeer.updatePalette(t)},Render.prototype.updateMoss=function(t){this.mainPeer.updateMoss(t)},Render.prototype.restart=function(t,e){},Render.prototype.initUI=function(){this.remote[f.MAIN_WORKER].MainPeer.initUI()},Render.prototype.startRoomPlay=function(){this.remote[f.MAIN_WORKER].MainPeer.startRoomPlay()},Render.prototype.updateRoom=function(t,e){this.mInputManager.update(t,e),this.mDisplayManager.update(t,e)},Render.prototype.destroy=function(){var t=this;return this.mainPeer.destroy(),this.physicalPeer.destroy(),new Promise((function(i,n){t.mGame?(t.destroyManager(),t.mGame.events.off(Phaser.Core.Events.FOCUS,t.onFocus,t),t.mGame.events.off(Phaser.Core.Events.BLUR,t.onBlur,t),t.mGame.scale.off("enterfullscreen",t.onFullScreenChange,t),t.mGame.scale.off("leavefullscreen",t.onFullScreenChange,t),t.mGame.scale.off("orientationchange",t.onOrientationChange,t),t.mGame.plugins.removeGlobalPlugin("rexButton"),t.mGame.plugins.removeGlobalPlugin("rexNinePatchPlugin"),t.mGame.plugins.removeGlobalPlugin("rexInputText"),t.mGame.plugins.removeGlobalPlugin("rexBBCodeTextPlugin"),t.mGame.plugins.removeGlobalPlugin("rexMoveTo"),t.mGame.plugins.removeScenePlugin("DragonBones"),t.mGame.events.once(Phaser.Core.Events.DESTROY,(function(){t.mGame=void 0,e.prototype.destroy.call(t),i()})),t.mGame.destroy(!0)):(e.prototype.destroy.call(t),i())}))},Object.defineProperty(Render.prototype,"curTime",{get:function(){return this._curTime},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"moveStyle",{get:function(){return this._moveStyle},enumerable:!1,configurable:!0}),Render.prototype.initGameConfig=function(t){this.remote[f.MAIN_WORKER].MainPeer.initGameConfig(JSON.stringify(t))},Render.prototype.newGame=function(){var t=this;return new Promise((function(e,i){t.mGame&&e(!0),t.gameConfig={type:Phaser.AUTO,parent:t.mConfig.parent,loader:{timeout:300},disableContextMenu:!0,transparent:!1,backgroundColor:0,resolution:1,fps:{target:45,forceSetTimeOut:!0},dom:{createContainer:!0},plugins:{scene:[{key:"DragonBones",plugin:dragonBones.phaser.plugin.DragonBonesScenePlugin,mapping:"dragonbone"}]},render:{pixelArt:!0,roundPixels:!0},scale:{mode:Phaser.Scale.NONE,width:t.mConfig.width*window.devicePixelRatio,height:t.mConfig.height*window.devicePixelRatio,zoom:1/window.devicePixelRatio}},Object.assign(t.gameConfig,t.mConfig),t.mGame=new r.Game(t.gameConfig),t.mGame.input.mouse.capture=!0,t.mGame.device.os.desktop?(t.mUIScale=1,t.mConfig.platform="pc"):t.mConfig.platform="nopc",e(!0)}))},Render.prototype.closeConnect=function(t){this.mainPeer.closeConnect(t)},Render.prototype.send=function(t){this.mainPeer.send(t.Serialization)},Render.prototype.terminate=function(){this.mainPeer.terminate()},Render.prototype.changeScene=function(t){this.mInputManager&&this.mInputManager.setScene(t)},Render.prototype.onFocus=function(){this.resumeScene()},Render.prototype.onBlur=function(){this.pauseScene()},Render.prototype.syncClock=function(t){this.mainPeer.syncClock(t)},Render.prototype.clearClock=function(){this.mainPeer.clearClock()},Render.prototype.destroyClock=function(){this.mainPeer.destroyClock()},Render.prototype.exitUser=function(){this.mainPeer.exitUser()},Render.prototype.requestCurTime=function(){this.mainPeer.requestCurTime()},Render.prototype.setDirection=function(t,e){this.mainPeer.setDirection(t,e)},Render.prototype.onLoginErrorHanlerCallBack=function(t,e){},Render.prototype.onShowErrorHandlerCallBack=function(t,e){},Render.prototype.getCurrentRoomSize=function(){return this.mainPeer.getCurrentRoomSize()},Render.prototype.getCurrentRoomMiniSize=function(){return this.mainPeer.getCurrentRoomMiniSize()},Render.prototype.syncCameraScroll=function(){this.mMainPeer&&this.mMainPeer.syncCameraScroll()},Render.prototype.renderEmitter=function(t,e){this.mMainPeer&&this.mMainPeer.renderEmitter(t,e)},Render.prototype.renderToPhysicalEmitter=function(t,e){this.physicalPeer&&this.physicalPeer.renderEmitter(t,e)},Render.prototype.showMediator=function(t,e){this.mMainPeer&&this.mMainPeer.showMediator(t,e)},Render.prototype.getMainScene=function(){return this.mSceneManager.getMainScene()},Render.prototype.destroyAccount=function(){return __awaiter(this,void 0,void 0,(function(){var t=this;return __generator(this,(function(e){return[2,new Promise((function(e,i){t.mAccount&&t.mAccount.destroy(),e()}))]}))}))},Render.prototype.reconnect=function(){this.createGame()},Render.prototype.showLogin=function(){this.sceneManager&&this.mSceneManager.startScene(f.SceneName.LOGIN_SCENE,this)},Render.prototype.hideLogin=function(){this.sceneManager&&this.sceneManager.stopScene(f.SceneName.LOGIN_SCENE)},Render.prototype.showCreateRolePanel=function(t){var e=this;return new Promise((function(i,n){var createPanel=function(){e.mUiManager.showPanel(f.ModuleName.PICACREATEROLE_NAME,t).then((function(t){t?t.addExportListener((function(){i(!0)})):n(!1)}))};e.mUiManager.scene&&e.mUiManager.scene.scene.key===f.SceneName.CREATE_ROLE_SCENE?createPanel():e.mSceneManager.startScene(f.SceneName.CREATE_ROLE_SCENE,{callBack:function(){createPanel()}})}))},Render.prototype.updateModel=function(t,e){this.displayManager&&this.displayManager.updateModel(t,e)},Render.prototype.showCreateRole=function(t){this.mSceneManager&&this.mSceneManager.startScene(f.SceneName.CREATE_ROLE_SCENE,{render:this,params:t})},Render.prototype.hideCreateRole=function(){this.mSceneManager&&this.mSceneManager.stopScene(f.SceneName.CREATE_ROLE_SCENE)},Render.prototype.showPlay=function(t){this.mSceneManager&&this.mSceneManager.startScene(f.SceneName.PLAY_SCENE,{render:this,params:t})},Render.prototype.updateFPS=function(){if(this.game){var t=this.game.scene.getScene(f.SceneName.MAINUI_SCENE);t&&t.scene.isVisible&&t.scene.isActive&&t.scene.isPaused&&t.updateFPS()}},Render.prototype.endFPS=function(){},Render.prototype.hidePlay=function(){this.mSceneManager&&this.mSceneManager.stopScene(f.SceneName.PLAY_SCENE)},Render.prototype.showPanel=function(t,e){var i=this;return new Promise((function(n,s){i.mUiManager.showPanel(t,e).then((function(t){t?t.addExportListener((function(){n(!0)})):s(!1)}))}))},Render.prototype.hidePanel=function(t){this.mUiManager&&this.mUiManager.hidePanel(t)},Render.prototype.reload=function(){a.Logger.getInstance().log("game relaod =====>"),window.location.reload()},Render.prototype.showJoystick=function(){this.mInputManager&&this.mInputManager.showJoystick()},Render.prototype.setInputVisible=function(t){},Render.prototype.setLoginEnable=function(t){},Render.prototype.onShowVerified=function(){},Render.prototype.setVerifiedEnable=function(t){},Render.prototype.onShowErrorHandler=function(t,e){this.onShowErrorHandlerCallBack(t,e)},Render.prototype.onLoginErrorHanler=function(t,e){this.onLoginErrorHanlerCallBack(t,e)},Render.prototype.updateCharacterPackage=function(){this.emitter.emit(f.MessageType.UPDATED_CHARACTER_PACKAGE)},Render.prototype.displayReady=function(t,e){var i=this.mDisplayManager.getDisplay(t);i&&e&&(i.play(e),i.showNickname())},Render.prototype.soundChangeRoom=function(t){},Render.prototype.playSound=function(t){},Render.prototype.onConnected=function(){this.isConnect=!0},Render.prototype.onDisConnected=function(){this.isConnect=!1},Render.prototype.onConnectError=function(t){this.isConnect=!1},Render.prototype.connectFail=function(){this.isConnect=!1,this.mConnectFailFunc&&this.mConnectFailFunc()},Render.prototype.updateUIState=function(t,e){this.uiManager.updateUIState(t,e)},Render.prototype.setMoveStyle=function(t){this._moveStyle=t},Render.prototype.onEnterRoom=function(t){},Render.prototype.scaleTween=function(t,e){},Render.prototype.getRenderPosition=function(t,e){return[]},Render.prototype.createAccount=function(t,e,i,n,s,r){var o=this;return new Promise((function(h,c){o.mAccount||(o.mAccount=new l.a);var p=(new Date).getTime();a.Logger.getInstance().debug("createAccount ====>",p),o.exportProperty(o.mAccount,o,f.ModuleName.ACCOUNT_NAME).onceReady((function(){a.Logger.getInstance().debug("createAccountExport ====>",(new Date).getTime()-p),o.mAccount.enterGame(t,e,i,{locX:n,locY:s,locZ:r}),h(!0)}))}))},Render.prototype.refreshAccount=function(t){this.account.refreshToken(t)},Render.prototype.getAccount=function(){return this.mAccount},Render.prototype.setAccount=function(t){this.mAccount.setAccount(t)},Render.prototype.getWorldView=function(){var t=this;if(this.sceneManager)return new Promise((function(e,i){var n=t.sceneManager.getMainScene();if(n){var s=n.cameras.main,r=s.worldView;e({x:r.x,y:r.y,width:s.width,height:s.height,zoom:s.zoom,scrollX:s.scrollX,scrollY:s.scrollY})}}))},Render.prototype.onClockReady=function(){},Render.prototype.showAlert=function(t,e){},Render.prototype.showLoading=function(t){var e=this;this.mSceneManager&&(t.callBack=function(){t.sceneName&&e.mSceneManager.startScene(t.sceneName)},t.dpr=this.uiRatio,this.mSceneManager.startScene(f.SceneName.LOADING_SCENE,t))},Render.prototype.updateProgress=function(t){t>1&&(t=1),t.toFixed(2),this.mSceneManager&&this.mSceneManager.showProgress(t)},Render.prototype.hideLoading=function(){this.mSceneManager&&this.mSceneManager.sleepScene(f.SceneName.LOADING_SCENE)},Render.prototype.onForceOfflineHandler=function(){this.uiManager.showAlertView(a.i18n.t("common.offline"),!0)},Render.prototype.loadStart=function(t,e){},Render.prototype.roomPause=function(t){},Render.prototype.roomResume=function(t){},Render.prototype.removeScene=function(t){this.sceneManager&&this.sceneManager.remove(t)},Render.prototype.showCreatePanelError=function(t){},Render.prototype.createSetNickName=function(t){},Render.prototype.renderReconnect=function(){},Render.prototype.createAnotherGame=function(t,e,i,n,s,r){a.Logger.getInstance().debug("gotoanothergame ====>"),this.account.enterGame(t,e,i,{x:n,y:s,z:r})},Render.prototype.setCamerasBounds=function(t,e,i,n){this.mCameraManager&&this.mCameraManager.setBounds(t,e,i,n)},Render.prototype.setCamerasScroll=function(t,e,i){this.mCameraManager&&this.mCameraManager.scrollTargetPoint(t,e,i)},Render.prototype.setInteractive=function(t,e){if(this.mDisplayManager){var i=this.mDisplayManager.getDisplay(t);i&&i.setInteractive()}},Render.prototype.disableInteractive=function(t,e){var i=this.mDisplayManager.getDisplay(t);i&&i.disableInteractive()},Render.prototype.fadeIn=function(t,e){},Render.prototype.fadeOut=function(t,e){},Render.prototype.fadeAlpha=function(t,e,i){},Render.prototype.getCurTime=function(t){return this._curTime=t},Render.prototype.createGameCallBack=function(t){this.mGame.events.on(Phaser.Core.Events.FOCUS,this.onFocus,this),this.mGame.events.on(Phaser.Core.Events.BLUR,this.onBlur,this),window.screen.width>window.screen.height?this.mConfig.width>this.mConfig.height?this.resize(this.mConfig.width,this.mConfig.height):this.resize(this.mConfig.height,this.mConfig.width):this.mConfig.width<this.mConfig.height?this.resize(this.mConfig.width,this.mConfig.height):this.resize(this.mConfig.height,this.mConfig.width),this.gameCreated(t)},Render.prototype.addFillEffect=function(t,e,i){this.displayManager.addFillEffect(t,e,i)},Render.prototype.clearRoom=function(){this.clearManager()},Render.prototype.clearGame=function(t){var e=this;return new Promise((function(i,n){e.mGame?(e.destroyManager(),e.mGame.events.off(Phaser.Core.Events.FOCUS,e.onFocus,e),e.mGame.events.off(Phaser.Core.Events.BLUR,e.onBlur,e),e.mGame.scale.off("enterfullscreen",e.onFullScreenChange,e),e.mGame.scale.off("leavefullscreen",e.onFullScreenChange,e),e.mGame.scale.off("orientationchange",e.onOrientationChange,e),e.mGame.plugins.removeGlobalPlugin("rexButton"),e.mGame.plugins.removeGlobalPlugin("rexNinePatchPlugin"),e.mGame.plugins.removeGlobalPlugin("rexInputText"),e.mGame.plugins.removeGlobalPlugin("rexBBCodeTextPlugin"),e.mGame.plugins.removeGlobalPlugin("rexMoveTo"),e.mGame.plugins.removeScenePlugin("DragonBones"),e.mGame.events.once(Phaser.Core.Events.DESTROY,(function(){e.mGame=void 0,t?e.newGame().then((function(){e.createManager(),i()})):i()})),e.mGame.destroy(!0)):i()}))},Render.prototype.getMessage=function(t){return a.i18n.t(t)},Render.prototype.setLocalStorage=function(t,e){this.localStorageManager&&this.localStorageManager.setItem(t,e)},Render.prototype.getLocalStorage=function(t){return this.localStorageManager?this.localStorageManager.getItem(t):""},Render.prototype.createPanel=function(t,e){var i=this;return new Promise((function(n,s){if(i.uiManager){var r=i.uiManager.showPanel(t);i.exportProperty(r,i,e).onceReady((function(){n(!0)}))}else s("uiManager not found")}))},Render.prototype.roomstartPlay=function(){if(this.mSceneManager&&this.mCameraManager){var t=this.mSceneManager.getMainScene();t?this.mCameraManager.camera=t.cameras.main:a.Logger.getInstance().fatal("scene does not exist")}},Render.prototype.drawGrids=function(t){this.displayManager&&this.displayManager.showGridsDebug(t)},Render.prototype.drawAstar_init=function(t,e){this.displayManager&&this.displayManager.showAstarDebug_init(t,e)},Render.prototype.drawAstar_update=function(t,e,i){this.displayManager&&this.displayManager.showAstarDebug_update(t,e,i)},Render.prototype.drawAstar_findPath=function(t,e,i){this.displayManager&&this.displayManager.showAstarDebug_findPath(t,e,i)},Render.prototype.roomReady=function(){if(this.mSceneManager&&this.mCameraManager){var t=this.mSceneManager.getMainScene();t?t instanceof m.a&&t.onRoomCreated():a.Logger.getInstance().fatal("scene does not exist")}},Render.prototype.playAnimation=function(t,e,i,n){if(this.mDisplayManager){var s=this.mDisplayManager.getDisplay(t);s&&s.play(e)}},Render.prototype.setCameraScroller=function(t,e){if(this.mSceneManager&&this.mCameraManager){var i=this.mSceneManager.getMainScene();if(i){var n=i.scale;this.mCameraManager.setScroll(t*this.scaleRatio-n.width/2,e*this.scaleRatio-n.height/2),this.syncCameraScroll()}else a.Logger.getInstance().fatal("scene does not exist")}},Render.prototype.createDragonBones=function(t,e,i){this.mDisplayManager&&this.mDisplayManager.addDragonbonesDisplay(t,e,i)},Render.prototype.createUserDragonBones=function(t,e){this.mDisplayManager&&this.mDisplayManager.addUserDragonbonesDisplay(t,!0,e)},Render.prototype.createFramesDisplay=function(t,e,i){this.mDisplayManager?this.mDisplayManager.addFramesDisplay(t,e,i):a.Logger.getInstance().debug("no displayManager ====>")},Render.prototype.createTerrainDisplay=function(t,e,i){this.mDisplayManager&&this.mDisplayManager.addTerrainDisplay(t,e,i)},Render.prototype.setModel=function(t){this.mDisplayManager&&this.mDisplayManager.setModel(t)},Render.prototype.updateDirection=function(t,e){this.mDisplayManager&&this.mDisplayManager.getDisplay(t).setDirection(e)},Render.prototype.addSkybox=function(t){this.mDisplayManager&&this.mDisplayManager.addSkybox(t)},Render.prototype.removeSkybox=function(t){this.mDisplayManager&&this.mDisplayManager.removeSkybox(t)},Render.prototype.showMatterDebug=function(t){this.mDisplayManager&&this.mDisplayManager.showMatterDebug(t)},Render.prototype.hideMatterDebug=function(){this.mDisplayManager&&this.mDisplayManager.hideMatterDebug()},Render.prototype.drawServerPosition=function(t,e){this.mDisplayManager&&this.mDisplayManager.drawServerPosition(t,e)},Render.prototype.changeAlpha=function(t,e){this.mDisplayManager&&this.mDisplayManager.changeAlpha(t,e)},Render.prototype.removeBlockObject=function(t){this.mDisplayManager&&this.mDisplayManager.removeDisplay(t)},Render.prototype.setPosition=function(t,e,i,n){if(this.mDisplayManager){var s=this.mDisplayManager.getDisplay(t);s&&s.setPosition(e,i,n)}},Render.prototype.showBubble=function(t,e,i){if(this.mDisplayManager){var n=this.mDisplayManager.getDisplay(t);n&&n.showBubble(e,i)}},Render.prototype.clearBubble=function(t){var e=this.mDisplayManager.getDisplay(t);e&&e.clearBubble()},Render.prototype.startFollow=function(t){var e=this.mDisplayManager.getDisplay(t);e&&this.mCameraManager.startFollow(e)},Render.prototype.stopFollow=function(){this.mCameraManager&&this.mCameraManager.stopFollow()},Render.prototype.cameraFollow=function(t,e){return __awaiter(this,void 0,void 0,(function(){var i;return __generator(this,(function(n){switch(n.label){case 0:return(i=this.mDisplayManager.getDisplay(t))?"liner"!==e?[3,2]:[4,this.mCameraManager.pan(i.x,i.y,i.y)]:[3,4];case 1:return n.sent(),this.mCameraManager.startFollow(i),[3,3];case 2:this.mCameraManager.startFollow(i),n.label=3;case 3:return[3,5];case 4:this.mCameraManager.stopFollow(),n.label=5;case 5:return[2]}}))}))},Render.prototype.cameraPan=function(t){var e=this.mDisplayManager.getDisplay(t);e&&this.mCameraManager.pan(e.x,e.y,300)},Render.prototype.updateSkyboxState=function(t){this.mDisplayManager&&this.mDisplayManager.updateSkyboxState(t)},Render.prototype.setLayerDepth=function(t){var e=this.mSceneManager.getMainScene();e?e.layerManager.depthSurfaceDirty=t:a.Logger.getInstance().fatal("scene does not exist")},Render.prototype.doMove=function(t,e){this.mDisplayManager&&this.mDisplayManager.displayDoMove(t,e)},Render.prototype.showNickname=function(t,e){this.mDisplayManager&&this.mDisplayManager.showNickname(t,e)},Render.prototype.showTopDisplay=function(t,e){this.mDisplayManager&&this.mDisplayManager.showTopDisplay(t,e)},Render.prototype.showRefernceArea=function(t,e,i){var n=this.mDisplayManager.getDisplay(t);n&&n.showRefernceArea(e,i)},Render.prototype.hideRefernceArea=function(t){var e=this.mDisplayManager.getDisplay(t);e&&e.hideRefernceArea()},Render.prototype.displayAnimationChange=function(t){var e=t.id,i=t.direction,n=this.mDisplayManager.getDisplay(e);n&&(n.direction=i,n.play(t.animation))},Render.prototype.workerEmitter=function(t,e){this.emitter.emit(t,e)},Render.prototype.physicalEmitter=function(t,e){this.emitter.emit(t,e)},Render.prototype.mount=function(t,e,i){this.mDisplayManager.mount(t,e,i)},Render.prototype.unmount=function(t,e){this.mDisplayManager.unmount(t,e)},Render.prototype.updateInput=function(t){this.sceneManager.updateInput(t)},Render.prototype.addEffect=function(t,e,i){this.mDisplayManager.addEffect(t,e,i)},Render.prototype.removeEffect=function(t){this.mDisplayManager.removeEffect(t)},Render.prototype.onFullScreenChange=function(){this.resize(this.mGame.scale.gameSize.width,this.mGame.scale.gameSize.height)},Render.prototype.gameCreated=function(t){this.mCallBack&&this.mCallBack(),this.mConfig.game_created&&this.mConfig.game_created(),this.mGame.scale.on("enterfullscreen",this.onFullScreenChange,this),this.mGame.scale.on("leavefullscreen",this.onFullScreenChange,this)},Render.prototype.initConfig=function(){this.mConfig.devicePixelRatio||(this.mConfig.devicePixelRatio=window.devicePixelRatio||1),void 0===this.mConfig.width&&(this.mConfig.width=window.innerWidth),void 0===this.mConfig.height&&(this.mConfig.height=window.innerHeight),this.mScaleRatio=Math.ceil(this.mConfig.devicePixelRatio||1),this.mConfig.scale_ratio=this.mScaleRatio,this.mUIRatio=Math.round(this.mConfig.devicePixelRatio||1),this.mUIScale=this.mConfig.width/this.DEFAULT_WIDTH*(this.mConfig.devicePixelRatio/this.mUIRatio),a.Url.OSD_PATH=this.mConfig.osd,a.Url.RES_PATH="./resources_v"+x.a+"/",a.Url.RESUI_PATH=a.Url.RES_PATH+"ui/",Object(a.initLocales)(y.relative(t,"../"+a.Url.RES_PATH+"/locales/{{lng}}.json"))},Render.prototype.resumeScene=function(){if(a.Logger.getInstance().debug("#BlackSceneFromBackground; world.resumeScene(); isPause:"+this.isPause+"; mGame:"+this.mGame),this.isPause&&(this.isPause=!1,this.mGame)){this.sceneManager.currentScene&&this.sceneManager.currentScene.scene.resume(),this.mainPeer.onFocus();var t=this.mGame.scene.getScene(_.b.name);t&&(t.sleep(),this.mGame.scene.stop(_.b.name))}},Render.prototype.pauseScene=function(){a.Logger.getInstance().debug("#BlackSceneFromBackground; world.pauseScene(); isPause:"+this.isPause+"; mGame:"+this.mGame),this.isPause||(this.isPause=!0,this.mGame&&(this.sceneManager.currentScene&&this.sceneManager.currentScene.scene.pause(),this.mainPeer.onBlur(),this.mGame.scene.getScene(_.b.name)||this.mGame.scene.add(_.b.name,_.b),this.mGame.scene.start(_.b.name,{render:this})))},Object.defineProperty(Render.prototype,"mainPeer",{get:function(){if(!this.mMainPeer)throw new Error("can't find main worker");return this.mMainPeer},enumerable:!1,configurable:!0}),__decorate([Object(o.Export)()],Render.prototype,"gridsDebugger",void 0),__decorate([Object(o.Export)()],Render.prototype,"astarDebugger",void 0),__decorate([Object(o.Export)()],Render.prototype,"destroyAccount",null),__decorate([Object(o.Export)()],Render.prototype,"reconnect",null),__decorate([Object(o.Export)()],Render.prototype,"showLogin",null),__decorate([Object(o.Export)()],Render.prototype,"hideLogin",null),__decorate([Object(o.Export)()],Render.prototype,"showCreateRolePanel",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"updateModel",null),__decorate([Object(o.Export)()],Render.prototype,"showCreateRole",null),__decorate([Object(o.Export)()],Render.prototype,"hideCreateRole",null),__decorate([Object(o.Export)()],Render.prototype,"showPlay",null),__decorate([Object(o.Export)()],Render.prototype,"updateFPS",null),__decorate([Object(o.Export)()],Render.prototype,"endFPS",null),__decorate([Object(o.Export)()],Render.prototype,"hidePlay",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str])],Render.prototype,"showPanel",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str])],Render.prototype,"hidePanel",null),__decorate([Object(o.Export)()],Render.prototype,"reload",null),__decorate([Object(o.Export)()],Render.prototype,"showJoystick",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.boolean])],Render.prototype,"setInputVisible",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.boolean])],Render.prototype,"setLoginEnable",null),__decorate([Object(o.Export)()],Render.prototype,"onShowVerified",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.boolean])],Render.prototype,"setVerifiedEnable",null),__decorate([Object(o.Export)()],Render.prototype,"onShowErrorHandler",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str])],Render.prototype,"onLoginErrorHanler",null),__decorate([Object(o.Export)()],Render.prototype,"updateCharacterPackage",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"displayReady",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"soundChangeRoom",null),__decorate([Object(o.Export)()],Render.prototype,"playSound",null),__decorate([Object(o.Export)()],Render.prototype,"onConnected",null),__decorate([Object(o.Export)()],Render.prototype,"onDisConnected",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str])],Render.prototype,"onConnectError",null),__decorate([Object(o.Export)()],Render.prototype,"connectFail",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str])],Render.prototype,"updateUIState",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"setMoveStyle",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.unit8array])],Render.prototype,"onEnterRoom",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"scaleTween",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"getRenderPosition",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str,o.webworker_rpc.ParamType.str])],Render.prototype,"createAccount",null),__decorate([Object(o.Export)()],Render.prototype,"refreshAccount",null),__decorate([Object(o.Export)()],Render.prototype,"getAccount",null),__decorate([Object(o.Export)()],Render.prototype,"setAccount",null),__decorate([Object(o.Export)()],Render.prototype,"getWorldView",null),__decorate([Object(o.Export)()],Render.prototype,"onClockReady",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str,o.webworker_rpc.ParamType.str])],Render.prototype,"showAlert",null),__decorate([Object(o.Export)()],Render.prototype,"showLoading",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"updateProgress",null),__decorate([Object(o.Export)()],Render.prototype,"hideLoading",null),__decorate([Object(o.Export)()],Render.prototype,"onForceOfflineHandler",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str,o.webworker_rpc.ParamType.str])],Render.prototype,"loadStart",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"roomPause",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"roomResume",null),__decorate([Object(o.Export)()],Render.prototype,"removeScene",null),__decorate([Object(o.Export)()],Render.prototype,"showCreatePanelError",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str])],Render.prototype,"createSetNickName",null),__decorate([Object(o.Export)()],Render.prototype,"renderReconnect",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str,o.webworker_rpc.ParamType.str,o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"createAnotherGame",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"setCamerasBounds",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"setCamerasScroll",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"setInteractive",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"disableInteractive",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"fadeIn",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"fadeOut",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"fadeAlpha",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"getCurTime",null),__decorate([Object(o.Export)()],Render.prototype,"createGameCallBack",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"addFillEffect",null),__decorate([Object(o.Export)()],Render.prototype,"clearRoom",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.boolean])],Render.prototype,"clearGame",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str])],Render.prototype,"getMessage",null),__decorate([Object(o.Export)()],Render.prototype,"setLocalStorage",null),__decorate([Object(o.Export)()],Render.prototype,"getLocalStorage",null),__decorate([Object(o.Export)()],Render.prototype,"createPanel",null),__decorate([Object(o.Export)()],Render.prototype,"roomstartPlay",null),__decorate([Object(o.Export)()],Render.prototype,"drawGrids",null),__decorate([Object(o.Export)()],Render.prototype,"drawAstar_init",null),__decorate([Object(o.Export)()],Render.prototype,"drawAstar_update",null),__decorate([Object(o.Export)()],Render.prototype,"drawAstar_findPath",null),__decorate([Object(o.Export)()],Render.prototype,"roomReady",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"playAnimation",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"setCameraScroller",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"createDragonBones",null),__decorate([Object(o.Export)()],Render.prototype,"createUserDragonBones",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"createFramesDisplay",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"createTerrainDisplay",null),__decorate([Object(o.Export)()],Render.prototype,"setModel",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"updateDirection",null),__decorate([Object(o.Export)()],Render.prototype,"addSkybox",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"removeSkybox",null),__decorate([Object(o.Export)()],Render.prototype,"showMatterDebug",null),__decorate([Object(o.Export)()],Render.prototype,"hideMatterDebug",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"drawServerPosition",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"changeAlpha",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"removeBlockObject",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"setPosition",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.str])],Render.prototype,"showBubble",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"clearBubble",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"startFollow",null),__decorate([Object(o.Export)()],Render.prototype,"stopFollow",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.str])],Render.prototype,"cameraFollow",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"cameraPan",null),__decorate([Object(o.Export)()],Render.prototype,"updateSkyboxState",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.boolean])],Render.prototype,"setLayerDepth",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"doMove",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.str])],Render.prototype,"showNickname",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"showTopDisplay",null),__decorate([Object(o.Export)()],Render.prototype,"showRefernceArea",null),__decorate([Object(o.Export)()],Render.prototype,"hideRefernceArea",null),__decorate([Object(o.Export)()],Render.prototype,"displayAnimationChange",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str])],Render.prototype,"workerEmitter",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str])],Render.prototype,"physicalEmitter",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"mount",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"unmount",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"updateInput",null),__decorate([Object(o.Export)()],Render.prototype,"addEffect",null),__decorate([Object(o.Export)()],Render.prototype,"removeEffect",null),Render}(o.RPCPeer)}.call(this,"/")},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(0),s=function(){function DisplayMovement(t,e,i){this.scene=t,this.display=e,this.render=i}return DisplayMovement.prototype.destroy=function(){},DisplayMovement.prototype.doMove=function(t){var e=this;if(t.posPath){this.moveData=t;var i=t.tweenLineAnim;i&&(i.stop(),i.destroy());for(var n=[],s=0,r=0,o=t.posPath;r<o.length;r++){var a=o[r],h=a.duration,l=a.direction;n.push({x:a.x,y:a.y,direction:l,duration:h,onStartParams:l,onCompleteParams:{duration:h,index:s},onStart:function(t,i,n){e.onCheckDirection(n)},onComplete:function(t,i,n){e.onMovePathPointComplete(n)}}),s++}t.tweenLineAnim=this.scene.tweens.timeline({targets:this,ease:"Linear",tweens:n,onStart:function(){e.onMoveStart()},onComplete:function(){e.onMoveComplete()},onUpdate:function(){e.onMoving()},onCompleteParams:[this.display]})}},DisplayMovement.prototype.onCheckDirection=function(t){if("number"!=typeof t)return this.display.direction;n.Logger.getInstance().debug("dir:====",t),t!==this.display.displayInfo.avatarDir&&(this.display.direction=t,n.Logger.getInstance().debug("renderSetDirection:=====",t),this.render.setDirection(this.display.id,t))},DisplayMovement.prototype.onMovePathPointComplete=function(t){this.moveData&&(this.moveData.step+=1)},DisplayMovement.prototype.onMoveStart=function(){this.render.mainPeer.displayStartMove(this.display.id)},DisplayMovement.prototype.onMoveComplete=function(){this.moveData.tweenLineAnim&&this.moveData.tweenLineAnim.stop(),this.render.mainPeer.displayCompleteMove(this.display.id),this.stopMove()},DisplayMovement.prototype.onMoving=function(){var t=this.render.mainPeer.now();t-(this.moveData.tweenLastUpdate||0)>=50&&(this.display.setDepth(0),this.moveData.tweenLastUpdate=t),this.display.updateTopDisplay()},DisplayMovement.prototype.stopMove=function(){this.moveData&&this.moveData.posPath&&(delete this.moveData.posPath,this.moveData.arrivalTime&&(this.moveData.arrivalTime=0),this.moveData.tweenLineAnim&&(this.moveData.tweenLineAnim.stop(),this.moveData.tweenLineAnim.destroy())),this.render.mainPeer.displayStopMove(this.display.id)},DisplayMovement}()},function(t,e,i){"use strict";i(601)},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n,s=i(607),r=i(482),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),a=function(t){function BubbleAnimation(e){return t.call(this,e)||this}return o(BubbleAnimation,t),BubbleAnimation.prototype.load=function(e,i,n){t.prototype.load.call(this,e,i,n),this.animUrlData=new r.a,e?this.animUrlData.setData(this.resName,this.resUrl):this.animUrlData.setDisplayData(i,n),this.scene.load.image(this.resName,this.animUrlData.pngUrl),this.scene.load.image(this.animUrlData.jsonUrl,this.animUrlData.jsonUrl),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadComplete,this),this.scene.load.start()},BubbleAnimation.prototype.play=function(e){t.prototype.play.call(this,e),this.frameAnim&&(this.setScale(.2,.2),this.y=50,this.scene.tweens.add({targets:this,y:{value:-100,duration:300,ease:"Bounce.easeOut"},scaleX:{value:1,duration:300,ease:"Bounce.easeOut"},scaleY:{value:1,duration:300,ease:"Bounce.easeOut"}}))},BubbleAnimation.prototype.destroy=function(){t.prototype.destroy.call(this),this.frameAnim&&this.frameAnim.destroy(),this.bubblebg&&this.bubblebg.destroy(),this.frameAnim=null,this.bubblebg=null},BubbleAnimation.prototype.onLoadComplete=function(t,e,i){this.loaded=!0,this.bubblebg=this.scene.add.image(0,0,this.resName),this.frameAnim=this.scene.add.image(0,0,this.animUrlData.jsonUrl),this.add([this.bubblebg,this.frameAnim]),this.isPlaying&&this.play()},BubbleAnimation}(s.a)},function(t,e,i){"use strict";var n,s=i(607),r=i(482),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)});!function(t){function DragonbonesAnimation(e){return t.call(this,e)||this}o(DragonbonesAnimation,t),DragonbonesAnimation.prototype.load=function(e,i,n){t.prototype.load.call(this,e,i,n),this.animUrlData=new r.a,e?this.animUrlData.setData(this.resName,this.resUrl,!0,".dbbin"):this.animUrlData.setDisplayData(i,n),this.scene.load.dragonbone(this.resName,this.animUrlData.pngUrl,this.animUrlData.jsonUrl,this.animUrlData.boneUrl,this.animUrlData.textureXhrSettings,this.animUrlData.atlasXhrSettings,this.animUrlData.boneXhrSettings),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadComplete,this),this.scene.load.start()},DragonbonesAnimation.prototype.play=function(e){t.prototype.play.call(this,e),this.armatureDisplay&&this.armatureDisplay.animation.play(e)},DragonbonesAnimation.prototype.destroy=function(){t.prototype.destroy.call(this),this.armatureDisplay&&this.armatureDisplay.destroy(),this.armatureDisplay=null},DragonbonesAnimation.prototype.onLoadComplete=function(t,e,i){this.loaded=!0,this.armatureDisplay=this.scene.add.armature("mecha_1002_101d",this.resName),this.add(this.armatureDisplay),this.isPlaying&&this.play(this.curAniName)}}(s.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n,s=i(607),r=i(482),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),a=function(t){function FrameAnimation(e){return t.call(this,e)||this}return o(FrameAnimation,t),FrameAnimation.prototype.load=function(e,i,n,s){t.prototype.load.call(this,e,i,n),this.complHandler=s,this.animUrlData=new r.a,e?this.animUrlData.setData(this.resName,this.resUrl):this.animUrlData.setDisplayData(i,n),this.scene.load.atlas(this.resName,this.animUrlData.pngUrl,this.animUrlData.jsonUrl,this.animUrlData.textureXhrSettings,this.animUrlData.atlasXhrSettings),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadComplete,this),this.scene.load.start()},FrameAnimation.prototype.play=function(e){t.prototype.play.call(this,e),this.frameAnim&&this.frameAnim.play(this.curAniName)},FrameAnimation.prototype.destroy=function(){t.prototype.destroy.call(this),this.frameAnim&&this.frameAnim.destroy(),this.frameAnim=null,this.complHandler=void 0},FrameAnimation.prototype.onLoadComplete=function(t,e,i){this.loaded=!0,this.scene.anims.exists(this.curAniName)||this.scene.anims.create({key:this.curAniName,frames:this.scene.anims.generateFrameNames(this.resName),repeat:-1}),this.frameAnim||(this.frameAnim=this.scene.add.sprite(0,0,this.resName),this.add(this.frameAnim)),0===this.width?(this.setSize(this.frameAnim.width,this.frameAnim.height),this.scale=1):this.scale=this.width/this.frameAnim.displayWidth,this.isPlaying||this.play(this.curAniName),this.complHandler&&this.complHandler.run()},FrameAnimation}(s.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n=i(2),s=i(0),r=function(){function AnimationModel(t){var e=t.baseLoc.split(",");this.mNode=t.node,this.id=t.node.id,this.name=t.node.name,this.frameName=t.frameName,!t.frameName||this.frameName.length,this.loop=t.loop,t.loop,t.frameRate,t.originPoint,t.baseLoc,this.frameRate=t.frameRate,this.baseLoc=new s.LogicPoint(parseInt(e[0],10),parseInt(e[1],10));var i=t.originPoint;this.originPoint=new s.LogicPoint(i[0],i[1]),"string"==typeof t.collisionArea?this.collisionArea=this.stringToArray(t.collisionArea,",","&")||[[0]]:this.collisionArea=t.collisionArea||[[0]],"string"==typeof t.walkableArea?this.walkableArea=this.stringToArray(t.walkableArea,",","&")||[[0]]:this.walkableArea=t.walkableArea||[[0]],this.interactiveArea=t.interactiveArea,this.changeLayer(t.layer),this.mountLayer=t.mountLayer}return AnimationModel.prototype.changeLayer=function(t){this.layer=t,this.layer.length<1&&(this.layer=[{frameName:this.frameName,offsetLoc:this.baseLoc}])},AnimationModel.prototype.createProtocolObject=function(){var t=n.op_gameconfig_01.AnimationData.create();t.node=this.mNode,t.baseLoc=this.baseLoc.x+","+this.baseLoc.y,t.node.name=this.name,t.loop=this.loop,t.frameRate=this.frameRate,t.frameName=this.frameName,t.originPoint=[this.originPoint.x,this.originPoint.y],t.walkOriginPoint=[this.originPoint.x,this.originPoint.y],t.walkableArea=this.arrayToString(this.walkableArea,",","&"),t.collisionArea=this.arrayToString(this.collisionArea,",","&"),t.interactiveArea=this.interactiveArea;for(var e=[],i=0,s=this.layer;i<s.length;i++){var r=s[i];e.push(n.op_gameconfig_01.AnimationLayer.create(r))}return t.layer=e,this.changeLayer(t.layer),t.mountLayer=this.mountLayer,t},AnimationModel.prototype.stringToArray=function(t,e,i){if(t){for(var n=[],s=0,r=t.split(i);s<r.length;s++){var o=r[s].split(e);n.push(o.map((function(t){return parseInt(t,10)})))}return n}},AnimationModel.prototype.arrayToString=function(t,e,i){if(!t)return"";for(var n=[],s=0,r=t;s<r.length;s++){var o=r[s];n.push(o.join(e))}return n.join(i)},AnimationModel}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n,s=i(534),r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function UIDragonbonesDisplay(){var e=null!==t&&t.apply(this,arguments)||this;return e.mInteractive=!1,e.isBack=!1,e}return r(UIDragonbonesDisplay,t),UIDragonbonesDisplay.prototype.play=function(e){e.name=this.getAnimationName(e.name)+(this.isBack?"_back":""),t.prototype.play.call(this,e),this.mArmatureDisplay&&(this.mArmatureDisplay.hasDBEventListener(dragonBones.EventObject.LOOP_COMPLETE)&&this.mArmatureDisplay.removeDBEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.onArmatureLoopComplete,this),e.times>0&&this.mArmatureDisplay.addDBEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.onArmatureLoopComplete,this))},UIDragonbonesDisplay.prototype.setBack=function(t){this.isBack=t},UIDragonbonesDisplay.prototype.setCompleteHandler=function(t){this.mComplHandler=t},UIDragonbonesDisplay.prototype.setSuits=function(t){if(t)for(var e=0,i=t;e<i.length;e++){var n=i[e];if("weapon"===n.suit_type&&n.tag)return void(this.AniAction=JSON.parse(n.tag).action)}this.AniAction=void 0},UIDragonbonesDisplay.prototype.getAnimationName=function(t){if(this.AniAction){if("idle"===t)return this.AniAction[0];if("walk"===t)return this.AniAction[1]}return t},Object.defineProperty(UIDragonbonesDisplay.prototype,"back",{get:function(){return this.isBack},enumerable:!1,configurable:!0}),UIDragonbonesDisplay.prototype.onArmatureLoopComplete=function(t){if(this.mArmatureDisplay&&this.mAnimation){this.mArmatureDisplay.removeDBEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.onArmatureLoopComplete,this);var e=this.mAnimation.playingQueue;if(e&&void 0!==e.name){var i={name:e.name,times:e.playTimes,flip:this.mAnimation.flip};this.play(i)}else this.mComplHandler&&this.mComplHandler.run()}},UIDragonbonesDisplay.prototype.showPlaceholder=function(){},UIDragonbonesDisplay.prototype.closePlaceholder=function(){},UIDragonbonesDisplay}(s.a)},function(t,e){},function(t,e,i){"use strict";i(610),i(611),i(612)},function(t,e,i){"use strict";i.r(e),i.d(e,"BottomPanel",(function(){return d}));var n,s=i(470),r=i(5),o=i(1),a=i(0),h=i(11),l=i(488),c=i(471),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function BottomPanel(e){var i=t.call(this,e)||this;return i.chatCatchArr=[],i.chatMaxLen=100,i.atlasNames=[h.d.uicommon,h.d.iconcommon],i.key=o.ModuleName.BOTTOM,i}return p(BottomPanel,t),BottomPanel.prototype.show=function(e){t.prototype.show.call(this,e),this.initialized&&this.checkUpdateActive()},BottomPanel.prototype.resize=function(t,e){this.scale,this.scene.cameras.main.width;var i=this.scene.cameras.main.height;this.mInput.resize(),this.y=i,this.mNavigate.y=-this.mNavigate.height,this.mInput.y=this.mNavigate.y-this.mInput.height,this.updateOutputLayout()},BottomPanel.prototype.addListen=function(){this.mInput.on("enter",this.onSendMsgHandler,this),this.mInput.on("pointerScene",this.onPointerSceneHandler,this),this.resizeColtroll.addListen(),this.resizeColtroll.on("toggleSize",this.onToggleSizeHandler,this)},BottomPanel.prototype.removeListen=function(){this.mInput.on("enter",this.onSendMsgHandler,this),this.mInput.off("pointerScene",this.onPointerSceneHandler,this),this.resizeColtroll.removeListen(),this.resizeColtroll.off("toggleSize",this.onToggleSizeHandler,this)},BottomPanel.prototype.appendChat=function(t){this.chatCatchArr.push(t),this.chatCatchArr.length>this.chatMaxLen&&this.chatCatchArr.shift(),this.mOutput&&this.mOutput.appendChat(t)},BottomPanel.prototype.preload=function(){this.addAtlas(this.key,"bottom/bottom.png","bottom/bottom.json"),t.prototype.preload.call(this)},BottomPanel.prototype.showKeyboard=function(t,e){var i=this.cameraHeight/this.scale-e/this.scale;0!==i?(this.mInput.y=-i-this.mInput.height,this.updateOutputLayout()):this.hideKeyboard()},BottomPanel.prototype.hideKeyboard=function(){this.mInput.y=this.mNavigate.y-this.mInput.height,this.updateOutputLayout()},BottomPanel.prototype.init=function(){this.mOutput=new m(this.scene,this.dpr,this.scale),this.mInput=new u(this.scene,this.key,this.dpr),this.mNavigate=new l.PicaNewNavigatePanel(this.scene,this.key,this.dpr),this.mNavigate.setHandler(new a.Handler(this,this.onNavigateHandler)),this.resizeColtroll=new y(this.scene,this.key,this.dpr),this.add([this.mOutput,this.mInput,this.mNavigate,this.resizeColtroll]),this.resize(this.width,this.mOutput.height+this.mInput.height+this.mNavigate.height),t.prototype.init.call(this),this.onToggleSizeHandler(!1)},BottomPanel.prototype.checkUpdateActive=function(){var t=this;this.render.mainPeer.getActiveUIData(o.ModuleName.PICACHAT_NAME).then((function(e){if(e)for(var i=0,n=e;i<n.length;i++){var s=n[i];t.updateUIState(s)}}))},BottomPanel.prototype.sendChat=function(t){if(t){var e=this.mediator;e&&e.sendChat(t)}},BottomPanel.prototype.onSendMsgHandler=function(t){this.sendChat(t)},BottomPanel.prototype.onNavigateHandler=function(t,e){"bag"===t?this.render.renderEmitter(o.ModuleName.BOTTOM+"_showpanel",o.ModuleName.PICABAG_NAME):"friend"===t?this.render.renderEmitter(o.ModuleName.BOTTOM+"_showpanel",o.ModuleName.PICAFRIEND_NAME):"avatar"===t?this.render.renderEmitter(o.ModuleName.BOTTOM+"_showpanel",o.ModuleName.PICAAVATAR_NAME):"shop"===t?this.render.renderEmitter(o.ModuleName.BOTTOM+"_showpanel",o.ModuleName.PICAMARKET_NAME):"explore"===t&&this.render.renderEmitter(o.ModuleName.BOTTOM+"_showpanel",o.ModuleName.PICAEXPLORELIST_NAME)},BottomPanel.prototype.onToggleSizeHandler=function(t){this.expanded=t,t?(this.mOutput.expand(),this.resizeColtroll.expand()):(this.mOutput.collapse(),this.resizeColtroll.collapse()),this.render.renderEmitter(o.EventType.CHAT_PANEL_EXTPAND,t),this.updateOutputLayout()},BottomPanel.prototype.onPointerSceneHandler=function(t){if(t&&t.length>0)for(var e=0,i=t;e<i.length;e++){if(i[e].parentContainer===this.resizeColtroll)return}this.mInput.blurInput()},BottomPanel.prototype.updateOutputLayout=function(){this.expanded?(this.mOutput.x=0,this.mOutput.y=this.mInput.y-1*this.dpr-this.mOutput.height,this.resizeColtroll.y=this.mOutput.y-.5*this.resizeColtroll.height,this.mOutput.expand()):(this.mOutput.x=this.resizeColtroll.width-1*this.dpr,this.mOutput.y=this.mInput.y-1*this.dpr-this.mOutput.height,this.resizeColtroll.y=this.mInput.y-1*this.dpr-.5*this.resizeColtroll.height,this.mOutput.collapse()),this.mOutput.updateLayout()},BottomPanel.prototype.onFocusHandler=function(){this.showKeyboard(window.document.documentElement.clientWidth*window.devicePixelRatio,window.document.documentElement.clientHeight*window.devicePixelRatio)},BottomPanel.prototype.onBlurHandler=function(){this.hideKeyboard()},Object.defineProperty(BottomPanel.prototype,"mediator",{get:function(){return this.render.mainPeer[this.key]},enumerable:!1,configurable:!0}),BottomPanel}(c.PicaBasePanel),m=function(t){function OutputContainer(e,i,n){var s=t.call(this,e)||this;s.dpr=i,s.scaleRatio=n,s.background=s.scene.make.graphics(void 0,!1),s.background.clear();var o=s.scene.cameras.main.width,h=s.scaleRatio;return s.mOutputText=new r.BBCodeText(s.scene,0,0,"",{fontSize:12*s.dpr+"px",fontFamily:a.Font.DEFULT_FONT,stroke:"#000000",strokeThickness:1*s.dpr*h,shadow:{offsetX:0,offsetY:0,color:"#000",blur:4,stroke:!0,fill:!0},wrap:{mode:"char",width:o-12*s.dpr*h}}),s.mTextArea=new r.TextArea(s.scene,{x:.5*o+8*s.dpr*h,y:6*s.dpr,textWidth:o-4*s.dpr*h,textHeight:126*s.dpr*h,text:s.mOutputText}).layout(),s.updateLayout(),s.add([s.background,s.mTextArea,s.mOutputText]),s}return p(OutputContainer,t),OutputContainer.prototype.resize=function(t,e){this.setSize(t,e),this.background.clear(),this.background.fillStyle(0,.6),this.background.fillRect(0,0,t+1*this.dpr,e),this.mTextArea.childrenMap.child.setMinSize(t*this.scaleRatio,e*this.scaleRatio),this.mTextArea.layout(),this.mTextArea.setChildOY(4*this.dpr*this.scaleRatio),this.updateLayout(),this.mTextArea.childrenMap.text.y=4*this.dpr,this.mTextArea.scrollToBottom()},OutputContainer.prototype.expand=function(){this.resize(this.scene.cameras.main.width,125.33*this.dpr),this.mTextArea.setScrollerEnable(!0)},OutputContainer.prototype.collapse=function(){this.resize(296*this.dpr,40*this.dpr),this.mTextArea.setScrollerEnable(!1)},OutputContainer.prototype.updateLayout=function(){var t=this.getWorldTransformMatrix(this.getLocalTransformMatrix());this.mTextArea.setPosition(this.width*this.scaleRatio*.5+8*this.dpr,t.ty+.5*this.mTextArea.height),this.mTextArea.scrollToBottom()},OutputContainer.prototype.appendChat=function(t){this.mTextArea&&(this.mTextArea.appendText(t),this.mTextArea.scrollToBottom())},OutputContainer}(Phaser.GameObjects.Container),u=function(t){function InputContainer(e,i,n){var r=t.call(this,e)||this;r.dpr=n,r.background=e.make.graphics(void 0,!1);var o=a.i18n.t("chat.placeholder");r.emoji=e.make.image({key:i,frame:"home_face"}),r.emoji.x=12.67*n+.5*r.emoji.width;var h=r.scene.cameras.main.width;return r.inputText=new s.LabelInput(r.scene,{width:h,height:16*r.dpr,placeholder:o,fontSize:11*r.dpr+"px",color:"#ffffff"}).setOrigin(0,.5).setAutoBlur(!1),r.add([r.background,r.emoji,r.inputText]),r.inputText.on("enter",r.onEnterHandler,r),r.inputText.on("blur",r.onInputBlurHandler,r),r.inputText.on("focus",r.onInputFocusHandler,r),r}return p(InputContainer,t),InputContainer.prototype.resize=function(){var t=this.scene.cameras.main.width;this.setSize(t,38.33*this.dpr),this.inputText.x=46*this.dpr,this.inputText.y=.5*this.height,this.inputText.setSize(this.inputText.width,this.height),this.emoji.y=.5*this.height,this.background.clear(),this.background.fillStyle(0,.6),this.background.fillRect(0,0,t,this.height),this.background.input=void 0,this.background.setInteractive(new Phaser.Geom.Rectangle(0,0,t/this.scale,this.height/this.scale),Phaser.Geom.Rectangle.Contains)},InputContainer.prototype.setText=function(t){this.inputText.setText(t)},InputContainer.prototype.blurInput=function(){this.inputText.setBlur()},InputContainer.prototype.onEnterHandler=function(t){this.emit("enter",t),this.inputText.setText("")},InputContainer.prototype.onInputBlurHandler=function(){this.scene.input.off("pointerdown",this.onPointerSceneHandler,this),this.inputText.setBlur()},InputContainer.prototype.onInputFocusHandler=function(){this.scene.input.on("pointerdown",this.onPointerSceneHandler,this)},InputContainer.prototype.onPointerSceneHandler=function(t,e){this.emit("pointerScene",e),this.inputText.setBlur()},InputContainer}(Phaser.GameObjects.Container),y=function(t){function ResizeControll(e,i,n){var s=t.call(this,e)||this;return s.dpr=n,s.expaned=!0,s.background=new r.Button(s.scene,i,"home_chat_pack_up_bg"),s.background.tweenEnable=!1,s.bubble=s.scene.make.image({key:i,frame:"home_chat"}),s.arrow=s.scene.make.image({key:i,frame:"home_unwind"}),s.setSize(s.background.width,s.background.height),s.bubble.x=.5*(-s.width+s.bubble.width)+12.67*n,s.arrow.x=.5*(-s.width+s.arrow.width)+43*n,s.add([s.background,s.bubble,s.arrow]),s.x=.5*s.background.width,s}return p(ResizeControll,t),ResizeControll.prototype.addListen=function(){this.background.on(r.ClickEvent.Tap,this.onToggleSizeHandler,this)},ResizeControll.prototype.removeListen=function(){this.background.off(r.ClickEvent.Tap,this.onToggleSizeHandler,this)},ResizeControll.prototype.expand=function(){this.background.setFrame("home_chat_unwind_bg"),this.arrow.scaleY=-1,this.expaned=!0,this.setSize(this.background.width,this.background.height)},ResizeControll.prototype.collapse=function(){this.background.setFrame("home_chat_pack_up_bg"),this.arrow.scaleY=1,this.expaned=!1,this.setSize(this.background.width,this.background.height)},ResizeControll.prototype.getExpaned=function(){return this.expaned},ResizeControll.prototype.onToggleSizeHandler=function(){this.expaned=!this.expaned,this.emit("toggleSize",this.expaned)},ResizeControll}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"ChatPanel",(function(){return l}));var n,s=i(470),r=i(5),o=i(1),a=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function ChatPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i.chatCatchArr=[],i.chatMaxLen=100,i.scale=1,i.key=o.ModuleName.CHAT_NAME,i}return h(ChatPanel,t),ChatPanel.prototype.show=function(e){t.prototype.show.call(this,e),this.initialized&&this.checkUpdateActive()},ChatPanel.prototype.resize=function(e,i){var n=this.scale,s=this.scene.cameras.main.width,r=this.scene.cameras.main.height;e=s,i=i||133*this.dpr,this.mInputPanel.resize(),this.setSize(s,i+this.mInputPanel.height),this.y=r-this.height-54*this.dpr,this.mBackground.clear(),this.mBackground.fillStyle(0,.6),this.mBackground.fillRect(0,0,s/this.scale,i/this.scale),this.mTextArea.childrenMap.child.setMinSize(e,(i-16*this.dpr)*n),this.mTextArea.layout(),this.mTextArea.setPosition(this.width/2+4*this.dpr,this.y+this.mTextArea.height/2+10*this.dpr*n),this.mTextArea.childrenMap.text.y=8*this.dpr,this.mTextArea.scrollToBottom(),t.prototype.resize.call(this,e,i),this.mBackground.input=void 0,this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,s/this.scale,i/this.scale),Phaser.Geom.Rectangle.Contains)},ChatPanel.prototype.addListen=function(){this.mInputPanel.on("enter",this.onSendMsgHandler,this)},ChatPanel.prototype.removeListen=function(){this.mInputPanel.on("enter",this.onSendMsgHandler,this)},ChatPanel.prototype.appendChat=function(t){this.chatCatchArr.push(t),this.chatCatchArr.length>this.chatMaxLen&&this.chatCatchArr.shift(),this.mTextArea&&(this.mTextArea.appendText(t),this.mTextArea.scrollToBottom())},ChatPanel.prototype.init=function(){var e=this.scene.cameras.main.width;this.scene.cameras.main.height;this.mBackground=this.scene.make.graphics(void 0,!1);var i=this.scale;this.mOutputText=new r.BBCodeText(this.mScene,0,0,"",{fontSize:12*this.dpr/i+"px",fontFamily:a.Font.DEFULT_FONT,stroke:"#000000",strokeThickness:1*this.dpr*i,textMask:!1,shadow:{offsetX:0,offsetY:0,color:"#000",blur:4,stroke:!0,fill:!0},wrap:{mode:"char",width:e-12*this.dpr*i}}),this.mTextArea=new r.TextArea(this.mScene,{x:e/2+4*this.dpr*i,y:160*this.dpr*i,textWidth:e-4*this.dpr*i,textHeight:126*this.dpr*i,text:this.mOutputText}).layout(),this.mInputPanel=new c(this.scene,this.dpr),this.mInputPanel.y=134*this.dpr,this.add([this.mBackground,this.mTextArea,this.mOutputText,this.mInputPanel]),this.resize(this.width,133*this.dpr),t.prototype.init.call(this)},ChatPanel.prototype.checkUpdateActive=function(){var t=this;this.render.mainPeer.getActiveUIData(o.ModuleName.PICACHAT_NAME).then((function(e){if(e)for(var i=0,n=e;i<n.length;i++){var s=n[i];t.updateUIState(s)}}))},ChatPanel.prototype.sendChat=function(t){if(t){var e=this.mediator;e&&e.sendChat(t)}},ChatPanel.prototype.onSendMsgHandler=function(t){this.sendChat(t)},Object.defineProperty(ChatPanel.prototype,"mediator",{get:function(){return this.render.mainPeer[o.ModuleName.CHAT_NAME]},enumerable:!1,configurable:!0}),ChatPanel}(s.BasePanel),c=function(t){function InputPanle(e,i){var n=t.call(this,e)||this;n.dpr=i,n.background=e.make.graphics(void 0,!1);var r=a.i18n.t("chat.placeholder"),o=n.scene.cameras.main.width;return n.inputText=new s.LabelInput(n.scene,{width:o,height:16*n.dpr,placeholder:r,fontSize:11*n.dpr+"px",color:"#ffffff"}).setOrigin(0,.5),n.add([n.background,n.inputText]),n.inputText.on("enter",n.onEnterHandler,n),n}return h(InputPanle,t),InputPanle.prototype.resize=function(){var t=this.scene.cameras.main.width;this.setSize(t,38.33*this.dpr),this.inputText.x=46*this.dpr,this.inputText.y=.5*this.height,this.background.clear(),this.background.fillStyle(0,.6),this.background.fillRect(0,0,t,this.height),this.background.input=void 0,this.background.setInteractive(new Phaser.Geom.Rectangle(0,0,t/this.scale,this.height/this.scale),Phaser.Geom.Rectangle.Contains)},InputPanle.prototype.onEnterHandler=function(){this.emit("enter",this.inputText.text),this.inputText.setBlur(),this.inputText.setText("")},InputPanle}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"GMToolsPanel",(function(){return l}));var n,s=i(5),r=i(11),o=i(470),a=i(1),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function GMToolsPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=a.ModuleName.GM_TOOLS_NAME,i}return h(GMToolsPanel,t),GMToolsPanel.prototype.show=function(e){t.prototype.show.call(this,e),this.mInitialized&&this.showButtons()},GMToolsPanel.prototype.update=function(e){t.prototype.update.call(this,e),this.mInitialized&&this.showButtons()},GMToolsPanel.prototype.addListen=function(){this.mInitialized&&(this.command.on("enter",this.onEnterCommandHandler,this),this.closeBtn.on(s.ClickEvent.Tap,this.onCloseHandler,this),this.commitBtn.on(s.ClickEvent.Tap,this.onCommitCmdHandler,this))},GMToolsPanel.prototype.removeListen=function(){this.mInitialized&&(this.command.off("enter",this.onEnterCommandHandler,this),this.closeBtn.off(s.ClickEvent.Tap,this.onCloseHandler,this),this.commitBtn.off(s.ClickEvent.Tap,this.onCommitCmdHandler,this))},GMToolsPanel.prototype.resize=function(){var t=this.scaleWidth,e=this.scaleHeight;this.setSize(this.scaleWidth,this.scaleHeight),this.closeBtn.x=.5*(t-this.closeBtn.width)-16*this.dpr,this.closeBtn.y=.5*-(e-this.closeBtn.height)+16*this.dpr,this.background.clear(),this.background.fillStyle(0,.6),this.background.fillRect(0,0,t,e),this.background.x=.5*-t,this.background.y=.5*-e,this.background.setInteractive(new Phaser.Geom.Rectangle(0,0,t,e),Phaser.Geom.Rectangle.Contains),this.command.x=.5*-this.width+20*this.dpr,this.command.y=.5*-this.height+60*this.dpr,this.x=.5*this.cameraWidth,this.y=.5*this.cameraHeight,this.commitBtn.x=this.command.x+this.command.width+.5*this.commitBtn.width+16*this.dpr,this.commitBtn.y=this.command.y+.5*this.command.height,this.gridtable.setSize(this.width,e-110*this.dpr),this.gridtable.layout(),this.gridtable.resetMask()},GMToolsPanel.prototype.preload=function(){this.addAtlas(r.c.commonKey,r.d.commonUrl+".png",r.d.commonUrl+".json"),t.prototype.preload.call(this)},GMToolsPanel.prototype.init=function(){var e=this,i=this.scaleWidth,n=this.scaleHeight;this.setSize(i,n),this.background=this.scene.make.graphics(void 0,!1);var a=this.scale,h=i-30*this.dpr,l=46*this.dpr,p=null;this.scene.textures.exists("gmtools_btn")||((p=this.scene.make.graphics(void 0,!1)).fillStyle(36026),p.fillRoundedRect(0,0,h,l),p.generateTexture("gmtools_btn",h,l)),this.command=new o.LabelInput(this.scene,{width:this.width-110*this.dpr,height:16*this.dpr,placeholder:"输入命令",fontSize:14*this.dpr+"px",color:"#666666"}).setOrigin(0,0),this.command.x=.5*-this.width+20*this.dpr,this.command.y=.5*-this.height+60*this.dpr,this.command.createBackground(6*this.dpr,10*this.dpr),this.scene.textures.exists("gmtools_commit")||(p.clear(),p.fillStyle(699050),p.fillRoundedRect(0,0,50*this.dpr,30*this.dpr),p.generateTexture("gmtools_commit",50*this.dpr,30*this.dpr),p.destroy()),this.commitBtn=new s.Button(this.scene,"gmtools_commit","","","提交"),this.commitBtn.setTextStyle({fontSize:12*this.dpr});var d=54*this.dpr,m={x:0,y:60*this.dpr,table:{width:i,height:n-110*this.dpr,columns:1,cellWidth:i,cellHeight:d,reuseCellContainer:!0,zoom:a,cellPadX:0,cellPadY:10*this.dpr},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.item;return null===i&&(i=new c(e.scene,91*e.dpr,46*e.dpr,e.dpr)).on("targetUI",e.onTargetUIHandler,e),i.setSize(t.width,t.height),i.setData({item:n}),i.setItemData(n),i}};this.gridtable=new s.GameGridTable(this.scene,m),this.gridtable.on("cellTap",(function(t){if(t){var i=t.item;i&&i.node&&e.onTargetUIHandler(i.node.id)}})),this.closeBtn=new s.Button(this.scene,r.c.commonKey,"close"),this.add([this.background,this.gridtable,this.closeBtn,this.command,this.commitBtn]),t.prototype.init.call(this),this.resize()},GMToolsPanel.prototype.showButtons=function(){if(this.mShowData){var t=this.showData,e=t.button;e.length>=1&&this.gridtable.setItems(e);var i=t.inputText;i&&i.length>0&&this.command.setData({item:i[0]})}},GMToolsPanel.prototype.onTargetUIHandler=function(t){!this.mShowData||this.mShowData.length<1||(this.emit("targetUI",this.mShowData.id,t),this.render.renderEmitter(this.key+"_targetUI",{id:this.mShowData.id,componentId:t}),this.command.setBlur())},GMToolsPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(this.key+"_close")},GMToolsPanel.prototype.onCommitCmdHandler=function(){if(this.command.setBlur(),this.mShowData&&!(this.mShowData.length<1)){var t=this.command.text;if(t){var e=this.command.getData("item");e&&e.node&&this.render.renderEmitter(this.key+"_targetUI",{id:this.mShowData.id,componentId:e.node.id,text:t})}}},GMToolsPanel.prototype.onEnterCommandHandler=function(){this.onCommitCmdHandler()},GMToolsPanel}(o.BasePanel),c=function(t){function Item(e,i,n,r){var o=t.call(this,e)||this;return o.btn=new s.Button(o.scene,"gmtools_btn","","","1"),o.btn.on(String(s.ClickEvent.Tap),o.onBtnHandler,o),o.btn.setTextStyle({fontSize:12*r}),o.btn.removeInteractive(),o.add(o.btn),o}return h(Item,t),Item.prototype.setItemData=function(t){this.item=t,this.btn.setText(t.text)},Item.prototype.onBtnHandler=function(){this.item&&this.emit("targetUI",this.item.id)},Item}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaDecoratePanel",(function(){return l}));var n,s=i(5),r=i(470),o=i(1),a=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaDecoratePanel(e){var i=t.call(this,e.render.sceneManager.getMainScene(),e.render)||this;return i.resKey="decorate",i.minGrid=2,i.maxGrid=10,i.offset=new a.LogicPos,i.mScaleRatio=1,i.key=o.ModuleName.PICADECORATE_NAME,i.mScaleRatio=e.render.scaleRatio,i}return h(PicaDecoratePanel,t),PicaDecoratePanel.prototype.show=function(t){this.mShowData=t,this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.scene.layerManager.addToLayer("sceneUILayer",this)):this.preload()},PicaDecoratePanel.prototype.addListen=function(){this.mCancelBtn&&this.mCancelBtn.on(s.ClickEvent.Tap,this.onCancelHandler,this),this.mOkBtn&&this.mOkBtn.on(s.ClickEvent.Tap,this.onAddHandler,this),this.mRecycleBtn&&this.mRecycleBtn.on(s.ClickEvent.Tap,this.onRecycleHandler,this),this.mTurnBtn&&this.mTurnBtn.on(s.ClickEvent.Tap,this.onTurnHandler,this),this.mMoveBtn&&this.mMoveBtn.on(s.ClickEvent.Tap,this.onShowMoveMenuHandler,this),this.mRepeatBtn&&this.mRepeatBtn.on(s.ClickEvent.Tap,this.onShowRepeatHandler,this),this.mExtendBtn&&this.mExtendBtn.on(s.ClickEvent.Tap,this.onShowExtendsHandler,this),this.mMoveMenuContainer&&(this.mMoveMenuContainer.register(),this.mMoveMenuContainer.on(s.ClickEvent.Tap,this.onMoveHandler,this)),this.mRepeatMenuContainer&&(this.mRepeatMenuContainer.register(),this.mRepeatMenuContainer.on(s.ClickEvent.Tap,this.onRepeatHandler,this),this.mRepeatMenuContainer.on(s.ClickEvent.Hold,this.onHoldRepeatHandler,this))},PicaDecoratePanel.prototype.removeListen=function(){this.mCancelBtn&&this.mCancelBtn.off(s.ClickEvent.Tap,this.onCancelHandler,this),this.mOkBtn&&this.mOkBtn.off(s.ClickEvent.Tap,this.onAddHandler,this),this.mRecycleBtn&&this.mRecycleBtn.off(s.ClickEvent.Tap,this.onRecycleHandler,this),this.mTurnBtn&&this.mTurnBtn.off(s.ClickEvent.Tap,this.onTurnHandler,this),this.mMoveBtn&&this.mMoveBtn.off(s.ClickEvent.Tap,this.onShowMoveMenuHandler,this),this.mRepeatBtn&&this.mRepeatBtn.off(s.ClickEvent.Tap,this.onShowRepeatHandler,this),this.mExtendBtn&&this.mExtendBtn.off(s.ClickEvent.Tap,this.onShowExtendsHandler,this),this.mMoveMenuContainer&&(this.mMoveMenuContainer.unRegister(),this.mMoveMenuContainer.off(s.ClickEvent.Tap,this.onMoveHandler,this)),this.mRepeatMenuContainer&&(this.mRepeatMenuContainer.unRegister(),this.mRepeatMenuContainer.off(s.ClickEvent.Tap,this.onRepeatHandler,this),this.mRepeatMenuContainer.off(s.ClickEvent.Hold,this.onHoldRepeatHandler,this))},PicaDecoratePanel.prototype.setElement=function(t){this.mDisplayObject=this.render.displayManager.getDisplay(t),this.mInitialized&&(this.mDisplayObject&&this.setPos(this.mDisplayObject.x,this.mDisplayObject.y),this.addListen())},PicaDecoratePanel.prototype.canPut=function(t){if(t!==this.mCanPut){if(this.mCanPut=t,!this.mOkBtn)return;this.mOkBtn.enable=t}},PicaDecoratePanel.prototype.setPos=function(t,e,i){this.x=t*this.mScaleRatio,this.y=(e+this.offset.y)*this.mScaleRatio,this.z=i||0},PicaDecoratePanel.prototype.setOffset=function(t,e){this.offset.x=t,this.offset.y=e,this.mDisplayObject&&this.setPos(this.mDisplayObject.x,this.mDisplayObject.y)},PicaDecoratePanel.prototype.destroy=function(){this.mRepeatMenuContainer&&this.mRepeatMenuContainer.destroy(),this.mMoveMenuContainer&&this.mMoveMenuContainer.destroy(),t.prototype.destroy.call(this)},PicaDecoratePanel.prototype.preload=function(){this.addAtlas(this.key,"decorate_edit_menu/decorate_edit_menu.png","decorate_edit_menu/decorate_edit_menu.json"),t.prototype.preload.call(this)},PicaDecoratePanel.prototype.init=function(){var e=this.scene.cameras.main.width/this.scale;this.scene.cameras.main.height,this.scale;this.mMainMenus=[],this.mMenuContainer=this.scene.make.container({x:e>>1},!1),this.mSubMenus=this.scene.make.container({x:e>>1,y:60*this.dpr},!1),this.mOkBtn=new s.Button(this.scene,this.key,"ok_btn.png"),this.mRecycleBtn=new s.Button(this.scene,this.key,"recycly_btn.png"),this.mTurnBtn=new s.Button(this.scene,this.key,"turn_btn.png"),this.mCancelBtn=new s.Button(this.scene,this.key,"cancel_btn.png"),this.mMenuContainer.y=.5*this.mOkBtn.height,this.mSubMenus.y=this.mMenuContainer.y+60*this.dpr,this.mHorizontalBtn=new s.Button(this.scene,this.key,"horizontal_btn.png"),this.mMoveBtn=new s.Button(this.scene,this.key,"move_btn.png"),this.mRepeatBtn=new s.Button(this.scene,this.key,"repeat_btn.png"),this.mExtendBtn=new s.Button(this.scene,this.key,"extend_btn.png"),this.mMoveMenuContainer=new c(this.scene,this.key,this.dpr,this.scale),this.mMoveMenuContainer.y=this.mSubMenus.y+15*this.dpr+this.mMoveMenuContainer.height,this.mRepeatMenuContainer=new c(this.scene,this.key,this.dpr,this.scale),this.mRepeatMenuContainer.y=this.mMoveMenuContainer.y;var i=this.scale;this.add([this.mMenuContainer,this.mSubMenus]),this.mMenuContainer.add([this.mOkBtn,this.mTurnBtn,this.mRecycleBtn,this.mCancelBtn]),this.mSubMenus.add([this.mHorizontalBtn,this.mMoveBtn,this.mRepeatBtn,this.mExtendBtn]);var n=e-55*this.dpr*this.mWorld.uiScale*2;this.mMenuContainer.x=-n>>1;var r=this.mMenuContainer.list;r.map((function(t){return n-=t.width}));for(var o=n/(r.length-1)/i,a=1;a<r.length;a++){var h=r[a-1];r[a].x=h.width+h.x+o}n=e-70*this.dpr*this.mWorld.uiScale*2,this.mSubMenus.x=-n>>1;var l=this.mSubMenus.list;l.map((function(t){return n-=t.width})),o=n/(l.length-1)/i;for(a=1;a<l.length;a++){h=l[a-1];l[a].x=h.width+h.x+o}this.mMoveMenuContainer.x=this.mSubMenus.x+this.mMoveBtn.x+29*this.dpr,this.mRepeatMenuContainer.x=this.mSubMenus.x+this.mRepeatBtn.x+29*this.dpr,this.mOkBtn.enable=this.mCanPut,t.prototype.init.call(this),this.mDisplayObject&&this.setElement(this.mDisplayObject)},PicaDecoratePanel.prototype.onTurnHandler=function(){var t=this.mediator;t&&t.turn()},PicaDecoratePanel.prototype.onRecycleHandler=function(){var t=this.mediator;t&&t.recycle()},PicaDecoratePanel.prototype.onCancelHandler=function(){var t=this.mediator;t&&t.cancel()},PicaDecoratePanel.prototype.onAddHandler=function(){if(this.mCanPut){var t=this.mediator;t&&t.putElement()}},PicaDecoratePanel.prototype.onMoveHandler=function(t){if("number"==typeof t){var e=this.mediator;e&&e.moveDir(t)}},PicaDecoratePanel.prototype.onRepeatHandler=function(t){var e=this.mediator;e&&e.repeatAdd(t,2)},PicaDecoratePanel.prototype.onHoldRepeatHandler=function(t){var e=this.mediator;e&&e.repeatAdd(t,10)},PicaDecoratePanel.prototype.onShowMoveMenuHandler=function(){this.add(this.mMoveMenuContainer),this.remove(this.mRepeatMenuContainer)},PicaDecoratePanel.prototype.onShowRepeatHandler=function(){this.add(this.mRepeatMenuContainer),this.remove(this.mMoveMenuContainer)},PicaDecoratePanel.prototype.onShowExtendsHandler=function(){},Object.defineProperty(PicaDecoratePanel.prototype,"mediator",{get:function(){return this.render.mainPeer[o.ModuleName.PICADECORATE_NAME]},enumerable:!1,configurable:!0}),PicaDecoratePanel}(r.BasePanel),c=function(t){function MoveMenu(e,i,n,r){void 0===n&&(n=1),void 0===r&&(r=1);var o=t.call(this,e)||this,h=e.make.image({key:i,frame:"bg.png"},!1);o.setSize(h.displayWidth,h.displayHeight),o.mArrow1=new s.Button(o.scene,i,"arrow_1.png"),o.mArrow1.setData("dir",a.Direction.north_west),o.mArrow3=new s.Button(o.scene,i,"arrow_3.png"),o.mArrow3.setData("dir",a.Direction.west_south),o.mArrow5=new s.Button(o.scene,i,"arrow_5.png"),o.mArrow5.setData("dir",a.Direction.south_east),o.mArrow7=new s.Button(o.scene,i,"arrow_7.png"),o.mArrow7.setData("dir",a.Direction.east_north),o.mBtns=[o.mArrow1,o.mArrow3,o.mArrow5,o.mArrow7],o.add(h),o.add(o.mBtns);o.width;var l=o.width-20*n;o.mBtns.map((function(t){return l-=t.displayWidth}));for(var c=l/=o.mBtns.length-1,p=3*n,d=0;d<o.mBtns.length;d++)o.mBtns[d].x=0===d?10*n+o.mBtns[d].width/2-o.width/2:c+o.mBtns[d-1].x+o.mBtns[d-1].width,o.mBtns[d].y=p;return o.setInteractive(),o}return h(MoveMenu,t),MoveMenu.prototype.register=function(){this.mArrow1.on(s.ClickEvent.Hold,this.onHoldHandler,this),this.mArrow1.on(s.ClickEvent.Tap,this.onClickHandler,this),this.mArrow3.on(s.ClickEvent.Hold,this.onHoldHandler,this),this.mArrow3.on(s.ClickEvent.Tap,this.onClickHandler,this),this.mArrow5.on(s.ClickEvent.Hold,this.onHoldHandler,this),this.mArrow5.on(s.ClickEvent.Tap,this.onClickHandler,this),this.mArrow7.on(s.ClickEvent.Hold,this.onHoldHandler,this),this.mArrow7.on(s.ClickEvent.Tap,this.onClickHandler,this)},MoveMenu.prototype.unRegister=function(){this.mArrow1.off(s.ClickEvent.Hold,this.onHoldHandler,this),this.mArrow1.off(s.ClickEvent.Tap,this.onClickHandler,this),this.mArrow3.off(s.ClickEvent.Hold,this.onHoldHandler,this),this.mArrow3.off(s.ClickEvent.Tap,this.onClickHandler,this),this.mArrow5.off(s.ClickEvent.Hold,this.onHoldHandler,this),this.mArrow5.off(s.ClickEvent.Tap,this.onClickHandler,this),this.mArrow7.off(s.ClickEvent.Hold,this.onHoldHandler,this),this.mArrow7.off(s.ClickEvent.Tap,this.onClickHandler,this)},MoveMenu.prototype.onHoldHandler=function(t){this.emit(s.ClickEvent.Hold,t.getData("dir"))},MoveMenu.prototype.onClickHandler=function(t,e){this.emit(s.ClickEvent.Tap,e.getData("dir"))},MoveMenu}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNewOldMainPanel",(function(){return c}));var n,s=i(5),r=i(11),o=i(470),a=i(1),h=i(0),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function fulfilled(t){try{step(n.next(t))}catch(t){r(t)}}function rejected(t){try{step(n.throw(t))}catch(t){r(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function verb(r){return function(a){return function step(r){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(s=2&r[0]?n.return:r[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,r[1])).done)return s;switch(n=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],n=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},c=function(t){function PicaNewOldMainPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.isSceneNameActive=!1,i.key=a.ModuleName.PICAMAINUI_NAME,i}return l(PicaNewOldMainPanel,t),PicaNewOldMainPanel.prototype.show=function(e){t.prototype.show.call(this,e),this.mInitialized&&(this.setInteractive(),this.update(this.mShowData),this.checkUpdateActive())},PicaNewOldMainPanel.prototype.resize=function(e,i){var n=this.scene.cameras.main.width/this.scale,s=this.scene.cameras.main.height/this.scale;t.prototype.resize.call(this,n,s),this.mCoinValue.x=n-this.mCoinValue.width/2-5*this.dpr,this.mDiamondValue.x=n-this.mDiamondValue.width/2-5*this.dpr},PicaNewOldMainPanel.prototype.preload=function(){this.addAtlas(this.key,"main_ui/mainui.png","main_ui/mainui.json"),this.addAtlas(r.c.commonKey,r.d.commonUrl+".png",r.d.commonUrl+".json"),t.prototype.preload.call(this)},PicaNewOldMainPanel.prototype.addListen=function(){t.prototype.addListen.call(this),this.mInitialized&&(this.roomCon?(this.roomCon.on("pointerup",this.onOpenRoomPanel,this),this.render.emitter.on(a.EventType.UPDATE_ROOM_INFO,this.onUpdateRoomHandler,this),this.render.emitter.on(a.EventType.UPDATE_PLAYER_INFO,this.onUpdatePlayerHandler,this),this.render.emitter.on(a.EventType.UPDATE_PARTY_STATE,this.onUpdatePartyHandler,this)):h.Logger.getInstance().fatal(PicaNewOldMainPanel.name+": sceneName does not exist!"))},PicaNewOldMainPanel.prototype.removeListen=function(){t.prototype.removeListen.call(this),this.mInitialized&&(this.roomCon?(this.roomCon.off("pointerup",this.onOpenRoomPanel,this),this.render.emitter.off(a.EventType.UPDATE_ROOM_INFO,this.onUpdateRoomHandler,this),this.render.emitter.off(a.EventType.UPDATE_PLAYER_INFO,this.onUpdatePlayerHandler,this),this.render.emitter.off(a.EventType.UPDATE_PARTY_STATE,this.onUpdatePartyHandler,this)):h.Logger.getInstance().fatal(PicaNewOldMainPanel.name+": sceneName does not exist!"))},PicaNewOldMainPanel.prototype.destroy=function(){t.prototype.destroy.call(this),this.playerInfo=void 0,this.roomInfo=void 0},PicaNewOldMainPanel.prototype.update=function(e){t.prototype.update.call(this),e&&(e.hasOwnProperty("roomId")?this.roomInfo=e:this.playerInfo=e),this.playerInfo&&this.updatePlayerInfo(this.playerInfo),this.roomInfo&&this.updateRoomInfo(this.roomInfo)},PicaNewOldMainPanel.prototype.updatePlayerInfo=function(t){if(this.playerInfo=t,this.mInitialized){if(t.level){var e=t.level;this.playerLv.text=e.level+""}if(void 0!==t.coin&&this.mCoinValue.setText(this.getCoin().value+""||"0"),void 0!==t.diamond&&this.mDiamondValue.setText(this.getDiamond().value+""||"0"),t.energy){var i=t.energy;i?this.mStrengthValue.setValue(i.currentValue,i.max):this.mStrengthValue.setValue(0,100)}this.mSceneName.rightIcon.visible=this.isSelfRoom}},PicaNewOldMainPanel.prototype.getCoin=function(){for(var t=0,e=this.playerInfo.properties;t<e.length;t++){var i=e[t];if(i.hasOwnProperty("id")){if("IV0000001"===i.id)return i}else h.Logger.getInstance().error(i.key+"  缺少ID")}},PicaNewOldMainPanel.prototype.getDiamond=function(){for(var t=0,e=this.playerInfo.properties;t<e.length;t++){var i=e[t];if(i.hasOwnProperty("id")){if("IV0000002"===i.id)return i}else h.Logger.getInstance().error(i.key+"  缺少ID")}},PicaNewOldMainPanel.prototype.updateRoomInfo=function(t){this.roomInfo=t,this.mInitialized&&(this.roomCon.setSize(60*this.dpr,30*this.dpr),t.name&&(this.mSceneName.setText(t.name),this.roomCon.setSize(2*this.mSceneName.rightbound,30*this.dpr)),this.roomCon.setInteractive(),this.isSceneNameActive=!0,t.playerCount&&this.mCounter.setText(""+t.playerCount),this.mCounter.x=this.mSceneName.x+this.mSceneName.rightbound+5*this.dpr,this.praiseBtn.visible=!1,t.roomType&&("room"!==t.roomType&&"store"!==t.roomType||(this.praiseBtn.visible=!0),this.praiseBtn.setText(t.praise+""),this.praiseBtn.selected=t.hasPraised,t.hasPraised?(this.praiseBtn.setTextColor("#8E99C1"),this.praiseImg.setFrame("praise_after")):(this.praiseBtn.setTextColor("#ffffff"),this.praiseImg.setFrame("praise_before"))),this.mSceneName.rightIcon.visible=this.isSelfRoom,this.partyBtn.visible=this.isSelfRoom,t.openingParty?this.partyBtn.setText(h.i18n.t("common.manager")):this.partyBtn.setText(h.i18n.t("main_ui.party")))},Object.defineProperty(PicaNewOldMainPanel.prototype,"isSelfRoom",{get:function(){if(!this.playerInfo||!this.roomInfo)return!1;for(var t=this.playerInfo.rooms,e=this.roomInfo.roomId,i=0,n=t;i<n.length;i++){if(n[i].roomId===e)return!0}return!1},enumerable:!1,configurable:!0}),PicaNewOldMainPanel.prototype.updateUIState=function(t){this.mInitialized&&("mainui.playerinfo"===t.name&&(this.playerCon.visible=t.visible),"mainui.roominfo"===t.name&&(this.roomCon.visible=t.visible),"mainui.headbtn"===t.name&&(t.disabled?this.playerIcon.removeInteractive():this.playerIcon.setInteractive()),"mainui.entereditorbtn"===t.name&&(this.mSceneName.visible=t.visible,this.isSceneNameActive&&(t.disabled?this.roomCon.removeInteractive():(this.roomCon.setSize(2*this.mSceneName.rightbound,30*this.dpr),this.roomCon.setInteractive()))))},PicaNewOldMainPanel.prototype.init=function(){var e=this.scene.cameras.main.width,i=this.scene.cameras.main.height;this.playerCon=this.scene.make.container(void 0,!1),this.playerCon.y=25*this.dpr,this.add(this.playerCon),this.mCoinValue=new p(this.scene,this.key,"coin",this.dpr),this.mDiamondValue=new p(this.scene,this.key,"diamond",this.dpr),this.mDiamondValue.setHandler(new h.Handler(this,this.onOpenRechargeHandler)),this.mDiamondValue.y=35*this.dpr;var n=this.scene.textures.getFrame(this.key,"strength_progress");this.mStrengthValue=new u(this.scene,this.key,"strength_icon",this.dpr),this.mStrengthValue.x=76*this.dpr;var a=new s.NineSlicePatch(this.scene,68*this.dpr/2,this.mStrengthValue.height/2-n.height-1*this.dpr,92*this.dpr,n.height,this.key,"strength_progress",{left:8*this.dpr,top:3*this.dpr,right:n.width-2-8*this.dpr,bottom:n.height-1-3*this.dpr});this.mStrengthValue.setProgress(a,this.scale),this.playerIcon=this.scene.make.image({key:this.key,frame:"head"}),this.playerIcon.x=.5*-this.mStrengthValue.width-8*this.dpr,this.mStrengthValue.add(this.playerIcon),this.playerIcon.on("pointerup",this.onHeadHandler,this),this.playerIcon.setInteractive(),this.mStrengthValue.setValue(1e3,1e3),this.mStrengthValue.setInteractive(),this.mStrengthValue.on("pointerup",this.onStrengthHandler,this);var l=this.playerIcon.x+.5*this.playerIcon.width-2*this.dpr,c=this.playerIcon.y+.5*this.playerIcon.height-10*this.dpr;this.playerLv=this.scene.make.text({text:"0",x:l,y:c,style:{fontSize:11*this.dpr,bold:!0,fontFamily:h.Font.DEFULT_FONT,color:"#356EE3"}},!1).setOrigin(1,0),this.playerLv.setShadow(0,0,"#ffffff",2),this.playerLv.setStroke("#356EE3",2),this.playerLv.setShadowStroke(!0),this.mStrengthValue.add(this.playerLv),this.playerCon.add([this.mStrengthValue,this.mCoinValue,this.mDiamondValue]),this.roomCon=this.scene.make.container(void 0,!1),this.roomCon.y=this.playerCon.y+32*this.dpr,this.add(this.roomCon),this.mSceneName=new m(this.scene,this.key,"room_icon","setting_icon",this.dpr),this.mSceneName.setText(""),this.mSceneName.x=18*this.dpr,this.mCounter=new d(this.scene,r.c.commonKey,"home_persons",this.dpr),this.mCounter.setText(""),this.mCounter.x=this.mSceneName.x+this.mSceneName.rightbound+5*this.dpr,this.mCounter.y=this.mSceneName.y,this.mCounter.setColor("#28D5F5"),this.textToolTip=new o.TextToolTips(this.scene,r.c.commonKey,"tips_bg",this.dpr,this.scale),this.textToolTip.setSize(160*this.dpr,45).visible=!1,this.praiseBtn=new s.CheckBox(this.scene,this.key,"praise_before_bg","praise_after_bg","1"),this.praiseBtn.y=this.mSceneName.y+this.mSceneName.height+.5*this.praiseBtn.height+20*this.dpr,this.praiseBtn.x=8*this.dpr+.5*this.praiseBtn.width,this.praiseBtn.setTextStyle({fontSize:11*this.dpr,fontFamily:h.Font.DEFULT_FONT}),this.praiseBtn.setTextOffset(10*this.dpr,0),this.praiseBtn.on(String(s.ClickEvent.Tap),this.onPraiseHandler,this),this.praiseImg=this.scene.make.image({key:this.key,frame:"praise_before"}),this.praiseImg.x=-10*this.dpr,this.praiseBtn.add(this.praiseImg),this.partyBtn=new s.Button(this.scene,this.key,"home_party_bg","home_party_bg",h.i18n.t("main_ui.party")),this.partyBtn.x=this.praiseBtn.x+.5*this.praiseBtn.width+.5*this.partyBtn.width+5*this.dpr,this.partyBtn.y=this.praiseBtn.y,this.partyBtn.setTextOffset(8*this.dpr,0),this.partyBtn.setTextStyle({fontSize:11*this.dpr,fontFamily:h.Font.DEFULT_FONT}),this.partyBtn.on(String(s.ClickEvent.Tap),this.onPartyHandler,this),this.roomCon.add([this.mSceneName,this.mCounter,this.praiseBtn,this.partyBtn,this.textToolTip]),this.roomCon.setSize(2*this.mSceneName.rightbound,30*this.dpr),this.resize(e,i),t.prototype.init.call(this)},PicaNewOldMainPanel.prototype.onOpenRoomPanel=function(){this.render.renderEmitter("openroompanel")},PicaNewOldMainPanel.prototype.onHeadHandler=function(){this.render.renderEmitter("showPanel",a.ModuleName.CHARACTERINFO_NAME)},PicaNewOldMainPanel.prototype.onStrengthHandler=function(){var t=this;if(this.playerInfo){var e=this.playerInfo.energy,i=e.currentValue+"/"+e.max+"\n",n=h.i18n.t("main_ui.energy_tips",{name:i,interpolation:{escapeValue:!1}});this.textToolTip.visible||this.scene.input.on("pointerdown",this.onTextToolTipHandler,this),this.textToolTip.setDelayText(n,3e3,new h.Handler(this,(function(){t.scene.input.off("pointerdown",t.onTextToolTipHandler,t)}))),this.textToolTip.setPosition(120*this.dpr,20*this.dpr)}},PicaNewOldMainPanel.prototype.onTextToolTipHandler=function(){this.textToolTip.visible=!1,this.scene.input.off("pointerdown",this.onTextToolTipHandler,this)},PicaNewOldMainPanel.prototype.checkUpdateActive=function(){return __awaiter(this,void 0,void 0,(function(){var t,e,i,n;return __generator(this,(function(s){switch(s.label){case 0:return[4,this.mWorld.mainPeer.getActiveUIData("PicaMainUI")];case 1:if(t=s.sent())for(e=0,i=t;e<i.length;e++)n=i[e],this.updateUIState(n);return[2]}}))}))},PicaNewOldMainPanel.prototype.onUpdatePlayerHandler=function(t){this.playerInfo=t,this.updatePlayerInfo(t)},PicaNewOldMainPanel.prototype.onUpdateRoomHandler=function(t){this.roomInfo=t,this.updateRoomInfo(t)},PicaNewOldMainPanel.prototype.onUpdatePartyHandler=function(t){this.roomInfo&&this.updateRoomInfo(this.roomInfo)},PicaNewOldMainPanel.prototype.onPraiseHandler=function(t,e){this.render.renderEmitter(a.EventType.QUERY_PRAISE,e.selected)},PicaNewOldMainPanel.prototype.onPartyHandler=function(){this.render.renderEmitter("showPanel",a.ModuleName.PICAOPENPARTY_NAME)},PicaNewOldMainPanel.prototype.onOpenRechargeHandler=function(){this.render.renderEmitter("showPanel",a.ModuleName.PICARECHARGE_NAME)},PicaNewOldMainPanel}(o.BasePanel),p=function(t){function ValueContainer(e,i,n,s){void 0===s&&(s=1);var r=t.call(this,e)||this;return r.init(i,n,s),r}return l(ValueContainer,t),ValueContainer.prototype.setText=function(t){this.mText.setText(t)},ValueContainer.prototype.setHandler=function(t){this.sendHandler=t},ValueContainer.prototype.init=function(t,e,i){var n=this.scene.make.image({key:t,frame:"home_progress_bottom"},!1);n.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mLeft=this.scene.make.image({key:t,frame:e},!1),this.mLeft.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mText=this.scene.make.text({text:"0",width:n.width,height:n.height,style:{fontSize:14*i,fontFamily:h.Font.NUMBER}},!1).setOrigin(.5),this.mText.setStroke("#000000",1*i),this.mText.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mAddBtn=new s.Button(this.scene,t,"add_btn","add_btn"),this.setSize(n.width,n.height),this.mLeft.x=.5*-n.width+5*i,this.mLeft.y=n.y+.5*n.height-.5*this.mLeft.height,this.mAddBtn.x=this.width*this.originX-this.mAddBtn.width*this.originX-5*i,this.mText.x=4*i,this.add([n,this.mLeft,this.mText,this.mAddBtn]),this.mAddBtn.on(s.ClickEvent.Tap,this.onAddHandler,this)},ValueContainer.prototype.onAddHandler=function(){this.sendHandler&&this.sendHandler.run()},ValueContainer}(Phaser.GameObjects.Container),d=function(t){function IconText(e,i,n,s){void 0===s&&(s=1);var r=t.call(this,e)||this,o=e.make.image({key:i,frame:n},!1);return r.mText=e.make.text({style:{fontSize:14*s,fontFamily:h.Font.DEFULT_FONT}},!1).setOrigin(0,.5),r.mText.x=o.width/2+4*s,r.mText.setStroke("#000000",2*s),r.add([o,r.mText]),r}return l(IconText,t),IconText.prototype.setText=function(t){this.mText.setText(t)},IconText.prototype.setStroke=function(t,e){this.mText.setStroke(t,e)},IconText.prototype.setColor=function(t){this.mText.setColor(t)},IconText}(Phaser.GameObjects.Container),m=function(t){function SceneName(e,i,n,s,r){void 0===r&&(r=1);var o=t.call(this,e,i,n,r)||this;return o.mDpr=r,o.mRightIcon=e.make.image({y:2*r,key:i,frame:s},!1),o.add(o.mRightIcon),o.mRightIcon.y=8*r,o.mRightIcon.x=10*r,o}return l(SceneName,t),SceneName.prototype.setText=function(e){t.prototype.setText.call(this,e)},Object.defineProperty(SceneName.prototype,"rightbound",{get:function(){return this.mText.x+this.mText.width+10*this.mDpr},enumerable:!1,configurable:!0}),Object.defineProperty(SceneName.prototype,"rightIcon",{get:function(){return this.mRightIcon},enumerable:!1,configurable:!0}),SceneName}(d),u=(function(t){function ExpProgress(e,i,n,r,o){var a=t.call(this,e)||this,l=o.getSize().width/r,c=a.scene.textures.getFrame(i,"exp_bg");a.setSize(l,c.height);var p=a.width,d=a.height;a.mProgressBar=new y(e,n),a.mProgressBar.setSize(a.width,a.height);var m=new s.NineSlicePatch(a.scene,p/2,d/2,p,d,i,"exp_bg",{left:8*n,top:3*n,right:c.width-2-8*n,bottom:c.height-1-3*n});a.mProgressBar.setBackground(m),c=a.scene.textures.getFrame(i,"exp_progress");var u=new s.NineSlicePatch(a.scene,p/2,d/2,l,c.height,i,"exp_progress",{left:8*n,top:3*n,right:c.width-2-10*n,bottom:c.height-1-5*n});return a.mProgressBar.setProgress(u,r),a.mProgressBar.setRatio(.5),a.mCurrentLv=e.make.text({text:"57",style:{fontSize:10*n,fontFamily:h.Font.DEFULT_FONT}},!1),a.mCurrentLv.setStroke("#000000",1*n),a.mNextLv=e.make.text({text:"58",style:{fontSize:10*n,fontFamily:h.Font.DEFULT_FONT}},!1).setOrigin(0,0),a.mNextLv.setStroke("#000000",1*n),a.mNextLv.x=a.width-a.mNextLv.width,a.add([a.mProgressBar,a.mCurrentLv,a.mNextLv]),a}l(ExpProgress,t),ExpProgress.prototype.setLv=function(t,e){this.mCurrentLv.setText(t.toString()),this.mNextLv.setText((t+1).toString()),this.mNextLv.x=this.width-this.mNextLv.width,this.mProgressBar.setRatio(e)}}(Phaser.GameObjects.Container),function(t){function ProgressValue(e,i,n,s){return t.call(this,e,i,n,s)||this}return l(ProgressValue,t),ProgressValue.prototype.setProgress=function(t,e){this.mProgress.setProgress(t,e)},ProgressValue.prototype.setValue=function(t,e){this.mText&&(this.mText.text=t+"/"+e,this.mProgress.setRatio(t/e))},ProgressValue.prototype.setInteractive=function(e){return e=e||new Phaser.Geom.Rectangle(0,0,this.width,this.height),t.prototype.setInteractive.call(this,e,Phaser.Geom.Rectangle.Contains),this},ProgressValue.prototype.init=function(t,e,i){var n=this.scene.make.image({key:t,frame:"home_progress_bottom"},!1);n.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.setSize(n.width,n.height),this.mLeft=this.scene.make.image({key:t,frame:e},!1),this.mLeft.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mProgress=new y(this.scene,i),this.mProgress.x=-this.width/2+10*i,this.mProgress.y=4*i,this.mText=this.scene.make.text({text:"0",width:n.width,height:n.height,style:{fontSize:10*i,fontFamily:h.Font.NUMBER}},!1).setOrigin(.5),this.mText.setStroke("#000000",1*i),this.mText.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mAddBtn=new s.Button(this.scene,t,"add_btn","add_btn"),this.setSize(n.width,n.height),this.mLeft.x=-this.width*this.originX+13*i,this.mAddBtn.x=this.width*this.originX-10*i,this.add([n,this.mProgress,this.mLeft,this.mText,this.mAddBtn])},ProgressValue}(p)),y=function(t){function ProgressBar(e,i){var n=t.call(this,e)||this;return n.dpr=i,n}return l(ProgressBar,t),ProgressBar.prototype.setBackground=function(t){this.addAt(t,0)},ProgressBar.prototype.setProgress=function(t,e){this.mScale=e,this.mProgress=t,this.add(this.mProgress),this.setSize(t.width*this.mScale,t.height*this.mScale);var i=t.getWorldTransformMatrix();this.worldpos=new Phaser.Geom.Point(i.tx,i.ty),this.mMaskGraphics=this.scene.make.graphics(void 0,!1),this.mMaskGraphics.fillStyle(16750848),this.mMaskGraphics.fillRect(0,0,this.width,this.height+8*this.dpr),this.mProgress.mask=new Phaser.Display.Masks.GeometryMask(this.scene,this.mMaskGraphics),this.mMaskGraphics.y=i.ty+this.height+4*this.dpr,this.mMaskGraphics.x=i.tx},ProgressBar.prototype.setRatio=function(t){this.mMaskGraphics&&(this.mMaskGraphics.x=this.worldpos.x+4*this.dpr-.5*this.mProgress.width+(this.width*t-this.width))},ProgressBar}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaOrderPanel",(function(){return c}));var n,s=i(5),r=i(470),o=i(1),a=i(11),h=i(0),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function fulfilled(t){try{step(n.next(t))}catch(t){r(t)}}function rejected(t){try{step(n.throw(t))}catch(t){r(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function verb(r){return function(a){return function step(r){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(s=2&r[0]?n.return:r[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,r[1])).done)return s;switch(n=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],n=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},c=function(t){function PicaOrderPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i.key=o.ModuleName.PICAORDER_NAME,i}return l(PicaOrderPanel,t),PicaOrderPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,n,s),this.setSize(n,s),this.mBackground.clear(),this.mBackground.fillStyle(0,.5),this.mBackground.fillRoundedRect(-this.x,-this.y,n,s),this.content.x=.5*n,this.content.y=.5*s+10*this.dpr,this.mGameGrid.resetMask(),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,n,s),Phaser.Geom.Rectangle.Contains)},PicaOrderPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicaOrderPanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.OnClosePanel,this)},PicaOrderPanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.OnClosePanel,this)},PicaOrderPanel.prototype.preload=function(){this.addAtlas(this.key,"order/order.png","order/order.json"),this.addAtlas(a.c.commonKey,a.d.commonUrl+".png",a.d.commonUrl+".json"),this.addAtlas(a.c.common2Key,a.d.common2Url+".png",a.d.common2Url+".json"),h.Logger.getInstance().debug("=====>> dpr",this.dpr),t.prototype.preload.call(this)},PicaOrderPanel.prototype.init=function(){var e=this;this.mBackground=this.scene.make.graphics(void 0,!1),this.add(this.mBackground);var i=295*this.dpr,n=454*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(i,n),this.add(this.content),this.bg=new s.NineSlicePatch(this.scene,0,0,i,n,a.c.commonKey,"bg",{left:30*this.dpr,top:30*this.dpr,bottom:30*this.dpr,right:30*this.dpr});var l=.5*-n;this.titlebg=this.scene.make.image({x:0,y:0,key:this.key,frame:"order_title_bg"}),this.titlebg.y=l-.5*this.titlebg.height+2*this.dpr;var c=this.scene.make.image({x:0,y:0,key:this.key,frame:"order_title"});c.y=this.titlebg.y+34*this.dpr,this.tilteName=this.scene.make.text({x:0,y:l-18*this.dpr,text:h.i18n.t("order.title"),style:{color:"#905B06",fontSize:15*this.dpr,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(.5,0),this.closeBtn=this.scene.make.image({x:.5*i-5*this.dpr,y:l+5*this.dpr,key:a.c.commonKey,frame:"close"}),this.tilteName.setStroke("#8F4300",2),this.tilteName.setResolution(this.dpr),this.closeBtn.setInteractive(),this.orderProgressPanel=new u(this.scene,252*this.dpr,45*this.dpr,this.key,this.dpr),this.orderProgressPanel.y=.5*-n+20*this.dpr,this.orderProgressPanel.setHandler(new h.Handler(this,this.onProgressHandler));var d={x:0,y:15*this.dpr,table:{width:i-40*this.dpr,height:n-110*this.dpr,columns:1,cellWidth:i-40*this.dpr,cellHeight:70*this.dpr,reuseCellContainer:!0,zoom:this.scale},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,i){t.scene;var n=t.index,s=t.item;return null===i&&((i=new p(e.uiManager,e.key,e.dpr)).setHandler(new h.Handler(e,e.onSendHandler),new h.Handler(e,e.onRefreshOrderList),new h.Handler(e,e.onItemInfoTips)),i.on("pointerdown",e.onClickDownHandler,e)),i.setOrderData(s,n),i}};this.mGameGrid=new s.GameGridTable(this.scene,d),this.mGameGrid.layout(),this.goldImageValue=new r.ImageValue(this.scene,50*this.dpr,14*this.dpr,this.key,"iv_coin_s",this.dpr),this.goldImageValue.setFrameValue("",this.key,"order_precious"),this.goldImageValue.setTextStyle({color:"#144B99",fontSize:10*this.dpr,fontFamily:h.Font.DEFULT_FONT}),this.goldImageValue.setFontStyle("bold"),this.goldImageValue.y=.5*n-25*this.dpr,this.goldImageValue.visible=!1,this.orderProgressPanel.visible=!1,this.itemtips=new r.ItemInfoTips(this.scene,121*this.dpr,46*this.dpr,a.c.common2Key,"tips_bg",this.dpr),this.itemtips.setVisible(!1),this.content.add([this.bg,this.closeBtn,this.titlebg,c,this.tilteName,this.orderProgressPanel,this.mGameGrid,this.goldImageValue,this.itemtips]),this.resize(),t.prototype.init.call(this),this.render.renderEmitter(o.ModuleName.PICAORDER_NAME+"_questlist"),this.render.renderEmitter(o.ModuleName.PICAORDER_NAME+"_questprogress")},PicaOrderPanel.prototype.setOrderDataList=function(t){this.goldImageValue.visible=!0,this.orderProgressPanel.visible=!0;var e=t.orders;this.mGameGrid.setItems(e),this.royalOrderLimit=t.royalOrderLimit,this.goldImageValue.setText(this.royalOrderLimit.currentValue+"/"+this.royalOrderLimit.max),this.goldImageValue.resetSize(),this.goldImageValue.x=.5*this.content.width-.5*this.goldImageValue.width-20*this.dpr},PicaOrderPanel.prototype.setOrderProgress=function(t){this.progressData=t,this.orderProgressPanel.setProgressDatas(t)},PicaOrderPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaOrderPanel.prototype.OnClosePanel=function(){this.render.renderEmitter(o.ModuleName.PICAORDER_NAME+"_hide")},PicaOrderPanel.prototype.onSendHandler=function(t,e){var i=this;2===e?new r.AlertView(this.uiManager).show({text:h.i18n.t("order.refreshtips"),title:h.i18n.t("order.refreshtitle"),oy:302*this.dpr*this.mWorld.uiScale,callback:function(){i.render.renderEmitter(o.ModuleName.PICAORDER_NAME+"_changeorder",{index:t,orderOperator:e})}}):this.render.renderEmitter(o.ModuleName.PICAORDER_NAME+"_changeorder",{index:t,orderOperator:e})},PicaOrderPanel.prototype.onProgressHandler=function(t,e){if(this.progressData){var i=e.progressData;i.received||(i.targetValue<=this.progressData.currentProgressValue?this.render.renderEmitter(o.ModuleName.PICAORDER_NAME+"_questreward",t):(this.itemtips.setItemData(i.rewards[0]),this.showItemTipsState(e)))}},PicaOrderPanel.prototype.onRefreshOrderList=function(){this.render.renderEmitter(o.ModuleName.PICAORDER_NAME+"_questlist")},PicaOrderPanel.prototype.onItemInfoTips=function(t){var e=t.itemData;this.itemtips.setItemData(e),this.showItemTipsState(t,10*this.dpr)},PicaOrderPanel.prototype.onClickDownHandler=function(){this.itemtips.setVisible(!1)},PicaOrderPanel.prototype.showItemTipsState=function(t,e){void 0===e&&(e=0);var i=this.itemtips.x,n=this.itemtips.y;this.setTipsPosition(t,e),i!==this.itemtips.x||n!==this.itemtips.y?this.itemtips.setVisible(!0):this.itemtips.setVisible(!this.itemtips.visible)},PicaOrderPanel.prototype.setTipsPosition=function(t,e){void 0===e&&(e=0);for(var i=t.x,n=t.y,s=t;s.parentContainer!==this.content;)i+=s.parentContainer.x,n+=s.parentContainer.y,s=s.parentContainer;i-.5*this.itemtips.width<.5*-this.content.width?this.itemtips.x=.5*this.itemtips.width-.5*this.content.width+20*this.dpr:i+.5*this.itemtips.width>.5*this.content.width?this.itemtips.x=.5*this.content.width-.5*this.itemtips.width-20*this.dpr:this.itemtips.x=i,this.itemtips.y=n-.5*this.itemtips.height+10*this.dpr+e},PicaOrderPanel}(r.BasePanel),p=function(t){function OrderItem(e,i,n){var o=t.call(this,e.scene)||this;o.materialItems=[],o.imageValues=[],o.orderRewards=[],o.key=i,o.dpr=n,o.mScene=e.scene,o.mRender=e.render,o.bg=o.mScene.make.image({key:i,frame:"order_ordinary_bg"}),o.add(o.bg),o.setSize(o.bg.width,o.bg.height),o.headbg=o.mScene.make.image({key:i,frame:"order_ordinary_head_bg"}),o.add(o.headbg),o.headbg.x=.5*-o.width+.5*o.headbg.width+4*n,o.headbg.y=5*n,o.headIcon=new r.DynamicImage(o.mScene,o.headbg.x,0),o.add(o.headIcon),o.refreshBtn=new s.Button(o.mScene,o.key,"order_delete_bg","order_delete_bg"),o.refreshBtn.x=.5*o.width-.5*o.refreshBtn.width,o.refreshBtn.y=.5*-o.height+.5*o.refreshBtn.height,o.add(o.refreshBtn);var l=o.mScene.make.image({key:i,frame:"order_delete"});return o.refreshBtn.add(l),o.sendBtn=new s.Button(o.mScene,a.c.commonKey,"order_green_butt","order_green_butt",h.i18n.t("order.send")),o.sendBtn.x=.5*o.width-.5*o.sendBtn.width-5*n,o.sendBtn.setTextStyle({fontSize:10*n}),o.add(o.sendBtn),o.sendTitle=o.mScene.make.text({x:.5*o.width-5*n,y:0,text:h.i18n.t("order.deliverying"),style:{color:"#ffffff",fontSize:13*n,fontFamily:h.Font.DEFULT_FONT}}),o.sendTitle.setOrigin(1,.5),o.add(o.sendTitle),o.acceleBtn=new s.Button(o.mScene,a.c.commonKey,"order_red_butt","order_red_butt",h.i18n.t("order.accele")),o.acceleBtn.x=20*n,o.acceleBtn.y=0,o.acceleBtn.setTextStyle({fontSize:11*n}),o.add(o.acceleBtn),o.acceleSpend=new r.ImageValue(o.mScene,30*n,10*n,o.key,"iv_coin_s",o.dpr),o.acceleSpend.x=o.acceleBtn.x,o.acceleSpend.y=o.acceleBtn.y-.5*o.acceleBtn.height-10*n,o.add(o.acceleSpend),o.calcuTime=new r.ImageValue(o.mScene,30*n,10*n,o.key,"iv_coin_s",n),o.add(o.calcuTime),o.calcuTime.setTextStyle({color:"#144B99",fontSize:10*o.dpr,fontFamily:h.Font.DEFULT_FONT}),o.calcuTime.setFontStyle("bold"),o.calcuTime.x=o.acceleBtn.x,o.calcuTime.y=o.acceleBtn.y+.5*o.acceleBtn.height+10*n,o.sendBtn.on(String(s.ClickEvent.Tap),o.onSendHandler,o),o.acceleBtn.on(String(s.ClickEvent.Tap),o.onAcceleHandler,o),o.refreshBtn.on(String(s.ClickEvent.Tap),o.onRefreshHandler,o),o.setInteractive(),o}return l(OrderItem,t),OrderItem.prototype.setHandler=function(t,e,i){this.sendHandler=t,this.tipsHandler=i,this.refreshHandler=e},OrderItem.prototype.setOrderData=function(t,e){var i=this;if(this.orderData=t,this.index=e,this.hideAllElement(),this.bg.setFrame(5===t.questType?"order_precious_bg":"order_ordinary_bg"),4!==t.stage){var n=h.Url.getOsdRes(t.display.texturePath);this.headIcon.load(n,this,(function(){i.headIcon.scale=1,i.headIcon.scaleY=49*i.dpr/i.headIcon.displayHeight,i.headIcon.scaleX=i.headIcon.scaleY})),this.headIcon.visible=!0}1===t.stage?(this.deliveryState(t),this.orderOperator=0):2===t.stage?this.deliveryingState(t):3===t.stage?(this.rewardState(t),this.orderOperator=3):4===t.stage&&(this.cooldownState(t),this.orderOperator=1)},OrderItem.prototype.destroy=function(e){this.timeID&&(clearTimeout(this.timeID),this.timeID=void 0),t.prototype.destroy.call(this,e)},OrderItem.prototype.getServiceTimestamp=function(){return this.mRender.mainPeer.now()},OrderItem.prototype.onAcceleHandler=function(){this.sendHandler&&this.sendHandler.runWith([this.index,this.orderOperator])},OrderItem.prototype.onSendHandler=function(){this.sendHandler&&this.sendHandler.runWith([this.index,this.orderOperator])},OrderItem.prototype.onRefreshHandler=function(){this.sendHandler&&this.sendHandler.runWith([this.index,2])},OrderItem.prototype.deliveryState=function(t){var e=t.questType;this.headbg.setFrame(5===e?"order_precious_head_bg":"order_ordinary_head_bg"),this.refreshBtn.visible=!0,this.refreshBtn.setInteractive(),this.refreshBtn.setFrameNormal(5===e?"order_precious_delete_bg":"order_delete_bg");for(var i=.5*-this.width+58*this.dpr,n=!0,s=0;s<t.targets.length;s++){var o=t.targets[s],a=void 0;s<this.materialItems.length?a=this.materialItems[s]:(a=new d(this.scene,this.key,this.dpr),this.add(a),this.materialItems.push(a),a.setHandler(this.tipsHandler),a.addListen()),a.setMaterialData(o),a.x=i+.5*a.width,i+=a.width+8*this.dpr,a.y=-10*this.dpr,a.visible=!0,n&&(n=o.count>=o.neededCount)}n?(this.sendBtn.setFrameNormal("order_green_butt"),this.sendBtn.setInteractive()):(this.sendBtn.setFrameNormal("order_gray_butt"),this.sendBtn.disInteractive()),this.sendBtn.visible=!0,this.sendBtn.setText(h.i18n.t("order.send")),this.sendBtn.setTextColor("#ffffff"),i=.5*-this.width+58*this.dpr;for(s=0;s<t.rewards.length;s++){var l=t.rewards[s];a=void 0;s<this.imageValues.length?a=this.imageValues[s]:(a=new r.ImageValue(this.scene,30*this.dpr,13*this.dpr,this.key,"iv_coin_s",this.dpr),this.add(a),this.imageValues.push(a)),a.setOffset(0,this.dpr),a.setFrameValue(""+l.count,this.key,this.getIconName(l.display.texturePath)+"_s"),a.setTextStyle({color:5===e?"#ffffff":"#2154BD"}),a.x=i+.5*a.width,i+=a.width+20*this.dpr,a.y=.5*this.height-.5*a.height-4*this.dpr,a.visible=!0}},OrderItem.prototype.deliveryingState=function(t){var e=this;this.deliverybg?this.deliverybg.visible=!0:(this.deliverybg=this.scene.make.image({key:this.key,frame:"order_transport"}),this.addAt(this.deliverybg,1),this.deliverybg.x=.5*this.width-.5*this.deliverybg.width-10*this.dpr),this.headbg.setFrame("order_ordinary_head_bg"),this.sendTitle.visible=!0,this.timeID&&(clearTimeout(this.timeID),this.timeID=void 0);var timeextu=function(){return __awaiter(e,void 0,void 0,(function(){var e,i,n,s,r;return __generator(this,(function(o){switch(o.label){case 0:return[4,this.getServiceTimestamp()];case 1:return e=o.sent(),(i=Math.ceil(t.deliveryDeadline-e/1e3))<0&&(i=0),n=Math.floor(i/60),r=(n<10?"0"+n:n+"")+":"+((s=i%60)<10?"0"+s:s+""),this.calcuTime.visible=!0,this.calcuTime.setFrameValue(r,this.key,"order_time"),this.calcuTime.resetSize(),this.calcuTime.x=.5*this.width-.5*this.calcuTime.width-10*this.dpr,this.calcuTime.y=.5*this.height-.5*this.calcuTime.height-5*this.dpr,i>0?this.timeID=setTimeout((function(){timeextu()}),1e3):(this.timeID&&this.refreshHandler&&this.refreshHandler.run(),this.timeID=void 0),[2]}}))}))};timeextu();for(var i=.5*-this.width+60*this.dpr,n=0;n<t.rewards.length;n++){var s=t.rewards[n],o=void 0;n<this.imageValues.length?o=this.imageValues[n]:(o=new r.ImageValue(this.scene,30*this.dpr,13*this.dpr,this.key,"iv_coin_s",this.dpr),this.add(o),this.imageValues.push(o)),o.setFrameValue(""+s.count,this.key,this.getIconName(s.display.texturePath)+"_s"),o.setTextStyle({color:"#2154BD"}),o.x=i+.5*o.width,i+=o.width+20*this.dpr,o.y=.5*this.height-.5*o.height-4*this.dpr,o.visible=!0}},OrderItem.prototype.rewardState=function(t){this.headbg.setFrame("order_ordinary_head_bg"),this.sendBtn.visible=!0,this.sendBtn.setInteractive(),this.sendBtn.setFrameNormal("order_yellow_butt"),this.sendBtn.setText(h.i18n.t("order.receive")),this.sendBtn.setTextColor("#9A6600");for(var e=.5*-this.width+60*this.dpr,i=0;i<t.rewards.length;i++){var n=t.rewards[i],s=void 0;i<this.orderRewards.length?s=this.orderRewards[i]:(s=new m(this.scene,this.key,this.dpr),this.add(s),this.orderRewards.push(s)),s.x=e+.5*s.width,e+=s.width+20*this.dpr,s.y=-6*this.dpr,s.visible=!0,s.setItemData(n)}},OrderItem.prototype.cooldownState=function(t){var e=this;this.headbg.setFrame("order_unknown_head"),this.headIcon.visible=!1,this.acceleBtn.visible=!0,this.acceleBtn.setInteractive(),this.acceleSpend.visible=!0,this.calcuTime.visible=!0,this.calcuTime.y=this.acceleBtn.y+.5*this.acceleBtn.height+10*this.dpr,this.timeID&&(clearTimeout(this.timeID),this.timeID=void 0);var timeextu=function(){return __awaiter(e,void 0,void 0,(function(){var e,i,n,s,r;return __generator(this,(function(o){switch(o.label){case 0:return[4,this.getServiceTimestamp()];case 1:return e=o.sent(),(i=Math.ceil(t.refreshDeadline-e/1e3))<0&&(i=0),n=Math.floor(i/60),r=(n<10?"0"+n:n+"")+":"+((s=i%60)<10?"0"+s:s+""),this.calcuTime.visible=!0,this.calcuTime.setFrameValue(r,this.key,"order_time"),this.calcuTime.resetSize(),this.calcuTime.x=this.acceleBtn.x,this.acceleSpend.setFrameValue(n+"",this.key,"iv_diamond_s"),i>0?this.timeID=setTimeout((function(){timeextu()}),1e3):(this.timeID&&this.refreshHandler&&this.refreshHandler.run(),this.timeID=void 0),[2]}}))}))};timeextu()},OrderItem.prototype.getIconName=function(t){var e=t,i=e.lastIndexOf("/"),n=e.lastIndexOf(".");return e.slice(i+1,n)},OrderItem.prototype.hideAllElement=function(){this.refreshBtn.visible=!1,this.refreshBtn.disInteractive(),this.sendBtn.visible=!1,this.sendBtn.disInteractive(),this.sendTitle.visible=!1,this.acceleBtn.visible=!1,this.acceleBtn.disInteractive(),this.acceleSpend.visible=!1,this.calcuTime.visible=!1,this.deliverybg&&(this.deliverybg.visible=!1);for(var t=0,e=this.materialItems;t<e.length;t++){(o=e[t]).visible=!1,o.removeListen()}for(var i=0,n=this.orderRewards;i<n.length;i++){(o=n[i]).visible=!1}for(var s=0,r=this.imageValues;s<r.length;s++){var o;(o=r[s]).visible=!1}this.timeID&&(clearTimeout(this.timeID),this.timeID=void 0)},OrderItem}(Phaser.GameObjects.Container),d=function(t){function MaterialItem(e,i,n){var o=t.call(this,e)||this;return o.key=i,o.dpr=n,o.bg=e.make.image({key:i,frame:"order_demand_icon"}),o.setSize(o.bg.width,o.bg.height),o.icon=new r.DynamicImage(e,0,-5*n),o.icon.setSize(15*n,15*n),o.value=new s.BBCodeText(o.scene,0,.5*o.height-10*n,"60/30",{color:"#0",fontSize:8*o.dpr,fontFamily:h.Font.DEFULT_FONT}).setOrigin(.5),o.add([o.bg,o.icon,o.value]),o.setInteractive(),o}return l(MaterialItem,t),MaterialItem.prototype.setMaterialData=function(t){var e=this;this.itemData=t;var i=h.Url.getOsdRes(t.display.texturePath);this.icon.load(i,this,(function(){e.icon.scale=1,e.icon.scaleX=15*e.dpr/e.icon.displayWidth,e.icon.scaleY=e.icon.scaleX})),this.value.text=t.count+"/"+t.neededCount},MaterialItem.prototype.setHandler=function(t){this.tipsHandler=t},MaterialItem.prototype.addListen=function(){this.on("pointerup",this.onClickHandler,this)},MaterialItem.prototype.removeListen=function(){this.off("pointerdown",this.onClickHandler,this)},MaterialItem.prototype.destroy=function(e){this.removeListen(),t.prototype.destroy.call(this,e)},MaterialItem.prototype.onClickHandler=function(){this.tipsHandler&&this.tipsHandler.runWith(this)},MaterialItem}(Phaser.GameObjects.Container),m=function(t){function OrderRewardItem(e,i,n){var s=t.call(this,e)||this;return s.key=i,s.dpr=n,s.bg=e.make.image({key:i,frame:"order_reward"}),s.setSize(s.bg.width,s.bg.height),s.icon=e.make.image({key:i,frame:"order_silver_middle"}),s.add([s.bg,s.icon]),s}return l(OrderRewardItem,t),OrderRewardItem.prototype.setItemData=function(t){this.imageValue=new r.ImageValue(this.scene,30*this.dpr,13*this.dpr,this.key,void 0,this.dpr),this.imageValue.setFrameValue(""+t.count,this.key,this.getIconName(t.display.texturePath)+"_s"),this.imageValue.x=-4*this.dpr,this.imageValue.y=this.height-.5*this.imageValue.height+2*this.dpr,this.imageValue.setOffset(0,this.dpr),this.imageValue.setTextStyle({color:"#2154BD"}),this.add([this.imageValue]),this.icon.setFrame(this.getIconName(t.display.texturePath))},OrderRewardItem.prototype.getIconName=function(t){var e=t,i=e.lastIndexOf("/"),n=e.lastIndexOf(".");return e.slice(i+1,n)},OrderRewardItem}(Phaser.GameObjects.Container),u=function(t){function OrderProgressPanel(e,i,n,r,o){var a=t.call(this,e)||this;a.progressItems=[],a.setSize(i,n),a.dpr=o,a.key=r;var h={x:0*o/2,y:15*o,width:251*o,height:11*o,background:{x:0,y:0,width:251*o,height:11*o,config:{top:0*o,left:7*o,right:7*o,bottom:0*o},key:r,frame:"order_progress_bottom"},bar:{x:0,y:0,width:251*o,height:11*o,config:{top:0*o,left:7*o,right:7*o,bottom:0*o},key:r,frame:"order_progress_top"},dpr:o,textConfig:void 0};return a.progress=new s.ProgressBar(e,h),a.add(a.progress),a}return l(OrderProgressPanel,t),OrderProgressPanel.prototype.setProgressDatas=function(t){for(var e=t.steps.length,i=100,n=0;n<e;n++){var s=t.steps[n],r=void 0;n<this.progressItems.length?r=this.progressItems[n]:(r=new y(this.scene,0,0,this.key,this.dpr),this.add(r),this.progressItems.push(r),r.setHandler(this.receiveHandler)),r.x=.5*-this.width+this.width*(n+1)/e-16*this.dpr,r.y=15*this.dpr,r.setItemData(s,n,t.currentProgressValue),i=s.targetValue}this.progress.setProgress(t.currentProgressValue,i)},OrderProgressPanel.prototype.setHandler=function(t){this.receiveHandler=t},OrderProgressPanel}(Phaser.GameObjects.Container),y=function(t){function OrderProgressItem(e,i,n,o,a){var l=t.call(this,e,i,n)||this;return l.dpr=a,l.key=o,l.bg=new s.Button(e,o,"order_progress_unfinished","order_progress_unfinished"),l.icon=new r.DynamicImage(e,0,0),l.text=e.make.text({x:0,y:.5*l.bg.height+10*a,text:"10",style:{color:"#2154BD",fontSize:12*a,fontFamily:h.Font.DEFULT_FONT}}),l.text.setFontStyle("bold"),l.text.setOrigin(.5),l.finishIcon=e.make.image({key:o,frame:"order_progress_ok"}),l.balckgraphic=e.make.graphics(void 0,!1),l.balckgraphic.clear(),l.balckgraphic.fillStyle(0,.5),l.balckgraphic.fillCircle(0,0,16*a),l.add([l.bg,l.icon,l.text,l.balckgraphic,l.finishIcon]),l.finishIcon.visible=!1,l}return l(OrderProgressItem,t),OrderProgressItem.prototype.setItemData=function(t,e,i){var n=this;if(this.progressData=t,this.index=e,this.text.text=t.targetValue+"",t.rewards){var r=h.Url.getOsdRes(t.rewards[0].display.texturePath);this.icon.load(r,this,(function(){n.icon.scale=1,n.icon.scaleY=29*n.dpr/n.icon.displayHeight,n.icon.scaleX=n.icon.scaleY}))}this.finishIcon.visible=!1,this.balckgraphic.visible=!1,t.targetValue<=i?(this.bg.setFrameNormal("order_progress_finished","order_progress_finished"),t.received&&(this.finishIcon.visible=!0,this.balckgraphic.visible=!0),this.text.setColor("#2154BD")):(this.bg.setFrameNormal("order_progress_unfinished","order_progress_unfinished"),this.text.setColor("#989898")),t.received?this.bg.off(String(s.ClickEvent.Tap),this.onReceiveHandler,this):(this.bg.off(String(s.ClickEvent.Tap),this.onReceiveHandler,this),this.bg.on(String(s.ClickEvent.Tap),this.onReceiveHandler,this))},OrderProgressItem.prototype.setHandler=function(t){this.receiveHandler=t},OrderProgressItem.prototype.onReceiveHandler=function(){this.receiveHandler&&this.receiveHandler.runWith([this.index,this])},OrderProgressItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRoamEffectOnePanel",(function(){return r}));var n,s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),r=function(t){function PicaRoamEffectOnePanel(e){return t.call(this,e)||this}return s(PicaRoamEffectOnePanel,t),PicaRoamEffectOnePanel}(Phaser.GameObjects.Container);(function(t){function RaomEffectBackground(e){return t.call(this,e)||this}s(RaomEffectBackground,t)})(Phaser.GameObjects.Container),function(t){function RoamEffectBallPanel(e){var i=t.call(this,e)||this;return i.pos=[[194,71,1],[1175,78,-1],[1893,174,1],[484,356,-1],[1590,500,-1],[974,625,-1],[70,898,-1],[1762,1001,-1],[372,1366,-1],[1388,1327,-1],[830,1566,-1],[1765,1723,-1],[1312,1798,-1],[513,2047,-1],[68,2430,-1],[594,2432,1],[1384,2316,-1],[1464,2702,1],[664,2949,1],[215,3019,1],[1151,3176,1],[590,3419,1],[1603,3379,1],[217,3751,1],[1009,4126,1],[387,4245,1],[1495,4383,1],[74,4600,1],[801,4674,1]],i.setSize(1980,4740),i.createBalls(),i}s(RoamEffectBallPanel,t),RoamEffectBallPanel.prototype.createBalls=function(){for(var t=0,e=this.pos;t<e.length;t++)e[t]}}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaWorkPanel",(function(){return c}));var n,s=i(5),r=i(470),o=i(1),a=i(11),h=i(0),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaWorkPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.imageValues=[],i.curProgress=0,i.isWorking=!1,i.moneyAniKey="workemoeny",i.starAniKey="workstar",i.key=o.ModuleName.PICAWORK_NAME,i}return l(PicaWorkPanel,t),PicaWorkPanel.prototype.resize=function(e,i){var n=this.scaleWidth,s=this.scaleHeight;t.prototype.resize.call(this,n,s),this.setSize(n,s),this.content.x=.5*n,this.content.y=s-.5*this.content.height,this.content.setInteractive()},PicaWorkPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen(),this.render.renderEmitter(this.key+"_initialized")):this.preload())},PicaWorkPanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.OnClosePanel,this)},PicaWorkPanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.OnClosePanel,this)},PicaWorkPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaWorkPanel.prototype.preload=function(){this.addAtlas(this.key,"work/work.png","work/work.json"),this.addAtlas(a.c.commonKey,a.d.textureUrl(a.d.commonUrl),a.d.jsonUrl(a.d.commonUrl)),this.addAtlas(a.c.common2Key,a.d.textureUrl(a.d.common2Url),a.d.jsonUrl(a.d.common2Url)),t.prototype.preload.call(this)},PicaWorkPanel.prototype.init=function(){var e=this.scaleWidth,i=153*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.add(this.content),this.bg=this.scene.make.image({key:this.key,frame:"work_bg"}),this.bg.y=.5*i-.5*this.bg.height,this.headIcon=new r.DynamicImage(this.scene,0,0,this.key,"work_npc"),this.headIcon.x=.5*-e+65*this.dpr,this.headIcon.y=-5*this.dpr,this.headIcon.scale=this.dpr,this.headIcon.visible=!1;var n=new s.NineSlicePatch(this.scene,0,0,95*this.dpr,24*this.dpr,this.key,"work_name",{left:14*this.dpr,top:0*this.dpr,bottom:0*this.dpr,right:14*this.dpr});n.x=.5*-e+.5*n.width+15*this.dpr,n.y=35*this.dpr,this.titleName=this.scene.make.text({x:n.x,y:n.y,text:"这是额二比大厨师",style:{color:"#FFE11A",fontSize:11*this.dpr,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(.5),this.salaryLabel=this.scene.make.text({x:.5*-e+20*this.dpr,y:this.bg.y+7*this.dpr,text:h.i18n.t("work.salary")+":",style:h.UIHelper.whiteStyle(this.dpr,11)}),this.salaryLabel.setOrigin(0,.5),this.salaryvalue=new r.ImageValue(this.scene,60*this.dpr,20*this.dpr,a.c.commonKey,"iv_coin",this.dpr),this.salaryvalue.setOffset(-this.dpr,0),this.salaryvalue.setTextStyle({color:"#FFEA00"}),this.salaryvalue.setLayout(1),this.salaryvalue.x=this.salaryLabel.x+this.salaryLabel.width+.5*this.salaryvalue.width+3*this.dpr,this.salaryvalue.y=this.salaryLabel.y,this.workbutton=new d(this.scene,132*this.dpr,35*this.dpr,this.key,"progress_top",h.i18n.t("work.title"),this.dpr),this.workbutton.x=30*this.dpr,this.workbutton.y=5*this.dpr,this.workbutton.on(s.ClickEvent.Tap,this.onSendHandler,this),this.starSprite=this.createSprite(this.key,this.starAniKey,"star",[1,30],24),this.moneySprite=this.createSprite(this.key,this.moneyAniKey,"workover",[1,10],24),this.starSprite.x=this.workbutton.x,this.starSprite.y=this.workbutton.y,this.moneySprite.x=this.starSprite.x,this.moneySprite.y=this.starSprite.y,this.closeBtn=new s.Button(this.scene,this.key,"close","close"),this.closeBtn.y=this.bg.y+2*this.dpr,this.closeBtn.x=.5*this.content.width-.5*this.closeBtn.width-10*this.dpr,this.itemtips=new r.ItemInfoTips(this.scene,150*this.dpr,46*this.dpr,a.c.common2Key,"tips_bg",this.dpr),this.itemtips.setVisible(!1),this.content.add([this.headIcon,this.bg,this.closeBtn,n,this.titleName,this.salaryLabel,this.salaryvalue,this.workbutton,this.starSprite,this.moneySprite,this.closeBtn,this.itemtips]),this.resize(),t.prototype.init.call(this),this.render.renderEmitter(this.key+"_questlist")},PicaWorkPanel.prototype.setWorkData=function(t){this.setJobData(t),this.workbutton.setProgressDatas(0,100)},PicaWorkPanel.prototype.setWorkChance=function(t){t<=0?this.workbutton.disInteractive():this.workbutton.setInteractive()},PicaWorkPanel.prototype.setJobData=function(t){var e=this;this.jobData=t;var i=h.Url.getOsdRes(t.display.texturePath);this.headIcon.load(i,this,(function(){e.headIcon.scale=e.dpr})),this.headIcon.visible=!0,this.titleName.text=t.name;var n="0";if(t.rewards){var s=t.rewards[0].countRange;n=s.start+"~"+s.stop}this.salaryvalue.setText(n);for(var r=t.targets,o=0,a=this.imageValues;o<a.length;o++){(d=a[o]).visible=!1}for(var l=this.salaryvalue.x+.5*this.salaryvalue.width+20*this.dpr,c=0;c<r.length;c++){var d=void 0,m=r[c];c<this.imageValues.length?d=this.imageValues[c]:(d=new p(this.scene,35*this.dpr,15*this.dpr,this.key,this.dpr),this.content.add(d),this.imageValues.push(d),d.setHandler(new h.Handler(this,this.onItemInfoTips)));var u=h.Url.getOsdRes(m.display.texturePath);d.setUrlValue(u,m.neededCount),d.setTextStyle({color:m.count>=m.neededCount?"#000000":"#E71313"}),d.setImageData(m),d.visible=!0,d.x=l+.5*d.width,d.y=this.salaryLabel.y,d.visible=!0,l+=d.width+20*this.dpr}},PicaWorkPanel.prototype.createSprite=function(t,e,i,n,s,r,o){void 0===s&&(s=30),void 0===r&&(r=0);var a=this.scene.make.sprite({key:t,frame:i+"1"});a.visible=!1;var h=this.scene.anims.create({key:e,frames:this.scene.anims.generateFrameNames(t,{prefix:i+"",start:n[0],end:n[1]}),frameRate:s,repeat:r});return h.removeAllListeners(),h.on(Phaser.Animations.Events.ANIMATION_COMPLETE,(function(){a.visible=!1,o&&o.run()}),this),h.on(Phaser.Animations.Events.ANIMATION_START,(function(){a.visible=!0}),this),a},PicaWorkPanel.prototype.calculateTimeout=function(){var t=this;this.isWorking=!0,this.interTimeerID=setTimeout((function(){t.curProgress+=.1,t.workbutton.setProgressDatas(t.curProgress,100),t.curProgress<100?t.calculateTimeout():(t.isWorking=!1,t.curProgress=0,t.workbutton.setProgressDatas(t.curProgress,100),t.render.renderEmitter(t.key+"_questwork"),t.interTimeerID=void 0,t.moneySprite.play(t.moneyAniKey))}),20)},PicaWorkPanel.prototype.OnClosePanel=function(){this.interTimeerID&&clearTimeout(this.interTimeerID),this.render.renderEmitter(this.key+"_hide")},PicaWorkPanel.prototype.onSendHandler=function(t){this.curProgress+=3,this.isWorking||this.calculateTimeout(),this.starSprite.play(this.starAniKey,!0)},PicaWorkPanel.prototype.onItemInfoTips=function(t){var e=t.imageData;this.itemtips.visible=!0,this.itemtips.setTipsPosition(t,this),this.itemtips.setText(this.getDesText(e))},PicaWorkPanel.prototype.getDesText=function(t){return t||(t={sellingPrice:!0,tradable:!1}),h.i18n.t("work.attri",{name:""+t.name,value:t.neededCount})},PicaWorkPanel}(r.BasePanel),p=function(t){function PointerImageValue(e,i,n,s,r){var o=t.call(this,e,i,n,s,void 0,r)||this;return o.addListen(),o}return l(PointerImageValue,t),PointerImageValue.prototype.setImageData=function(t){this.imageData=t},PointerImageValue.prototype.setUrlValue=function(t,e){var i=this;this.value.text=e,this.icon.load(t,this,(function(){i.icon.scale=1,i.icon.scaleY=14*i.dpr/i.icon.displayHeight,i.icon.scaleX=i.icon.scaleY,i.value.x=i.icon.x+.5*i.icon.displayWidth+10*i.dpr,i.resetSize()}))},PointerImageValue.prototype.addListen=function(){this.setInteractive(),this.on("pointerdown",this.onClickDownHandler,this),this.scene.input.on("pointerup",this.onClickUpHandler,this)},PointerImageValue.prototype.removeListen=function(){this.disableInteractive(),this.off("pointerdown",this.onClickDownHandler,this),this.scene.input.off("pointerup",this.onClickUpHandler,this)},PointerImageValue.prototype.destroy=function(e){this.removeListen(),t.prototype.destroy.call(this,e)},PointerImageValue.prototype.setHandler=function(t){this.tipsHandler=t},PointerImageValue.prototype.create=function(){this.icon=new r.DynamicImage(this.scene,0,0),this.value=this.scene.make.text({x:0,y:this.offset.y,text:"10",style:{color:"#ffffff",fontSize:11*this.dpr,fontFamily:h.Font.DEFULT_FONT}}),this.value.setOrigin(0,.5),this.add([this.icon,this.value])},PointerImageValue.prototype.onClickDownHandler=function(){new Phaser.Geom.Point;this.tipsHandler&&this.tipsHandler.runWith([this,!0])},PointerImageValue.prototype.onClickUpHandler=function(){this.tipsHandler&&this.tipsHandler.runWith([this,!1])},PointerImageValue}(r.ImageValue),d=function(t){function ProgressItem(e,i,n,s,o,a,l){var c=t.call(this,e,0,0)||this;return c.setSize(i,n),c.dpr=l,c.key=s,c.progress=new r.ProgressMaskBar(e,s,"progress_bottom","progress_top"),c.add(c.progress),c.title=e.make.text({x:0,y:0,text:a,style:{color:"#512103",fontSize:14*l,fontFamily:h.Font.DEFULT_FONT}}),c.title.setFontStyle("bold"),c.title.setOrigin(.5),c.add(c.title),c.enable=!0,c.mDuration=35,c}return l(ProgressItem,t),ProgressItem.prototype.setProgressDatas=function(t,e){this.progress.setProgress(t,e)},ProgressItem}(r.ButtonEventDispatcher)},function(t,e,i){"use strict";var n,s=i(536),r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)});(function(t){function EditorCamerasManager(){return null!==t&&t.apply(this,arguments)||this}r(EditorCamerasManager,t),EditorCamerasManager.prototype.centerCameas=function(){},EditorCamerasManager.prototype.offsetScroll=function(t,e){if(this.mMain)for(var i=0,n=this.mCameras;i<n.length;i++){var s=n[i];s.scrollX+=t/this.zoom,s.scrollY+=e/this.zoom}},EditorCamerasManager.prototype.syncCameraScroll=function(){}})(s.a),i(326)},function(t,e,i){var n={"./":481,"./Activity/ActivityPanel":540,"./Activity/ActivityPanel.ts":540,"./Bottom/BottomPanel":633,"./Bottom/BottomPanel.ts":633,"./Bubble/InteractionBubbleCell":489,"./Bubble/InteractionBubbleCell.ts":489,"./Bubble/InteractionBubbleContainer":490,"./Bubble/InteractionBubbleContainer.ts":490,"./Bubble/InteractiveBubblePanel":547,"./Bubble/InteractiveBubblePanel.ts":547,"./CharacterInfo/CharacterAttributePanel":484,"./CharacterInfo/CharacterAttributePanel.ts":484,"./CharacterInfo/CharacterEditorPanel":485,"./CharacterInfo/CharacterEditorPanel.ts":485,"./CharacterInfo/CharacterInfoPanel":541,"./CharacterInfo/CharacterInfoPanel.ts":541,"./CharacterInfo/GraphicsProgressBar":542,"./CharacterInfo/GraphicsProgressBar.ts":542,"./Chat/ChatPanel":634,"./Chat/ChatPanel.ts":634,"./Components":472,"./Components/":472,"./Components/Item.button":535,"./Components/Item.button.ts":535,"./Components/back.text.button":538,"./Components/back.text.button.ts":538,"./Components/detail.display":473,"./Components/detail.display.ts":473,"./Components/energy.progress.bar":539,"./Components/energy.progress.bar.ts":539,"./Components/index":472,"./Components/index.ts":472,"./CreateRole/CreateRolePanel":548,"./CreateRole/CreateRolePanel.ts":548,"./CutIn/CutInPanel":549,"./CutIn/CutInPanel.ts":549,"./CutInMenu/CutInMenuPanel":550,"./CutInMenu/CutInMenuPanel.ts":550,"./Dialog/DialogPanel":551,"./Dialog/DialogPanel.ts":551,"./GMTools/GMToolsPanel":635,"./GMTools/GMToolsPanel.ts":635,"./Login/LoginPanel":552,"./Login/LoginPanel.ts":552,"./Login/VerifiePanel":553,"./Login/VerifiePanel.ts":553,"./PicManorInfo/PicManorInfoPanel":554,"./PicManorInfo/PicManorInfoPanel.ts":554,"./PicManorInfo/PicaManorBasePanel":477,"./PicManorInfo/PicaManorBasePanel.ts":477,"./PicManorInfo/PicaManorChildPanel":491,"./PicManorInfo/PicaManorChildPanel.ts":491,"./PicManorInfo/PicaManorShopPanel":492,"./PicManorInfo/PicaManorShopPanel.ts":492,"./PicManorInfo/PicaManorTipsPanel":555,"./PicManorInfo/PicaManorTipsPanel.ts":555,"./PicRoomUpgrade/PicRoomUpgradePanel":556,"./PicRoomUpgrade/PicRoomUpgradePanel.ts":556,"./PicaAvatar/PicaAvatarPanel":557,"./PicaAvatar/PicaAvatarPanel.ts":557,"./PicaBag/PicaBagPanel":558,"./PicaBag/PicaBagPanel.ts":558,"./PicaBusinessMarketingPlan/PicaBusinessChoosePlanPanel":493,"./PicaBusinessMarketingPlan/PicaBusinessChoosePlanPanel.ts":493,"./PicaBusinessMarketingPlan/PicaBusinessMarketingPlanPanel":559,"./PicaBusinessMarketingPlan/PicaBusinessMarketingPlanPanel.ts":559,"./PicaBusinessMarketingPlan/PicaBusinessPlanPanel":494,"./PicaBusinessMarketingPlan/PicaBusinessPlanPanel.ts":494,"./PicaBusinessStreet/PicaBusinessContentPanel":479,"./PicaBusinessStreet/PicaBusinessContentPanel.ts":479,"./PicaBusinessStreet/PicaBusinessHistoryPanel":495,"./PicaBusinessStreet/PicaBusinessHistoryPanel.ts":495,"./PicaBusinessStreet/PicaBusinessMyStreetPanel":496,"./PicaBusinessStreet/PicaBusinessMyStreetPanel.ts":496,"./PicaBusinessStreet/PicaBusinessRankRewardPanel":497,"./PicaBusinessStreet/PicaBusinessRankRewardPanel.ts":497,"./PicaBusinessStreet/PicaBusinessRankingDetailPanel":498,"./PicaBusinessStreet/PicaBusinessRankingDetailPanel.ts":498,"./PicaBusinessStreet/PicaBusinessRankingPanel":499,"./PicaBusinessStreet/PicaBusinessRankingPanel.ts":499,"./PicaBusinessStreet/PicaBusinessStoreCreatePanel":500,"./PicaBusinessStreet/PicaBusinessStoreCreatePanel.ts":500,"./PicaBusinessStreet/PicaBusinessStreetListPanel":501,"./PicaBusinessStreet/PicaBusinessStreetListPanel.ts":501,"./PicaBusinessStreet/PicaBusinessStreetPanel":560,"./PicaBusinessStreet/PicaBusinessStreetPanel.ts":560,"./PicaBusinessStreet/SecondaryMenuPanel":478,"./PicaBusinessStreet/SecondaryMenuPanel.ts":478,"./PicaChat/PicaChatInputPanel":486,"./PicaChat/PicaChatInputPanel.ts":486,"./PicaChat/PicaChatPanel":544,"./PicaChat/PicaChatPanel.ts":544,"./PicaChat/PicaGiftPanel":487,"./PicaChat/PicaGiftPanel.ts":487,"./PicaCompose/PicaComposePanel":561,"./PicaCompose/PicaComposePanel.ts":561,"./PicaCreateRole/PicaCreateRolePanel":562,"./PicaCreateRole/PicaCreateRolePanel.ts":562,"./PicaDecorate/PicaDecoratePanel":636,"./PicaDecorate/PicaDecoratePanel.ts":636,"./PicaDecorateControl/PicaDecorateControlPanel":563,"./PicaDecorateControl/PicaDecorateControlPanel.ts":563,"./PicaEffectMgr/PicaEffectMgrPanel":564,"./PicaEffectMgr/PicaEffectMgrPanel.ts":564,"./PicaEffectMgr/PicaFurniUnlockEffectPanel":502,"./PicaEffectMgr/PicaFurniUnlockEffectPanel.ts":502,"./PicaElementStorage/Item":617,"./PicaElementStorage/Item.ts":617,"./PicaElementStorage/PicaElementStoragePanel":565,"./PicaElementStorage/PicaElementStoragePanel.ts":565,"./PicaElevator/PicaElevatorPanel":566,"./PicaElevator/PicaElevatorPanel.ts":566,"./PicaEquipUpgrade/PicaEquipUpgradeItem":503,"./PicaEquipUpgrade/PicaEquipUpgradeItem.ts":503,"./PicaEquipUpgrade/PicaEquipUpgradePanel":567,"./PicaEquipUpgrade/PicaEquipUpgradePanel.ts":567,"./PicaExploreList/PicaChapterLevelClue":480,"./PicaExploreList/PicaChapterLevelClue.ts":480,"./PicaExploreList/PicaExploreListBottomPanel":504,"./PicaExploreList/PicaExploreListBottomPanel.ts":504,"./PicaExploreList/PicaExploreListDetailPanel":505,"./PicaExploreList/PicaExploreListDetailPanel.ts":505,"./PicaExploreList/PicaExploreListLevelPanel":506,"./PicaExploreList/PicaExploreListLevelPanel.ts":506,"./PicaExploreList/PicaExploreListPanel":568,"./PicaExploreList/PicaExploreListPanel.ts":568,"./PicaExploreLog/PicaExploreLogPanel":569,"./PicaExploreLog/PicaExploreLogPanel.ts":569,"./PicaExploreLog/PicaExploreLogSettlePanel":507,"./PicaExploreLog/PicaExploreLogSettlePanel.ts":507,"./PicaFriend/PicaFriendPanel":570,"./PicaFriend/PicaFriendPanel.ts":570,"./PicaFurniFun/PicaFurniFunPanel":571,"./PicaFurniFun/PicaFurniFunPanel.ts":571,"./PicaFurnitureCompose/PicaFurnitureComposePanel":572,"./PicaFurnitureCompose/PicaFurnitureComposePanel.ts":572,"./PicaGiftEffect/PicaGiftEffectPanel":573,"./PicaGiftEffect/PicaGiftEffectPanel.ts":573,"./PicaGiftEffect/PicaGiftLateralItem":509,"./PicaGiftEffect/PicaGiftLateralItem.ts":509,"./PicaGiftEffect/PicaGiftLaterctPanel":508,"./PicaGiftEffect/PicaGiftLaterctPanel.ts":508,"./PicaGiftEffect/PicaGiftPlayerPanel":510,"./PicaGiftEffect/PicaGiftPlayerPanel.ts":510,"./PicaHandheld/PicaHandheldPanel":543,"./PicaHandheld/PicaHandheldPanel.ts":543,"./PicaHouse/PicaHouseInfoPanel":511,"./PicaHouse/PicaHouseInfoPanel.ts":511,"./PicaHouse/PicaHousePanel":574,"./PicaHouse/PicaHousePanel.ts":574,"./PicaItemPopCard/PicaItemPopCardPanel":575,"./PicaItemPopCard/PicaItemPopCardPanel.ts":575,"./PicaMainUI/PicaMainUIPanel":545,"./PicaMainUI/PicaMainUIPanel.ts":545,"./PicaManorList/PicaManorContentPanel":512,"./PicaManorList/PicaManorContentPanel.ts":512,"./PicaManorList/PicaManorListPanel":576,"./PicaManorList/PicaManorListPanel.ts":576,"./PicaManorList/PicaManorScrollPanel":513,"./PicaManorList/PicaManorScrollPanel.ts":513,"./PicaMarket/ElementDetail":514,"./PicaMarket/ElementDetail.ts":514,"./PicaMarket/NumberCounter":515,"./PicaMarket/NumberCounter.ts":515,"./PicaMarket/PicaMarketPanel":577,"./PicaMarket/PicaMarketPanel.ts":577,"./PicaMarket/item":516,"./PicaMarket/item.ts":516,"./PicaMessageBox/PicaMessageBoxPanel":578,"./PicaMessageBox/PicaMessageBoxPanel.ts":578,"./PicaMineCar/PicaMineCarPanel":579,"./PicaMineCar/PicaMineCarPanel.ts":579,"./PicaMineSettle/PicaMineSettlePanel":580,"./PicaMineSettle/PicaMineSettlePanel.ts":580,"./PicaNavigate/PicaNavigatePanel":581,"./PicaNavigate/PicaNavigatePanel.ts":581,"./PicaNewMain/PicaNewActivityPanel":517,"./PicaNewMain/PicaNewActivityPanel.ts":517,"./PicaNewMain/PicaNewChatPanel":518,"./PicaNewMain/PicaNewChatPanel.ts":518,"./PicaNewMain/PicaNewHeadPanel":519,"./PicaNewMain/PicaNewHeadPanel.ts":519,"./PicaNewMain/PicaNewLeftPanel":520,"./PicaNewMain/PicaNewLeftPanel.ts":520,"./PicaNewMain/PicaNewMainPanel":582,"./PicaNewMain/PicaNewMainPanel.ts":582,"./PicaNewMain/PicaNewNavigatePanel":488,"./PicaNewMain/PicaNewNavigatePanel.ts":488,"./PicaNewMain/PicaNewOldMainPanel":637,"./PicaNewMain/PicaNewOldMainPanel.ts":637,"./PicaNewRole/PicaNewRolePanel":583,"./PicaNewRole/PicaNewRolePanel.ts":583,"./PicaNotice/PicaNoticePanel":584,"./PicaNotice/PicaNoticePanel.ts":584,"./PicaOnline/PicaOnlineBottomPanel":618,"./PicaOnline/PicaOnlineBottomPanel.ts":618,"./PicaOnline/PicaOnlinePanel":585,"./PicaOnline/PicaOnlinePanel.ts":585,"./PicaOpenParty/PicaOpenPartyCreatePanel":521,"./PicaOpenParty/PicaOpenPartyCreatePanel.ts":521,"./PicaOpenParty/PicaOpenPartyPanel":586,"./PicaOpenParty/PicaOpenPartyPanel.ts":586,"./PicaOrder/PicaOrderPanel":638,"./PicaOrder/PicaOrderPanel.ts":638,"./PicaPartyList/PicaMyRoomNavigationPanel":619,"./PicaPartyList/PicaMyRoomNavigationPanel.ts":619,"./PicaPartyList/PicaPartyListPanel":587,"./PicaPartyList/PicaPartyListPanel.ts":587,"./PicaPartyList/PicaPartyNavigationPanel":620,"./PicaPartyList/PicaPartyNavigationPanel.ts":620,"./PicaPropFun/PicaPropFunPanel":588,"./PicaPropFun/PicaPropFunPanel.ts":588,"./PicaRecaste/PicaRecastePanel":589,"./PicaRecaste/PicaRecastePanel.ts":589,"./PicaRecharge/PicaRechargePanel":590,"./PicaRecharge/PicaRechargePanel.ts":590,"./PicaRewardTip/PicaRewardTipPanel":591,"./PicaRewardTip/PicaRewardTipPanel.ts":591,"./PicaRoam/PicaRoamDrawPanel":522,"./PicaRoam/PicaRoamDrawPanel.ts":522,"./PicaRoam/PicaRoamEffectOnePanel":639,"./PicaRoam/PicaRoamEffectOnePanel.ts":639,"./PicaRoam/PicaRoamListPanel":523,"./PicaRoam/PicaRoamListPanel.ts":523,"./PicaRoam/PicaRoamPanel":592,"./PicaRoam/PicaRoamPanel.ts":592,"./PicaRoam/PicaRoamPreviewPanel":524,"./PicaRoam/PicaRoamPreviewPanel.ts":524,"./PicaRoomList/PicaRoomListPanel":593,"./PicaRoomList/PicaRoomListPanel.ts":593,"./PicaTask/PicaTaskItem":525,"./PicaTask/PicaTaskItem.ts":525,"./PicaTask/PicaTaskMainPanel":526,"./PicaTask/PicaTaskMainPanel.ts":526,"./PicaTask/PicaTaskPanel":594,"./PicaTask/PicaTaskPanel.ts":594,"./PicaTask/PicaTaskSidePanel":595,"./PicaTask/PicaTaskSidePanel.ts":595,"./PicaTreasure/PicaTreasureAllOpenPanel":528,"./PicaTreasure/PicaTreasureAllOpenPanel.ts":528,"./PicaTreasure/PicaTreasureOpenPanel":529,"./PicaTreasure/PicaTreasureOpenPanel.ts":529,"./PicaTreasure/PicaTreasurePanel":596,"./PicaTreasure/PicaTreasurePanel.ts":596,"./PicaTreasure/PicaTreasurePreviewPanel":530,"./PicaTreasure/PicaTreasurePreviewPanel.ts":530,"./PicaWork/PicaWorkOldPanel":597,"./PicaWork/PicaWorkOldPanel.ts":597,"./PicaWork/PicaWorkPanel":640,"./PicaWork/PicaWorkPanel.ts":640,"./SinglePanel/PicaItemTipsPanel":527,"./SinglePanel/PicaItemTipsPanel.ts":527,"./SinglePanel/PicaSingleManager":476,"./SinglePanel/PicaSingleManager.ts":476,"./Task/TaskPanel":598,"./Task/TaskPanel.ts":598,"./index":481,"./index.ts":481,"./pica.Renderuimanager":546,"./pica.Renderuimanager.ts":546,"./pica.base.panel":471,"./pica.base.panel.ts":471};function webpackContext(t){var e=webpackContextResolve(t);return i(e)}function webpackContextResolve(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}webpackContext.keys=function webpackContextKeys(){return Object.keys(n)},webpackContext.resolve=webpackContextResolve,t.exports=webpackContext,webpackContext.id=642},,function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n=i(180),s=i(184),r=function(){function EditorCanvasManager(t){this.render=t,this.AVATAR_CANVAS_TEST_DATA=[{id:"5facff1a67d3b140e835e1d0",parts:["head_hair"]}],this.AVATAR_CANVAS_RESOURCE_PATH="https://osd-alpha.tooqing.com",this.AVATAR_CANVAS_PARENT="avatarCanvas",this.SCENEKEY_SNAPSHOT="AvatarEditorSnapshotScene"}return EditorCanvasManager.prototype.destroy=function(){this.render.game&&(this.render.game.scene.stop(this.SCENEKEY_SNAPSHOT),this.render.game.scene.remove(this.SCENEKEY_SNAPSHOT))},EditorCanvasManager.prototype.createHeadIcon=function(t){var e=this;return new Promise((function(i,r){e.render.game.scene.getScene(e.SCENEKEY_SNAPSHOT)||e.render.game.scene.add(e.SCENEKEY_SNAPSHOT,n.c,!1),e.render.sceneManager.currentScene.scene.launch(e.SCENEKEY_SNAPSHOT,{onCreated:function(n){e.render.game.scene.sendToBack(e.SCENEKEY_SNAPSHOT);new s.a(n,e.AVATAR_CANVAS_RESOURCE_PATH,e.render.emitter,!1,t,(function(t){t.generateHeadIcon().then((function(n){i(n),t.destroy(),e.render.game.scene.stop(e.SCENEKEY_SNAPSHOT),e.render.game.scene.remove(e.SCENEKEY_SNAPSHOT)}))}))}})}))},EditorCanvasManager}()}])]);